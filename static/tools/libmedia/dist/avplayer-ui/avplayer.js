!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.AVPlayer=t():e.AVPlayer=t()}(self,(()=>(()=>{var e,t,i={83327:e=>{var t,i,r,s,a,n,o,c,l,d,h,u,f,p,m,g,v,y,A,b,w,x,k,T,I;e.exports=(t=void 0,i=!0,r={class:"avplayer-ui-player"},s={class:"avplayer-ui-title"},a={d:"M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"},n={viewBox:"64 64 896 896"},o={href:"https://github.com/zhaohappy/libmedia",target:"_blank"},c={class:"avplayer-ui-header"},l={class:"avplayer-ui-progress-container"},d={class:"avplayer-ui-control-item"},h={class:"avplayer-ui-footer-left"},u={class:"avplayer-ui-footer-right"},f={class:"avplayer-ui-control"},p={class:"avplayer-ui-footer"},m={d:"m10 17 5-5-5-5v10z"},g={viewBox:"0 0 24 24"},v={class:"avplayer-ui-pcm-visualization-container"},y={height:"min(80vh, 80vw)",width:"min(80vh, 80vw)"},A={class:"avplayer-ui-pcm-visualization-mask"},b={class:"avplayer-ui-mask"},w={class:"avplayer-ui-mask info"},x={class:"avplayer-ui-mask showSettings"},k={class:"avplayer-ui-menu-item"},T={class:"avplayer-ui-menu"},I={type:"text/css"},function(e,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z,V,W,j,G,H,q,Y,K,Q,X,J,Z,ee,te,ie,re,se,ae,ne,oe,ce){ce.push({children:function(){var S=[];return S.push({context:X,events:{click:M("click","playClick(true)","click","","playClick",{execute:function(e,t){return[!0]}})},nativeAttrs:r,operator:H,ref:"playerContainer",tag:"div",type:3}),N(ae,ae.length-1,"hasHeader").value?S.push({children:function(){var e=[];return e.push({context:X,nativeAttrs:s,operator:H,tag:"span",text:W(N(ae,ae.length-1,"title").value),type:3}),e.push({children:[{children:[{context:X,isPure:i,isStatic:i,isSvg:i,nativeAttrs:a,operator:H,tag:"path",type:3}],context:X,isPure:i,isStatic:i,isSvg:i,nativeAttrs:n,operator:H,tag:"svg",type:3}],context:X,isPure:i,isStatic:i,nativeAttrs:o,operator:H,tag:"a",type:3}),e.length?e:t}(),context:X,nativeAttrs:c,operator:H,tag:"div",type:3}):S.push({isPure:i,operator:G,text:"",type:2}),N(ae,ae.length-1,"hasFooter").value?S.push({children:function(){var e=[];return N(ae,ae.length-1,"isLive").value?e.push({isPure:i,operator:G,text:"",type:2}):e.push({children:function(){var e=[];return e.push({context:X,operator:q,props:{indicatorUrl:N(ae,ae.length-1,"indicatorUrl").value,player:N(ae,ae.length-1,"player").value},tag:"Progress",type:4}),e.length?e:t}(),context:X,nativeAttrs:l,operator:H,tag:"div",type:3}),e.push({children:function(){var e=[];return e.push({children:function(){var e=[];return e.push({children:function(){var e=[];return e.push({context:X,operator:q,props:{language:N(ae,ae.length-1,"language").value,played:N(ae,ae.length-1,"played").value,player:N(ae,ae.length-1,"player").value},ref:"play",tag:"Play",type:4}),e.length?e:t}(),context:X,nativeAttrs:d,operator:H,tag:"div",type:3}),e.push({children:function(){var e=[];return e.push({context:X,operator:q,props:{language:N(ae,ae.length-1,"language").value,player:N(ae,ae.length-1,"player").value},tag:"Volume",type:4}),e.length?e:t}(),context:X,nativeAttrs:d,operator:H,tag:"div",type:3}),N(ae,ae.length-1,"isLive").value?e.push({isPure:i,operator:G,text:"",type:2}):e.push({children:function(){var e=[];return e.push({context:X,operator:q,props:{language:N(ae,ae.length-1,"language").value,player:N(ae,ae.length-1,"player").value},tag:"Loop",type:4}),e.length?e:t}(),context:X,nativeAttrs:d,operator:H,tag:"div",type:3}),N(ae,ae.length-1,"isLive").value?e.push({isPure:i,operator:G,text:"",type:2}):e.push({children:function(){var e=[];return e.push({context:X,operator:q,props:{language:N(ae,ae.length-1,"language").value,player:N(ae,ae.length-1,"player").value},tag:"Timer",type:4}),e.length?e:t}(),context:X,nativeAttrs:d,operator:H,tag:"div",type:3}),e.length?e:t}(),context:X,nativeAttrs:h,operator:H,tag:"div",type:3}),e.push({children:function(){var e=[];return N(ae,ae.length-1,"hasVideoTrack").value?e.push({children:function(){var e=[];return e.push({context:X,operator:q,props:{language:N(ae,ae.length-1,"language").value,player:N(ae,ae.length-1,"player").value},tag:"VideoTrack",type:4}),e.length?e:t}(),context:X,nativeAttrs:d,operator:H,tag:"div",type:3}):e.push({isPure:i,operator:G,text:"",type:2}),N(ae,ae.length-1,"hasAudioTrack").value?e.push({children:function(){var e=[];return e.push({context:X,operator:q,props:{language:N(ae,ae.length-1,"language").value,player:N(ae,ae.length-1,"player").value},tag:"AudioTrack",type:4}),e.length?e:t}(),context:X,nativeAttrs:d,operator:H,tag:"div",type:3}):e.push({isPure:i,operator:G,text:"",type:2}),N(ae,ae.length-1,"hasSubtitleTrack").value?e.push({children:function(){var e=[];return e.push({context:X,operator:q,props:{language:N(ae,ae.length-1,"language").value,player:N(ae,ae.length-1,"player").value},tag:"SubtitleTrack",type:4}),e.length?e:t}(),context:X,nativeAttrs:d,operator:H,tag:"div",type:3}):e.push({isPure:i,operator:G,text:"",type:2}),e.push({children:function(){var e=[];return e.push({context:X,operator:q,props:{language:N(ae,ae.length-1,"language").value,player:N(ae,ae.length-1,"player").value},tag:"Playrate",type:4}),e.length?e:t}(),context:X,nativeAttrs:d,operator:H,tag:"div",type:3}),e.push({children:function(){var e=[];return e.push({context:X,operator:q,props:{language:N(ae,ae.length-1,"language").value,player:N(ae,ae.length-1,"player").value},tag:"Setting",type:4}),e.length?e:t}(),context:X,nativeAttrs:d,operator:H,tag:"div",type:3}),N(ae,ae.length-1,"hasPip").value?e.push({children:function(){var e=[];return e.push({context:X,operator:q,props:{language:N(ae,ae.length-1,"language").value,player:N(ae,ae.length-1,"player").value},tag:"Pip",type:4}),e.length?e:t}(),context:X,nativeAttrs:d,operator:H,tag:"div",type:3}):e.push({isPure:i,operator:G,text:"",type:2}),e.push({children:function(){var e=[];return e.push({context:X,operator:q,props:{dom:N(ae,ae.length-1,"fullscreenDom").value,language:N(ae,ae.length-1,"language").value,player:N(ae,ae.length-1,"player").value},tag:"Fullscreen",type:4}),e.length?e:t}(),context:X,nativeAttrs:d,operator:H,tag:"div",type:3}),e.length?e:t}(),context:X,nativeAttrs:u,operator:H,tag:"div",type:3}),e.length?e:t}(),context:X,nativeAttrs:f,operator:H,tag:"div",type:3}),e.length?e:t}(),context:X,nativeAttrs:p,operator:H,tag:"div",type:3}):S.push({isPure:i,operator:G,text:"",type:2}),N(ae,ae.length-1,"hasFolder").value?S.push({children:function(){var e=[];return e.push({children:[{children:[{context:X,isPure:i,isStatic:i,isSvg:i,nativeAttrs:m,operator:H,tag:"path",type:3}],context:X,isPure:i,isStatic:i,isSvg:i,nativeAttrs:g,operator:H,tag:"svg",type:3}],context:X,events:{click:M("click","toggleFold()","click","","toggleFold")},nativeAttrs:{class:"avplayer-ui-folder-toggle hint--right","data-hint":N(ae,ae.length-1,"folded").value?O(ae,ae.length-1,"language.TIP_UNFOLD",["language","TIP_UNFOLD"],i).value:O(ae,ae.length-1,"language.TIP_FOLD",["language","TIP_FOLD"],i).value},operator:H,tag:"div",type:3}),e.push({context:X,operator:q,props:{language:N(ae,ae.length-1,"language").value,player:N(ae,ae.length-1,"player").value},ref:"folder",tag:"Folder",type:4}),e.length?e:t}(),context:X,nativeAttrs:{class:"avplayer-ui-folder-container","data-fold":N(ae,ae.length-1,"folded").value?1:0},operator:H,tag:"div",type:3}):S.push({isPure:i,operator:G,text:"",type:2}),S.push({context:X,operator:q,props:{error:N(ae,ae.length-1,"error").value,language:N(ae,ae.length-1,"language").value,player:N(ae,ae.length-1,"player").value},tag:"LoadingTip",type:4}),N(ae,ae.length-1,"hasPcmVisualization").value&&!N(ae,ae.length-1,"loading").value?S.push({children:function(){var e=[];return e.push({children:function(){var e=[];return e.push({context:X,operator:q,props:{language:N(ae,ae.length-1,"language").value,player:N(ae,ae.length-1,"player").value},tag:"PcmVisualization",type:4}),e.length?e:t}(),context:X,nativeAttrs:v,nativeStyles:y,operator:H,tag:"div",type:3}),e.length?e:t}(),context:X,nativeAttrs:A,operator:H,tag:"div",type:3}):S.push({isPure:i,operator:G,text:"",type:2}),S.push({children:function(){var e=[];return e.push({children:function(){var e=[];return N(ae,ae.length-1,"error").value?e.push({context:X,nativeAttrs:{src:N(ae,ae.length-1,"errorStateUrl").value},operator:H,tag:"img",type:3}):N(ae,ae.length-1,"played").value?e.push({isPure:i,operator:G,text:"",type:2}):e.push({context:X,events:{click:M("click","playClick()","click","","playClick")},nativeAttrs:{src:N(ae,ae.length-1,"pauseStateUrl").value},operator:H,tag:"img",type:3}),e.length?e:t}(),context:X,nativeAttrs:{class:"avplayer-ui-state","data-show":N(ae,ae.length-1,"title").value&&!N(ae,ae.length-1,"played").value&&!N(ae,ae.length-1,"loading").value||N(ae,ae.length-1,"error").value?1:0},operator:H,tag:"div",type:3}),e.length?e:t}(),context:X,nativeAttrs:b,operator:H,tag:"div",type:3}),N(ae,ae.length-1,"showInfo").value?S.push({children:function(){var e=[];return e.push({context:X,operator:q,props:{language:N(ae,ae.length-1,"language").value,player:N(ae,ae.length-1,"player").value},tag:"Info",type:4}),e.length?e:t}(),context:X,nativeAttrs:w,operator:H,tag:"div",type:3}):S.push({isPure:i,operator:G,text:"",type:2}),N(ae,ae.length-1,"showSettings").value?S.push({children:function(){var e=[];return e.push({context:X,operator:q,props:{language:N(ae,ae.length-1,"language").value,player:N(ae,ae.length-1,"player").value},tag:"Settings",type:4}),e.length?e:t}(),context:X,nativeAttrs:x,operator:H,tag:"div",type:3}):S.push({isPure:i,operator:G,text:"",type:2}),N(ae,ae.length-1,"showMenu").value?S.push({children:function(){var e=[];return D(N(ae,ae.length-1,"menu"),(function(t,i,r,s){e.push({context:X,events:{click:M("click","menuAction(action)","click","","menuAction",{execute:function(e,i){return[N(t,t.length-1,"action").value]}})},key:N(t,t.length-1,"action").value,nativeAttrs:k,operator:H,tag:"div",text:W(N(t,t.length-1,"name").value),type:3})})),e.length?e:t}(),context:X,events:{outside:M("outside","menuOutside()","outside","","menuOutside")},nativeAttrs:T,nativeStyles:e("top: "+W(N(ae,ae.length-1,"menuTop").value)+"px; left: "+W(N(ae,ae.length-1,"menuLeft").value)+"px;"),operator:H,tag:"div",type:3}):S.push({isPure:i,operator:G,text:"",type:2}),S.push({context:X,html:W(N(ae,ae.length-1,"style").value),nativeAttrs:I,operator:H,tag:"style",type:3}),S.length?S:t}(),context:X,events:{mousemove:M("mousemove","mousemove()","mousemove","","mousemove")},nativeAttrs:{class:"avplayer-ui-container","data-bar-show":N(ae,ae.length-1,"showBar").value?1:0,id:"avplayer-ui-container"},operator:H,tag:"div",type:3})})},82723:e=>{var t,i,r,s,a;e.exports=(t=void 0,i={class:"avplayer-ui-control-audio-track-value"},r={class:"libmedia-ui-selector"},s={type:"text/css"},a={class:"avplayer-ui-control-audio-track"},function(e,n,o,c,l,d,h,u,f,p,m,g,v,y,A,b,w,x,k,T,I,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z,V){V.push({children:function(){var e=[];return e.push({context:B,nativeAttrs:i,operator:S,tag:"div",text:k(A(O,O.length-1,"language.CONTROL_AUDIO_TRACK",["language","CONTROL_AUDIO_TRACK"],!0).value),type:3}),e.push({children:function(){var e=[];return f(b(O,O.length-1,"list"),(function(t,i,r,s,a){e.push({context:B,events:{click:l("click","change(i)","click","","change",{execute:function(e,t){return[a]}})},key:b(t,t.length-1,"id").value,nativeAttrs:{class:"libmedia-ui-selector-item "+(b(t,t.length-1,"selectIndex").value===a?"active":"")},operator:S,tag:"div",text:k(b(t,t.length-1,"name").value),type:3})})),e.length?e:t}(),context:B,nativeAttrs:r,operator:S,tag:"div",type:3}),e.push({context:B,html:k(b(O,O.length-1,"style").value),nativeAttrs:s,operator:S,tag:"style",type:3}),e.length?e:t}(),context:B,nativeAttrs:a,operator:S,tag:"div",type:3})})},22179:e=>{var t,i,r,s,a;e.exports=(t=!0,i={d:"M768 298.666667h170.666667v85.333333h-256V128h85.333333v170.666667zM341.333333 384H85.333333V298.666667h170.666667V128h85.333333v256z m426.666667 341.333333v170.666667h-85.333333v-256h256v85.333333h-170.666667zM341.333333 640v256H256v-170.666667H85.333333v-85.333333h256z",fill:"#ffffff"},r={class:"icon",version:"1.1",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},s={d:"M625.777778 256h142.222222V398.222222h113.777778V142.222222H625.777778v113.777778zM256 398.222222V256H398.222222v-113.777778H142.222222V398.222222h113.777778zM768 625.777778v142.222222H625.777778v113.777778h256V625.777778h-113.777778zM398.222222 768H256V625.777778h-113.777778v256H398.222222v-113.777778z",fill:"#ffffff"},a={type:"text/css"},function(e,n,o,c,l,d,h,u,f,p,m,g,v,y,A,b,w,x,k,T,I,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z,V){V.push({children:function(){var e=[];return b(O,O.length-1,"fullscreen").value?e.push({children:[{context:B,isPure:t,isStatic:t,isSvg:t,nativeAttrs:i,operator:S,tag:"path",type:3}],context:B,isPure:t,isStatic:t,isSvg:t,nativeAttrs:r,operator:S,tag:"svg",type:3}):e.push({children:[{context:B,isPure:t,isStatic:t,isSvg:t,nativeAttrs:s,operator:S,tag:"path",type:3}],context:B,isPure:t,isStatic:t,isSvg:t,nativeAttrs:r,operator:S,tag:"svg",type:3}),e.push({context:B,html:k(b(O,O.length-1,"style").value),nativeAttrs:a,operator:S,tag:"style",type:3}),e.length?e:void 0}(),context:B,events:{click:l("click","fullscreenClick()","click","","fullscreenClick")},nativeAttrs:{class:"avplayer-ui-control-fullscreen hint--top","data-hint":A(O,O.length-1,"language.TIP_FULLSCREEN",["language","TIP_FULLSCREEN"],t).value},operator:S,tag:"div",type:3})})},82237:e=>{var t,i,r,s,a,n;e.exports=(t=!0,i={d:"M9 8.877a3 3 0 0 0-2.995 2.824L6 11.877v4a3 3 0 0 0 2.824 2.995l.176.005a1 1 0 1 1 0 2 5 5 0 0 1-4.995-4.783L4 15.877v-4a5 5 0 0 1 4.783-4.995L9 6.877h3V5.5a.5.5 0 0 1 .834-.372L17 8.878H9Zm11 10a3 3 0 0 0 2.995-2.823l.005-.177v-4a3 3 0 0 0-2.824-2.995L20 8.877a1 1 0 0 1 0-2 5 5 0 0 1 4.995 4.783l.005.217v4a5 5 0 0 1-4.783 4.996l-.217.004h-3v1.378a.5.5 0 0 1-.834.371L12 18.877h8Z","fill-rule":"nonzero"},r={"fill-rule":"evenodd"},s={viewBox:"0 0 28 28",xmlns:"http://www.w3.org/2000/svg"},a={d:"M16.859 14.22c2.738 0 4.958 2.164 4.958 4.834 0 2.67-2.22 4.834-4.958 4.834-2.739 0-4.959-2.164-4.959-4.834 0-2.67 2.22-4.835 4.959-4.835Zm0 .966c-2.19 0-3.967 1.732-3.967 3.868s1.776 3.867 3.967 3.867c2.19 0 3.967-1.731 3.967-3.867s-1.776-3.868-3.967-3.868Zm-1.206 2.02.069.056 2.975 2.9a.475.475 0 0 1 0 .684.506.506 0 0 1-.633.056l-.068-.056-2.975-2.9a.475.475 0 0 1 0-.684.506.506 0 0 1 .632-.056ZM12.591 4.9a.69.69 0 0 1 .456.171l3.812 3.346H11.9v-.001H8.925c-1.584 0-2.88 1.208-2.97 2.731l-.005.17v3.868c0 1.545 1.239 2.808 2.8 2.896l.175.005.992-.001v1.934h-.992c-2.664 0-4.838-2.048-4.953-4.619l-.005-.215v-3.868c0-2.597 2.101-4.717 4.737-4.83l.221-.004H11.9v-.892c0-.382.31-.691.691-.691Zm7.243 1.68c2.19.433 3.856 2.274 3.961 4.512l.006.225v3.868c0 .432-.058.85-.167 1.248l-1.817-2.215v-2.9c0-1.263-.827-2.338-1.982-2.736V6.581Z","fill-rule":"nonzero"},n={type:"text/css"},function(e,o,c,l,d,h,u,f,p,m,g,v,y,A,b,w,x,k,T,I,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z,V,W){W.push({children:function(){var e=[];return w(N,N.length-1,"loop").value?e.push({children:[{children:[{context:E,isPure:t,isStatic:t,isSvg:t,nativeAttrs:i,operator:P,tag:"path",type:3}],context:E,isPure:t,isStatic:t,isSvg:t,nativeAttrs:r,operator:P,tag:"g",type:3}],context:E,isPure:t,isStatic:t,isSvg:t,nativeAttrs:s,operator:P,tag:"svg",type:3}):e.push({children:[{children:[{context:E,isPure:t,isStatic:t,isSvg:t,nativeAttrs:a,operator:P,tag:"path",type:3}],context:E,isPure:t,isStatic:t,isSvg:t,nativeAttrs:r,operator:P,tag:"g",type:3}],context:E,isPure:t,isStatic:t,isSvg:t,nativeAttrs:s,operator:P,tag:"svg",type:3}),e.push({context:E,html:T(w(N,N.length-1,"style").value),nativeAttrs:n,operator:P,tag:"style",type:3}),e.length?e:void 0}(),context:E,events:{click:d("click","change()","click","","change")},nativeAttrs:{class:"avplayer-ui-control-loop hint--top","data-hint":w(N,N.length-1,"loop").value?b(N,N.length-1,"language.TIP_LOOP_STOP",["language","TIP_LOOP_STOP"],t).value:b(N,N.length-1,"language.TIP_LOOP_START",["language","TIP_LOOP_START"],t).value},operator:P,tag:"div",type:3})})},16979:e=>{var t,i,r,s;e.exports=(t=!0,i={d:"M23.625 15.75c.966 0 1.75.784 1.75 1.75v4.375a1.75 1.75 0 0 1-1.75 1.75H17.5a1.75 1.75 0 0 1-1.75-1.75V17.5c0-.966.784-1.75 1.75-1.75h6.125ZM21 5.25a2.625 2.625 0 0 1 2.62 2.47l.005.155v5.25a.875.875 0 0 1-1.744.102l-.006-.102v-5.25a.875.875 0 0 0-.773-.87L21 7H7a.875.875 0 0 0-.87.773l-.005.102V19.25c0 .449.338.819.773.87l.102.005h6.125a.875.875 0 0 1 .102 1.744l-.102.006H7a2.625 2.625 0 0 1-2.62-2.47l-.005-.155V7.875a2.625 2.625 0 0 1 2.47-2.62L7 5.25h14Z","fill-rule":"evenodd","stroke-width":".5"},r={viewBox:"0 0 28 28",xmlns:"http://www.w3.org/2000/svg"},s={type:"text/css"},function(e,a,n,o,c,l,d,h,u,f,p,m,g,v,y,A,b,w,x,k,T,I,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z){z.push({children:function(){var e=[];return e.push({children:[{children:[{context:C,isPure:t,isStatic:t,isSvg:t,nativeAttrs:i,operator:I,tag:"path",type:3}],context:C,isPure:t,isStatic:t,isSvg:t,operator:I,tag:"g",type:3}],context:C,isPure:t,isStatic:t,isSvg:t,nativeAttrs:r,operator:I,tag:"svg",type:3}),e.push({context:C,html:x(A(F,F.length-1,"style").value),nativeAttrs:s,operator:I,tag:"style",type:3}),e.length?e:void 0}(),context:C,events:{click:c("click","pipClick()","click","","pipClick")},nativeAttrs:{class:"avplayer-ui-control-pip hint--top","data-hint":A(F,F.length-1,"pip").value?y(F,F.length-1,"language.TIP_PIP_STOP",["language","TIP_PIP_STOP"],t).value:y(F,F.length-1,"language.TIP_PIP_START",["language","TIP_PIP_START"],t).value},operator:I,tag:"div",type:3})})},1449:e=>{var t,i,r,s,a;e.exports=(t=!0,i={d:"M7 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2zM15 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2z"},r={viewBox:"0 0 22 22",xmlns:"http://www.w3.org/2000/svg"},s={d:"M17.982 9.275L8.06 3.27A2.013 2.013 0 0 0 5 4.994v12.011a2.017 2.017 0 0 0 3.06 1.725l9.922-6.005a2.017 2.017 0 0 0 0-3.45z"},a={type:"text/css"},function(e,n,o,c,l,d,h,u,f,p,m,g,v,y,A,b,w,x,k,T,I,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z,V){V.push({children:function(){var e=[];return b(O,O.length-1,"played").value?e.push({children:[{context:B,isPure:t,isStatic:t,isSvg:t,nativeAttrs:i,operator:S,tag:"path",type:3}],context:B,isPure:t,isStatic:t,isSvg:t,nativeAttrs:r,operator:S,tag:"svg",type:3}):e.push({children:[{context:B,isPure:t,isStatic:t,isSvg:t,nativeAttrs:s,operator:S,tag:"path",type:3}],context:B,isPure:t,isStatic:t,isSvg:t,nativeAttrs:r,operator:S,tag:"svg",type:3}),e.push({context:B,html:k(b(O,O.length-1,"style").value),nativeAttrs:a,operator:S,tag:"style",type:3}),e.length?e:void 0}(),context:B,events:{click:l("click","playClick()","click","","playClick")},nativeAttrs:{class:"avplayer-ui-control-play hint--top","data-hint":b(O,O.length-1,"played").value?A(O,O.length-1,"language.TIP_PAUSE",["language","TIP_PAUSE"],t).value:A(O,O.length-1,"language.TIP_PLAY",["language","TIP_PLAY"],t).value},operator:S,tag:"div",type:3})})},8809:e=>{var t,i,r,s,a,n,o;e.exports=(i=void 0,r=!0,s={class:"avplayer-ui-control-play-rate-value"},a={class:"libmedia-ui-selector"},n={type:"text/css"},o={class:"avplayer-ui-control-play-rate"},function(e,c,l,d,h,u,f,p,m,g,v,y,A,b,w,x,k,T,I,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z,V,W,j){j.push({children:function(){var e=[];return e.push({context:D,nativeAttrs:s,operator:_,tag:"div",text:I(w(z,z.length-1,"language.CONTROL_PLAYRATE",["language","CONTROL_PLAYRATE"],r).value),type:3}),e.push({children:function(){var e=[];return m(x(z,z.length-1,"list"),(function(s,a,n,o,c){e.push({children:function(){var e=[];return e.push({isPure:r,operator:S,text:I((t=s[s.length-1],T(t.getScope(),t.keypath)).value)+"x",type:1}),e.length?e:i}(),context:D,events:{click:h("click","change(i)","click","","change",{execute:function(e,t){return[c]}})},key:(t=s[s.length-1],T(t.getScope(),t.keypath)).value,nativeAttrs:{class:"libmedia-ui-selector-item "+(x(s,s.length-1,"index").value===c?"active":"")},operator:_,tag:"div",type:3})})),e.length?e:i}(),context:D,nativeAttrs:a,operator:_,tag:"div",type:3}),e.push({context:D,html:I(x(z,z.length-1,"style").value),nativeAttrs:n,operator:_,tag:"style",type:3}),e.length?e:i}(),context:D,nativeAttrs:o,operator:_,tag:"div",type:3})})},78675:e=>{var t,i,r,s,a;e.exports=(t=!0,i={cx:"11",cy:"11",r:"2"},r={d:"M19.164 8.861L17.6 8.6a6.978 6.978 0 0 0-1.186-2.099l.574-1.533a1 1 0 0 0-.436-1.217l-1.997-1.153a1.001 1.001 0 0 0-1.272.23l-1.008 1.225a7.04 7.04 0 0 0-2.55.001L8.716 2.829a1 1 0 0 0-1.272-.23L5.447 3.751a1 1 0 0 0-.436 1.217l.574 1.533A6.997 6.997 0 0 0 4.4 8.6l-1.564.261A.999.999 0 0 0 2 9.847v2.306c0 .489.353.906.836.986l1.613.269a7 7 0 0 0 1.228 2.075l-.558 1.487a1 1 0 0 0 .436 1.217l1.997 1.153c.423.244.961.147 1.272-.23l1.04-1.263a7.089 7.089 0 0 0 2.272 0l1.04 1.263a1 1 0 0 0 1.272.23l1.997-1.153a1 1 0 0 0 .436-1.217l-.557-1.487c.521-.61.94-1.31 1.228-2.075l1.613-.269a.999.999 0 0 0 .835-.986V9.847a.999.999 0 0 0-.836-.986zM11 15a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"},s={viewBox:"0 0 22 22",xmlns:"http://www.w3.org/2000/svg"},a={type:"text/css"},function(e,n,o,c,l,d,h,u,f,p,m,g,v,y,A,b,w,x,k,T,I,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z,V){V.push({children:function(){var e=[];return e.push({children:[{context:B,isPure:t,isStatic:t,isSvg:t,nativeAttrs:i,operator:S,tag:"circle",type:3},{context:B,isPure:t,isStatic:t,isSvg:t,nativeAttrs:r,operator:S,tag:"path",type:3}],context:B,isPure:t,isStatic:t,isSvg:t,nativeAttrs:s,operator:S,tag:"svg",type:3}),e.push({context:B,html:k(b(O,O.length-1,"style").value),nativeAttrs:a,operator:S,tag:"style",type:3}),e.length?e:void 0}(),context:B,events:{click:l("click","click()","click","","click")},nativeAttrs:{class:"avplayer-ui-control-settings hint--top","data-hint":A(O,O.length-1,"language.TIP_SETTING",["language","TIP_SETTING"],t).value},operator:S,tag:"div",type:3})})},95683:e=>{var t,i,r,s,a,n,o;e.exports=(t=void 0,i=!0,r={class:"avplayer-ui-control-subtitle-track-value"},s={display:"none"},a={class:"libmedia-ui-selector"},n={type:"text/css"},o={class:"avplayer-ui-control-subtitle-track"},function(e,c,l,d,h,u,f,p,m,g,v,y,A,b,w,x,k,T,I,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z,V,W,j){j.push({children:function(){var e=[];return e.push({context:D,nativeAttrs:r,operator:_,tag:"div",text:I(w(z,z.length-1,"language.CONTROL_SUBTITLE_TRACK",["language","CONTROL_SUBTITLE_TRACK"],i).value),type:3}),e.push({children:function(){var e,r=[];return m(x(z,z.length-1,"list"),(function(e,t,i,s,a){r.push({context:D,events:{click:h("click","change(i)","click","","change",{execute:function(e,t){return[a]}})},key:x(e,e.length-1,"id").value,nativeAttrs:{class:"libmedia-ui-selector-item "+(x(e,e.length-1,"selectIndex").value===a?"active":"")},operator:_,tag:"div",text:I(x(e,e.length-1,"name").value),type:3})})),r.push((e={children:function(){var e=[];return e.push({isPure:i,operator:S,text:I(w(z,z.length-1,"language.CONTROL_SUBTITLE_TRACK_ADD",["language","CONTROL_SUBTITLE_TRACK_ADD"],i).value),type:1}),x(z,z.length-1,"canUseFilePicker").value?e.push({isPure:i,operator:P,text:"",type:2}):e.push({context:D,events:{change:h("change","fileChange()","change","","fileChange")},nativeAttrs:{accept:x(z,z.length-1,"accept").value,id:"avplayer-file-open-subtitle",type:"file"},nativeStyles:s,operator:_,tag:"input",type:3}),e.length?e:t}(),context:D,nativeAttrs:{class:"libmedia-ui-selector-item"},operator:_,tag:"label",type:3},x(z,z.length-1,"canUseFilePicker").value?y(e,"events","click",h("click","openFile()","click","","openFile")):y(e,"nativeAttrs","for","avplayer-file-open-subtitle"),e)),r.length?r:t}(),context:D,nativeAttrs:a,operator:_,tag:"div",type:3}),e.push({context:D,html:I(x(z,z.length-1,"style").value),nativeAttrs:n,operator:_,tag:"style",type:3}),e.length?e:t}(),context:D,nativeAttrs:o,operator:_,tag:"div",type:3})})},9127:e=>{var t,i,r,s,a,n;e.exports=(i=!0,r={class:"avplayer-ui-time-label"},s={class:"avplayer-ui-time-div"},a={type:"text/css"},n={class:"avplayer-ui-control-timer"},function(e,o,c,l,d,h,u,f,p,m,g,v,y,A,b,w,x,k,T,I,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z,V,W){W.push({children:function(){var e=[];return e.push({context:E,nativeAttrs:r,operator:P,tag:"span",text:T(k((t=w(N,N.length-1,"formatTime",R&&R.formatTime||U.formatTime).value,"function"==typeof t?t(w(N,N.length-1,"currentTime").value):D.fatal("[formatTime(currentTime)] is not a function."))).value),type:3}),e.push({context:E,html:"&nbsp;/&nbsp;",isPure:i,isStatic:i,nativeAttrs:s,operator:P,tag:"span",type:3}),e.push({context:E,nativeAttrs:r,operator:P,tag:"span",text:T(k((t=w(N,N.length-1,"formatTime",R&&R.formatTime||U.formatTime).value,"function"==typeof t?t(w(N,N.length-1,"totalTime").value):D.fatal("[formatTime(totalTime)] is not a function."))).value),type:3}),e.push({context:E,html:T(w(N,N.length-1,"style").value),nativeAttrs:a,operator:P,tag:"style",type:3}),e.length?e:void 0}(),context:E,nativeAttrs:n,operator:P,tag:"div",type:3})})},43145:e=>{var t,i,r,s,a;e.exports=(t=void 0,i={class:"avplayer-ui-control-video-track-value"},r={class:"libmedia-ui-selector"},s={type:"text/css"},a={class:"avplayer-ui-control-video-track"},function(e,n,o,c,l,d,h,u,f,p,m,g,v,y,A,b,w,x,k,T,I,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z,V){V.push({children:function(){var e=[];return e.push({context:B,nativeAttrs:i,operator:S,tag:"div",text:k(A(O,O.length-1,"language.CONTROL_VIDEO_TRACK",["language","CONTROL_VIDEO_TRACK"],!0).value),type:3}),e.push({children:function(){var e=[];return f(b(O,O.length-1,"list"),(function(t,i,r,s,a){e.push({context:B,events:{click:l("click","change(i)","click","","change",{execute:function(e,t){return[a]}})},key:b(t,t.length-1,"id").value,nativeAttrs:{class:"libmedia-ui-selector-item "+(b(t,t.length-1,"selectIndex").value===a?"active":"")},operator:S,tag:"div",text:k(b(t,t.length-1,"name").value),type:3})})),e.length?e:t}(),context:B,nativeAttrs:r,operator:S,tag:"div",type:3}),e.push({context:B,html:k(b(O,O.length-1,"style").value),nativeAttrs:s,operator:S,tag:"style",type:3}),e.length?e:t}(),context:B,nativeAttrs:a,operator:S,tag:"div",type:3})})},93069:e=>{var t,i,r,s,a,n,o,c,l,d,h,u,f;e.exports=(t=void 0,i=!0,r={d:"M10.188 4.65L6 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39V5.04a.498.498 0 0 0-.812-.39zM14.446 3.778a1 1 0 0 0-.862 1.804 6.002 6.002 0 0 1-.007 10.838 1 1 0 0 0 .86 1.806A8.001 8.001 0 0 0 19 11a8.001 8.001 0 0 0-4.554-7.222z"},s={d:"M15 11a3.998 3.998 0 0 0-2-3.465v6.93A3.998 3.998 0 0 0 15 11z"},a={viewBox:"0 0 22 22",xmlns:"http://www.w3.org/2000/svg"},n={d:"M15 11a3.998 3.998 0 0 0-2-3.465v2.636l1.865 1.865A4.02 4.02 0 0 0 15 11z"},o={d:"M13.583 5.583A5.998 5.998 0 0 1 17 11a6 6 0 0 1-.585 2.587l1.477 1.477a8.001 8.001 0 0 0-3.446-11.286 1 1 0 0 0-.863 1.805zM18.778 18.778l-2.121-2.121-1.414-1.414-1.415-1.415L13 13l-2-2-3.889-3.889-3.889-3.889a.999.999 0 1 0-1.414 1.414L5.172 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39v-3.131l2.587 2.587-.01.005a1 1 0 0 0 .86 1.806c.215-.102.424-.214.627-.333l2.3 2.3a1.001 1.001 0 0 0 1.414-1.416zM11 5.04a.5.5 0 0 0-.813-.39L8.682 5.854 11 8.172V5.04z"},c={class:"avplayer-ui-volume-icon"},l={class:"avplayer-ui-volume-value"},d={class:"avplayer-ui-volume-inner"},h={class:"avplayer-ui-volume-panel"},u={type:"text/css"},f={class:"avplayer-ui-control-volume"},function(e,p,m,g,v,y,A,b,w,x,k,T,I,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z,V,W,j,G,H,q,Y,K,Q){Q.push({children:function(){var e=[];return e.push({children:function(){var e=[];return _(q,q.length-1,"volume").value?e.push({children:[{context:O,isPure:i,isStatic:i,isSvg:i,nativeAttrs:r,operator:R,tag:"path",type:3},{context:O,isPure:i,isStatic:i,isSvg:i,nativeAttrs:s,operator:R,tag:"path",type:3}],context:O,isPure:i,isStatic:i,isSvg:i,nativeAttrs:a,operator:R,tag:"svg",type:3}):e.push({children:[{context:O,isPure:i,isStatic:i,isSvg:i,nativeAttrs:n,operator:R,tag:"path",type:3},{context:O,isPure:i,isStatic:i,isSvg:i,nativeAttrs:o,operator:R,tag:"path",type:3}],context:O,isPure:i,isStatic:i,isSvg:i,nativeAttrs:a,operator:R,tag:"svg",type:3}),e.length?e:t}(),context:O,events:{click:v("click","volumeClick()","click","","volumeClick")},nativeAttrs:c,operator:R,tag:"div",type:3}),e.push({children:function(){var e=[];return e.push({children:function(){var e=[];return e.push({context:O,nativeAttrs:l,operator:R,tag:"div",text:B(_(q,q.length-1,"volume").value),type:3}),e.push({context:O,model:g(_(q,q.length-1,"volume")),operator:U,tag:"Slider",type:4}),e.length?e:t}(),context:O,nativeAttrs:d,operator:R,tag:"div",type:3}),e.length?e:t}(),context:O,nativeAttrs:h,operator:R,tag:"div",type:3}),e.push({context:O,html:B(_(q,q.length-1,"style").value),nativeAttrs:u,operator:R,tag:"style",type:3}),e.length?e:t}(),context:O,nativeAttrs:f,operator:R,tag:"div",type:3})})},94907:e=>{var t,i,r,s,a,n,o,c,l,d,h,u,f,p,m,g,v,y,A,b,w,x,k,T,I,S,P;e.exports=(i=void 0,r=!0,s={d:"M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"},a={viewBox:"0 0 24 24"},n={class:"avplayer-ui-folder-icon dir"},o={class:"avplayer-ui-folder-open-name"},c={class:"avplayer-ui-folder-open-dir item"},l={"stroke-width":"0"},d={"stroke-linecap":"round","stroke-linejoin":"round"},h={d:"M21 11V15.8C21 16.9201 21 17.4802 20.782 17.908C20.5903 18.2843 20.2843 18.5903 19.908 18.782C19.4802 19 18.9201 19 17.8 19H6.2C5.0799 19 4.51984 19 4.09202 18.782C3.71569 18.5903 3.40973 18.2843 3.21799 17.908C3 17.4802 3 16.9201 3 15.8V8.2C3 7.0799 3 6.51984 3.21799 6.09202C3.40973 5.71569 3.71569 5.40973 4.09202 5.21799C4.51984 5 5.0799 5 6.2 5H15M21 11L15 5M21 11H16.6C16.0399 11 15.7599 11 15.546 10.891C15.3578 10.7951 15.2049 10.6422 15.109 10.454C15 10.2401 15 9.96005 15 9.4V5","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},u={fill:"none",transform:"rotate(270)",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},f={class:"avplayer-ui-folder-icon file"},p={display:"none"},m={class:"avplayer-ui-folder-open"},g={type:"checkbox"},v={class:"avplayer-ui-url-open-live"},y={"clip-rule":"evenodd",d:"M10 1C9.73478 1 9.48043 1.10536 9.29289 1.29289L3.29289 7.29289C3.10536 7.48043 3 7.73478 3 8V20C3 21.6569 4.34315 23 6 23H7C7.55228 23 8 22.5523 8 22C8 21.4477 7.55228 21 7 21H6C5.44772 21 5 20.5523 5 20V9H10C10.5523 9 11 8.55228 11 8V3H18C18.5523 3 19 3.44772 19 4V7C19 7.55228 19.4477 8 20 8C20.5523 8 21 7.55228 21 7V4C21 2.34315 19.6569 1 18 1H10ZM9 7H6.41421L9 4.41421V7ZM12.5 24","fill-rule":"evenodd"},A={stroke:"none"},b={d:"M17 15V18M17 21V18M17 18H14M17 18H20",stroke:"","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},w={fill:"none",height:"120%",viewBox:"00 0 24 24",width:"120%",x:"-4",xmlns:"http://www.w3.org/2000/svg",y:"-4"},x={fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},k={class:"avplayer-ui-url-open"},T={class:"avplayer-ui-folder-list",role:"list"},I={class:"avplayer-ui-folder-list-container"},S={type:"text/css"},P={class:"avplayer-ui-folder"},function(e,_,M,C,B,E,D,R,U,L,$,F,O,N,z,V,W,j,G,H,q,Y,K,Q,X,J,Z,ee,te,ie,re,se,ae,ne,oe,ce,le,de){de.push({children:function(){var P=[];return P.push({children:function(){var e,t=[];return V(oe,oe.length-1,"canOpenFolder").value?t.push({children:function(){var e=[];return e.push({children:[{children:[{context:Z,isPure:r,isStatic:r,isSvg:r,nativeAttrs:s,operator:Y,tag:"path",type:3}],context:Z,isPure:r,isStatic:r,isSvg:r,nativeAttrs:a,operator:Y,tag:"svg",type:3}],context:Z,isPure:r,isStatic:r,nativeAttrs:n,operator:Y,tag:"div",type:3}),e.push({context:Z,nativeAttrs:o,operator:Y,tag:"div",text:G(z(oe,oe.length-1,"language.FOLDER_OPEN_DIR",["language","FOLDER_OPEN_DIR"],r).value),type:3}),e.length?e:i}(),context:Z,events:{click:B("click","openDir()","click","","openDir")},nativeAttrs:c,operator:Y,tag:"div",type:3}):t.push({isPure:r,operator:q,text:"",type:2}),t.push((e={children:function(){var e=[];return e.push({children:[{children:[{context:Z,isPure:r,isStatic:r,isSvg:r,nativeAttrs:l,operator:Y,tag:"g",type:3},{context:Z,isPure:r,isStatic:r,isSvg:r,nativeAttrs:d,operator:Y,tag:"g",type:3},{children:[{isPure:r,operator:H,text:" ",type:1},{context:Z,isPure:r,isStatic:r,isSvg:r,nativeAttrs:h,operator:Y,tag:"path",type:3},{isPure:r,operator:H,text:" ",type:1}],context:Z,isPure:r,isStatic:r,isSvg:r,operator:Y,tag:"g",type:3}],context:Z,isPure:r,isStatic:r,isSvg:r,nativeAttrs:u,operator:Y,tag:"svg",type:3}],context:Z,isPure:r,isStatic:r,nativeAttrs:f,operator:Y,tag:"div",type:3}),e.push({context:Z,nativeAttrs:o,operator:Y,tag:"div",text:G(z(oe,oe.length-1,"language.FOLDER_OPEN_FILE",["language","FOLDER_OPEN_FILE"],r).value),type:3}),V(oe,oe.length-1,"canUseFilePicker").value?e.push({isPure:r,operator:q,text:"",type:2}):e.push({context:Z,events:{change:B("change","fileChange()","change","","fileChange")},nativeAttrs:{accept:V(oe,oe.length-1,"accept").value,id:"avplayer-file-open-input",type:"file"},nativeStyles:p,operator:Y,tag:"input",type:3}),e.length?e:i}(),context:Z,nativeAttrs:{class:"avplayer-ui-folder-open-file item"},operator:Y,tag:"label",type:3},V(oe,oe.length-1,"canUseFilePicker").value?F(e,"events","click",B("click","openFile()","click","","openFile")):F(e,"nativeAttrs","for","avplayer-file-open-input"),e)),t.length?t:i}(),context:Z,nativeAttrs:m,operator:Y,tag:"div",type:3}),P.push({children:function(){var e=[];return e.push({context:Z,nativeAttrs:{class:"avplayer-ui-url-open-input",placeholder:z(oe,oe.length-1,"language.FOLDER_OPEN_URL_PLACEHOLDER",["language","FOLDER_OPEN_URL_PLACEHOLDER"],r).value,type:"text"},operator:Y,ref:"url",tag:"input",type:3}),e.push({children:function(){var e=[];return e.push({context:Z,nativeAttrs:g,operator:Y,ref:"live",tag:"input",type:3}),e.push({context:Z,operator:Y,tag:"span",text:G(z(oe,oe.length-1,"language.CHECKBOX_LIVE",["language","CHECKBOX_LIVE"],r).value),type:3}),e.length?e:i}(),context:Z,nativeAttrs:v,operator:Y,tag:"label",type:3}),e.push({children:[{children:[{context:Z,isPure:r,isStatic:r,isSvg:r,nativeAttrs:l,operator:Y,tag:"g",type:3},{context:Z,isPure:r,isStatic:r,isSvg:r,nativeAttrs:d,operator:Y,tag:"g",type:3},{children:[{isPure:r,operator:H,text:" ",type:1},{context:Z,isPure:r,isStatic:r,isSvg:r,nativeAttrs:y,nativeStyles:A,operator:Y,tag:"path",type:3},{isPure:r,operator:H,text:" ",type:1}],context:Z,isPure:r,isStatic:r,isSvg:r,operator:Y,tag:"g",type:3},{children:[{children:[{context:Z,isPure:r,isStatic:r,isSvg:r,nativeAttrs:b,operator:Y,tag:"path",type:3}],context:Z,isPure:r,isStatic:r,isSvg:r,operator:Y,tag:"g",type:3}],context:Z,isPure:r,isStatic:r,isSvg:r,nativeAttrs:w,operator:Y,tag:"svg",type:3}],context:Z,isPure:r,isStatic:r,isSvg:r,nativeAttrs:x,operator:Y,tag:"svg",type:3}],context:Z,events:{click:B("click","openUrl()","click","","openUrl")},nativeAttrs:{class:"avplayer-ui-folder-icon add hint--top","data-hint":z(oe,oe.length-1,"language.BUTTON_ADD",["language","BUTTON_ADD"],r).value},operator:Y,tag:"div",type:3}),e.length?e:i}(),context:Z,nativeAttrs:k,operator:Y,tag:"div",type:3}),P.push({children:function(){var e=[];return e.push({children:function(){var e=[];return U(V(oe,oe.length-1,"root"),(function(i,r,s,a){e.push({context:Z,key:j(r.name,i[i.length-1].getKeypath("name")).value,operator:K,props:{language:V(i,i.length-1,"language").value,node:(t=i[i.length-1],j(t.getScope(),t.keypath)).value},ref:j(r.id,i[i.length-1].getKeypath("id")).value,tag:"FolderNode",type:4})})),e.length?e:i}(),context:Z,nativeAttrs:T,operator:Y,tag:"ul",type:3}),e.length?e:i}(),context:Z,events:{keydown:B("keydown","preventDefault()","keydown","","preventDefault"),keyup:B("keyup","preventDefault()","keyup","","preventDefault")},nativeAttrs:I,operator:Y,ref:"scroll",tag:"div",type:3}),P.push({context:Z,nativeAttrs:{class:"avplayer-ui-folder-tip","data-show":V(oe,oe.length-1,"tipShow").value?1:0},nativeStyles:e("top: "+G(V(oe,oe.length-1,"tipTop").value)+"px"),operator:Y,tag:"div",text:G(V(oe,oe.length-1,"tip").value),type:3}),P.push({context:Z,html:G(V(oe,oe.length-1,"style").value),nativeAttrs:S,operator:Y,tag:"style",type:3}),P.length?P:i}(),context:Z,nativeAttrs:P,operator:Y,tag:"div",type:3})})},81747:e=>{var t,i,r,s,a,n,o,c,l,d,h,u,f,p,m,g,v,y,A,b,w,x,k,T,I;e.exports=(i=void 0,r=!0,s={d:"m10 17 5-5-5-5v10z"},a={viewBox:"0 0 24 24"},n={d:"M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"},o={class:"avplayer-ui-folder-icon dir"},c={"stroke-width":"0"},l={"stroke-linecap":"round","stroke-linejoin":"round"},d={"clip-rule":"evenodd",d:"M10 1C9.73478 1 9.48043 1.10536 9.29289 1.29289L3.29289 7.29289C3.10536 7.48043 3 7.73478 3 8V20C3 21.6569 4.34315 23 6 23H7C7.55228 23 8 22.5523 8 22C8 21.4477 7.55228 21 7 21H6C5.44772 21 5 20.5523 5 20V9H10C10.5523 9 11 8.55228 11 8V3H18C18.5523 3 19 3.44772 19 4V7C19 7.55228 19.4477 8 20 8C20.5523 8 21 7.55228 21 7V4C21 2.34315 19.6569 1 18 1H10ZM9 7H6.41421L9 4.41421V7ZM12.5 24","fill-rule":"evenodd"},h={d:"M255.994,0.006C114.607,0.013,0.012,114.612,0,256c0.012,141.387,114.607,255.986,255.994,255.994 C397.393,511.986,511.992,397.387,512,256C511.992,114.612,397.393,0.013,255.994,0.006z M97.607,97.612 c23.34-23.328,51.761-41.475,83.455-52.725c-15.183,18.375-27.84,41.906-37.757,69.116H82.772 C87.452,108.308,92.396,102.824,97.607,97.612z M65.612,138.003h69.986c-9.008,31.929-14.41,67.834-15.363,105.997H32.327 C34.374,205.196,46.3,169.088,65.612,138.003z M65.612,373.997C46.3,342.912,34.374,306.804,32.327,268h87.991 c0.961,38.124,6.21,74.092,15.206,105.998H65.612z M97.607,414.386c-5.211-5.211-10.156-10.695-14.836-16.39h60.573 c4.28,11.774,9.019,22.944,14.312,33.21c6.954,13.438,14.758,25.468,23.348,35.89C149.332,455.846,120.931,437.699,97.607,414.386z M243.998,479.667c-3.746-0.196-7.469-0.477-11.164-0.86c-5.89-2.64-11.722-6.25-17.5-10.961 c-17.632-14.359-33.976-38.671-46.398-69.85h75.061V479.667z M243.998,373.997h-83.436c-9.477-31.171-15.316-67.311-16.328-105.998 h99.763V373.997z M243.998,244H144.31c1.008-38.71,6.875-74.819,16.359-105.997h83.33V244z M243.998,114.003h-74.951 c3.109-7.79,6.367-15.312,9.934-22.195c10.64-20.625,23.17-36.89,36.354-47.656c5.777-4.71,11.609-8.32,17.5-10.96 c3.695-0.382,7.417-0.664,11.164-0.859V114.003z M446.392,138.003c19.312,31.085,31.234,67.194,33.281,105.997h-87.991 c-0.961-38.124-6.21-74.092-15.21-105.997H446.392z M414.393,97.612c5.211,5.211,10.156,10.696,14.836,16.391h-60.577 c-4.281-11.773-9.023-22.945-14.312-33.21c-6.953-13.437-14.758-25.468-23.347-35.89C362.668,56.16,391.065,74.301,414.393,97.612z M267.998,32.333c3.746,0.195,7.469,0.484,11.16,0.859c5.89,2.649,11.723,6.25,17.504,10.96 c17.636,14.359,33.976,38.671,46.397,69.85h-75.061V32.333z M267.998,138.003h83.436c9.476,31.171,15.32,67.31,16.328,105.997 h-99.764V138.003z M267.998,268h99.685c-1.007,38.71-6.874,74.818-16.359,105.998h-83.326V268z M296.661,467.846 c-5.781,4.711-11.614,8.313-17.504,10.961c-3.691,0.375-7.414,0.664-11.16,0.86v-81.67h74.951 c-3.109,7.789-6.367,15.312-9.933,22.195C322.376,440.816,309.845,457.081,296.661,467.846z M414.393,414.386 c-23.336,23.328-51.764,41.476-83.459,52.725c15.187-18.375,27.835-41.905,37.757-69.115h60.538 C424.548,403.692,419.604,409.176,414.393,414.386z M446.392,373.997h-69.998c9.008-31.929,14.414-67.842,15.367-105.998h87.912 C477.626,306.804,465.704,342.912,446.392,373.997z"},u={fill:"none",height:"65%",viewBox:"00 0 512 512",width:"65%",x:"8",xmlns:"http://www.w3.org/2000/svg",y:"8"},f={fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},p={class:"avplayer-ui-folder-icon url"},m={"clip-rule":"evenodd",d:"M10 1C9.73478 1 9.48043 1.10536 9.29289 1.29289L3.29289 7.29289C3.10536 7.48043 3 7.73478 3 8V20C3 21.6569 4.34315 23 6 23H7C7.55228 23 8 22.5523 8 22C8 21.4477 7.55228 21 7 21H6C5.44772 21 5 20.5523 5 20V9H10C10.5523 9 11 8.55228 11 8V3H18C18.5523 3 19 3.44772 19 4V7C19 7.55228 19.4477 8 20 8C20.5523 8 21 7.55228 21 7V4C21 2.34315 19.6569 1 18 1H10ZM9 7H6.41421L9 4.41421V7ZM12.5 24C13.8807 24 15 22.8807 15 21.5V12.8673L20 12.153V18.05C19.8384 18.0172 19.6712 18 19.5 18C18.1193 18 17 19.1193 17 20.5C17 21.8807 18.1193 23 19.5 23C20.8807 23 22 21.8807 22 20.5V11C22 10.7101 21.8742 10.4345 21.6552 10.2445C21.4362 10.0546 21.1456 9.96905 20.8586 10.0101L13.8586 11.0101C13.3659 11.0804 13 11.5023 13 12V19.05C12.8384 19.0172 12.6712 19 12.5 19C11.1193 19 10 20.1193 10 21.5C10 22.8807 11.1193 24 12.5 24Z","fill-rule":"evenodd"},g={class:"avplayer-ui-folder-icon music"},v={"clip-rule":"evenodd",d:"M10 1C9.73478 1 9.48043 1.10536 9.29289 1.29289L3.29289 7.29289C3.10536 7.48043 3 7.73478 3 8V20C3 21.6569 4.34315 23 6 23H8C8.55228 23 9 22.5523 9 22C9 21.4477 8.55228 21 8 21H6C5.44772 21 5 20.5523 5 20V9H10C10.5523 9 11 8.55228 11 8V3H18C18.5523 3 19 3.44772 19 4V7C19 7.55228 19.4477 8 20 8C20.5523 8 21 7.55228 21 7V4C21 2.34315 19.6569 1 18 1H10ZM9 7H6.41421L9 4.41421V7ZM12 17C12 14.2386 14.2386 12 17 12C19.7614 12 22 14.2386 22 17C22 19.7614 19.7614 22 17 22C14.2386 22 12 19.7614 12 17ZM17 10C13.134 10 10 13.134 10 17C10 20.866 13.134 24 17 24C20.866 24 24 20.866 24 17C24 13.134 20.866 10 17 10ZM16.5547 14.1679C16.2478 13.9634 15.8533 13.9443 15.5281 14.1183C15.203 14.2923 15 14.6312 15 15V19C15 19.3688 15.203 19.7077 15.5281 19.8817C15.8533 20.0557 16.2478 20.0366 16.5547 19.8321L19.5547 17.8321C19.8329 17.6466 20 17.3344 20 17C20 16.6656 19.8329 16.3534 19.5547 16.1679L16.5547 14.1679Z","fill-rule":"evenodd"},y={class:"avplayer-ui-folder-icon mov"},A={class:"avplayer-ui-folder-node-name"},b={d:"M7 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2zM15 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2z"},w={viewBox:"0 0 22 22",xmlns:"http://www.w3.org/2000/svg"},x={d:"M17.982 9.275L8.06 3.27A2.013 2.013 0 0 0 5 4.994v12.011a2.017 2.017 0 0 0 3.06 1.725l9.922-6.005a2.017 2.017 0 0 0 0-3.45z"},k={d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"},T={class:"avplayer-ui-folder-list",role:"list"},I={class:"avplayer-ui-folder-list-li",role:"listitem"},function(e,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z,V,W,j,G,H,q,Y,K,Q,X,J,Z,ee,te,ie,re,se,ae,ne,oe,ce){ce.push({children:function(){var I=[];return I.push({children:function(){var e=[];return V((t=N(ae,ae.length-1,"isFolder",Z&&Z.isFolder||ee.isFolder).value,"function"==typeof t?t(N(ae,ae.length-1,"node").value):J.fatal("[isFolder(node)] is not a function."))).value?(e.push({children:[{children:[{context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:s,operator:H,tag:"path",type:3}],context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:a,operator:H,tag:"svg",type:3}],context:X,events:{click:M("click","toggle()","click","","toggle")},nativeAttrs:{class:"avplayer-ui-folder-expand hint--right","data-hint":O(ae,ae.length-1,"node.opened",["node","opened"],r).value?O(ae,ae.length-1,"language.TIP_FOLD",["language","TIP_FOLD"],r).value:O(ae,ae.length-1,"language.TIP_UNFOLD",["language","TIP_UNFOLD"],r).value,"data-open":O(ae,ae.length-1,"node.opened",["node","opened"],r).value?1:0},operator:H,tag:"div",type:3}),e.push({children:[{children:[{context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:n,operator:H,tag:"path",type:3}],context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:a,operator:H,tag:"svg",type:3}],context:X,isPure:r,isStatic:r,nativeAttrs:o,operator:H,tag:"div",type:3})):V((t=N(ae,ae.length-1,"isUrl",Z&&Z.isUrl||ee.isUrl).value,"function"==typeof t?t(N(ae,ae.length-1,"node").value):J.fatal("[isUrl(node)] is not a function."))).value?e.push({children:[{children:[{context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:c,operator:H,tag:"g",type:3},{context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:l,operator:H,tag:"g",type:3},{children:[{isPure:r,operator:j,text:" ",type:1},{context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:d,operator:H,tag:"path",type:3},{isPure:r,operator:j,text:" ",type:1}],context:X,isPure:r,isStatic:r,isSvg:r,operator:H,tag:"g",type:3},{children:[{children:[{context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:h,operator:H,tag:"path",type:3},{isPure:r,operator:j,text:" ",type:1}],context:X,isPure:r,isStatic:r,isSvg:r,operator:H,tag:"g",type:3}],context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:u,operator:H,tag:"svg",type:3}],context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:f,operator:H,tag:"svg",type:3}],context:X,isPure:r,isStatic:r,nativeAttrs:p,operator:H,tag:"div",type:3}):V((t=N(ae,ae.length-1,"isMusic",Z&&Z.isMusic||ee.isMusic).value,"function"==typeof t?t(N(ae,ae.length-1,"node").value):J.fatal("[isMusic(node)] is not a function."))).value?e.push({children:[{children:[{context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:c,operator:H,tag:"g",type:3},{context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:l,operator:H,tag:"g",type:3},{children:[{isPure:r,operator:j,text:" ",type:1},{context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:m,operator:H,tag:"path",type:3},{isPure:r,operator:j,text:" ",type:1}],context:X,isPure:r,isStatic:r,isSvg:r,operator:H,tag:"g",type:3}],context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:f,operator:H,tag:"svg",type:3}],context:X,isPure:r,isStatic:r,nativeAttrs:g,operator:H,tag:"div",type:3}):e.push({children:[{children:[{context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:c,operator:H,tag:"g",type:3},{context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:l,operator:H,tag:"g",type:3},{children:[{isPure:r,operator:j,text:" ",type:1},{context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:v,operator:H,tag:"path",type:3},{isPure:r,operator:j,text:" ",type:1}],context:X,isPure:r,isStatic:r,isSvg:r,operator:H,tag:"g",type:3}],context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:f,operator:H,tag:"svg",type:3}],context:X,isPure:r,isStatic:r,nativeAttrs:y,operator:H,tag:"div",type:3}),e.push({context:X,events:{mouseenter:M("mouseenter","mouseenter()","mouseenter","","mouseenter"),mouseleave:M("mouseleave","mouseleave()","mouseleave","","mouseleave")},nativeAttrs:A,operator:H,ref:"name",tag:"div",text:W(O(ae,ae.length-1,"node.name",["node","name"],r).value),type:3}),V((t=N(ae,ae.length-1,"isFolder",Z&&Z.isFolder||ee.isFolder).value,"function"==typeof t?t(N(ae,ae.length-1,"node").value):J.fatal("[isFolder(node)] is not a function."))).value?e.push({isPure:r,operator:G,text:"",type:2}):e.push({children:function(){var e=[];return O(ae,ae.length-1,"node.played",["node","played"],r).value&&!O(ae,ae.length-1,"node.paused",["node","paused"],r).value?e.push({children:[{context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:b,operator:H,tag:"path",type:3}],context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:w,operator:H,tag:"svg",type:3}):e.push({children:[{context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:x,operator:H,tag:"path",type:3}],context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:w,operator:H,tag:"svg",type:3}),e.length?e:i}(),context:X,events:{click:M("click","play()","click","","play")},nativeAttrs:{class:"avplayer-ui-folder-icon play hint--top","data-hint":!O(ae,ae.length-1,"node.played",["node","played"],r).value||O(ae,ae.length-1,"node.paused",["node","paused"],r).value?O(ae,ae.length-1,"language.TIP_PLAY",["language","TIP_PLAY"],r).value:O(ae,ae.length-1,"language.TIP_PAUSE",["language","TIP_PAUSE"],r).value},operator:H,tag:"div",type:3}),O(ae,ae.length-1,"node.depth",["node","depth"],r).value?e.push({isPure:r,operator:G,text:"",type:2}):e.push({children:[{children:[{context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:k,operator:H,tag:"path",type:3}],context:X,isPure:r,isStatic:r,isSvg:r,nativeAttrs:a,operator:H,tag:"svg",type:3}],context:X,events:{click:M("click","delete()","click","","delete")},nativeAttrs:{class:"avplayer-ui-folder-icon delete hint--top","data-hint":O(ae,ae.length-1,"language.TIP_DELETE",["language","TIP_DELETE"],r).value},operator:H,tag:"div",type:3}),e.length?e:i}(),context:X,nativeAttrs:{class:"avplayer-ui-folder-node "+(O(ae,ae.length-1,"node.played",["node","played"],r).value?"active":"")},nativeStyles:e("padding-inline-start: "+W(V((t=N(ae,ae.length-1,"paddingStart",Z&&Z.paddingStart||ee.paddingStart).value,"function"==typeof t?t(N(ae,ae.length-1,"node").value):J.fatal("[paddingStart(node)] is not a function."))).value)+"px;"),operator:H,tag:"div",type:3}),V((t=N(ae,ae.length-1,"isFolder",Z&&Z.isFolder||ee.isFolder).value,"function"==typeof t?t(N(ae,ae.length-1,"node").value):J.fatal("[isFolder(node)] is not a function."))).value&&O(ae,ae.length-1,"node.opened",["node","opened"],r).value?I.push({children:function(){var e=[];return D(O(ae,ae.length-1,"node.children",["node","children"],r),(function(i,r,s,a){e.push({context:X,key:V(r.name,i[i.length-1].getKeypath("name")).value,operator:q,props:{language:N(i,i.length-1,"language").value,node:(t=i[i.length-1],V(t.getScope(),t.keypath)).value},ref:V(r.id,i[i.length-1].getKeypath("id")).value,tag:"FolderNode",type:4})})),e.length?e:i}(),context:X,nativeAttrs:T,operator:H,tag:"ul",type:3}):I.push({isPure:r,operator:G,text:"",type:2}),I.length?I:i}(),context:X,nativeAttrs:I,operator:H,tag:"li",type:3})})},15491:e=>{var t,i,r,s,a,n,o,c,l,d,h,u,f;e.exports=(t=void 0,i=!0,r={class:"avplayer-ui-info-title"},s={d:"m8 6.939 3.182-3.182a.75.75 0 1 1 1.061 1.061L9.061 8l3.182 3.182a.75.75 0 1 1-1.061 1.061L8 9.061l-3.182 3.182a.75.75 0 1 1-1.061-1.061L6.939 8 3.757 4.818a.75.75 0 1 1 1.061-1.061L8 6.939z"},a={"data-pointer":"none",space:"preserve",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},n={class:"avplayer-ui-info-close"},o={class:"avplayer-ui-info-format"},c={class:"avplayer-ui-info-line-title"},l={class:"avplayer-ui-info-line-value"},d={class:"avplayer-ui-info-line"},h={class:"avplayer-ui-info-panel"},u={type:"text/css"},f={class:"avplayer-ui-info"},function(e,p,m,g,v,y,A,b,w,x,k,T,I,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z,V,W,j,G,H,q,Y,K,Q){Q.push({children:function(){var e=[];return e.push({context:O,nativeAttrs:r,operator:R,tag:"div",text:B(P(q,q.length-1,"language.INFO_TITLE",["language","INFO_TITLE"],i).value),type:3}),e.push({children:[{children:[{context:O,isPure:i,isStatic:i,isSvg:i,nativeAttrs:s,operator:R,tag:"path",type:3}],context:O,isPure:i,isStatic:i,isSvg:i,nativeAttrs:a,operator:R,tag:"svg",type:3}],context:O,events:{click:v("click","close()","click","","close")},nativeAttrs:n,operator:R,tag:"span",type:3}),e.push({children:function(){var e=[];return e.push({children:function(){var e=[];return e.push({context:O,html:B(_(q,q.length-1,"info").value),operator:R,tag:"span",type:3}),e.length?e:t}(),context:O,nativeAttrs:o,operator:R,tag:"div",type:3}),w(_(q,q.length-1,"list"),(function(i,r,s,a){e.push({children:function(){var e=[];return e.push({context:O,nativeAttrs:c,operator:R,tag:"span",text:B(_(i,i.length-1,"key").value),type:3}),e.push({context:O,nativeAttrs:l,operator:R,tag:"span",text:B(_(i,i.length-1,"value").value),type:3}),e.length?e:t}(),context:O,nativeAttrs:d,operator:R,tag:"div",type:3})})),e.length?e:t}(),context:O,events:{keydown:v("keydown","preventDefault()","keydown","","preventDefault"),keyup:v("keyup","preventDefault()","keyup","","preventDefault")},nativeAttrs:h,operator:R,tag:"div",type:3}),e.push({context:O,html:B(_(q,q.length-1,"style").value),nativeAttrs:u,operator:R,tag:"style",type:3}),e.length?e:t}(),context:O,nativeAttrs:f,operator:R,tag:"div",type:3})})},32849:e=>{var t,i,r,s,a;e.exports=(t=!0,i={cx:"50",cy:"50",fill:"none",r:"20"},r={class:"avplayer-ui-circular",viewBox:"25 25 50 50"},s={class:"avplayer-ui-loading-spinner"},a={type:"text/css"},function(e,n,o,c,l,d,h,u,f,p,m,g,v,y,A,b,w,x,k,T,I,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z,V){V.push({children:function(){var e=[];return e.push({children:[{children:[{context:B,isPure:t,isStatic:t,isSvg:t,nativeAttrs:i,operator:S,tag:"circle",type:3}],context:B,isPure:t,isStatic:t,isSvg:t,nativeAttrs:r,operator:S,tag:"svg",type:3}],context:B,isPure:t,isStatic:t,nativeAttrs:s,operator:S,tag:"div",type:3}),e.push({context:B,html:k(b(O,O.length-1,"style").value),nativeAttrs:a,operator:S,tag:"style",type:3}),e.length?e:void 0}(),context:B,nativeAttrs:{class:"avplayer-ui-loading-mask","data-loading":b(O,O.length-1,"loading").value?1:0},operator:S,tag:"div",type:3})})},23077:e=>{var t,i,r,s,a;e.exports=(i=void 0,r=!0,s={class:"avplayer-ui-loading-message-list"},a={type:"text/css"},function(e,n,o,c,l,d,h,u,f,p,m,g,v,y,A,b,w,x,k,T,I,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z,V){V.push({children:function(){var n=[];return n.push({children:function(){var s=[];return f(b(O,O.length-1,"message"),(function(i,a,n,o,c){s.push({context:B,key:(t=i[i.length-1],x(t.getScope(),t.keypath)).value,nativeAttrs:{class:"avplayer-ui-loading-message","data-last":A(i,i.length-1,"message.length",["message","length"],r).value-1===c?1:0},nativeStyles:e("bottom: "+k(30*(A(i,i.length-1,"message.length",["message","length"],r).value-1-c))+"px;"),operator:S,tag:"div",text:k((t=i[i.length-1],x(t.getScope(),t.keypath)).value),type:3})})),s.length?s:i}(),context:B,nativeAttrs:s,operator:S,tag:"div",type:3}),n.push({context:B,html:k(b(O,O.length-1,"style").value),nativeAttrs:a,operator:S,tag:"style",type:3}),n.length?n:i}(),context:B,nativeAttrs:{class:"avplayer-ui-loading-tip","data-show":b(O,O.length-1,"showMessage").value?1:0},operator:S,tag:"div",type:3})})},65051:e=>{var t,i;e.exports=(t={type:"text/css"},i={class:"avplayer-ui-pcm-visualization"},function(e,r,s,a,n,o,c,l,d,h,u,f,p,m,g,v,y,A,b,w,x,k,T,I,S,P,_,M,C,B,E,D,R,U,L,$,F,O){O.push({children:function(){var e=[];return e.push({context:_,operator:k,ref:"canvas",tag:"canvas",type:3}),e.push({context:_,html:b(v(L,L.length-1,"style").value),nativeAttrs:t,operator:k,tag:"style",type:3}),e.length?e:void 0}(),context:_,nativeAttrs:i,operator:k,tag:"div",type:3})})},90577:e=>{var t,i,r,s,a,n,o,c,l,d,h,u,f,p,m;e.exports=(i=void 0,r=!0,s={class:"avplayer-ui-progress-hover"},a={class:"avplayer-ui-progress-loaded"},n={class:"avplayer-ui-progress-played"},o={class:"avplayer-ui-progress-chapter-item"},c={class:"avplayer-ui-progress-chapter"},l={class:"avplayer-ui-icon-indicator"},d={class:"avplayer-ui-progress-indicator"},h={class:"avplayer-ui-progress-tip"},u={class:"avplayer-ui-progress-inner"},f={class:"libmedia-ui-progress-thumb"},p={type:"text/css"},m={class:"avplayer-ui-progress"},function(e,g,v,y,A,b,w,x,k,T,I,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z,V,W,j,G,H,q,Y,K,Q,X,J){J.push({children:function(){var m=[];return m.push({children:function(){var u=[];return u.push({context:z,nativeAttrs:s,nativeStyles:e("width: "+D(C(K,K.length-1,"hoverWidth").value)+"%;"),operator:L,tag:"div",type:3}),u.push({context:z,nativeAttrs:a,nativeStyles:e("width: "+D(C(K,K.length-1,"loadedWidth").value)+"%;"),operator:L,tag:"div",type:3}),u.push({context:z,nativeAttrs:n,nativeStyles:e("width: "+D(C(K,K.length-1,"playedWidth").value)+"%;"),operator:L,tag:"div",type:3}),u.push({children:function(){var r=[];return k(C(K,K.length-1,"chapters"),(function(i,s,a,n){r.push({context:z,events:{click:A("click","chapterClick(this)","click","","chapterClick",{execute:function(e,r){return[(t=i[i.length-1],E(t.getScope(),t.keypath)).value]}}),mouseenter:A("mouseenter","chapterEnter(this)","mouseenter","","chapterEnter",{execute:function(e,r){return[(t=i[i.length-1],E(t.getScope(),t.keypath)).value]}}),mouseleave:A("mouseleave","chapterLeave(this)","mouseleave","","chapterLeave",{execute:function(e,r){return[(t=i[i.length-1],E(t.getScope(),t.keypath)).value]}})},key:E(s.text,i[i.length-1].getKeypath("text")).value,nativeAttrs:o,nativeStyles:e("left: "+D(C(i,i.length-1,"left").value)+"%;"),operator:L,tag:"span",type:3})})),r.length?r:i}(),context:z,nativeAttrs:c,operator:L,tag:"div",type:3}),C(K,K.length-1,"indicatorUrl").value?u.push({children:function(){var e=[];return e.push({children:function(){var e=[];return e.push({context:z,nativeAttrs:{draggable:"false",height:C(K,K.length-1,"indicatorSize").value,src:C(K,K.length-1,"indicatorUrl").value,width:C(K,K.length-1,"indicatorSize").value},operator:L,tag:"img",type:3}),e.length?e:i}(),context:z,nativeAttrs:l,operator:L,tag:"i",type:3}),e.length?e:i}(),context:z,events:{mousedown:A("mousedown","indicatorDown()","mousedown","","indicatorDown")},nativeAttrs:d,nativeStyles:e("left: "+D(C(K,K.length-1,"playedWidth").value)+"%;"),operator:L,tag:"div",type:3}):u.push({isPure:r,operator:U,text:"",type:2}),u.push({context:z,nativeAttrs:h,nativeStyles:e("left: "+D(C(K,K.length-1,"hoverWidth").value)+"%; display: "+D(C(K,K.length-1,"showTip").value?"block":"none")+";"),operator:L,tag:"div",text:D(C(K,K.length-1,"hoverChapter").value||E((t=C(K,K.length-1,"formatTime",W&&W.formatTime||j.formatTime).value,"function"==typeof t?t(C(K,K.length-1,"hoverTime").value):V.fatal("[formatTime(hoverTime)] is not a function."))).value),type:3}),u.length?u:i}(),context:z,events:{click:A("click","hoverClick()","click","","hoverClick"),mouseenter:A("mouseenter","hoverEnter()","mouseenter","","hoverEnter"),mouseleave:A("mouseleave","hoverLeave()","mouseleave","","hoverLeave"),mousemove:A("mousemove","hoverMove()","mousemove","","hoverMove")},nativeAttrs:u,operator:L,ref:"slider",tag:"div",type:3}),m.push({context:z,isPure:r,isStatic:r,nativeAttrs:f,operator:L,tag:"div",type:3}),m.push({context:z,html:D(C(K,K.length-1,"style").value),nativeAttrs:p,operator:L,tag:"style",type:3}),m.length?m:i}(),context:z,nativeAttrs:m,operator:L,tag:"div",type:3})})},42461:e=>{var t,i,r,s,a,n,o,c,l,d,h;e.exports=(t=void 0,i=!0,r={class:"avplayer-ui-settings-title"},s={d:"m8 6.939 3.182-3.182a.75.75 0 1 1 1.061 1.061L9.061 8l3.182 3.182a.75.75 0 1 1-1.061 1.061L8 9.061l-3.182 3.182a.75.75 0 1 1-1.061-1.061L6.939 8 3.757 4.818a.75.75 0 1 1 1.061-1.061L8 6.939z"},a={"data-pointer":"none",space:"preserve",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},n={class:"avplayer-ui-settings-close"},o={class:"avplayer-ui-settings-tabs"},c={class:"avplayer-ui-settings-context"},l={class:"avplayer-ui-settings-panel"},d={type:"text/css"},h={class:"avplayer-ui-settings"},function(e,u,f,p,m,g,v,y,A,b,w,x,k,T,I,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z,V,W,j,G,H,q,Y){Y.push({children:function(){var e=[];return e.push({context:$,nativeAttrs:r,operator:E,tag:"div",text:M(I(G,G.length-1,"language.SETTINGS_TITLE",["language","SETTINGS_TITLE"],i).value),type:3}),e.push({children:[{children:[{context:$,isPure:i,isStatic:i,isSvg:i,nativeAttrs:s,operator:E,tag:"path",type:3}],context:$,isPure:i,isStatic:i,isSvg:i,nativeAttrs:a,operator:E,tag:"svg",type:3}],context:$,events:{click:m("click","close()","click","","close")},nativeAttrs:n,operator:E,tag:"span",type:3}),e.push({children:function(){var e=[];return e.push({children:function(){var e=[];return A(S(G,G.length-1,"list"),(function(t,i,r,s){e.push({context:$,events:{click:m("click","set('tab', id)","click","","set",{execute:function(e,i){return["tab",S(t,t.length-1,"id").value]}})},nativeAttrs:{class:"avplayer-ui-settings-tab "+(S(t,t.length-1,"id").value===S(t,t.length-1,"tab").value?"active":"")},operator:E,tag:"div",text:M(S(t,t.length-1,"name").value),type:3})})),e.length?e:t}(),context:$,nativeAttrs:o,operator:E,tag:"div",type:3}),e.push({context:$,isPure:i,isStatic:i,nativeAttrs:c,operator:E,tag:"div",type:3}),e.length?e:t}(),context:$,nativeAttrs:l,operator:E,tag:"div",type:3}),e.push({context:$,html:M(S(G,G.length-1,"style").value),nativeAttrs:d,operator:E,tag:"style",type:3}),e.length?e:t}(),context:$,nativeAttrs:h,operator:E,tag:"div",type:3})})},82042:e=>{var t,i,r,s;e.exports=(t=void 0,i={class:"libmedia-ui-slider-inner"},r={class:"libmedia-ui-slider-outer"},s={class:"libmedia-ui-slider-thumb"},function(e,a,n,o,c,l,d,h,u,f,p,m,g,v,y,A,b,w,x,k,T,I,S,P,_,M,C,B,E,D,R,U,L,$,F,O,N,z){z.push({children:function(){var e=[];return e.push({children:function(){var e=[];return e.push({context:C,nativeAttrs:i,nativeStyles:a(A(F,F.length-1,"offset").value),operator:I,tag:"div",type:3}),e.length?e:t}(),context:C,nativeAttrs:r,operator:I,ref:"slider",tag:"div",type:3}),e.push({context:C,events:{mousedown:c("mousedown","mousedown()","mousedown","","mousedown")},nativeAttrs:s,nativeStyles:a(A(F,F.length-1,"offset").value),operator:I,tag:"div",type:3}),e.length?e:t}(),context:C,nativeAttrs:{class:"libmedia-ui-slider","data-direction":A(F,F.length-1,"direction").value},operator:I,tag:"div",type:3})})},35308:e=>{e.exports="html{--libmedia-ui-theme:#23ade5;--libmedia-ui-font-color:#fff;--libmedia-ui-background-color:#000;--libmedia-ui-text-shadow-color:rgba(0,0,0,0.502);--libmedia-ui-transition-duration:.2s;--libmedia-ui-padding:10px;--libmedia-ui-border-radius:3px;--libmedia-ui-progress-height:6px;--libmedia-ui-progress-color:rgba(255,255,255,0.251);--libmedia-ui-hover-color:rgba(255,255,255,0.251);--libmedia-ui-loaded-color:rgba(255,255,255,0.251);--libmedia-ui-state-size:80px;--libmedia-ui-state-opacity:.8;--libmedia-ui-header-height:40px;--libmedia-ui-bottom-height:100px;--libmedia-ui-bottom-offset:51px;--libmedia-ui-bottom-gap:5px;--libmedia-ui-chapter-width:8px;--libmedia-ui-chapter-color:rgba(255,255,255,0.502);--libmedia-ui-control-height:46px;--libmedia-ui-control-opacity:.75;--libmedia-ui-control-icon-size:28px;--libmedia-ui-control-icon-scale:1.1;--libmedia-ui-volume-height:120px;--libmedia-ui-slider-thumb-size:14px;--libmedia-ui-slider-thickness:2px;--libmedia-ui-lock-size:36px;--libmedia-ui-indicator-scale:0;--libmedia-ui-indicator-size:16px;--libmedia-ui-fullscreen-web-index:9999;--libmedia-ui-settings-icon-size:24px;--libmedia-ui-settings-max-height:300px;--libmedia-ui-selector-max-height:300px;--libmedia-ui-contextmenus-min-width:250px;--libmedia-ui-subtitle-font-size:20px;--libmedia-ui-subtitle-gap:5px;--libmedia-ui-subtitle-bottom:15px;--libmedia-ui-subtitle-border:#000;--libmedia-ui-widget-background:rgba(0,0,0,0.851);--libmedia-ui-widget-hover-background:rgba(255,255,255,0.102);--libmedia-ui-tip-background:rgba(0,0,0,0.702);--libmedia-ui-tip-font-color:#fff;--libmedia-ui-scrollbar-size:4px;--libmedia-ui-scrollbar-background:rgba(255,255,255,0.251);--libmedia-ui-scrollbar-background-hover:rgba(255,255,255,0.502);--libmedia-ui-mini-progress-height:2px;--libmedia-ui-folder-width:300px}[class*=\"hint--\"]{font-style:normal;position:relative}[class*=\"hint--\"]:before,[class*=\"hint--\"]:after{visibility:hidden;opacity:0;z-index:1000000;pointer-events:none;transition:all .3s;position:absolute;transform:translate3d(0,0,0)}[class*=\"hint--\"]:hover:before,[class*=\"hint--\"]:hover:after{visibility:visible;opacity:1;transition-delay:.1s}[class*=\"hint--\"]:before{content:\"\";z-index:1000001;background:none;border:6px solid rgba(0,0,0,0);position:absolute}[class*=\"hint--\"]:after{color:var(--libmedia-ui-tip-font-color);white-space:nowrap;background:var(--libmedia-ui-tip-background);padding:8px 10px;font-size:12px;line-height:12px}[class*=\"hint--\"][data-hint]:after{content:attr(data-hint)}[data-hint=\"\"]:before,[data-hint=\"\"]:after{display:none !important}.hint--top-left:before,.hint--top-right:before,.hint--top:before{border-top-color:var(--libmedia-ui-tip-background)}.hint--bottom-left:before,.hint--bottom-right:before,.hint--bottom:before{border-bottom-color:var(--libmedia-ui-tip-background)}.hint--left:before{border-left-color:var(--libmedia-ui-tip-background)}.hint--right:before{border-right-color:var(--libmedia-ui-tip-background)}.hint--top:before{margin-bottom:-11px}.hint--top:before,.hint--top:after{bottom:100%;left:50%}.hint--top:before{left:calc(50% - 6px)}.hint--top:after{transform:translateX(-50%)}.hint--top:hover:before{transform:translateY(-8px)}.hint--top:hover:after{transform:translateX(-50%) translateY(-8px)}.hint--bottom:before{margin-top:-11px}.hint--bottom:before,.hint--bottom:after{top:100%;left:50%}.hint--bottom:before{left:calc(50% - 6px)}.hint--bottom:after{transform:translateX(-50%)}.hint--bottom:hover:before{transform:translateY(8px)}.hint--bottom:hover:after{transform:translateX(-50%) translateY(8px)}.hint--right:before{margin-bottom:-6px;margin-left:-11px}.hint--right:after{margin-bottom:-14px}.hint--right:before,.hint--right:after{bottom:50%;left:100%}.hint--right:hover:before,.hint--right:hover:after{transform:translateX(8px)}.hint--left:before{margin-bottom:-6px;margin-right:-11px}.hint--left:after{margin-bottom:-14px}.hint--left:before,.hint--left:after{bottom:50%;right:100%}.hint--left:hover:before,.hint--left:hover:after{transform:translateX(-8px)}.hint--top-left:before{margin-bottom:-11px}.hint--top-left:before,.hint--top-left:after{bottom:100%;left:50%}.hint--top-left:before{left:calc(50% - 6px)}.hint--top-left:after{margin-left:12px;transform:translateX(-100%)}.hint--top-left:hover:before{transform:translateY(-8px)}.hint--top-left:hover:after{transform:translateX(-100%) translateY(-8px)}.hint--top-right:before{margin-bottom:-11px}.hint--top-right:before,.hint--top-right:after{bottom:100%;left:50%}.hint--top-right:before{left:calc(50% - 6px)}.hint--top-right:after{margin-left:-12px;transform:translateX(0)}.hint--top-right:hover:before,.hint--top-right:hover:after{transform:translateY(-8px)}.hint--bottom-left:before{margin-top:-11px}.hint--bottom-left:before,.hint--bottom-left:after{top:100%;left:50%}.hint--bottom-left:before{left:calc(50% - 6px)}.hint--bottom-left:after{margin-left:12px;transform:translateX(-100%)}.hint--bottom-left:hover:before{transform:translateY(8px)}.hint--bottom-left:hover:after{transform:translateX(-100%) translateY(8px)}.hint--bottom-right:before{margin-top:-11px}.hint--bottom-right:before,.hint--bottom-right:after{top:100%;left:50%}.hint--bottom-right:before{left:calc(50% - 6px)}.hint--bottom-right:after{margin-left:-12px;transform:translateX(0)}.hint--bottom-right:hover:before,.hint--bottom-right:hover:after{transform:translateY(8px)}.hint--small:after,.hint--medium:after,.hint--large:after{white-space:normal;word-wrap:break-word;line-height:1.4em}.hint--small:after{width:80px}.hint--medium:after{width:150px}.hint--large:after{width:300px}[class*=\"hint--\"]:after{text-shadow:0 -1px #000;box-shadow:4px 4px 8px rgba(0,0,0,0.302)}.hint--error:after{text-shadow:0 -1px #592726;background-color:#b34e4d}.hint--error.hint--top-left:before,.hint--error.hint--top-right:before,.hint--error.hint--top:before{border-top-color:#b34e4d}.hint--error.hint--bottom-left:before,.hint--error.hint--bottom-right:before,.hint--error.hint--bottom:before{border-bottom-color:#b34e4d}.hint--error.hint--left:before{border-left-color:#b34e4d}.hint--error.hint--right:before{border-right-color:#b34e4d}.hint--warning:after{text-shadow:0 -1px #6c5328;background-color:#c09854}.hint--warning.hint--top-left:before,.hint--warning.hint--top-right:before,.hint--warning.hint--top:before{border-top-color:#c09854}.hint--warning.hint--bottom-left:before,.hint--warning.hint--bottom-right:before,.hint--warning.hint--bottom:before{border-bottom-color:#c09854}.hint--warning.hint--left:before{border-left-color:#c09854}.hint--warning.hint--right:before{border-right-color:#c09854}.hint--info:after{text-shadow:0 -1px #1a3c4d;background-color:#3986ac}.hint--info.hint--top-left:before,.hint--info.hint--top-right:before,.hint--info.hint--top:before{border-top-color:#3986ac}.hint--info.hint--bottom-left:before,.hint--info.hint--bottom-right:before,.hint--info.hint--bottom:before{border-bottom-color:#3986ac}.hint--info.hint--left:before{border-left-color:#3986ac}.hint--info.hint--right:before{border-right-color:#3986ac}.hint--success:after{text-shadow:0 -1px #1a321a;background-color:#458746}.hint--success.hint--top-left:before,.hint--success.hint--top-right:before,.hint--success.hint--top:before{border-top-color:#458746}.hint--success.hint--bottom-left:before,.hint--success.hint--bottom-right:before,.hint--success.hint--bottom:before{border-bottom-color:#458746}.hint--success.hint--left:before{border-left-color:#458746}.hint--success.hint--right:before{border-right-color:#458746}.hint--always:after,.hint--always:before{opacity:1;visibility:visible}.hint--always.hint--top:before{transform:translateY(-8px)}.hint--always.hint--top:after{transform:translateX(-50%) translateY(-8px)}.hint--always.hint--top-left:before{transform:translateY(-8px)}.hint--always.hint--top-left:after{transform:translateX(-100%) translateY(-8px)}.hint--always.hint--top-right:before,.hint--always.hint--top-right:after{transform:translateY(-8px)}.hint--always.hint--bottom:before{transform:translateY(8px)}.hint--always.hint--bottom:after{transform:translateX(-50%) translateY(8px)}.hint--always.hint--bottom-left:before{transform:translateY(8px)}.hint--always.hint--bottom-left:after{transform:translateX(-100%) translateY(8px)}.hint--always.hint--bottom-right:before,.hint--always.hint--bottom-right:after{transform:translateY(8px)}.hint--always.hint--left:before,.hint--always.hint--left:after{transform:translateX(-8px)}.hint--always.hint--right:before,.hint--always.hint--right:after{transform:translateX(8px)}.hint--rounded:after{border-radius:4px}.hint--no-animate:before,.hint--no-animate:after{transition-duration:0s}.hint--bounce:before,.hint--bounce:after{transition:opacity .3s,visibility .3s,transform .3s cubic-bezier(.71,1.7,.77,1.24)}.hint--no-shadow:before,.hint--no-shadow:after{text-shadow:initial;box-shadow:initial}.hint--no-arrow:before{display:none}.libmedia-ui-selector{text-align:center;border-radius:var(--libmedia-ui-border-radius);opacity:0;pointer-events:none;bottom:var(--libmedia-ui-control-height);max-height:var(--libmedia-ui-selector-max-height);background-color:var(--libmedia-ui-widget-background);transition:all var(--libmedia-ui-transition-duration) ease;flex-direction:column;align-items:center;display:flex;position:absolute;overflow:hidden auto}.libmedia-ui-selector .libmedia-ui-selector-item{flex-shrink:0;justify-content:center;align-items:center;width:100%;padding:10px 15px;line-height:1;display:flex;cursor:pointer}.libmedia-ui-selector .libmedia-ui-selector-item.active{color:var(--libmedia-ui-theme)}.libmedia-ui-selector .libmedia-ui-selector-item:hover{background-color:var(--libmedia-ui-widget-hover-background)}.libmedia-ui-slider{cursor:pointer;width:100%;height:100%;position:relative;justify-content:center;display:flex}.libmedia-ui-slider .libmedia-ui-slider-outer{border-radius:var(--libmedia-ui-border-radius);background-color:rgba(255,255,255,0.251);justify-content:center;display:flex;position:relative;overflow:hidden}.libmedia-ui-slider .libmedia-ui-slider-outer .libmedia-ui-slider-inner{background-color:var(--libmedia-ui-theme);width:100%;height:100%;position:absolute}.libmedia-ui-slider .libmedia-ui-slider-thumb{width:var(--libmedia-ui-slider-thumb-size);height:var(--libmedia-ui-slider-thumb-size);background-color:var(--libmedia-ui-theme);transition:transform var(--libmedia-ui-transition-duration) ease;border-radius:100%;flex-shrink:0;position:absolute;transform:scale(1)}.libmedia-ui-slider[data-direction='vertical'] .libmedia-ui-slider-outer{width:var(--libmedia-ui-slider-thickness);height:100%}.libmedia-ui-slider[data-direction='vertical'] .libmedia-ui-slider-thumb{margin-top:calc(var(--libmedia-ui-slider-thumb-size) / -2)}.libmedia-ui-slider[data-direction='horizontal'] .libmedia-ui-slider-outer{width:100%;height:var(--libmedia-ui-slider-thickness)}.libmedia-ui-slider[data-direction='horizontal'] .libmedia-ui-slider-thumb{margin-right:calc(var(--libmedia-ui-slider-thumb-size) / -2)}.avplayer-ui-container{width:100%;height:100%;user-select:none;color:var(--libmedia-ui-font-color);background-color:var(--libmedia-ui-background-color);text-shadow:0 0 2px var(--libmedia-ui-text-shadow-color)}.avplayer-ui-container *{box-sizing:border-box;outline:none}.avplayer-ui-container svg{fill:var(--libmedia-ui-font-color)}.avplayer-ui-container .avplayer-ui-header{width:100%;height:var(--libmedia-ui-header-height);position:absolute;top:0;text-align:center;padding:0 var(--libmedia-ui-padding);transition:all var(--libmedia-ui-transition-duration) ease;background-size:100% var(--libmedia-ui-header-height);background-image:linear-gradient(to bottom,#000,rgba(0,0,0,0.4),rgba(0,0,0,0))}.avplayer-ui-container .avplayer-ui-header .avplayer-ui-title{line-height:var(--libmedia-ui-header-height);font-size:16px;max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.avplayer-ui-container .avplayer-ui-header a{position:absolute;right:calc((var(--libmedia-ui-header-height) - 16px) / 2);top:calc((var(--libmedia-ui-header-height) - 16px) / 2);height:16px}.avplayer-ui-container .avplayer-ui-header a svg{height:16px;width:16px}.avplayer-ui-container .avplayer-ui-player{width:100%;height:100%;position:absolute;top:0;left:0;overflow:hidden;cursor:pointer}.avplayer-ui-container .avplayer-ui-player canvas,.avplayer-ui-container .avplayer-ui-player video{background-color:#000}.avplayer-ui-container .avplayer-ui-footer{padding:0 var(--libmedia-ui-padding);transition:all var(--libmedia-ui-transition-duration) ease;background-size:100% var(--libmedia-ui-bottom-height);background-image:linear-gradient(to top,#000,rgba(0,0,0,0.4),rgba(0,0,0,0));flex-direction:column;justify-content:flex-end;width:100%;height:var(--libmedia-ui-bottom-height);display:flex;position:absolute;bottom:0}.avplayer-ui-container .avplayer-ui-footer .avplayer-ui-progress-container{pointer-events:auto;padding-bottom:var(--libmedia-ui-bottom-gap);position:relative;transition:transform var(--libmedia-ui-transition-duration) ease}.avplayer-ui-container .avplayer-ui-footer .avplayer-ui-control{height:var(--libmedia-ui-control-height);justify-content:space-between;align-items:center;display:flex;position:relative;transition:transform var(--libmedia-ui-transition-duration) ease}.avplayer-ui-container .avplayer-ui-footer .avplayer-ui-control .avplayer-ui-control-item{cursor:pointer;white-space:nowrap;opacity:var(--libmedia-ui-control-opacity);min-height:var(--libmedia-ui-control-height);min-width:var(--libmedia-ui-control-height);transition:opacity var(--libmedia-ui-transition-duration) ease;flex-shrink:0;justify-content:center;align-items:center;display:flex;position:relative}.avplayer-ui-container .avplayer-ui-footer .avplayer-ui-control .avplayer-ui-control-item svg{height:var(--libmedia-ui-control-icon-size);width:var(--libmedia-ui-control-icon-size);transform:scale(var(--libmedia-ui-control-icon-scale));transition:transform var(--libmedia-ui-transition-duration) ease}.avplayer-ui-container .avplayer-ui-footer .avplayer-ui-control .avplayer-ui-control-item:hover{cursor:pointer;opacity:1}.avplayer-ui-container .avplayer-ui-footer .avplayer-ui-control .avplayer-ui-footer-left{height:100%;display:flex}.avplayer-ui-container .avplayer-ui-footer .avplayer-ui-control .avplayer-ui-footer-right{height:100%;display:flex;justify-content:flex-end}.avplayer-ui-container .avplayer-ui-footer:hover .avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-indicator{transform:scale(1)}.avplayer-ui-container .avplayer-ui-folder-container{position:absolute;top:0;left:0;transition:all var(--libmedia-ui-transition-duration) ease;width:var(--libmedia-ui-folder-width);bottom:calc(var(--libmedia-ui-progress-height) + var(--libmedia-ui-bottom-gap) + var(--libmedia-ui-control-height));box-shadow:2px 0 8px rgba(0,0,0,0.6);background-color:var(--libmedia-ui-widget-background);border-top-right-radius:8px;border-bottom-right-radius:8px}.avplayer-ui-container .avplayer-ui-folder-container .avplayer-ui-folder-toggle{width:24px;height:60px;justify-content:center;align-items:center;display:flex;cursor:pointer;border-top-right-radius:8px;border-bottom-right-radius:8px;box-shadow:2px 0 8px rgba(0,0,0,0.6);transition:all var(--libmedia-ui-transition-duration) ease;position:absolute;right:-24px;top:50%;transform:translateY(-50%);opacity:1}.avplayer-ui-container .avplayer-ui-folder-container .avplayer-ui-folder-toggle svg{width:24px;height:24px;opacity:var(--libmedia-ui-control-opacity);transform:rotate(180deg)}.avplayer-ui-container .avplayer-ui-folder-container .avplayer-ui-folder-toggle:hover svg{opacity:1}.avplayer-ui-container .avplayer-ui-folder-container[data-fold='1']{transform:translateX(calc(var(--libmedia-ui-folder-width) * -1))}.avplayer-ui-container .avplayer-ui-folder-container[data-fold='1'] .avplayer-ui-folder-toggle svg{transform:rotate(0)}.avplayer-ui-container .avplayer-ui-mask{pointer-events:none;justify-content:center;align-items:center;width:100%;height:100%;display:flex;position:absolute}.avplayer-ui-container .avplayer-ui-mask .avplayer-ui-state{opacity:0;width:var(--libmedia-ui-state-size);height:var(--libmedia-ui-state-size);transition:all var(--libmedia-ui-transition-duration) ease;justify-content:center;align-items:center;display:flex;transform:scale(2)}.avplayer-ui-container .avplayer-ui-mask .avplayer-ui-state img{vertical-align:top;max-width:100%}.avplayer-ui-container .avplayer-ui-mask .avplayer-ui-state[data-show='1']{cursor:pointer;pointer-events:auto;opacity:var(--libmedia-ui-state-opacity);transform:scale(1)}.avplayer-ui-container .avplayer-ui-mask.info{height:calc(100% - var(--libmedia-ui-bottom-height))}.avplayer-ui-container .avplayer-ui-mask.showSettings{height:calc(100% - var(--libmedia-ui-bottom-height))}.avplayer-ui-container .avplayer-ui-pcm-visualization-mask{pointer-events:none;justify-content:center;align-items:center;width:100%;height:100%;display:flex;position:absolute;transition:all var(--libmedia-ui-transition-duration) ease}.avplayer-ui-container .avplayer-ui-menu{position:fixed;border-radius:var(--libmedia-ui-border-radius);background-color:var(--libmedia-ui-widget-background);transition:all var(--libmedia-ui-transition-duration) ease}.avplayer-ui-container .avplayer-ui-menu .avplayer-ui-menu-item{padding:10px 60px;font-size:14px;cursor:pointer}.avplayer-ui-container .avplayer-ui-menu .avplayer-ui-menu-item:hover{background-color:var(--libmedia-ui-widget-hover-background)}.avplayer-ui-container[data-bar-show='0']{cursor:none}.avplayer-ui-container[data-bar-show='0'] .avplayer-ui-player{cursor:none}.avplayer-ui-container[data-bar-show='0'] .avplayer-ui-header{transform:translateY(calc(var(--libmedia-ui-header-height) * -1))}.avplayer-ui-container[data-bar-show='0'] .avplayer-ui-footer{transform:translateY(var(--libmedia-ui-bottom-height))}.avplayer-ui-container[data-bar-show='0'] .avplayer-ui-footer .avplayer-ui-progress-container{transform:translateY(calc((var(--libmedia-ui-bottom-height) - var(--libmedia-ui-bottom-gap) - var(--libmedia-ui-progress-height) * 0.5 - var(--libmedia-ui-control-height)) * -1))}.avplayer-ui-container[data-bar-show='0'] .avplayer-ui-folder-container{opacity:0;transform:translateX(calc(var(--libmedia-ui-folder-width) * -1))}.avplayer-ui-container[data-bar-show='0'] .avplayer-ui-folder-container .avplayer-ui-folder-toggle{pointer-events:none}.avplayer-ui-container[data-bar-show='0'] .avplayer-ui-pcm-visualization-mask{background-color:rgba(0,0,0,0.5)}@keyframes icon_scale{0%{transform:scale(1);transform-origin:center center}50%{transform:scale(1.2);transform-origin:center center}100%{transform:scale(1);transform-origin:center center}}@keyframes icon_rotate{0%{transform:rotate(0);transform-origin:center center}100%{transform:rotate(120deg);transform-origin:center center}}"},41192:e=>{e.exports=".avplayer-ui-control-audio-track{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-audio-track:hover .libmedia-ui-selector{opacity:1;pointer-events:auto}"},56872:e=>{e.exports=".avplayer-ui-control-fullscreen{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-fullscreen:hover svg{animation:icon_scale .4s ease both}"},68738:e=>{e.exports=".avplayer-ui-control-loop{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-loop:hover svg{animation:icon_scale .4s ease both}"},38712:e=>{e.exports=".avplayer-ui-control-pip{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-pip:hover svg{animation:icon_scale .4s ease both}"},90902:e=>{e.exports=".avplayer-ui-control-play{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-play:hover svg{animation:icon_scale .4s ease both}"},33814:e=>{e.exports=".avplayer-ui-control-play-rate{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-play-rate:hover .libmedia-ui-selector{opacity:1;pointer-events:auto}"},97176:e=>{e.exports=".avplayer-ui-control-settings{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-settings:hover svg{animation:icon_rotate .4s ease both}"},66328:e=>{e.exports=".avplayer-ui-control-subtitle-track{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-subtitle-track:hover .libmedia-ui-selector{opacity:1;pointer-events:auto}"},52068:e=>{e.exports=".avplayer-ui-control-timer{display:flex;align-items:center;justify-content:center;cursor:pointer;padding:0 10px;opacity:var(--libmedia-ui-control-opacity)}.avplayer-ui-control-timer .avplayer-ui-time-label{min-width:66px}.avplayer-ui-control-timer .avplayer-ui-time-div{transform:translateX(-1px)}.avplayer-ui-control-timer:hover{opacity:1}"},15478:e=>{e.exports=".avplayer-ui-control-video-track{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-video-track:hover .libmedia-ui-selector{opacity:1;pointer-events:auto}"},92066:e=>{e.exports=".avplayer-ui-control-volume{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-volume:hover svg{animation:icon_scale .4s ease both}.avplayer-ui-control-volume:hover .avplayer-ui-volume-panel{opacity:1;pointer-events:auto}.avplayer-ui-control-volume .avplayer-ui-volume-icon{justify-content:center;align-items:center;display:flex}.avplayer-ui-control-volume .avplayer-ui-volume-panel{text-align:center;opacity:0;pointer-events:none;left:0;right:0;bottom:var(--libmedia-ui-control-height);width:var(--libmedia-ui-control-height);height:var(--libmedia-ui-volume-height);transition:all ease;transition:all var(--libmedia-ui-transition-duration) ease 0s;justify-content:center;align-items:center;padding:0 5px;font-size:12px;display:flex;position:absolute;z-index:1}.avplayer-ui-control-volume .avplayer-ui-volume-panel .avplayer-ui-volume-inner{border-radius:var(--libmedia-ui-border-radius);background-color:var(--libmedia-ui-widget-background);flex-direction:column;align-items:center;gap:10px;width:100%;height:100%;padding:10px 0 12px;display:flex}.avplayer-ui-control-volume .avplayer-ui-volume-panel .avplayer-ui-volume-inner .libmedia-ui-slider{flex:1}"},74320:e=>{e.exports=".avplayer-ui-folder{width:100%;height:100%;padding:var(--libmedia-ui-padding) 0;transition:all var(--libmedia-ui-transition-duration) ease}.avplayer-ui-folder ul{margin:0;padding:0;list-style:none}.avplayer-ui-folder svg{width:24px;height:24px}.avplayer-ui-folder .avplayer-ui-folder-open{display:flex;justify-content:center;align-items:center;height:30px;margin-bottom:10px;width:var(--libmedia-ui-folder-width);padding-right:var(--libmedia-ui-padding)}.avplayer-ui-folder .avplayer-ui-folder-open .avplayer-ui-folder-open-dir{transform:scale(.9)}.avplayer-ui-folder .avplayer-ui-folder-open .avplayer-ui-folder-open-dir .avplayer-ui-folder-open-name{margin-left:3px}.avplayer-ui-folder .avplayer-ui-folder-open .avplayer-ui-folder-open-file{transform:scale(.9)}.avplayer-ui-folder .avplayer-ui-folder-open .avplayer-ui-folder-open-file svg{stroke:var(--libmedia-ui-font-color);fill:none}.avplayer-ui-folder .avplayer-ui-folder-open .item{cursor:pointer;display:flex;justify-content:center;align-items:center;opacity:var(--libmedia-ui-control-opacity);transition:opacity var(--libmedia-ui-transition-duration) ease}.avplayer-ui-folder .avplayer-ui-folder-open .item:hover{opacity:1}.avplayer-ui-folder .avplayer-ui-folder-open .avplayer-ui-folder-open-name{display:inline-block;font-size:12px}.avplayer-ui-folder .avplayer-ui-folder-open .item + .item{margin-left:20px}.avplayer-ui-folder .avplayer-ui-url-open{display:flex;justify-content:center;align-items:center;margin-bottom:10px;height:30px;width:var(--libmedia-ui-folder-width);padding:0 var(--libmedia-ui-padding);opacity:var(--libmedia-ui-control-opacity);transition:opacity var(--libmedia-ui-transition-duration) ease}.avplayer-ui-folder .avplayer-ui-url-open .avplayer-ui-url-open-input{flex:1;font-size:12px;border:1px;border-radius:4px;color:var(--libmedia-ui-font-color);outline:none;border:1px solid var(--libmedia-ui-font-color);background:none;height:28px;line-height:28px;margin-left:14px;padding-left:10px}.avplayer-ui-folder .avplayer-ui-url-open .avplayer-ui-url-open-input::placeholder{color:var(--libmedia-ui-font-color)}.avplayer-ui-folder .avplayer-ui-url-open .avplayer-ui-folder-icon{width:30px;transform:scale(.9)}.avplayer-ui-folder .avplayer-ui-url-open .avplayer-ui-folder-icon svg{stroke:var(--libmedia-ui-font-color)}.avplayer-ui-folder .avplayer-ui-url-open .avplayer-ui-folder-icon:hover{cursor:pointer}.avplayer-ui-folder .avplayer-ui-url-open .avplayer-ui-folder-icon:hover svg{animation:icon_scale .4s ease both}.avplayer-ui-folder .avplayer-ui-url-open .avplayer-ui-url-open-live{display:flex;justify-content:center;align-items:center;font-size:12px}.avplayer-ui-folder .avplayer-ui-url-open:hover{opacity:1}.avplayer-ui-folder .avplayer-ui-folder-list-container{position:absolute;top:90px;bottom:0;left:0;right:0;overflow:auto}.avplayer-ui-folder .avplayer-ui-folder-list-container::-webkit-scrollbar{display:none}.avplayer-ui-folder .avplayer-ui-folder-node{display:flex;flex-direction:row;justify-content:flex-start;align-items:center;height:30px;width:var(--libmedia-ui-folder-width);padding-right:var(--libmedia-ui-padding);opacity:var(--libmedia-ui-control-opacity);transition:opacity var(--libmedia-ui-transition-duration) ease}.avplayer-ui-folder .avplayer-ui-folder-node.active{background-color:var(--libmedia-ui-theme) !important}.avplayer-ui-folder .avplayer-ui-folder-node:hover{background-color:var(--libmedia-ui-widget-hover-background);opacity:1}.avplayer-ui-folder .avplayer-ui-folder-expand{cursor:pointer;font-size:0;display:flex;justify-content:center;align-items:center;transition:transform linear .1s;width:24px;height:100%}.avplayer-ui-folder .avplayer-ui-folder-expand svg{transform:rotate(0)}.avplayer-ui-folder .avplayer-ui-folder-expand[data-open='1'] svg{transform:rotate(90deg)}.avplayer-ui-folder .avplayer-ui-folder-icon{display:flex;justify-content:center;align-items:center;width:24px;height:100%}.avplayer-ui-folder .avplayer-ui-folder-icon.mov{margin-left:24px;transform:scale(.9)}.avplayer-ui-folder .avplayer-ui-folder-icon.music{margin-left:24px}.avplayer-ui-folder .avplayer-ui-folder-icon.url{margin-left:24px}.avplayer-ui-folder .avplayer-ui-folder-icon.play,.avplayer-ui-folder .avplayer-ui-folder-icon.delete{cursor:pointer;transform:scale(.8)}.avplayer-ui-folder .avplayer-ui-folder-icon.play:hover svg,.avplayer-ui-folder .avplayer-ui-folder-icon.delete:hover svg{animation:icon_scale .4s ease both}.avplayer-ui-folder .avplayer-ui-folder-node-name{padding:0 5px;min-width:100px;flex-grow:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.avplayer-ui-folder .avplayer-ui-folder-tip{text-shadow:0 -1px var(--libmedia-ui-tip-background);box-shadow:4px 4px 8px var(--libmedia-ui-tip-background);color:var(--libmedia-ui-tip-font-color);white-space:nowrap;background:var(--libmedia-ui-tip-background);padding:8px 10px;font-size:12px;line-height:12px;opacity:0;pointer-events:none;transition:all var(--libmedia-ui-transition-duration) ease .1s,top 0s ease 0s;position:absolute;transform:translate3d(0,0,0);left:100%}.avplayer-ui-folder .avplayer-ui-folder-tip::before{content:\"\";border:5px solid rgba(0,0,0,0);position:absolute;border-right-color:var(--libmedia-ui-tip-background);left:-10px;transform:translateY(1px)}.avplayer-ui-folder .avplayer-ui-folder-tip[data-show='1']{transform:translateX(8px);opacity:1}"},51e3:e=>{e.exports=".avplayer-ui-info{pointer-events:auto;background:var(--libmedia-ui-tip-background);border-radius:4px;color:#fff;line-height:18px;padding-bottom:15px;text-align:center;text-align:left;-webkit-font-smoothing:antialiased;position:relative;max-height:80%;max-width:80%;user-select:text;display:flex;flex-direction:column}.avplayer-ui-info .avplayer-ui-info-title{border-bottom:1px solid rgba(255,255,255,0.1);font-size:16px;line-height:40px;text-align:center;height:41px}.avplayer-ui-info .avplayer-ui-info-close{fill:#fff;color:#fff;cursor:pointer;height:22px;position:absolute;right:10px;top:8px;width:22px}.avplayer-ui-info .avplayer-ui-info-panel{flex:1;padding:15px 26px 0;position:relative;overflow:auto;scrollbar-width:thin}.avplayer-ui-info .avplayer-ui-info-panel::-webkit-scrollbar{width:8px;height:8px}.avplayer-ui-info .avplayer-ui-info-panel .avplayer-ui-info-format{font-size:12px;font-weight:500}.avplayer-ui-info .avplayer-ui-info-panel .avplayer-ui-info-line{min-width:290px}.avplayer-ui-info .avplayer-ui-info-panel .avplayer-ui-info-line .avplayer-ui-info-line-title{font-size:12px;font-weight:500;margin-right:10px;text-align:right;text-indent:-99em;width:190px;display:inline-block}.avplayer-ui-info .avplayer-ui-info-panel .avplayer-ui-info-line .avplayer-ui-info-line-value{color:#999;font-size:12px;font-weight:400;margin-right:6px}"},17246:e=>{e.exports=".avplayer-ui-loading-mask{position:absolute;width:100%;height:100%;text-align:center;top:0;left:0;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:all var(--libmedia-ui-transition-duration) ease}.avplayer-ui-loading-mask .avplayer-ui-loading-spinner{top:50%;margin-top:-21px;width:100%;text-align:center;position:absolute}.avplayer-ui-loading-mask .avplayer-ui-loading-spinner .avplayer-ui-circular{height:42px;width:42px;animation:loading-rotate 2s linear infinite}.avplayer-ui-loading-mask .avplayer-ui-loading-spinner .avplayer-ui-circular circle{animation:loading-dash 1.5s ease-in-out infinite;stroke-dasharray:90,150;stroke-dashoffset:0;stroke-width:2;stroke:var(--libmedia-ui-theme);stroke-linecap:round}.avplayer-ui-loading-mask[data-loading='1']{opacity:1;pointer-events:auto}@keyframes loading-rotate{to{transform:rotate(1turn)}}@keyframes loading-dash{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-40px}to{stroke-dasharray:90,150;stroke-dashoffset:-120px}}"},85466:e=>{e.exports=".avplayer-ui-loading-tip{position:absolute;right:20px;bottom:calc(var(--libmedia-ui-bottom-height) + 10px);opacity:1;pointer-events:none;transition:all 1s ease}.avplayer-ui-loading-tip .avplayer-ui-loading-message{transition:bottom .1s ease,transform 1s ease;border-radius:var(--libmedia-ui-border-radius);white-space:nowrap;background-color:var(--libmedia-ui-tip-background);padding:3px 5px;font-size:12px;line-height:1;position:absolute;right:0}.avplayer-ui-loading-tip .avplayer-ui-loading-message[data-last='1']{animation:avplayer-ui-loading-message-last .1s ease}.avplayer-ui-loading-tip[data-show='0']{opacity:0}.avplayer-ui-loading-tip[data-show='0'] .avplayer-ui-loading-message{transform:translateY(-40px)}@keyframes avplayer-ui-loading-message-last{0%{opacity:0}100%{opacity:1}}"},5840:e=>{e.exports=".avplayer-ui-pcm-visualization{width:100%;height:100%}.avplayer-ui-pcm-visualization canvas{width:100%;height:100%}"},99726:e=>{e.exports=".avplayer-ui-progress{cursor:pointer;height:var(--libmedia-ui-progress-height);justify-content:center;align-items:center;display:flex;position:relative}.avplayer-ui-progress:hover .avplayer-ui-progress-inner{height:100%}.avplayer-ui-progress .avplayer-ui-progress-inner{transition:height var(--libmedia-ui-transition-duration) ease;background-color:var(--libmedia-ui-progress-color);align-items:center;width:100%;height:50%;display:flex;position:relative}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-hover{background-color:var(--libmedia-ui-hover-color);width:0%;height:100%;position:absolute}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-loaded{background-color:var(--libmedia-ui-loaded-color);width:0%;height:100%;position:absolute}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-played{background-color:var(--libmedia-ui-theme);width:0%;height:100%;position:absolute}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-chapter{pointer-events:none;width:100%;height:100%;position:absolute}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-indicator{width:var(--libmedia-ui-indicator-size);height:var(--libmedia-ui-indicator-size);transform:scale(var(--libmedia-ui-indicator-scale));margin-left:calc(var(--libmedia-ui-indicator-size) / -2);transition:transform var(--libmedia-ui-transition-duration) ease;border-radius:50%;justify-content:center;align-items:center;display:flex;position:absolute;left:0}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-indicator:hover{transform:scale(1.2) !important}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-indicator .avplayer-ui-icon-indicator{width:100%;height:100%}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-chapter{pointer-events:none;width:100%;height:100%;position:absolute;overflow:hidden}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-chapter .avplayer-ui-progress-chapter-item{pointer-events:auto;transform:translateX(calc(var(--libmedia-ui-chapter-width) / -2));background-color:var(--libmedia-ui-chapter-color);width:var(--libmedia-ui-chapter-width);height:100%;position:absolute}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-tip{border-radius:var(--libmedia-ui-border-radius);white-space:nowrap;background-color:var(--libmedia-ui-tip-background);transform:translateX(-50%);padding:3px 5px;font-size:12px;line-height:1;display:none;position:absolute;top:-25px;left:0}.avplayer-ui-progress .libmedia-ui-progress-thumb{bottom:calc(var(--libmedia-ui-bottom-gap) + 10px);border-radius:var(--libmedia-ui-border-radius);pointer-events:none;background-color:var(--libmedia-ui-widget-background);display:none;position:absolute;left:0;box-shadow:0 1px 3px rgba(0,0,0,0.2),0 1px 2px -1px rgba(0,0,0,0.2)}"},47410:e=>{e.exports=".avplayer-ui-settings{pointer-events:auto;background:var(--libmedia-ui-tip-background);border-radius:4px;color:#fff;position:relative;max-height:100%;max-width:80%;width:600px;height:500px;display:flex;flex-direction:column}.avplayer-ui-settings .avplayer-ui-settings-title{border-bottom:1px solid rgba(255,255,255,0.1);font-size:16px;line-height:40px;text-align:center;height:41px}.avplayer-ui-settings .avplayer-ui-settings-close{fill:#fff;color:#fff;cursor:pointer;height:22px;position:absolute;right:10px;top:8px;width:22px}.avplayer-ui-settings .avplayer-ui-settings-panel{flex:1;position:relative;display:flex;overflow:hidden}.avplayer-ui-settings .avplayer-ui-settings-panel .avplayer-ui-settings-tabs{width:141px;height:100%;padding:20px;overflow:auto;transition:all var(--libmedia-ui-transition-duration) ease;border-right:1px solid rgba(255,255,255,0.1)}.avplayer-ui-settings .avplayer-ui-settings-panel .avplayer-ui-settings-tabs .avplayer-ui-settings-tab{width:100px;height:36px;text-align:center;line-height:36px;cursor:pointer;border-radius:4px;font-size:14px;opacity:var(--libmedia-ui-control-opacity);background-color:var(--libmedia-ui-widget-hover-background)}.avplayer-ui-settings .avplayer-ui-settings-panel .avplayer-ui-settings-tabs .avplayer-ui-settings-tab:hover{opacity:1}.avplayer-ui-settings .avplayer-ui-settings-panel .avplayer-ui-settings-tabs .avplayer-ui-settings-tab.active{opacity:1;background-color:var(--libmedia-ui-theme)}.avplayer-ui-settings .avplayer-ui-settings-panel .avplayer-ui-settings-tabs .avplayer-ui-settings-tab + .avplayer-ui-settings-tab{margin-top:10px}.avplayer-ui-settings .avplayer-ui-settings-panel .avplayer-ui-settings-context{flex:1;height:100%;overflow:auto;padding:20px}"},92246:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(134),s=i(16030),a=i(4624),n=i(9705);class o{constructor(e){(0,r.A)(this,"resampler",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"inputParameters",void 0),(0,r.A)(this,"outputParameters",void 0),this.options=e,this.resampler=new s.A(this.options.resource)}async open(e,t){this.inputParameters=e,this.outputParameters=t,await this.resampler.run(),this.resampler.invoke("resample_set_input_parameters",e.sampleRate,e.channels,e.format,e.layout||0),this.resampler.invoke("resample_set_output_parameters",t.sampleRate,t.channels,t.format,t.layout||0);let i=this.resampler.invoke("resample_init");return i<0?(a.z3(`open resampler failed, ret: ${i}`,"src/audioresample/Resampler.ts",85),n.nr):0}resample(e,t,i){return this.resampler.invoke("resample_process",e,t,i)}getOutputSampleCount(e){return this.resampler.invoke("resample_nb_sample",e)}close(){this.resampler.invoke("resample_destroy"),this.resampler.destroy()}getInputPCMParameters(){return this.inputParameters}getOutputPCMParameters(){return this.outputParameters}}},70089:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(134),s=i(16030);class a{constructor(e){(0,r.A)(this,"processor",void 0),(0,r.A)(this,"options",void 0),this.options=e,this.processor=new s.A(this.options.resource)}async open(e){await this.processor.run(),this.processor.invoke("stretchpitch_init"),this.processor.invoke("stretchpitch_set_channels",e.channels),this.processor.invoke("stretchpitch_set_samplerate",e.sampleRate)}setRate(e){this.processor.invoke("stretchpitch_set_rate",e)}setRateChange(e){this.processor.invoke("stretchpitch_set_rate_change",e)}setTempo(e){this.processor.invoke("stretchpitch_set_tempo",e)}setTempoChange(e){this.processor.invoke("stretchpitch_set_tempo_change",e)}setPitch(e){this.processor.invoke("stretchpitch_set_pitch",e)}setPitchOctaves(e){this.processor.invoke("stretchpitch_set_pitch_octaves",e)}setPitchSemiTones(e){this.processor.invoke("stretchpitch_set_pitch_semi_tones",e)}sendSamples(e,t){this.processor.invoke("stretchpitch_send_samples",e,t)}receiveSamples(e,t){return this.processor.invoke("stretchpitch_receive_samples",e,t)}flush(){this.processor.invoke("stretchpitch_flush")}clear(){this.processor.invoke("stretchpitch_clear")}getUnprocessedSamplesCount(){return this.processor.invoke("stretchpitch_get_unprocessed_samples_num")}getInputOutputSamplesRatio(){return this.processor.invoke("stretchpitch_get_input_output_sample_ratio")}getLatency(){return this.processor.invoke("get_latency")}close(){this.processor.invoke("stretchpitch_destroy"),this.processor.destroy()}}},53616:(e,t,i)=>{"use strict";i.d(t,{A:()=>h});var r=i(134),s=i(63939),a=i(9705),n=i(26235),o=i(59996),c=i(62624),l=i(9787),d=i(43950);class h{constructor(e){(0,r.A)(this,"options",void 0),(0,r.A)(this,"frame",void 0),(0,r.A)(this,"decoder",void 0),this.options=e}getAVFrame(){return this.frame?this.frame:this.frame={pts:BigInt(0),duration:BigInt(0),rects:[],timeBase:{den:1,num:1}}}outputAVFrame(){this.frame&&(this.options.onReceiveSubtitle&&this.options.onReceiveSubtitle(this.frame),this.frame=void 0)}receiveAVFrame(){return this.decoder.receiveAVFrame(this.getAVFrame())}async open(e){switch(s.f[15](e+4)){case 94226:this.decoder=new n.A;break;case 94232:this.decoder=new c.A;break;case 94210:case 94225:this.decoder=new d.A;break;case 94213:this.decoder=new l.A;break;case 94212:case 94230:this.decoder=new o.A;break;default:return a.r8}return 0}decode(e){let t=this.decoder.sendAVPacket(e);if(t)return t;for(;;){if(t=this.receiveAVFrame(),1!==t){if(t<0)return t;break}this.outputAVFrame()}return 0}async flush(){for(this.decoder.flush();;){if(this.receiveAVFrame()<1)return;this.outputAVFrame()}}close(){this.frame&&(this.frame=void 0)}}},59996:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(134),s=i(63939),a=i(81023),n=i(71517),o=i(50011);class c extends a.A{constructor(){super(),(0,r.A)(this,"queue",void 0),this.queue=[]}sendAVPacket(e){return this.queue.push({data:(0,n.iI)(e).slice(),pts:s.f[17](e+8),duration:s.f[17](e+48),timeBase:{den:s.f[15](e+76),num:s.f[15](e+72)}}),0}receiveAVFrame(e){if(this.queue.length){const t=this.queue.shift();e.pts=t.pts,e.duration=t.duration,e.timeBase.den=t.timeBase.den,e.timeBase.num=t.timeBase.num;let i=o.decode(t.data);return/^\w+?\s*:/.test(i)||(i="Dialogue: "+i),e.rects.push({type:3,text:i,flags:0}),1}return 0}flush(){return 0}}},81023:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});class r{}},43950:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(134),s=i(63939),a=i(81023),n=i(71517),o=i(50011);class c extends a.A{constructor(){super(),(0,r.A)(this,"queue",void 0),this.queue=[]}sendAVPacket(e){return this.queue.push({data:(0,n.iI)(e).slice(),pts:s.f[17](e+8),duration:s.f[17](e+48),timeBase:{den:s.f[15](e+76),num:s.f[15](e+72)}}),0}receiveAVFrame(e){if(this.queue.length){const t=this.queue.shift();return e.pts=t.pts,e.duration=t.duration,e.timeBase.den=t.timeBase.den,e.timeBase.num=t.timeBase.num,e.rects.push({type:1,text:o.decode(t.data),flags:0}),1}return 0}flush(){return 0}}},9787:(e,t,i)=>{"use strict";i.d(t,{A:()=>l});var r=i(134),s=i(63939),a=i(81023),n=i(71517),o=i(50011),c=i(4624);class l extends a.A{constructor(){super(),(0,r.A)(this,"queue",void 0),this.queue=[]}sendAVPacket(e){const t=(0,n.iI)(e).slice();if(t.length<2)return 0;const i=t[0]<<8|t[1];if(i+2>t.length)return c.R8(`invalid timed text data, need ${i+2} but got ${t.length}, ignore it`,"src/avcodec/subtitle/decoder/TimedTextDecoder.ts",59),0;const r=o.decode(t.subarray(2,2+i));return this.queue.push({text:r,pts:s.f[17](e+8),duration:s.f[17](e+48),timeBase:{den:s.f[15](e+76),num:s.f[15](e+72)}}),0}receiveAVFrame(e){if(this.queue.length){const t=this.queue.shift();return e.pts=t.pts,e.duration=t.duration,e.timeBase.den=t.timeBase.den,e.timeBase.num=t.timeBase.num,e.rects.push({type:1,text:t.text,flags:0}),1}return 0}flush(){return 0}}},62624:(e,t,i)=>{"use strict";i.d(t,{A:()=>d});var r=i(134),s=i(63939),a=i(81023),n=i(50011),o=i(71517),c=i(77231),l=i(74762);class d extends a.A{constructor(){super(),(0,r.A)(this,"queue",void 0),this.queue=[]}sendAVPacket(e){let t=n.decode((0,o.iI)(e));return t?(/<tt/.test(t.trim())?this.queue=this.queue.concat(l.q(t).queue):this.queue.push({pts:s.f[17](e+8),duration:s.f[17](e+48),context:t,region:"Default"}),0):0}receiveAVFrame(e){if(this.queue.length){const t=this.queue.shift();return e.pts=t.pts,e.duration=t.duration,e.timeBase.den=c.qs,e.timeBase.num=1,e.rects.push({type:2,text:t.context,flags:0}),1}return 0}flush(){return 0}}},26235:(e,t,i)=>{"use strict";i.d(t,{A:()=>d});var r=i(134),s=i(63939),a=i(81023),n=i(50011),o=i(71517),c=i(54825),l=i(77231);class d extends a.A{constructor(){super(),(0,r.A)(this,"queue",void 0),this.queue=[]}findTimelineTag(e){const t=e.indexOf("<");if(t>=0){const i=e.indexOf(">",t);if(i>t&&/^(\d{2,}:)?\d{2}:\d{2}\.\d{1,3}$/.test(e.substring(t+1,i)))return{start:t,end:i}}return{start:-1,end:-1}}sendAVPacket(e){let t=n.decode((0,o.iI)(e)),i=s.f[17](e+8);const r=i+s.f[17](e+48),a=[];for(;;){const{start:r,end:n}=this.findTimelineTag(t);if(r<0)break;const o=(0,c.j)(t.substring(r+1,n));a.push(t.substring(0,r)),this.queue.push({context:a.join(""),pts:i,duration:o-i,timeBase:{den:s.f[15](e+76),num:s.f[15](e+72)}}),i=o,t=t.substring(n+1)}return a.push(t),this.queue.push({context:a.join(""),pts:i,duration:r-i,timeBase:{den:s.f[15](e+76),num:s.f[15](e+72)}}),0}receiveAVFrame(e){if(this.queue.length){const t=this.queue.shift();return e.pts=t.pts,e.duration=t.duration,e.timeBase.den=l.qs,e.timeBase.num=1,e.rects.push({type:2,text:t.context,flags:0}),1}return 0}flush(){return 0}}},75742:(e,t,i)=>{"use strict";i.d(t,{A:()=>g});var r=i(134),s=i(63939),a=i(50932),n=i(11473),o=i(16030),c=i(56024),l=i(4624),d=i(95797),h=(i(56490),i(95335)),u=i(73749),f=i(67672),p=i(37837),m=i(9705);class g{constructor(e){(0,r.A)(this,"options",void 0),(0,r.A)(this,"decoder",void 0),(0,r.A)(this,"frame",0),(0,r.A)(this,"decoderOptions",0),(0,r.A)(this,"timeBase",void 0),this.options=e,this.decoder=new o.A(e.resource)}getAVFrame(){return this.frame?this.frame:this.frame=this.options.avframePool?this.options.avframePool.alloc():(0,c.FP)()}outputAVFrame(){this.frame&&(this.options.onReceiveAVFrame?(a.M[15](this.frame+124,this.timeBase.den),a.M[15](this.frame+120,this.timeBase.num),this.options.onReceiveAVFrame(this.frame)):this.options.avframePool?this.options.avframePool.release(this.frame):(0,c.xj)(this.frame),this.frame=0)}receiveAVFrame(){return this.decoder.invoke("decoder_receive",this.getAVFrame())}async open(e,t={}){await this.decoder.run();const i=n.s_.malloc(4);a.M[20](i,0),h.HP(t).length&&(this.decoderOptions&&(u.AO(this.decoderOptions),n.s_.free(this.decoderOptions),this.decoderOptions=0),this.decoderOptions=(0,p.Gy)(8),h.__(t,((e,t)=>{(f.Yj(e)||f.Yj(t))&&u.a5(this.decoderOptions,t,e)})),a.M[20](i,this.decoderOptions));let r=0;return d.A.jspi?r=await this.decoder.invokeAsync("decoder_open",e,0,1,i):(r=this.decoder.invoke("decoder_open",e,0,1,i),await this.decoder.childThreadsReady()),this.decoderOptions=s.f[20](i),n.s_.free(i),r<0?(l.z3(`open audio decoder failed, ret: ${r}`,"src/avcodec/wasmcodec/AudioDecoder.ts",128),m.r8):(this.timeBase=void 0,0)}decode(e){this.timeBase||(this.timeBase={den:s.f[15](e+76),num:s.f[15](e+72)});let t=this.decoder.invoke("decoder_decode",e);if(t)return t;for(;;){if(t=this.receiveAVFrame(),1!==t){if(t<0)return t;break}this.outputAVFrame()}return 0}async flush(){for(this.decoder.invoke("decoder_flush");;){const e=this.receiveAVFrame();if(e<1)return e;this.outputAVFrame()}return 0}close(){this.decoder.invoke("decoder_close"),this.decoder.destroy(),this.frame&&(this.options.avframePool?this.options.avframePool.release(this.frame):(0,c.xj)(this.frame),this.frame=0),this.decoderOptions&&(u.AO(this.decoderOptions),n.s_.free(this.decoderOptions),this.decoderOptions=0)}}},40417:(e,t,i)=>{"use strict";i.d(t,{A:()=>g});var r=i(134),s=i(63939),a=i(50932),n=i(11473),o=i(16030),c=i(56024),l=i(4624),d=i(95797),h=(i(56490),i(95335)),u=i(73749),f=i(67672),p=i(37837),m=i(9705);class g{constructor(e){(0,r.A)(this,"options",void 0),(0,r.A)(this,"decoder",void 0),(0,r.A)(this,"frame",0),(0,r.A)(this,"parameters",0),(0,r.A)(this,"decoderOptions",0),(0,r.A)(this,"timeBase",void 0),(0,r.A)(this,"dtsQueue",[]),this.options=e,this.decoder=new o.A(this.options.resource)}getAVFrame(){return this.frame?this.frame:this.frame=this.options.avframePool?this.options.avframePool.alloc():(0,c.FP)()}outputAVFrame(){this.frame&&(2&s.f[15](this.parameters+160)&&this.dtsQueue.length&&a.M[17](this.frame+104,this.dtsQueue.shift()),this.options.onReceiveAVFrame?(a.M[15](this.frame+124,this.timeBase.den),a.M[15](this.frame+120,this.timeBase.num),this.options.onReceiveAVFrame(this.frame)):this.options.avframePool?this.options.avframePool.release(this.frame):(0,c.xj)(this.frame),this.frame=0)}receiveAVFrame(){return this.decoder.invoke("decoder_receive",this.getAVFrame())}async open(e,t=1,i={}){await this.decoder.run(void 0,t);let r=0;const o=n.s_.malloc(4);return a.M[20](o,0),h.HP(i).length&&(this.decoderOptions&&(u.AO(this.decoderOptions),n.s_.free(this.decoderOptions),this.decoderOptions=0),this.decoderOptions=(0,p.Gy)(8),h.__(i,((e,t)=>{(f.Yj(e)||f.Yj(t))&&u.a5(this.decoderOptions,t,e)})),a.M[20](o,this.decoderOptions)),d.A.jspi?r=await this.decoder.invokeAsync("decoder_open",e,0,t,o):(r=this.decoder.invoke("decoder_open",e,0,t,o),await this.decoder.childThreadsReady()),this.decoderOptions=s.f[20](o),n.s_.free(o),r<0?(l.z3(`open video decoder failed, ret: ${r}`,"src/avcodec/wasmcodec/VideoDecoder.ts",171),m.r8):(this.parameters=e,this.timeBase=void 0,this.dtsQueue.length=0,0)}decode(e){this.timeBase||(this.timeBase={den:s.f[15](e+76),num:s.f[15](e+72)});let t=this.decoder.invoke("decoder_decode",e);if(t)return t;for(2&s.f[15](this.parameters+160)&&this.dtsQueue.push(s.f[17](e+16));;){if(t=this.receiveAVFrame(),1!==t){if(t<0)return t;break}this.outputAVFrame()}return 0}async flush(){for(this.decoder.invoke("decoder_flush");;){const e=this.receiveAVFrame();if(e<1)return e;this.outputAVFrame()}return 0}close(){this.decoder.invoke("decoder_close"),this.decoder.destroy(),this.frame&&(this.options.avframePool?this.options.avframePool.release(this.frame):(0,c.xj)(this.frame),this.frame=0),this.parameters=0,this.decoderOptions&&(u.AO(this.decoderOptions),n.s_.free(this.decoderOptions),this.decoderOptions=0)}setSkipFrameDiscard(e){this.decoder.invoke("decoder_discard",e)}getChildThreadCount(){return this.decoder?this.decoder.getChildThreadCount():0}}},77104:(e,t,i)=>{"use strict";i.d(t,{A:()=>f});var r=i(134),s=i(63939),a=i(79756),n=i(14686),o=i(71517),c=i(22898),l=i(4624),d=i(9705),h=i(72739);const u="src/avcodec/webcodec/AudioDecoder.ts";class f{constructor(e){(0,r.A)(this,"options",void 0),(0,r.A)(this,"decoder",void 0),(0,r.A)(this,"parameters",0),(0,r.A)(this,"extradata",void 0),(0,r.A)(this,"currentError",null),this.options=e}output(e){this.options.onReceiveAudioData?this.options.onReceiveAudioData(e):e.close()}error(e){this.currentError=e,this.options.onError(e)}async open(e){this.currentError=null,this.parameters=e,this.extradata=void 0,0!==s.f[20](e+12)&&(this.extradata=(0,n.s3)(s.f[20](e+12),s.f[15](e+16)).slice());const t={codec:(0,a.A)(this.parameters),sampleRate:s.f[15](e+136),numberOfChannels:s.f[15](e+116),description:this.extradata};t.description||delete t.description;try{if(!(await AudioDecoder.isConfigSupported(t)).supported)return l.z3("not support",u,94),d.nr}catch(e){return l.z3(`${e}`,u,99),d.r8}return this.decoder&&"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=new AudioDecoder({output:this.output.bind(this),error:this.error.bind(this)}),this.decoder.reset(),this.decoder.configure(t),this.currentError?(l.z3(`open audio decoder error, ${this.currentError}`,u,116),d.r8):0}changeExtraData(e){return h.FB(e,this.extradata)?0:(this.currentError=null,this.extradata=e.slice(),this.decoder.reset(),this.decoder.configure({codec:(0,a.A)(this.parameters),sampleRate:s.f[15](this.parameters+136),numberOfChannels:s.f[15](this.parameters+116),description:this.extradata}),this.currentError?(l.z3(`change extra data error, ${this.currentError}`,u,140),d.r8):0)}decode(e){if(this.currentError)return l.z3(`decode error, ${this.currentError}`,u,149),d.LR;const t=(0,o.rU)(e,1);if(0!==t){let e=this.changeExtraData((0,n.s3)(s.f[20](t),s.f[25](t+4)));if(e)return e}const i=(0,c.A)(e);try{this.decoder.decode(i)}catch(e){return l.z3(`decode error, ${e}`,u,168),d.LR}return 0}async flush(){if(this.currentError)return l.z3(`flush error, ${this.currentError}`,u,177),d.LR;try{return await this.decoder.flush(),0}catch(e){return l.z3(`flush error, ${e}`,u,185),d.LR}}close(){"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=void 0}getQueueLength(){var e,t;return null!==(e=null===(t=this.decoder)||void 0===t?void 0:t.decodeQueueSize)&&void 0!==e?e:0}static async isSupported(e){let t;0!==s.f[20](e+12)&&(t=(0,n.s3)(s.f[20](e+12),s.f[15](e+16)).slice());const i={codec:(0,a.A)(e),sampleRate:s.f[15](e+136),numberOfChannels:s.f[15](e+116),description:t};i.description||delete i.description;try{return(await AudioDecoder.isConfigSupported(i)).supported}catch(e){return!1}}}},71039:(e,t,i)=>{"use strict";i.d(t,{A:()=>w});var r=i(134),s=i(63939),a=(i(9599),i(86834)),n=i(28875),o=i(14686),c=i(71517),l=i(39365),d=i(28917),h=i(4624),u=i(44690),f=i(62815),p=i(67659),m=i(59166),g=i(9705),v=i(72739),y=i(77231),A=i(44328);const b="src/avcodec/webcodec/VideoDecoder.ts";class w{constructor(e){(0,r.A)(this,"decoder",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"parameters",0),(0,r.A)(this,"extradata",void 0),(0,r.A)(this,"currentError",null),(0,r.A)(this,"inputQueue",void 0),(0,r.A)(this,"outputQueue",void 0),(0,r.A)(this,"dtsQueue",void 0),(0,r.A)(this,"sort",void 0),(0,r.A)(this,"keyframeRequire",!1),(0,r.A)(this,"extradataRequire",!1),this.options=e,this.inputQueue=[],this.outputQueue=[],this.dtsQueue=[],this.sort=!!(a.A.safari&&!a.A.checkVersion(a.A.version,"17.4",!0)||u.A.ios&&!a.A.checkVersion(u.A.version,"17.4",!0))}async output(e){if(2&s.f[15](this.parameters+160)&&this.dtsQueue.length){const t=e;e=new VideoFrame(t,{timestamp:this.dtsQueue.shift()}),t.close()}if(this.sort){let t=0;for(;t<this.outputQueue.length;t++)if(this.outputQueue[t].timestamp>e.timestamp){this.outputQueue.splice(t,0,e);break}for(t===this.outputQueue.length&&this.outputQueue.push(e);this.outputQueue.length>2&&this.outputQueue[0].timestamp===this.inputQueue[0];){const e=this.outputQueue.shift();this.options.onReceiveVideoFrame?this.options.onReceiveVideoFrame(e):e.close(),this.inputQueue.shift()}}else this.options.onReceiveVideoFrame?this.options.onReceiveVideoFrame(e):e.close()}error(e){this.currentError=e,this.options.onError(e)}changeExtraData(e){var t;return v.FB(e,this.extradata)?0:(this.currentError=null,this.extradata=e.slice(),this.decoder.reset(),this.decoder.configure({codec:(0,n.A)(this.parameters,e),description:this.extradata,hardwareAcceleration:(0,l.C)(null===(t=this.options.enableHardwareAcceleration)||void 0===t||t)}),this.currentError?(h.z3(`change extra data error, ${this.currentError}`,b,152),g.r8):(this.keyframeRequire=!0,0))}async open(e){var t;this.currentError=null,this.extradata=void 0,0!==s.f[20](e+12)&&(this.extradata=(0,o.s3)(s.f[20](e+12),s.f[15](e+16)).slice()),this.parameters=e;const i={codec:(0,n.A)(e),codedWidth:s.f[15](e+56),codedHeight:s.f[15](e+60),description:1&s.f[15](e+160)?void 0:this.extradata,hardwareAcceleration:(0,l.C)(null===(t=this.options.enableHardwareAcceleration)||void 0===t||t)};i.description||delete i.description;try{if(!(await VideoDecoder.isConfigSupported(i)).supported)return h.z3("not support",b,185),g.nr}catch(e){return h.z3(`${e}`,b,190),g.r8}return this.decoder&&"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=new VideoDecoder({output:this.output.bind(this),error:this.error.bind(this)}),this.decoder.reset(),this.decoder.configure(i),this.currentError?(h.z3(`open video decoder error, ${this.currentError}`,b,207),g.r8):(this.keyframeRequire=!0,1&s.f[15](e+160)&&(this.extradataRequire=!0),2&s.f[15](this.parameters+160)&&(this.sort=!1),this.inputQueue.length=0,this.outputQueue.length=0,this.dtsQueue.length=0,0)}decode(e){if(this.currentError)return h.z3(`decode error, ${this.currentError}`,b,229),g.LR;const t=(0,c.rU)(e,1);if(0!==t){let e=this.changeExtraData((0,o.s3)(s.f[20](t),s.f[25](t+4)));if(e)return e}const i=1&s.f[15](e+36);if(this.keyframeRequire){if(!i)return 0;if(1&s.f[15](this.parameters+160)&&this.extradata&&this.extradataRequire){if(27===s.f[15](this.parameters+4)){if(!f.sL((0,c.iI)(e))){const t=f.kM((0,c.iI)(e),this.extradata);t&&(0,c.NX)(e,t.bufferPointer,t.length)}}else if(173===s.f[15](this.parameters+4)){if(!p.sL((0,c.iI)(e))){const t=p.kM((0,c.iI)(e),this.extradata);t&&(0,c.NX)(e,t.bufferPointer,t.length)}}else if(196===s.f[15](this.parameters+4)&&!m.sL((0,c.iI)(e))){const t=m.kM((0,c.iI)(e),this.extradata);t&&(0,c.NX)(e,t.bufferPointer,t.length)}this.extradataRequire=!1}}const r=(0,d.A)(e),a=r.timestamp;if(this.sort){let e=0;for(;e<this.inputQueue.length;e++)if(this.inputQueue[e]>a){this.inputQueue.splice(e,0,a);break}e===this.inputQueue.length&&this.inputQueue.push(a)}try{this.decoder.decode(r),2&s.f[15](this.parameters+160)&&this.dtsQueue.push(Number((0,A.Mr)(s.f[17](e+16),e+72,y.KR)))}catch(e){return h.z3(`decode error, ${e}`,b,304),g.LR}return i&&(this.keyframeRequire=!1),0}async flush(){if(this.currentError)return h.z3(`flush error, ${this.currentError}`,b,317),g.LR;try{await this.decoder.flush()}catch(e){return h.z3(`flush error, ${e}`,b,324),g.LR}if(this.sort)for(;this.outputQueue.length;){const e=this.outputQueue.shift();this.options.onReceiveVideoFrame?this.options.onReceiveVideoFrame(e):e.close()}return this.keyframeRequire=!0,0}close(){var e;this.decoder&&"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=void 0,this.currentError=null,null!==(e=this.outputQueue)&&void 0!==e&&e.length&&this.outputQueue.forEach((e=>{e.close()})),this.inputQueue.length=0,this.outputQueue.length=0}getQueueLength(){var e,t;return null!==(e=null===(t=this.decoder)||void 0===t?void 0:t.decodeQueueSize)&&void 0!==e?e:0}setSkipFrameDiscard(e){}static async isSupported(e,t){let i;0!==s.f[20](e+12)&&(i=(0,o.s3)(s.f[20](e+12),s.f[15](e+16)).slice());const r={codec:(0,n.A)(e),codedWidth:s.f[15](e+56),codedHeight:s.f[15](e+60),description:1&s.f[15](e+160)?void 0:i,hardwareAcceleration:(0,l.C)(null==t||t)};r.description||delete r.description;try{return(await VideoDecoder.isConfigSupported(r)).supported}catch(e){return!1}}}},44315:(e,t,i)=>{"use strict";i.d(t,{Xv:()=>p,fG:()=>m,oD:()=>f});var r=i(134),s=i(63939),a=i(50932),n=i(68960),o=i(71517),c=i(7417),l=i(73783);const d=c.z1(4,4),h=c.z1(4,4);class u{constructor(){(0,r.A)(this,"packetBuffer",void 0),this.packetBuffer=[]}}class f{constructor(){(0,r.A)(this,"metadataHeaderPadding",-1),(0,r.A)(this,"metadata",void 0),(0,r.A)(this,"streams",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"chapters",void 0),(0,r.A)(this,"privateData",void 0),(0,r.A)(this,"privateData2",void 0),(0,r.A)(this,"iformat",void 0),(0,r.A)(this,"oformat",void 0),(0,r.A)(this,"ioReader",void 0),(0,r.A)(this,"ioWriter",void 0),(0,r.A)(this,"errorFlag",void 0),(0,r.A)(this,"interval",void 0),(0,r.A)(this,"streamIndex",void 0),(0,r.A)(this,"getDecoderResource",null),this.streams=[],this.errorFlag=0,this.streamIndex=0,this.interval=new u,this.options={},this.privateData={},this.metadata={},this.chapters=[]}get format(){return this.iformat?this.iformat.type:this.oformat?this.oformat.type:-1}getStreamById(e){return this.streams.find((t=>t.id===e))}getStreamByIndex(e){return this.streams.find((t=>t.index===e))}getStreamByMediaType(e){return this.streams.find((t=>{var i;return(null===(i=t.codecpar)||void 0===i?void 0:i.codecType)===e}))}createStream(){const e=new n.A;return e.index=this.streamIndex++,(0,l.s2)(h),e.id=s.f[15](d),a.M[15](d,e.id+1),(0,l.Tl)(h),this.removeStreamByIndex(e.index),this.streams.push(e),e}addStream(e){this.removeStreamByIndex(e.index),this.streams.push(e)}removeStream(e){this.removeStreamByIndex(e.index)}removeStreamById(e){const t=this.streams.findIndex((t=>t.id===e));if(t>-1){const e=this.streams.splice(t,1);e[0]&&e[0].destroy()}}removeStreamByIndex(e){const t=this.streams.findIndex((t=>t.index===e));if(t>-1){const e=this.streams.splice(t,1);e[0]&&e[0].destroy()}}async destroy(){this.oformat&&this.oformat.destroy(this),this.iformat&&await this.iformat.destroy(this),this.interval.packetBuffer.length&&this.interval.packetBuffer.forEach((e=>{(0,o.Qe)(e)})),this.streams.forEach((e=>{e.destroy()})),this.streams=[],this.interval=null,this.ioReader=this.ioWriter=null,this.oformat=this.iformat=null}}function p(){return new f}function m(){return new f}},64436:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(134),s=i(63939),a=(i(77162),i(37837)),n=i(71766);class o{constructor(){(0,r.A)(this,"inCodecpar",void 0),(0,r.A)(this,"inTimeBase",void 0),(0,r.A)(this,"outCodecpar",void 0)}init(e,t){return this.inCodecpar=(0,a.Gy)(168),(0,n.Yi)(this.inCodecpar,e),this.inTimeBase={den:s.f[15](t+4),num:s.f[15](t)},0}destroy(){this.inCodecpar&&((0,n.dn)(this.inCodecpar),this.inCodecpar=0)}}},26173:(e,t,i)=>{"use strict";i.d(t,{A:()=>m});var r=i(134),s=i(63939),a=i(50932),n=i(64436),o=i(71517),c=i(62815),l=i(67659),d=i(59166),h=i(14686),u=i(9705),f=i(37837),p=i(4624);class m extends n.A{constructor(e=!1){super(),(0,r.A)(this,"cache",void 0),(0,r.A)(this,"cached",void 0),(0,r.A)(this,"reverseSps",void 0),this.reverseSps=e}init(e,t){return super.init(e,t),this.cache=(0,o._5)(),this.cached=!1,0}destroy(){super.destroy(),(0,o.Qe)(this.cache),this.cache=0}sendAVPacket(e){const t=(0,h.JW)(s.f[20](e+24),s.f[15](e+28));if(64&s.f[15](e+36)){let i;if((0,o.zu)(this.cache,e),27===s.f[15](this.inCodecpar+4)?i=c.oT(t,this.reverseSps):173===s.f[15](this.inCodecpar+4)?i=l.oT(t,this.reverseSps):196===s.f[15](this.inCodecpar+4)?i=d.oT(t,this.reverseSps):p.h2(`not support for codecId: ${s.f[15](this.inCodecpar+4)}`,"src/avformat/bsf/h2645/Annexb2AvccFilter.ts",96),a.M[15](this.cache+36,-65&s.f[15](this.cache+36)),(0,o.NX)(this.cache,i.bufferPointer,i.length),i.key&&a.M[15](this.cache+36,1|s.f[15](this.cache+36)),i.extradata){const e=(0,f.sY)(i.extradata.length);(0,h.lW)(e,i.extradata.length,i.extradata),(0,o.Ow)(this.cache,1,e,i.extradata.length)}}else(0,o.rN)(this.cache,e);return this.cached=!0,0}receiveAVPacket(e){return this.cached?((0,o.Up)(e),(0,o.rN)(e,this.cache),this.cached=!1,0):u.LR}reset(){return 0}}},16160:(e,t,i)=>{"use strict";i.d(t,{V:()=>s,v:()=>r});const r=256e3,s=BigInt(5e3)},75:(e,t,i)=>{"use strict";i.d(t,{Cj:()=>E,Ib:()=>M,ho:()=>_,jF:()=>D});var r=i(61499),s=i(63939),a=i(50932),n=i(36981),o=i(29170),c=i(9599),l=i(95335),d=i(72739),h=i(77231),u=i(31425),f=i(44328),p=i(71517),m=i(16160),g=i(9705),v=i(4624),y=i(40417),A=i(75742),b=i(56024),w=i(14686),x=i(31633),k=i(55680),T=i(89478);const I="src/avformat/demux.ts",S=16,P={fastOpen:!1,maxAnalyzeDuration:15e3};async function _(e,t={}){const i=l.X$({},P,t);return e.ioReader||v.h2("need IOReader",I,86),e.iformat||v.h2("need iformat",I,89),2===e.iformat.type&&(i.maxAnalyzeDuration=Math.max(i.maxAnalyzeDuration,2e3)),e.iformat.init(e),e.options=i,e.iformat.readHeader(e)}async function M(e){const t={},i={},g={},v={},w={},I={},P={},_=e.iformat.getAnalyzeStreamsCount();let M=0;const C=[];let B=0;function D(){if(!e.getDecoderResource)return!0;for(let t=0;t<e.streams.length;t++)if(I[e.streams[t].index]&&!P[e.streams[t].index])return!1;return!0}function R(e,t){let r=i[e.index];const n=g[e.index];let o=e.codecpar.videoDelay;if(null!=n&&n.length&&(o=Math.min(Math.max((0,k.A)(n),e.codecpar.videoDelay),16),t&&(e.codecpar.videoDelay=o)),!r&&null!=n&&n.length){r=o?(0,T.A)(o,n):n.slice();const t={delay:o,dtsQueue:r};r=[],w[e.index]=t;for(let i=0;i<C.length;i++)if(e.index===s.f[15](C[i]+32)){const n=t.dtsQueue.shift();a.M[17](C[i]+16,n),r.push(n);const o=e.sampleIndexes.find((e=>e.pts===s.f[17](C[i]+8)));o&&(o.dts=s.f[17](C[i]+16))}}if(r&&r.length>1){let t=BigInt(0);for(let e=1;e<r.length;e++)t+=r[e]-r[e-1];if(1===e.codecpar.codecType&&e.codecpar.sampleRate>0&&!e.codecpar.frameSize){let i=Number(t)/(r.length-1);e.codecpar.frameSize=Math.round(i/e.timeBase.den*e.timeBase.num*e.codecpar.sampleRate)}else if(0===e.codecpar.codecType){const i=(0,f.j2)(e.timeBase.den*(r.length-1)/(Number(t)*e.timeBase.num),h.go);e.codecpar.framerate.num=i.num,e.codecpar.framerate.den=i.den,(0,x.A)(e.codecpar.framerate)}const i=Number(r[r.length-1]-e.startTime)*e.timeBase.num/e.timeBase.den;i&&(e.codecpar.bitrate=BigInt(Math.floor(8*v[e.index]/i)))}}function U(){e.streams.forEach((e=>{R(e,!0),1===e.codecpar.codecType&&(1===e.codecpar.chLayout.nbChannels?(e.codecpar.chLayout.u.mask=BigInt(4),e.codecpar.chLayout.order=1):2===e.codecpar.chLayout.nbChannels&&(e.codecpar.chLayout.u.mask=BigInt(3),e.codecpar.chLayout.order=1))}))}for(;;){if(e.streams.length>=_&&e.options.fastOpen&&(0,u.$)(e)){U();break}M||(M=(0,p._5)());let a=!1;if(B=await E(e,M),0!==B){U();break}const l=e.getStreamByIndex(s.f[15](M+32));let d=s.f[17](M+8);if(d===h.Dh&&(d=s.f[17](M+16)),s.f[15](M+28)&&(a=!0,C.push(M),t[l.index]?d<l.startTime&&(l.startTime=d):(l.firstDTS=s.f[17](M+16),l.startTime=d,t[l.index]=!0),s.f[17](M+16)!==h.Dh&&(i[l.index]?i[l.index].push(s.f[17](M+16)):i[l.index]=[s.f[17](M+16)]),g[l.index]?g[l.index].push(d):g[l.index]=[d],v[l.index]?v[l.index]+=s.f[15](M+28):v[l.index]=s.f[15](M+28),!P[l.index]&&e.getDecoderResource&&!e.options.fastOpen&&!l.metadata.encryption)){let t=I[l.index];if(!t){const i=await e.getDecoderResource(l.codecpar.codecType,l.codecpar.codecId);i&&(1===l.codecpar.codecType?t=new A.A({resource:i,onReceiveAVFrame:e=>{l.codecpar.format=s.f[15](e+80),l.codecpar.frameSize=s.f[15](e+76),l.codecpar.sampleRate=s.f[15](e+152),l.codecpar.chLayout=(0,o.A)(e+288,n.r),(0,b.xj)(e),P[l.index]=!0}}):0===l.codecpar.codecType&&(i.threadModule&&delete i.threadModule,t=new y.A({resource:i,onReceiveAVFrame:e=>{l.codecpar.format=s.f[15](e+80),l.codecpar.colorRange=s.f[15](e+208),l.codecpar.colorSpace=s.f[15](e+220),l.codecpar.colorPrimaries=s.f[15](e+212),l.codecpar.colorTrc=s.f[15](e+216),l.codecpar.chromaLocation=s.f[15](e+224),l.codecpar.sampleAspectRatio=(0,o.A)(e+92,c.P),l.codecpar.width=s.f[15](e+68),l.codecpar.height=s.f[15](e+72),(0,b.xj)(e),P[l.index]=!0}})),await t.open(l.codecpar[r.o9])?(t.close(),P[l.index]=!0):I[l.index]=t)}t&&t.decode(M)&&(P[l.index]=!0)}if(g[l.index]&&g[l.index].length===S&&R(l,!1),l.startTime!==h.Dh&&d-l.startTime>(0,f.k)(BigInt(Math.floor(e.options.maxAnalyzeDuration)),h.i0,l.timeBase)&&(e.streams.length>=_&&(0,u.$)(e)||d-l.startTime>(0,f.k)(BigInt(15e3),h.i0,l.timeBase)&&(!g[l.index]||g[l.index].length>450))&&D()){U(),a&&(M=0);break}a&&(M=0)}return M&&(0,p.Qe)(M),C.length&&(e.interval.packetBuffer=C.concat(e.interval.packetBuffer)),l.__(I,(e=>{e&&e.close()})),l.__(w,((t,i)=>{const r=e.getStreamByIndex(+i);r.privateData2?l.X$(r.privateData2,t):r.privateData2=t})),-1048576===B||-1048572===B?0:0!==B?B:(2===e.iformat.type&&1&e.ioReader.flags&&!(2&e.ioReader.flags)&&await async function(e){const t=await e.ioReader.fileSize();if(t<=BigInt(0))return;const i=e.interval.packetBuffer;e.interval.packetBuffer=[];let r=e.ioReader.getPos(),a=0;for(;a<4;){const i=t-BigInt(Math.floor(m.v<<a)),n=await e.iformat.seek(e,null,i,2);if(n<0)break;!a&&n>0&&(r=n);const o={},c=(0,p._5)();for(;!(await E(e,c)<0);){let t=s.f[17](c+8);t===h.Dh&&(t=s.f[17](c+16));const i=e.getStreamByIndex(s.f[15](c+32));i.startTime!==h.Dh?t-=i.startTime:t-=i.firstDTS,t>BigInt(0)&&((i.duration===h.Dh||!o[s.f[15](c+32)]||i.duration<t&&Math.abs(Number(t-i.duration))<60*i.timeBase.den/i.timeBase.num)&&(i.duration=t),o[c.streamIndex]=t)}(0,p.Qe)(c);let l=!0;if(d.__(e.streams,(e=>{if(e.duration===h.Dh)return l=!1,!1})),l)break;a++}d.__(e.interval.packetBuffer,(e=>{(0,p.Qe)(e)})),e.interval.packetBuffer=i.filter((e=>!(s.f[17](e+56)>=r&&((0,p.Qe)(e),1)))),await e.iformat.seek(e,null,r,2)}(e),0)}function C(e,t){let i=s.f[17](t+8);i===h.Dh&&(i=s.f[17](t+16));const r=d.El(e.sampleIndexes,(e=>e.pts<i?1:-1)),a={dts:s.f[17](t+16),pts:i,pos:s.f[17](t+56),size:s.f[15](t+28),duration:s.f[17](t+48),flags:s.f[15](t+36)};r>-1?(e.sampleIndexesPosMap.set(s.f[17](t+56),r),e.sampleIndexes.splice(r,0,a)):(e.sampleIndexesPosMap.set(s.f[17](t+56),e.sampleIndexes.length),e.sampleIndexes.push(a))}async function B(e,t){const i=e.getStreamByIndex(s.f[15](t+32));if(s.f[17](t+16)===h.Dh){const e=i.privateData2;e&&(e.delay?(d._(e.dtsQueue,s.f[17](t+8),(e=>e<s.f[17](t+8)?1:-1)),e.dtsQueue.length>e.delay&&a.M[17](t+16,e.dtsQueue.shift())):a.M[17](t+16,s.f[17](t+8)))}let r=0;if(i&&(27===i.codecpar.codecId||173===i.codecpar.codecId||196===i.codecpar.codecId||86018===i.codecpar.codecId))if(!s.f[15](t+28)&&(0,p.fQ)(t,1))for(;;){const i=(0,p._5)();if(r=await e.iformat.readAVPacket(e,i),0!==r){if(e.interval.packetBuffer.length){let i=e.interval.packetBuffer.shift();return(0,p.Up)(t),(0,p.rN)(t,i),(0,p.Qe)(i),B(e,t)}return r}if(s.f[15](i+32)!==s.f[15](t+32)){let t=e.interval.packetBuffer.length-1,r=!0;for(;t>=0;t--)if(s.f[15](e.interval.packetBuffer[t]+32)===s.f[15](i+32)){s.f[15](e.interval.packetBuffer[t]+28)||s.f[15](i+28)?!s.f[15](e.interval.packetBuffer[t]+28)&&s.f[15](i+28)&&((0,p.Zx)(e.interval.packetBuffer[t],i),(0,p.Qe)(i),r=!1):((0,p.Qe)(e.interval.packetBuffer[t]),e.interval.packetBuffer.splice(t,1,i),r=!1);break}r&&e.interval.packetBuffer.push(i)}else{if(s.f[15](i+28))return(0,p.Zx)(t,i),a.M[17](t+16,s.f[17](i+16)),a.M[17](t+8,s.f[17](i+8)),(0,p.Qe)(i),0;(0,p.Up)(t),(0,p.rN)(t,i),(0,p.Qe)(i)}}else if(32&s.f[15](t+36))return E(e,t);if(1&e.ioReader.flags&&!i.sampleIndexesPosMap.has(s.f[17](t+56)))if(0===i.codecpar.codecType)1&s.f[15](t+36)&&C(i,t);else if(1===i.codecpar.codecType){const e=d.El(i.sampleIndexes,(e=>e.pts<s.f[17](t+8)?1:-1));(!i.sampleIndexes.length||e<0&&(0,f.Mr)(s.f[17](t+8)-i.sampleIndexes[i.sampleIndexes.length-1].pts,t+72,h.i0)>=m.V||e>0&&e<i.sampleIndexes.length-1&&(0,f.Mr)(s.f[17](t+8)-i.sampleIndexes[e-1].pts,t+72,h.i0)>=m.V||0===e&&(0,f.Mr)(i.sampleIndexes[0].pts-s.f[17](t+8),t+72,h.i0)>=m.V)&&C(i,t)}return 0}async function E(e,t){let i=0;if((0,p.Up)(t),e.interval.packetBuffer.length){const i=e.interval.packetBuffer.shift();return(0,p.rN)(t,i),(0,p.Qe)(i),B(e,t)}return i=await e.iformat.readAVPacket(e,t),0!==i?((0,p.Up)(t),i):B(e,t)}async function D(e,t,i,r){let n=t>-1?e.streams.find((e=>e.index===t)):null;if(n||(n=e.getStreamByMediaType(0),n||(n=e.getStreamByMediaType(1)),n||(n=e.getStreamByMediaType(3))),!n)return v.z3(`not found any stream to seek, streamIndex: ${n.index}`,I,732),BigInt(g.LR);v.Yz(`seek in ${0===n.codecpar.codecType?"video":"audio"} stream, streamIndex: ${n.index}, timestamp: ${i}, flags: ${r}`,I,736),i=(0,f.k)(i,h.i0,n.timeBase);const o=await e.iformat.seek(e,n,i,r);if(o>=BigInt(0)){d.__(e.interval.packetBuffer,(t=>{if(2&e.ioReader.flags){const i=(0,p.rU)(t,1),r=e.streams[s.f[15](t+32)];!r.sideData[1]&&i&&(r.sideData[1]=(0,w.s3)(s.f[20](i),s.f[25](i+4)).slice())}(0,p.Qe)(t)})),e.interval.packetBuffer.length=0;const t={};e.streams.forEach((e=>{const i=e.privateData2;null!=i&&i.dtsQueue&&(i.dtsQueue.length=0,i.delay&&(t[e.index]=i.delay,i.delay=S))}));const i=[];for(;e.streams.some((e=>{const t=e.privateData2;return t&&t.dtsQueue&&t.dtsQueue.length<t.delay}));){const t=(0,p._5)();if(await E(e,t)){(0,p.Qe)(t);break}i.push(t)}return e.streams.forEach((e=>{const r=e.privateData2;if(null!=r&&r.delay){r.delay=t[e.index],r.dtsQueue=(0,T.A)(r.delay,r.dtsQueue);for(let t=0;t<i.length;t++)if(e.index===s.f[15](i[t]+32)){a.M[17](i[t]+16,r.dtsQueue.shift());const n=e.sampleIndexes.find((e=>e.pts===s.f[17](i[t]+8)));n&&(n.dts=s.f[17](i[t]+16))}}})),e.interval.packetBuffer=i.concat(e.interval.packetBuffer),BigInt(0)}return o}},548:(e,t,i)=>{"use strict";i.d(t,{Ay:()=>B,L_:()=>M,eG:()=>_,yl:()=>P});var r=i(69736),s=i.n(r),a=i(61499),n=i(63939),o=i(36981),c=i(29170),l=i(9599),d=i(44315),h=i(95335),u=i(62751),f=i(67672),p=i(44328),m=i(77231),g=i(20525),v=i(62100),y=i(95832),A=i(62815),b=i(67659),w=i(21477),x=i(82014),k=i(64093),T=i(24310);function I(e){e<0&&(e=BigInt(0));const t=Number(BigInt.asIntN(32,e%BigInt(1e3))),i=Number(BigInt.asIntN(32,e/BigInt(1e3)%BigInt(60))),r=Number(BigInt.asIntN(32,e/BigInt(1e3)/BigInt(60)%BigInt(60))),s=Number(BigInt.asIntN(32,e/BigInt(1e3)/BigInt(3600)));return g.GP("%02d:%02d:%02d.%03d",s,r,i,t)}function S(e){return e<BigInt(1e4)?(0,v.A)(Number(BigInt.asIntN(32,e)))+" bps/s":Number(BigInt.asIntN(32,e/BigInt(1e3)))+" kbps/s"}function P(e,t,i="unknown"){let r=i;return h.__(e,((e,i)=>{if(t===e)return r=i,!1})),r}function _(e,t){return 1===e?P(u.n1,t):0===e?P(u._R,t):3===e?P(u.Xp,t):"unknown"}function M(e){return P(u.iW,e)}function C(e,t){switch(e){case 86018:return y.uF[t]||"LC";case 86017:return k.He[t]||"Layer3";case 27:return A.tZ[t]||"High";case 173:return b.dT[t]||"Main";case 225:return w.zk[t]||"Main";case 167:return x.wN[t]||"Profile0"}}function B(e,t){let i="";return e.forEach(((e,r)=>{if(e instanceof d.oD){const t=[];for(let i=0;i<e.streams.length;i++){const r=e.streams[i];t.push({index:r.index,id:r.id,codecpar:r.codecpar[a.o9],nbFrames:r.nbFrames,metadata:r.metadata,duration:r.duration,startTime:r.startTime,disposition:r.disposition,timeBase:r.timeBase})}e={metadata:e.metadata,format:e.format,chapters:e.chapters,streams:t}}i+=function(e,t,i){let r=`${i.tag} #${t}, ${i.isLive?"live":"vod"}, ${P(u.iW,e.format)}, from '${i.from}':\n`;s()(e.metadata).length&&(r+="  Metadata:\n",h.__(e.metadata,((e,t)=>{f.Ik(e)&&f.YO(e)||(r+=`    ${t}: ${e}\n`)})));let a=BigInt(0),d=BigInt(0),g=-BigInt(1);return e.streams.forEach((e=>{const t=(0,p.k)(e.duration,e.timeBase,m.i0),i=(0,p.k)(e.startTime,e.timeBase,m.i0);t>a&&(a=t),(i<g||g===-BigInt(1))&&(g=i),d+=n.f[17](e.codecpar+32)})),r+=`  Duration: ${I(a)}, start: ${I(g)}, bitrate: ${S(d)}\n`,e.streams.forEach(((e,i)=>{r+=function(e,t,i){const r=P(u.Mb,n.f[15](e.codecpar)),a=[];if(1===n.f[15](e.codecpar)){const t=C(n.f[15](e.codecpar+4),n.f[15](e.codecpar+48)),i=P(u.n1,n.f[15](e.codecpar+4));a.push(`${i}${t?` (${t})`:""}`),a.push(`${n.f[15](e.codecpar+136)} Hz`);let r=`${n.f[15](e.codecpar+116)} channels`;if(1===n.f[15](e.codecpar+112)){const t=P(u.IY,Number((0,c.A)(e.codecpar+120,o.r,"u").mask),"");t&&(r=t)}a.push(r),a.push(P(u.Sz,n.f[15](e.codecpar+28))),n.f[17](e.codecpar+32)>BigInt(0)&&a.push(`${S(n.f[17](e.codecpar+32))}`)}else if(0===n.f[15](e.codecpar)){const t=C(n.f[15](e.codecpar+4),n.f[15](e.codecpar+48)),i=P(u._R,n.f[15](e.codecpar+4));if(a.push(`${i}${t?` (${t})`:""}`),n.f[15](e.codecpar+28)!==m.N_){const t=P(u.qO,n.f[15](e.codecpar+28),`unknown(${n.f[15](e.codecpar+28)})`),i=P(u.mX,n.f[15](e.codecpar+84),"tv"),r=P(u._m,n.f[15](e.codecpar+96),"bt709"),s=P(u.Eh,n.f[15](e.codecpar+88),"bt709"),o=P(u.d8,n.f[15](e.codecpar+92),"bt709"),c=(0,T.A)(e.codecpar);r===s&&s===o?a.push(`${t}(${i}, ${r}, ${c?"HDR":"SDR"})`):a.push(`${t}(${i}, ${r}/${s}/${o}, ${c?"HDR":"SDR"})`)}const r={num:n.f[15](e.codecpar+56)*n.f[15](e.codecpar+64),den:n.f[15](e.codecpar+60)*n.f[15](e.codecpar+68)};(0,p.iU)(r),a.push(`${n.f[15](e.codecpar+56)}x${n.f[15](e.codecpar+60)} [SAR: ${n.f[15](e.codecpar+64)}:${n.f[15](e.codecpar+68)} DAR ${r.num}:${r.den}]`),n.f[17](e.codecpar+32)>BigInt(0)&&a.push(`${S(n.f[17](e.codecpar+32))}`),(0,p.lb)((0,c.A)(e.codecpar+72,l.P))>0&&(a.push(`${(0,p.lb)((0,c.A)(e.codecpar+72,l.P)).toFixed(2)} fps`),a.push(`${(0,p.lb)((0,c.A)(e.codecpar+72,l.P)).toFixed(2)} tbr`)),a.push(`${d=BigInt(Math.floor((0,p.lb)({num:e.timeBase.den,den:e.timeBase.num}))),d<BigInt(1e4)?(0,v.A)(Number(BigInt.asIntN(32,d))):Number(BigInt.asIntN(32,d/BigInt(1e3)))+"k"} tbn`)}else if(3===n.f[15](e.codecpar)){const t=P(u.Xp,n.f[15](e.codecpar+4));a.push(t),n.f[17](e.codecpar+32)>BigInt(0)&&a.push(`${S(n.f[17](e.codecpar+32))}`)}else n.f[17](e.codecpar+32)>BigInt(0)&&a.push(`${S(n.f[17](e.codecpar+32))}`);var d;let g="";e.disposition&&(g=" ",1&e.disposition&&(g+=`(${P(u.Ki,1)}) `),2&e.disposition&&(g+=`(${P(u.Ki,2)}) `),4&e.disposition&&(g+=`(${P(u.Ki,4)}) `),8&e.disposition&&(g+=`(${P(u.Ki,8)}) `),16&e.disposition&&(g+=`(${P(u.Ki,16)}) `),32&e.disposition&&(g+=`(${P(u.Ki,32)}) `),64&e.disposition&&(g+=`(${P(u.Ki,64)}) `),128&e.disposition&&(g+=`(${P(u.Ki,128)}) `),256&e.disposition&&(g+=`(${P(u.Ki,256)}) `),512&e.disposition&&(g+=`(${P(u.Ki,512)}) `),1024&e.disposition&&(g+=`(${P(u.Ki,1024)}) `),2048&e.disposition&&(g+=`(${P(u.Ki,2048)}) `),65536&e.disposition&&(g+=`(${P(u.Ki,65536)}) `),131072&e.disposition&&(g+=`(${P(u.Ki,131072)}) `),262144&e.disposition&&(g+=`(${P(u.Ki,262144)}) `),524288&e.disposition&&(g+=`(${P(u.Ki,524288)}) `),1048576&e.disposition&&(g+=`(${P(u.Ki,1048576)}) `));let y=`${i}Stream #${t}:${e.index} ${r}: ${a.join(", ")}${g}\n`;return s()(e.metadata).length&&(y+=`${i}  Metadata:\n`,h.__(e.metadata,((t,r)=>{f.Ik(t)||f.YO(t)?"matrix"===r&&0===n.f[15](e.codecpar)&&(y+=`${i}    ${r}: [${t.toString()}]\n`):y+=`${i}    ${r}: ${t}\n`}))),y}(e,t,"  ")})),r}(e,r,t[r])})),i}},51597:(e,t,i)=>{"use strict";i.d(t,{A:()=>s,E:()=>a});var r=i(134);class s{constructor(){(0,r.A)(this,"type",-1)}async destroy(e){}}const a={15:[86018],10:[86017,86019,86018,12,27],17:[86028],0:[86017,86018,86051,69645,86049,65543,65542,86019,86056,86076,86028,12,27,173,225,167,139,196],5:[139,167],8:[86021,86076,86018,86017,86028,86032,86020,86056,86019,65557,65537,65536,139,167,225,27,173,196,12,30,94226,94212,94230,94210,94225],9:[86021,86076,139,167,225,94226],1:[86021,86076,86018,86017,86028,86051,86019,86056,167,225,27,173,196,12,94226,94213],14:[86017],2:[86076,86018,86017,86019,,86020,86065,86056,12,225,27,173,196],3:[86058,86016,86017,86019,,86020,2,12,27,173,196],4:[86021,86076,86028,86051],16:[],18:[94226],20:[94230,94212],19:[94225],21:[94232],11:[27],12:[173],13:[196],6:[86076,86018,86017,65543,65542,2,12,27,173,139,167,225],7:[86017,86018,86051,69645,86049,65543,65542,12,27,173,225,167,196]}},69765:(e,t,i)=>{"use strict";i.d(t,{A:()=>R});var r=i(134),s=i(61499),a=i(63939),n=i(9599),o=i(29170),c=i(51597),l=i(9690),d=i(65977),h=i(75473),u=i(38106),f=i(3384),p=i(35336),m=i(72739),g=i(4624),v=i(92647),y=i(79804),A=i(77231),b=i(95335),w=i(20841),x=i(59989),k=i(44328),T=i(71517),I=i(26173),S=i(67672),P=i(43607),_=i(87518),M=i(14686),C=i(14041),B=i(50315);const E="src/avformat/formats/OMovFormat.ts",D={fragmentMode:0,movMode:0,fragment:!1,fastOpen:!1,defaultBaseIsMoof:!1,reverseSpsInAvcc:!1,ignoreEncryption:!1};class R extends c.A{constructor(e={}){super(),(0,r.A)(this,"type",1),(0,r.A)(this,"context",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"annexb2AvccFilter",void 0),(0,r.A)(this,"avpacket",void 0),this.options=b.X$({},D,e),this.context=(0,l.A)()}init(e){e.ioWriter.setEndian(!0);const t=e.getStreamByMediaType(0);return!t||27!==t.codecpar.codecId&&173!==t.codecpar.codecId&&196!==t.codecpar.codecId||(this.annexb2AvccFilter=new I.A(this.options.reverseSpsInAvcc),this.annexb2AvccFilter.init(t.codecpar[s.o9],t.timeBase[s.o9])),this.avpacket=(0,T._5)(),0}async destroy(e){this.annexb2AvccFilter&&(this.annexb2AvccFilter.destroy(),this.annexb2AvccFilter=null),this.avpacket&&((0,T.Qe)(this.avpacket),this.avpacket=0)}enableStreams(e){const t=[],i=[];for(let e=0;e<5;e++)t[e]=0,i[e]=-1;m.__(e.streams,((e,r)=>{if(-1===e.codecpar.codecType||e.codecpar.codecType>=5)return!0;i[e.codecpar.codecType]<0&&(i[e.codecpar.codecType]=r),1&e.disposition&&(t[e.codecpar.codecType]++,e.privData.flags|=1)}));for(let r=0;r<5;r++)switch(r){case 0:case 1:case 3:t[r]>1&&(e.streams[t[r]].privData.perStreamGrouping=!0),!t[r]&&i[r]>=0&&(e.streams[i[r]].privData.flags|=1)}}writeHeader(e){if(this.context.majorBrand=(0,d.A)("isom"),this.context.minorVersion=512,this.context.compatibleBrand=[(0,d.A)("isom")],this.context.timescale=1e3,this.context.ignoreEncryption=this.options.ignoreEncryption,this.options.fragment&&(this.context.compatibleBrand.push((0,d.A)("iso6")),this.context.fragment=!0),1===this.options.movMode&&(this.context.isom=!0,this.context.majorBrand=(0,d.A)("qt  "),this.context.compatibleBrand=[this.context.majorBrand]),1!==this.options.movMode){this.context.compatibleBrand.push((0,d.A)("iso2"));const t=e.getStreamByMediaType(0);t&&27===t.codecpar.codecId&&this.context.compatibleBrand.push((0,d.A)("avc1")),this.context.compatibleBrand.push((0,d.A)("mp41"))}if(h.l7(e.ioWriter,this.context),this.context.holdMoovPos=e.ioWriter.getPos(),this.options.fragment)this.context.currentFragment={pos:BigInt(0),currentTrack:null,sequence:1,tracks:[],size:0,firstWrote:!1},m.__(e.streams,((e,t)=>{const i=(0,u.A)();e.privData=i,i.chunkOffsets=[],i.cttsSampleCounts=[],i.cttsSampleOffsets=[],i.stscFirstChunk=[],i.stscSamplesPerChunk=[],i.stscSampleDescriptionIndex=[],i.stssSampleNumbers=[],i.sampleSizes=[],i.sttsSampleCounts=[],i.sttsSampleDeltas=[],i.alternateGroup=t;const r=(0,f.A)();r.baseIsMoof=this.options.defaultBaseIsMoof,r.streamIndex=e.index,r.trackId=this.context.nextTrackId++,i.trackId=r.trackId;const s=this.options.encryption||e.metadata.encryption;if(s){const e=this.context.cencs||{};e[r.trackId]={schemeType:s.schemeType,schemeVersion:s.schemeVersion,cryptByteBlock:s.cryptByteBlock,skipByteBlock:s.skipByteBlock,defaultConstantIV:s.constantIV,isProtected:1,defaultPerSampleIVSize:s.perSampleIVSize,defaultKeyId:s.kid,pattern:!!s.pattern},this.context.cencs=e}r.ioWriter=new p.A,r.ioWriter.onFlush=e=>(r.buffers.push(e.slice()),0),this.context.currentFragment.tracks.push(r)})),this.enableStreams(e),h.dI(e.ioWriter,e,this.context),e.ioWriter.flush();else{m.__(e.streams,((e,t)=>{const i=(0,u.A)();e.privData=i,i.trackId=this.context.nextTrackId++,i.chunkOffsets=[],i.cttsSampleCounts=[],i.cttsSampleOffsets=[],i.stscFirstChunk=[],i.stscSamplesPerChunk=[],i.stscSampleDescriptionIndex=[],i.stssSampleNumbers=[],i.sampleSizes=[],i.sttsSampleCounts=[],i.sttsSampleDeltas=[],i.alternateGroup=t})),this.enableStreams(e);const t=e.ioWriter.getPos();e.ioWriter.writeUint32(0),e.ioWriter.writeUint32((0,d.A)("mdat")),this.context.boxsPositionInfo.push({pos:t,type:"mdat",size:0})}return 0}updateCurrentChunk(e){let t=this.context.currentChunk;if(!t||!t.sampleCount)return;const i=e.streams.find((e=>e.index===t.streamIndex)).privData;i.chunkCount++,i.chunkOffsets.push(t.pos),i.stscFirstChunk.length?i.lastStscCount!==t.sampleCount&&(i.stscFirstChunk.push(i.chunkCount),i.stscSamplesPerChunk.push(t.sampleCount),i.stscSampleDescriptionIndex.push(1),i.lastStscCount=t.sampleCount):(i.stscFirstChunk.push(i.chunkCount),i.stscSamplesPerChunk.push(t.sampleCount),i.stscSampleDescriptionIndex.push(1),i.lastStscCount=t.sampleCount)}updateCurrentFragment(e,t){if(this.context.currentFragment.firstWrote){m.__(this.context.currentFragment.tracks,(i=>{const r=e.streams.find((e=>e.index===i.streamIndex));if(!i.sampleCount||!r)return!0;const s=r.privData;var a;i.baseDataOffset=e.ioWriter.getPos(),this.context.currentFragment.pos=e.ioWriter.getPos(),i.sampleDurations.length?t&&i.sampleDurations.length===i.sampleSizes.length-1&&i.sampleDurations.push(Number(t-s.lastDts)):1===r.codecpar.codecType?t?i.sampleDurations.push(Number(t-s.lastDts)):r.codecpar.frameSize>0?i.sampleDurations.push(Number((0,k.k)(BigInt(r.codecpar.frameSize/r.codecpar.sampleRate*A.SF),A.KR,r.timeBase))):(r.codecpar.codecId,i.sampleDurations.push(Number((0,k.k)(BigInt(1024/r.codecpar.sampleRate*A.SF),A.KR,r.timeBase)))):0===r.codecpar.codecType?t?i.sampleDurations.push(Number(t-s.lastDts)):(0,k.lb)(r.codecpar.framerate)>0?i.sampleDurations.push(Number((0,k.k)(BigInt(Math.floor(1/(0,k.lb)(r.codecpar.framerate)*A.SF)),A.KR,r.timeBase))):i.sampleDurations.push(r.timeBase.den/(30*r.timeBase.num)>>>0):i.sampleDurations.push(0),s.lastDuration=i.sampleDurations[i.sampleSizes.length-1],(1===i.sampleFlags.length||(0,x.A)(i.sampleFlags,1))&&(i.firstSampleFlags=i.sampleFlags[0],i.defaultSampleFlags=null!==(a=i.sampleFlags[1])&&void 0!==a?a:i.firstSampleFlags,i.sampleFlags=[]),(1===i.sampleSizes.length||(0,x.A)(i.sampleSizes))&&(i.defaultSampleSize=i.sampleSizes[0],i.sampleSizes=[]),(1===i.sampleDurations.length||(0,x.A)(i.sampleDurations))&&(i.defaultSampleDuration=i.sampleDurations[0],i.sampleDurations=[]),i.cenc&&(1===i.cenc.sampleSizes.length||(0,x.A)(i.cenc.sampleSizes))&&(i.cenc.defaultSampleInfoSize=i.cenc.sampleSizes[0],i.cenc.sampleSizes=[]),1===r.codecpar.codecType?i.defaultSampleFlags=33554432:i.sampleFlags.length&&(i.defaultSampleFlags=i.sampleFlags[0]),i.sampleSizes.length&&(i.defaultSampleSize=i.sampleSizes[0]),i.sampleDurations.length&&(i.defaultSampleDuration=i.sampleDurations[0])})),e.ioWriter.flush(),h.Ro(e.ioWriter,e,this.context);let i=this.context.currentFragment.size+8;const r=[];let s=8;m.__(this.context.currentFragment.tracks,(t=>{if(!t.sampleCount)return!0;t.ioWriter.flush();const a=(0,v.A)(Uint8Array,t.buffers);t.dataOffset=i,i+=a.length,s+=a.length,r.push(a),(0,w.A)(e.ioWriter,t.dataOffsetPos,t.dataOffset,"int32"),t.cenc&&t.cenc.offsetPos&&(0,w.A)(e.ioWriter,t.cenc.offsetPos,t.cenc.offset,"int32"),t.buffers=[],t.sampleFlags=[],t.sampleSizes=[],t.sampleDurations=[],t.sampleCompositionTimeOffset=[],t.sampleCount=0,t.firstSampleFlags=0,t.cenc=null})),e.ioWriter.writeUint32(s),e.ioWriter.writeUint32((0,d.A)("mdat")),m.__(r,(t=>{e.ioWriter.writeBuffer(t)})),(0,y.A)(e.ioWriter,this.context),e.ioWriter.flush(),this.context.currentFragment.firstWrote=!1,this.context.currentFragment.sequence++}}handleEAC3(e,t){this.context.ac3Info||(this.context.ac3Info={done:!1,numBlocks:0,dataRate:0,ac3BitrateCode:-1,numIndSub:0,substream:[]});const i=this.context.ac3Info,r=_.R((0,M.s3)(a.f[20](e+24),a.f[15](e+28)));if(S.ai(r))i.done=!0;else if(i.dataRate=Math.max(i.dataRate,r.bitrate/1e3),i.ac3BitrateCode=Math.max(i.ac3BitrateCode,r.ac3BitrateCode),!i.done){if(r.bitstreamId<=10&&0!=r.substreamId)return;if(0===r.frameType||2==r.frameType){var s;if(r.substreamId>i.numIndSub+1)return;if(r.substreamId==i.numIndSub+1)return;if(r.substreamId<i.numIndSub||0==r.substreamId&&null!==(s=i.substream[0])&&void 0!==s&&s.bsid)return void(i.done=!0)}else if(0!=r.substreamId)return;if(i.substream[r.substreamId]||(i.substream[r.substreamId]={fscod:0,bsid:0,bsmod:0,acmod:0,lfeon:0,numDepSub:0,chanLoc:0}),i.substream[r.substreamId].fscod=r.srCode,i.substream[r.substreamId].bsid=r.bitstreamId,i.substream[r.substreamId].bsmod=r.bitstreamMode,i.substream[r.substreamId].acmod=r.channelMode,i.substream[r.substreamId].lfeon=r.lfeOn,86019===t.codecpar.codecId)return void(i.done=!0)}}writeAVPacket(e,t){if(!a.f[15](t+28))return g.R8(`packet's size is 0: ${a.f[15](t+32)}, ignore it`,E,581),0;const i=e.getStreamByIndex(a.f[15](t+32));if(!i)return void g.R8(`can not found the stream width the avpacket's streamIndex: ${a.f[15](t+32)}, ignore it`,E,588);const r=i.privData,s=(0,k.Mr)(a.f[17](t+16),t+72,i.timeBase),c=(0,k.Mr)(a.f[17](t+8)!==A.Dh?a.f[17](t+8):a.f[17](t+16),t+72,i.timeBase),l=a.f[17](t+48)!==A.Dh?(0,k.Mr)(a.f[17](t+48),t+72,i.timeBase):-BigInt(1);if((27===i.codecpar.codecId||173===i.codecpar.codecId||196===i.codecpar.codecId)&&64&a.f[15](t+36)?(this.annexb2AvccFilter.sendAVPacket(t),this.annexb2AvccFilter.receiveAVPacket(this.avpacket),t=this.avpacket):86019!==i.codecpar.codecId&&86056!==i.codecpar.codecId||this.context.ac3Info&&this.context.ac3Info.done||this.handleEAC3(t,i),this.context.fragment){const d=this.context.currentFragment.tracks.find((e=>e.streamIndex===a.f[15](t+32)));if(d){if((0===this.options.fragmentMode&&0===i.codecpar.codecType&&1&a.f[15](t+36)||1===this.options.fragmentMode)&&(1===this.context.currentFragment.tracks.length?this.updateCurrentFragment(e,s):this.updateCurrentFragment(e)),d.ioWriter.writeBuffer((0,T.iI)(t)),d.sampleSizes.length||(d.baseMediaDecodeTime=s),d.sampleSizes.length&&(!d.sampleDurations[d.sampleSizes.length-1]||d.sampleDurations[d.sampleSizes.length-1]<=0)&&(d.sampleDurations[d.sampleSizes.length-1]=Number(s-r.lastDts)),a.f[17](t+48)>0&&d.sampleDurations.push(Number((0,k.k)(a.f[17](t+48),(0,o.A)(t+72,n.P),i.timeBase))),d.sampleSizes.push(a.f[15](t+28)),0===i.codecpar.codecType){let e=0;1&a.f[15](t+36)?e|=33554432:e|=16842752,d.sampleCompositionTimeOffset.push(Number((c!==A.Dh?c:s)-s)),d.sampleFlags.push(e)}const h=(0,T.Un)(t+40,t+44,25),u=this.context.cencs&&this.context.cencs[r.trackId];if(h&&u){const e=(0,B.p$)((0,M.s3)(a.f[20](h),a.f[25](h+4)));d.cenc||(d.cenc={sampleCount:0,defaultSampleInfoSize:0,sampleSizes:[],offset:0,useSubsamples:!1,sampleInfoOffset:[],sampleEncryption:[]}),e.subsamples.length&&(!d.cenc.useSubsamples&&d.cenc.sampleSizes.length&&(d.cenc.sampleSizes=d.cenc.sampleSizes.map((e=>e+2))),d.cenc.useSubsamples=!0),d.cenc.sampleCount++,d.cenc.sampleSizes.push(u.defaultPerSampleIVSize+(d.cenc.useSubsamples?2+6*e.subsamples.length:0)),d.cenc.sampleEncryption.push({iv:e.iv,subsamples:e.subsamples})}d.sampleCount++,r.lastPts=P.T9(r.lastPts,c+(l!==A.Dh?l:BigInt(0))),r.lastDts=s,this.context.currentFragment.firstWrote=!0}else g.R8(`can not found track width streamIndex ${a.f[15](t+32)}, ignore it`,E,711)}else{const n=e.ioWriter.getPos();let o=this.context.currentChunk;if(o?o.streamIndex!==a.f[15](t+32)?(this.updateCurrentChunk(e),o.streamIndex=a.f[15](t+32),o.sampleCount=1,o.pos=n):o.sampleCount++:o=this.context.currentChunk={pos:n,streamIndex:a.f[15](t+32),sampleCount:1},e.ioWriter.writeBuffer((0,T.iI)(t)),r.sampleSizes.push(a.f[15](t+28)),0===i.codecpar.codecType&&1&a.f[15](t+36)&&r.stssSampleNumbers.push(r.sampleSizes.length),r.firstWrote){const e=Number(s-r.lastDts);r.sttsSampleCounts.length&&r.sttsSampleDeltas[r.sttsSampleDeltas.length-1]===e?r.sttsSampleCounts[r.sttsSampleCounts.length-1]++:(r.sttsSampleCounts.push(1),r.sttsSampleDeltas.push(e))}else r.startDts=s,r.startCT=Number((c!==A.Dh?c:s)-s),r.firstWrote=!0;if(c>=0&&(r.startPts===A.Dh?r.startPts=c:r.startPts=P.jk(r.startPts,c)),0===i.codecpar.codecType){const e=Number((c!==A.Dh?c:s)-s);r.cttsSampleCounts.length&&r.cttsSampleOffsets[r.cttsSampleOffsets.length-1]===e?r.cttsSampleCounts[r.cttsSampleCounts.length-1]++:(r.cttsSampleCounts.push(1),r.cttsSampleOffsets.push(e))}r.lastPts=P.T9(r.lastPts,c+(l!==A.Dh?l:BigInt(0))),r.lastDts=s,r.lastDuration=Number(l)}return 0}writeTrailer(e){if(this.context.fragment)m.__(this.context.currentFragment.tracks,(t=>{const i=e.streams.find((e=>e.index===t.streamIndex)).privData;t.sampleCount&&(t.sampleDurations.length?t.sampleDurations.push(t.sampleDurations[t.sampleDurations.length-1]):t.sampleDurations=[i.lastDuration])})),this.updateCurrentFragment(e),e.ioWriter.writeUint32(8),e.ioWriter.writeString("mfra"),e.ioWriter.flush();else{this.updateCurrentChunk(e);let t=BigInt(0);m.__(e.streams,(e=>{const i=e.privData;i.sampleSizes.length&&(i.sttsSampleDeltas.length?i.lastDuration>0&&i.lastDuration!==i.sttsSampleDeltas[i.sttsSampleDeltas.length-1]?(i.sttsSampleCounts.push(1),i.sttsSampleDeltas.push(i.lastDuration)):i.sttsSampleCounts[i.sttsSampleCounts.length-1]++:(i.sttsSampleCounts=[1],i.sttsSampleDeltas=[0]));const r=(0,k.k)((0,C.A)(i),e.timeBase,{den:1e3,num:1});r>t&&(t=r)})),this.context.duration=t;const i=this.context.boxsPositionInfo[this.context.boxsPositionInfo.length-1];if("mdat"!==i.type&&g.z3("last box is not mdat",E,842),i.size=Number(e.ioWriter.getPos()-i.pos),i.size>A.f7){const t=e.ioWriter.getPos();e.ioWriter.seek(i.pos-BigInt(8)),e.ioWriter.writeUint32(1),e.ioWriter.writeUint32((0,d.A)("mdat")),e.ioWriter.writeUint64(BigInt(i.size)+BigInt(8)),e.ioWriter.seek(t),this.context.boxsPositionInfo.pop(),this.context.use64Mdat=!0}if((0,y.A)(e.ioWriter,this.context),this.options.fastOpen){e.ioWriter.flush();let t=[];const i=e.ioWriter.onFlush;e.ioWriter.onFlush=e=>(t.push(e.slice()),0),h.dI(e.ioWriter,e,this.context),e.ioWriter.flush();let r=(0,v.A)(Uint8Array,t);m.__(e.streams,(e=>{const t=e.privData;if(t.chunkOffsets.length)for(let e=0;e<t.chunkOffsets.length;e++)t.chunkOffsets[e]+=BigInt(Math.floor(r.length))})),t=[],h.dI(e.ioWriter,e,this.context),e.ioWriter.flush(),r=(0,v.A)(Uint8Array,t),i&&i(r,this.context.holdMoovPos),e.ioWriter.onFlush=i}else h.dI(e.ioWriter,e,this.context),e.ioWriter.flush()}return 0}flush(e){return this.options.fragment&&(m.__(this.context.currentFragment.tracks,(t=>{const i=e.streams.find((e=>e.index===t.streamIndex)).privData;t.sampleCount&&(t.sampleDurations.length?t.sampleDurations.push(t.sampleDurations[t.sampleDurations.length-1]):t.sampleDurations=[i.lastDuration])})),this.updateCurrentFragment(e)),e.ioWriter.flush(),0}}},5028:(e,t,i)=>{"use strict";i.d(t,{Q:()=>r});const r=["ReadOrder","Layer","Start","End","Style","Name","MarginL","MarginR","MarginV","Effect","Text"]},51785:(e,t,i)=>{"use strict";i.d(t,{Bp:()=>l,Ew:()=>h,wj:()=>u}),i(7210);var r=i(4624),s=i(5028),a=i(54825),n=i(44453),o=i(93935);const c="src/avformat/formats/ass/iass.ts";function l(e){return function(e,t){const i=t.match(/Format\s*:\s*(.*)/i)[1].split(/\s*,\s*/),s=[];for(let t=0;t<i.length;t++){const a=e.find((e=>e.toLowerCase()===i[t].toLowerCase()));a||r.R8(`not support ass field(${i[t]})`,c,40),s.push(a||i[t])}return s}(s.Q,e)}function d(e,t){let i=t.split(",");if(i.length>e.length){const t=i.slice(e.length-1).join(",");i=i.slice(0,e.length-1),i.push(t)}return i}function h(e,t,i,r){const[,,s]=t.match(/^(\w+?)\s*:\s*(.*)/i),n=d(e,s);return{start:(0,a.j)(n[i]),end:(0,a.j)(n[r])}}function u(e,t){const[,i,r]=t.match(/^(\w+?)\s*:\s*(.*)/i);let s=0;switch(i){case"Comment":s=2;break;case"Dialogue":s=1;break;case"Command":s=6;break;case"Movie":s=5;break;case"Picture":s=3;break;case"Sound":s=4}const c=d(e,r),l={type:s};for(let t=0;t<c.length;t++){l[e[t]]=c[t];const i=e[t],r=c[t].trim();switch(i){case"Layer":case"MarginL":case"MarginR":case"MarginV":l[i]=+r;break;case"Start":case"End":l[i]=(0,a.j)(r);break;case"Effect":l[i]=(0,n.d)(r);break;case"Text":l[i]=(0,o.r)(r);break;default:l[i]=r}}return l}},21071:(e,t,i)=>{"use strict";i.d(t,{_l:()=>r,gQ:()=>s});const r=["hmhd","nmhd","iods","xml ","url ","bxml","ipro","mere","stts","ctts","stss","stsz","stz2","stsc","stco","co64","stsd","dref","mvhd","tkhd","mdhd","hdlr"],s=["moov","trak","edts","mdia","minf","dinf","stbl","mvex","moof","traf","vttc","tref","iref","mfra","hnti","hinf","strd","sinf","rinf","schi","trgr","udta","iprp","ipco","strk","meco","encv","enca","sinf","schi"]},3384:(e,t,i)=>{"use strict";function r(){return{trackId:0,baseDataOffset:BigInt(0),defaultSampleDuration:0,defaultSampleSize:0,defaultSampleFlags:0,baseMediaDecodeTime:BigInt(0),sampleCount:0,dataOffset:0,remainDataOffsets:[],remainDataOffsetIndex:[],dataOffsetPos:BigInt(0),firstSampleFlags:0,sampleDurations:[],sampleSizes:[],sampleFlags:[],sampleCompositionTimeOffset:[],baseIsMoof:!1,ioWriter:null,buffers:[]}}i.d(t,{A:()=>r})},9690:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(77231);function s(){return{isom:!1,timescale:r.N_,duration:r.Dh,foundMoov:!1,foundMdat:!1,majorBrand:0,minorVersion:0,compatibleBrand:[],creationTime:BigInt(0),modificationTime:BigInt(0),rate:r.N_,volume:r.N_,matrix:null,nextTrackId:1,fragment:!1,trexs:[],currentFragment:null,boxsPositionInfo:[],holdMoovPos:BigInt(0),currentChunk:null}}},38106:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(77231);function s(){return{chunkOffsets:null,cttsSampleCounts:null,cttsSampleOffsets:null,stscFirstChunk:null,stscSamplesPerChunk:null,stscSampleDescriptionIndex:null,stssSampleNumbersMap:null,stssSampleNumbers:null,sampleSizes:null,sttsSampleCounts:null,sttsSampleDeltas:null,duration:BigInt(0),trackId:r.N_,layer:0,alternateGroup:0,volume:0,matrix:null,width:0,height:0,audioCid:0,samplesPerFrame:0,bytesPerFrame:0,currentSample:0,sampleEnd:!1,samplesIndex:[],samplesEncryption:[],fragIndexes:[],lastPts:r.Dh,lastDts:r.Dh,startDts:r.Dh,startCT:r.N_,startPts:r.Dh,lastDuration:0,chunkCount:0,firstWrote:!1,lastStscCount:0,perStreamGrouping:!1,index:0,flags:0}}},14041:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(77231);function s(e){return e.startPts!==r.Dh?e.lastPts-e.startPts:e.startDts===r.Dh?e.lastPts:e.lastPts-(e.startDts+BigInt(0|e.startCT))}},79804:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(72739);function s(e,t){const i=e.getPos(),s=e.getPointer(),a=i-BigInt(Math.floor(s)),n=[];r.__(t.boxsPositionInfo,(t=>{t.pos<i&&t.pos>=a?(e.seekInline(s+Number(t.pos-i)),e.writeUint32(t.size)):n.push(t)})),r.__(n,(t=>{e.seek(t.pos),e.writeUint32(t.size)})),n.length?e.seek(i):e.seekInline(s),t.boxsPositionInfo=[]}},14202:(e,t,i)=>{"use strict";i.d(t,{BB:()=>s,Ip:()=>a,Jl:()=>r});const r={1:function(e){return[{type:"tkhd"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"smhd"},e.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stsc"},{type:"stsz"},{type:"stco"}]}]}]}]},0:function(e){return[{type:"tkhd"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"vmhd"},e.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stsc"},{type:"stsz"},{type:"stco"}]}]}]}]}},s={1:function(e){return[{type:"tkhd"},{type:"edts"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"smhd"},e.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stsc"},{type:"stsz"},{type:e.use64Mdat?"co64":"stco"}]}]}]}]},0:function(e){return[{type:"tkhd"},{type:"edts"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"vmhd"},e.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stss"},{type:"ctts"},{type:"stsc"},{type:"stsz"},{type:e.use64Mdat?"co64":"stco"}]}]}]}]}},a=function(e){return[{type:"tfhd"},{type:"tfdt"},{type:"trun"},e.cenc&&(e.cenc.defaultSampleInfoSize||e.cenc.sampleSizes.length)?{type:"saiz"}:null,e.cenc&&(e.cenc.defaultSampleInfoSize||e.cenc.sampleSizes.length)?{type:"saio"}:null,e.cenc?{type:"senc"}:null]}},6660:(e,t,i)=>{"use strict";i.d(t,{Q9:()=>a,f3:()=>n,uf:()=>o,zs:()=>s});var r=i(65977);const s={86018:64,86017:105,86076:173,86028:193,86021:221,12:32,27:33,173:35,196:51,167:177,0:0},a={32:12,33:27,35:173,51:196,177:167,64:86018,102:86018,103:86018,104:86018,105:86017,107:86017,173:86076,193:86028,221:86021,0:0},n={vide:0,soun:1,clcp:3,sbtl:3,subt:3,subp:3,text:3},o={[(0,r.A)("mp4a")]:86018,1836253269:86017,[(0,r.A)("Opus")]:86076,[(0,r.A)("fLaC")]:86028,[(0,r.A)("spex")]:86051,[(0,r.A)("SPXN")]:86051,[(0,r.A)("ac-3")]:86019,[(0,r.A)("sac3")]:86019,[r.A.mp4v]:12,[(0,r.A)("av01")]:225,[(0,r.A)("vp08")]:139,[(0,r.A)("vp09")]:167,[(0,r.A)("avc1")]:27,[(0,r.A)("hev1")]:173,[(0,r.A)("hvc1")]:173,[(0,r.A)("vvc1")]:196,[(0,r.A)("vvi1")]:196,[(0,r.A)("text")]:94213,[(0,r.A)("tx3g")]:94213}},75473:(e,t,i)=>{"use strict";i.d(t,{Ro:()=>v,dI:()=>g,l7:()=>p});var r=i(61499),s=i(63939),a=i(65977),n=i(21071),o=i(72739),c=i(80025),l=i(14202),d=i(79804),h=i(71517),u=i(50315),f=i(14686);function p(e,t){e.flush();const i=e.getPointer(),r=e.getPos();e.writeUint32(0),e.writeUint32((0,a.A)("ftyp")),e.writeUint32(t.majorBrand||(0,a.A)("isom")),e.writeUint32(t.minorVersion||512),o.__(t.compatibleBrand,(t=>{e.writeUint32(t)})),function(e,t,i){const r=e.getPointer();e.seekInline(t),e.writeUint32(i),e.seekInline(r)}(e,i,Number(e.getPos()-r)),t.isom?(e.writeUint32(8),e.writeUint32((0,a.A)("wide"))):t.fragment||(e.writeUint32(8),e.writeUint32((0,a.A)("free")))}function m(e,t,i,r){o.__(t,(t=>{if(!t)return!0;if(c.A[t.type])c.A[t.type](e,i,r);else if(t.children){const s=e.getPos();e.writeUint32(0),e.writeUint32((0,a.A)(t.type)),m(e,t.children,i,r),r.boxsPositionInfo.push({pos:s,type:t.type,size:Number(e.getPos()-s)})}else!function(e,t){const i=o.zy(n._l,t);e.writeUint32(i?12:8),e.writeUint32((0,a.A)(t)),i&&e.writeUint32(0)}(e,t.type)}))}function g(e,t,i){const n=e.getPos();if(e.writeUint32(0),e.writeUint32((0,a.A)("moov")),c.A.mvhd(e,null,i),o.__(t.streams,(t=>{const r=e.getPos();e.writeUint32(0),e.writeUint32((0,a.A)("trak")),m(e,i.fragment?l.Jl[t.codecpar.codecType](i):l.BB[t.codecpar.codecType](i),t,i),i.boxsPositionInfo.push({pos:r,type:"trak",size:Number(e.getPos()-r)})})),i.fragment){const n=e.getPos();e.writeUint32(0),e.writeUint32((0,a.A)("mvex")),o.__(t.streams,(t=>{c.A.trex(e,t,i)})),i.boxsPositionInfo.push({pos:n,type:"mvex",size:Number(e.getPos()-n)}),i.ignoreEncryption||function(e,t,i){const n=[];o.__(t.streams,(e=>{const t=(0,h.Un)(e.codecpar[r.o9]+20,e.codecpar[r.o9]+24,24);t&&(0,u.ZK)((0,f.s3)(s.f[20](t),s.f[25](t+4))).forEach((e=>{(function(e){if(!n.length)return!1;for(let t=0;t<n.length;t++){const i=n[t];if(!o.FB(i.systemId,e.systemId))return!1;if(!i.keyIds||!e.keyIds)return!1;if(i.keyIds.length!==e.keyIds.length)return!1;for(let t=0;t<i.keyIds.length;t++)if(!o.FB(i.keyIds[t],e.keyIds[t]))return!1;if(!o.FB(i.data,e.data))return!1}return!0})(e)||n.push(e)}))})),n.length&&n.forEach((t=>{const r=e.getPos();e.writeUint32(0),e.writeUint32((0,a.A)("pssh")),e.writeUint8(1),e.writeUint24(0),e.writeBuffer(t.systemId),e.writeUint32(t.keyIds.length),t.keyIds.forEach((t=>{e.writeBuffer(t)})),e.writeUint32(t.data.length),e.writeBuffer(t.data),i.boxsPositionInfo.push({pos:r,type:"pssh",size:Number(e.getPos()-r)})}))}(e,t,i)}i.boxsPositionInfo.push({pos:n,type:"moov",size:Number(e.getPos()-n)}),(0,d.A)(e,i)}function v(e,t,i){const r=e.getPos();e.writeUint32(0),e.writeUint32((0,a.A)("moof")),c.A.mfhd(e,null,i),o.__(i.currentFragment.tracks,(r=>{if(!r.sampleCount)return!0;const s=e.getPos();e.writeUint32(0),e.writeUint32((0,a.A)("traf"));const n=t.streams.find((e=>e.privData.trackId===r.trackId));m(e,(0,l.Ip)(r),n,i),i.boxsPositionInfo.push({pos:s,type:"traf",size:Number(e.getPos()-s)})}));const s=Number(e.getPos()-r);i.boxsPositionInfo.push({pos:r,type:"moof",size:s}),i.currentFragment.size=s}},39878:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(14686);function s(e,t,i){var s;e.writeUint32(8+(null!==(s=t.codecpar.extradataSize)&&void 0!==s?s:0)),e.writeString("av1C"),i.fragment&&t.sideData[1]?(e.writeBuffer(t.sideData[1]),delete t.sideData[1]):t.codecpar.extradata&&e.writeBuffer((0,r.s3)(t.codecpar.extradata,t.codecpar.extradataSize))}},61600:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(14686),s=i(60264),a=i(62815);function n(e,t,i){let n;i.fragment&&t.sideData[1]?(n=t.sideData[1],delete t.sideData[1]):t.codecpar.extradata&&(n=(0,r.s3)(t.codecpar.extradata,t.codecpar.extradataSize)),n&&s.Bs(n)&&(n=a.S1(n)),e.writeUint32(8+(n?n.length:0)),e.writeString("avcC"),n&&e.writeBuffer(n)}},93861:(e,t,i)=>{"use strict";function r(e,t,i){e.writeUint32(20),e.writeString("btrt"),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0)}i.d(t,{A:()=>r})},34445:(e,t,i)=>{"use strict";function r(e,t,i){const r=t.privData.chunkOffsets||[];e.writeUint32(16+8*r.length),e.writeString("co64"),e.writeUint8(0),e.writeUint24(0),e.writeUint32(r.length);for(let t=0;t<r.length;t++)e.writeUint64(r[t])}i.d(t,{A:()=>r})},853:(e,t,i)=>{"use strict";function r(e,t,i){const r=t.sideData[28];if(r)e.writeUint32(12+r.length),e.writeString("colr"),e.writeString("prof"),e.writeBuffer(r);else{const i=2===t.codecpar.colorRange;e.writeUint32(19),e.writeString("colr"),e.writeString("nclx"),e.writeUint16(t.codecpar.colorPrimaries),e.writeUint16(t.codecpar.colorTrc),e.writeUint16(t.codecpar.colorSpace),e.writeUint8(i?128:0)}}i.d(t,{A:()=>r})},18387:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(4624);const s="src/avformat/formats/mov/writing/ctts.ts";function a(e,t,i){const a=t.privData,n=a.cttsSampleCounts||[],o=a.cttsSampleOffsets||[];n.length!==o.length&&r.R8("ctts sampleCounts's length is not match sampleOffsets's length",s,39);const c=Math.min(n.length,o.length);e.writeUint32(16+8*c),e.writeString("ctts"),e.writeUint8(1),e.writeUint24(0),e.writeUint32(c);for(let t=0;t<c;t++)e.writeUint32(n[t]),e.writeInt32(o[t])}},80648:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(83314);function s(e,t,i){e.writeUint32(11),e.writeString("dac3");const s=new r.A(3),a=i.ac3Info;s.writeU(2,a.substream[0].fscod),s.writeU(5,a.substream[0].bsid),s.writeU(3,a.substream[0].bsmod),s.writeU(3,a.substream[0].acmod),s.writeU(1,a.substream[0].lfeon),s.writeU(5,a.ac3BitrateCode),s.writeU(5,0),e.writeBuffer(s.getBuffer())}},55668:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(83314);function s(e,t,i){const s=i.ac3Info,a=new r.A(2+(34*(s.numIndSub+1)+7>>3));a.writeU(13,s.dataRate),a.writeU(3,s.numIndSub);for(let e=0;e<s.numIndSub;e++)a.writeU(2,s.substream[e].fscod),a.writeU(5,s.substream[e].bsid),a.writeU(1,0),a.writeU(1,0),a.writeU(3,s.substream[e].bsmod),a.writeU(3,s.substream[e].acmod),a.writeU(1,s.substream[e].lfeon),a.writeU(5,0),a.writeU(4,s.substream[e].numDepSub),s.substream[e].numDepSub?a.writeU(9,s.substream[e].chanLoc):a.writeU(1,0);a.padding();const n=a.getPointer();e.writeUint32(8+n),e.writeString("dec3"),e.writeBuffer(a.getBuffer().subarray(0,n))}},47280:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(14686),s=i(4624),a=i(14769);const n="src/avformat/formats/mov/writing/dfla.ts";function o(e,t,i){let o;i.fragment&&t.sideData[1]?(o=t.sideData[1],delete t.sideData[1]):t.codecpar.extradata&&(o=(0,r.s3)(t.codecpar.extradata,t.codecpar.extradataSize)),o&&o.length===a.ob?(e.writeUint32(o.length+16),e.writeString("dfLa"),e.writeUint8(0),e.writeUint24(0),e.writeUint8(128),e.writeUint24(o.length),e.writeBuffer(o)):s.z3("invalid extradata",n,57)}},82181:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(14686),s=i(31865);function a(e,t,i){let a;if(i.fragment&&t.sideData[1]?(a=t.sideData[1],delete t.sideData[1]):t.codecpar.extradata&&(a=(0,r.s3)(t.codecpar.extradata,t.codecpar.extradataSize)),!a||a.length<19)e.writeUint32(19),e.writeString("dOps"),e.writeUint8(0),e.writeUint8(t.codecpar.chLayout.nbChannels),e.writeUint16(t.codecpar.initialPadding),e.writeUint32(t.codecpar.sampleRate),e.writeUint16(0),e.writeUint8(0);else{const t=new s.A(a,!1);e.writeUint32(a.length),e.writeString("dOps"),e.writeUint8(0),t.seek(9),e.writeUint8(t.readUint8()),e.writeUint16(t.readUint16()),e.writeUint32(t.readUint32()),e.writeUint16(t.readUint16()),e.writeBuffer(a.subarray(18))}}},12412:(e,t,i)=>{"use strict";function r(e,t,i){e.writeUint32(28),e.writeString("dref"),e.writeUint32(0),e.writeUint32(1),e.writeUint32(12),e.writeString("url "),e.writeUint32(1)}i.d(t,{A:()=>r})},44473:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(77231),s=i(44328),a=i(14041);function n(e,t,i){const n=t.privData;let o=(0,s.k)((0,a.A)(n),t.timeBase,{den:i.timescale,num:1}),c=n.startCT;const l=(0,s.k)(n.startDts+BigInt(Math.floor(c)),t.timeBase,{den:i.timescale,num:1});let d=o<r.go?0:1;d|=l<r.go?0:1;const h=1+(l>0?1:0),u=24+h*(1===d?20:12);e.writeUint32(u),e.writeString("edts"),e.writeUint32(u-8),e.writeString("elst"),e.writeUint8(d),e.writeUint24(0),e.writeUint32(h),l>0?(1===d?(e.writeUint64(l),e.writeInt64(r.Dh)):(e.writeUint32(Number(l)),e.writeInt32(-1)),e.writeUint32(65536)):(c=-Math.min(Number(n.startDts),0),o+=l),i.fragment&&(o=BigInt(0)),1===d?(e.writeUint64(o),e.writeInt64(BigInt(Math.floor(c)))):(e.writeUint32(Number(o)),e.writeInt32(c)),e.writeUint32(65536)}},4652:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(6660),s=i(14686);function a(e,t,i){e.writeUint8(t);for(let t=3;t>0;t--)e.writeUint8(i>>7*t|128);e.writeUint8(127&i)}function n(e,t,i){const n=t.privData,o=t.codecpar.extradata?5+t.codecpar.extradataSize:0,c=e.getPos();e.writeUint32(0),e.writeString("esds"),e.writeUint32(0),a(e,3,21+o+5+1),e.writeUint16(n.trackId),e.writeUint8(0),a(e,4,13+o),(86016===t.codecpar.codecId||86017===t.codecpar.codecId)&&t.codecpar.sampleRate>24e3?e.writeUint8(107):e.writeUint8(r.zs[t.codecpar.codecId]),94208===t.codecpar.codecId?e.writeUint8(225):1===t.codecpar.codecType?e.writeUint8(21):e.writeUint8(17),e.writeUint24(0),e.writeUint32(0),e.writeUint32(0),t.codecpar.extradata&&(a(e,5,t.codecpar.extradataSize),e.writeBuffer((0,s.s3)(t.codecpar.extradata,t.codecpar.extradataSize))),a(e,6,1),e.writeUint8(2),i.boxsPositionInfo.push({pos:c,type:"esds",size:Number(e.getPos()-c)})}},87384:(e,t,i)=>{"use strict";function r(e,t,i,r,s,a,n){e.writeInt32(Math.floor(65536*t)),e.writeInt32(Math.floor(65536*i)),e.writeInt32(0),e.writeInt32(Math.floor(65536*r)),e.writeInt32(Math.floor(65536*s)),e.writeInt32(0),e.writeInt32(Math.floor(65536*a)),e.writeInt32(Math.floor(65536*n)),e.writeInt32(1073741824)}i.d(t,{A:()=>r})},17923:(e,t,i)=>{"use strict";function r(e,t,i){const r=e.getPos();e.writeUint32(0),e.writeString("hdlr"),e.writeUint8(0),e.writeUint24(0);let s="dhlr",a="url ",n="DataHandler";t&&(s="mhlr",1===t.codecpar.codecType?(a="soun",n="SoundHandler"):0===t.codecpar.codecType?(a="vide",n="VideoHandler"):3===t.codecpar.codecType?(a="text",n="SubtitleHandler"):(t.metadata.handlerName&&(n=t.metadata.handlerName),t.metadata.hdlrType&&(a=t.metadata.hdlrType))),e.writeString(s),e.writeString(a),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),t&&!i.isom||e.writeUint8(n.length),e.writeString(n),t&&!i.isom&&e.writeUint8(0),i.boxsPositionInfo.push({pos:r,type:"hdlr",size:Number(e.getPos()-r)})}i.d(t,{A:()=>r})},78669:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(14686),s=i(60264),a=i(67659);function n(e,t,i){let n;i.fragment&&t.sideData[1]?(n=t.sideData[1],delete t.sideData[1]):t.codecpar.extradata&&(n=(0,r.s3)(t.codecpar.extradata,t.codecpar.extradataSize)),n&&s.Bs(n)&&(n=a.S1(n)),e.writeUint32(8+(n?n.length:0)),e.writeString("hvcC"),n&&e.writeBuffer(n)}},6e3:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(77231),s=i(14041);function a(e,t,i){const a=t.privData,n=(0,s.A)(a),o=t.metadata.creationTime||0,c=t.metadata.modificationTime||0,l=t.metadata.language||21956;let d=n<BigInt(r.f7)?0:1;d=o<r.f7?0:1,d=c<r.f7?0:1,e.writeUint32(1===d?44:32),e.writeString("mdhd"),e.writeUint8(d),e.writeUint24(0),1===d?(e.writeUint64(o),e.writeUint64(c)):(e.writeUint32(Number(o)),e.writeUint32(Number(c))),e.writeUint32(t.timeBase.den),1===d?e.writeUint64(n):e.writeUint32(Number(n)),e.writeUint16(l),e.writeUint16(0)}},31130:(e,t,i)=>{"use strict";function r(e,t,i){e.writeUint32(16),e.writeString("mfhd"),e.writeUint8(0),e.writeUint24(0),e.writeUint32(i.currentFragment.sequence)}i.d(t,{A:()=>r})},48669:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(17923);function s(e,t,i){(0,r.A)(e,null,i)}},7114:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(77231),s=i(87384);function a(e,t,i){const a=i.duration,n=i.creationTime||0,o=i.modificationTime||0,c=i.timescale||0;let l=i.nextTrackId||1;i.fragment&&(l=2);let d=a<BigInt(r.f7)?0:1;d=n<r.f7?0:1,d=o<r.f7?0:1,e.writeUint32(1===d?120:108),e.writeString("mvhd"),e.writeUint8(d),e.writeUint24(0),1===d?(e.writeUint64(n),e.writeUint64(o)):(e.writeUint32(Number(n)),e.writeUint32(Number(o))),e.writeUint32(c),1===d?e.writeUint64(a):e.writeUint32(Number(a)),e.writeUint32(65536),e.writeUint16(256),e.writeUint16(0),e.writeUint32(0),e.writeUint32(0),(0,s.A)(e,1,0,0,1,0,0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(l)}},65629:(e,t,i)=>{"use strict";function r(e,t,i){e.writeUint32(16),e.writeString("pasp"),e.writeUint32(1),e.writeUint32(1)}i.d(t,{A:()=>r})},37241:(e,t,i)=>{"use strict";function r(e,t,i){const r=i.currentFragment.tracks.find((e=>e.trackId===t.privData.trackId));e.writeUint32(20),e.writeString("saio"),e.writeUint32(0),e.writeUint32(1),r.cenc.offsetPos=e.getPos(),e.writeUint32(0)}i.d(t,{A:()=>r})},32366:(e,t,i)=>{"use strict";function r(e,t,i){const r=i.currentFragment.tracks.find((e=>e.trackId===t.privData.trackId)),s=e.getPos();e.writeUint32(0),e.writeString("saiz"),e.writeUint32(0),e.writeUint8(r.cenc.sampleSizes.length?0:r.cenc.defaultSampleInfoSize),e.writeUint32(r.cenc.sampleCount),r.cenc.sampleSizes.length&&r.cenc.sampleSizes.forEach((t=>{e.writeUint8(t)})),i.boxsPositionInfo.push({pos:s,type:"saiz",size:Number(e.getPos()-s)})}i.d(t,{A:()=>r})},90842:(e,t,i)=>{"use strict";function r(e,t,i){const r=i.currentFragment.tracks.find((e=>e.trackId===t.privData.trackId)),s=i.cencs?i.cencs[r.trackId]:null,a=e.getPos();e.writeUint32(0),e.writeString("senc"),e.writeUint32(r.cenc.useSubsamples?2:0),e.writeUint32(r.cenc.sampleEncryption.length),r.cenc.offset=Number(e.getPos()-i.currentFragment.pos),r.cenc.sampleEncryption.forEach((t=>{s.defaultPerSampleIVSize&&e.writeBuffer(t.iv),r.cenc.useSubsamples&&(e.writeUint16(t.subsamples.length),t.subsamples.forEach((t=>{e.writeUint16(t.bytesOfClearData),e.writeUint32(t.bytesOfProtectedData)})))})),i.boxsPositionInfo.push({pos:a,type:"senc",size:Number(e.getPos()-a)})}i.d(t,{A:()=>r})},11573:(e,t,i)=>{"use strict";function r(e,t,i){e.writeUint32(16),e.writeString("smhd"),e.writeUint32(0),e.writeUint16(0),e.writeUint16(0)}i.d(t,{A:()=>r})},2204:(e,t,i)=>{"use strict";function r(e,t,i){const r=t.privData.chunkOffsets||[];e.writeUint32(16+4*r.length),e.writeString("stco"),e.writeUint8(0),e.writeUint24(0),e.writeUint32(r.length);for(let t=0;t<r.length;t++)e.writeUint32(Number(r[t]))}i.d(t,{A:()=>r})},84360:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(4624);const s="src/avformat/formats/mov/writing/stsc.ts";function a(e,t,i){const a=t.privData,n=a.stscFirstChunk,o=a.stscSamplesPerChunk,c=a.stscSampleDescriptionIndex;n.length===o.length&&n.length===c.length||r.R8("ctts firstChunk's length is not match samplesPerChunk's length or sampleDescriptionIndex's length",s,42);const l=Math.min(n.length,o.length,c.length);e.writeUint32(16+12*l),e.writeString("stsc"),e.writeUint8(0),e.writeUint24(0),e.writeUint32(l);for(let t=0;t<l;t++)e.writeUint32(n[t]),e.writeUint32(o[t]),e.writeUint32(c[t])}},69301:(e,t,i)=>{"use strict";i.d(t,{A:()=>P});var r=i(61600),s=i(78669),a=i(1263),n=i(99193),o=i(39878),c=i(47280),l=i(82181),d=i(4652),h=i(853),u=i(65629),f=i(93861),p=i(57756),m=i(80648),g=i(55668),v=i(14686),y=i(61619),A=i(65977);const b={27:"avc1",173:"hvc1",196:"vvc1",225:"av01",167:"vp09",86019:"ac-3",86056:"ec-3"};function w(e){if(e.codecTag)return(0,y.A)(e.codecTag);let t=b[e.codecId];return t||(t=0===e.codecType?"mp4v":1===e.codecType?86076===e.codecId?"Opus":86028===e.codecId?"fLaC":"mp4a":3===e.codecType?"text":"none"),t}function x(e,t,i){const r=t.privData,s=i.cencs[r.trackId],a=e.getPos();e.writeUint32(0),e.writeString("sinf"),e.writeUint32(12),e.writeString("frma"),e.writeString(w(t.codecpar)),e.writeUint32(20),e.writeString("schm"),e.writeUint32(0),e.writeUint32(s.schemeType||(0,A.A)("cenc")),e.writeUint32(s.schemeVersion||65536),e.writeUint32(16+s.defaultKeyId.length+8+(s.defaultConstantIV?1+s.defaultConstantIV.length:0)),e.writeString("schi"),e.writeUint32(16+s.defaultKeyId.length+(s.defaultConstantIV?1+s.defaultConstantIV.length:0)),e.writeString("tenc"),s.cryptByteBlock||s.skipByteBlock||s.pattern?e.writeUint8(1):e.writeUint8(0),e.writeUint24(0),e.writeUint8(0),e.writeUint8((15&(s.cryptByteBlock||0))<<4|15&(s.skipByteBlock||0)),e.writeUint8(1),e.writeUint8(s.defaultPerSampleIVSize),e.writeBuffer(s.defaultKeyId),s.defaultConstantIV&&(e.writeUint8(s.defaultConstantIV.length),e.writeBuffer(s.defaultConstantIV)),i.boxsPositionInfo.push({pos:a,type:"sinf",size:Number(e.getPos()-a)})}function k(e,t,i){const r=i.isom?1:0;e.writeUint32(0),e.writeUint16(0),e.writeUint16(1),e.writeUint16(r),e.writeUint16(0),e.writeUint32(0),i.isom?(e.writeUint16(t.codecpar.chLayout.nbChannels),65541===t.codecpar.codecId||65540===t.codecpar.codecId?e.writeUint16(8):69643===t.codecpar.codecId?e.writeUint16(t.codecpar.bitsPerCodedSample):e.writeUint16(16),e.writeUint16(-2)):(86028===t.codecpar.codecId||86032===t.codecpar.codecId||86076===t.codecpar.codecId?e.writeUint16(t.codecpar.chLayout.nbChannels):e.writeUint16(2),86028===t.codecpar.codecId||86032===t.codecpar.codecId?e.writeUint16(t.codecpar.bitsPerRawSample):e.writeUint16(16),e.writeUint16(0)),e.writeUint16(0),86076===t.codecpar.codecId?e.writeUint16(48e3):86060===t.codecpar.codecId?e.writeUint32(t.codecpar.sampleRate):e.writeUint16(t.codecpar.sampleRate),86060!==t.codecpar.codecId&&e.writeUint16(0),1===r&&(e.writeUint32(t.codecpar.frameSize),e.writeUint32(0),e.writeUint32(0),e.writeUint32(2))}function T(e,t,i){const r=w(t.codecpar);!i.isom||86018!==t.codecpar.codecId&&86019!==t.codecpar.codecId&&86056!==t.codecpar.codecId&&73728!==t.codecpar.codecId&&86032!==t.codecpar.codecId&&69638!==t.codecpar.codecId&&69633!==t.codecpar.codecId&&86035!==t.codecpar.codecId?86028===t.codecpar.codecId?(0,c.A)(e,t,i):86076===t.codecpar.codecId?(0,l.A)(e,t,i):86019===t.codecpar.codecId?(0,m.A)(e,t,i):86056===t.codecpar.codecId?(0,g.A)(e,t,i):"mp4a"==r&&(0,d.A)(e,t,i):(0,p.A)(e,t,i)}function I(e,t,i){const r=13==t.codecpar.codecId&&15==t.codecpar.format||13==t.codecpar.codecId&&1==t.codecpar.format||202==t.codecpar.codecId||203==t.codecpar.codecId||156==t.codecpar.codecId||127==t.codecpar.codecId;e.writeUint32(0),e.writeUint16(0),e.writeUint16(1),e.writeUint16(r?2:0),e.writeUint16(0),i.isom?(e.writeString("FFMP"),13===t.codecpar.codecId||r?(e.writeUint32(0),e.writeUint32(1024)):(e.writeUint32(512),e.writeUint32(512))):(e.writeUint32(0),e.writeUint32(0),e.writeUint32(0)),e.writeUint16(t.codecpar.width),e.writeUint16(t.codecpar.height),e.writeUint32(4718592),e.writeUint32(4718592),e.writeUint32(0),e.writeUint16(1);let s=t.metadata.compressorName||"";if(s=s.slice(0,31),e.writeUint8(s.length),e.writeString(s),s.length<31){let t=31-s.length;for(;t>0;)e.writeUint8(0),t--}i.isom&&t.codecpar.bitsPerCodedSample?e.writeUint16(t.codecpar.bitsPerCodedSample):e.writeUint16(24),e.writeUint16(65535)}function S(e,t,i){"mp4v"===w(t.codecpar)?(0,d.A)(e,t,i):27===t.codecpar.codecId?(0,r.A)(e,t,i):173===t.codecpar.codecId?(0,s.A)(e,t,i):196===t.codecpar.codecId?(0,a.A)(e,t,i):167===t.codecpar.codecId?(0,n.A)(e,t,i):225===t.codecpar.codecId&&(0,o.A)(e,t,i)}function P(e,t,i){const r=e.getPos();e.writeUint32(0),e.writeString("stsd");const s=t.privData,a=i.cencs&&i.cencs[s.trackId]&&(1===t.codecpar.codecType||0===t.codecpar.codecType)&&!i.ignoreEncryption;e.writeUint8(0),e.writeUint24(0),e.writeUint32(a?2:1),1===t.codecpar.codecType?(a&&function(e,t,i){const r=e.getPos();e.writeUint32(0),e.writeString("enca"),k(e,t,i),x(e,t,i),T(e,t,i),i.boxsPositionInfo.push({pos:r,type:"enca",size:Number(e.getPos()-r)})}(e,t,i),function(e,t,i){const r=e.getPos(),s=w(t.codecpar);e.writeUint32(0),e.writeString(s),k(e,t,i),T(e,t,i),i.isom||(0,f.A)(e,t,i),i.boxsPositionInfo.push({pos:r,type:s,size:Number(e.getPos()-r)})}(e,t,i)):0===t.codecpar.codecType?(a&&function(e,t,i){const r=e.getPos();e.writeUint32(0),e.writeString("encv"),I(e,t,i),x(e,t,i),S(e,t,i),i.boxsPositionInfo.push({pos:r,type:"encv",size:Number(e.getPos()-r)})}(e,t,i),function(e,t,i){const r=e.getPos(),s=w(t.codecpar);e.writeUint32(0),e.writeString(s),I(e,t,i),S(e,t,i),(0,h.A)(e,t,i),(0,u.A)(e,t,i),i.isom||(0,f.A)(e,t,i),i.boxsPositionInfo.push({pos:r,type:s,size:Number(e.getPos()-r)})}(e,t,i)):3===t.codecpar.codecType&&function(e,t,i){const r=e.getPos(),s=w(t.codecpar);e.writeUint32(0),e.writeString(s),e.writeUint32(0),e.writeUint16(0),e.writeUint16(1),94208===t.codecpar.codecId?(0,d.A)(e,t,i):t.codecpar.extradata&&e.writeBuffer((0,v.s3)(t.codecpar.extradata,t.codecpar.extradataSize)),i.isom||(0,f.A)(e,t,i),i.boxsPositionInfo.push({pos:r,type:s,size:Number(e.getPos()-r)})}(e,t,i),i.boxsPositionInfo.push({pos:r,type:"esds",size:Number(e.getPos()-r)})}},20184:(e,t,i)=>{"use strict";function r(e,t,i){const r=t.privData.stssSampleNumbers;e.writeUint32(16+4*r.length),e.writeString("stss"),e.writeUint8(0),e.writeUint24(0),e.writeUint32(r.length);for(let t=0;t<r.length;t++)e.writeUint32(r[t])}i.d(t,{A:()=>r})},57247:(e,t,i)=>{"use strict";function r(e,t,i){const r=t.privData.sampleSizes;e.writeUint32(20+4*r.length),e.writeString("stsz"),e.writeUint8(0),e.writeUint24(0),e.writeUint32(0),e.writeUint32(r.length);for(let t=0;t<r.length;t++)e.writeUint32(r[t])}i.d(t,{A:()=>r})},86051:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(4624);const s="src/avformat/formats/mov/writing/stts.ts";function a(e,t,i){const a=t.privData,n=a.sttsSampleCounts||[],o=a.sttsSampleDeltas||[];n.length!==o.length&&r.R8("stts sampleCounts's length is not match sampleDeltas's length",s,39);const c=Math.min(n.length,o.length);e.writeUint32(16+8*c),e.writeString("stts"),e.writeUint8(0),e.writeUint24(0),e.writeUint32(c);for(let t=0;t<c;t++)e.writeUint32(n[t]),e.writeInt32(o[t])}},11251:(e,t,i)=>{"use strict";function r(e,t,i){const r=i.currentFragment.tracks.find((e=>e.trackId===t.privData.trackId)),s=r?r.baseMediaDecodeTime:BigInt(0);e.writeUint32(20),e.writeString("tfdt"),e.writeUint8(1),e.writeUint24(0),e.writeUint64(s)}i.d(t,{A:()=>r})},11903:(e,t,i)=>{"use strict";function r(e,t,i){const r=i.currentFragment.tracks.find((e=>e.trackId===t.privData.trackId));let s=57;r.baseIsMoof&&(s&=-2,s|=131072);const a=e.getPos();e.writeUint32(0),e.writeString("tfhd"),e.writeUint8(0),e.writeUint24(s),e.writeUint32(r.trackId),1&s&&e.writeUint64(r.baseDataOffset),8&s&&e.writeUint32(r.defaultSampleDuration),16&s&&e.writeUint32(r.defaultSampleSize),32&s&&e.writeUint32(r.defaultSampleFlags),i.boxsPositionInfo.push({pos:a,type:"tfhd",size:Number(e.getPos()-a)})}i.d(t,{A:()=>r})},59868:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(77231),s=i(87384),a=i(44328),n=i(14041);function o(e,t,i){const o=t.privData,c=(0,a.k)((0,n.A)(o),t.timeBase,{den:i.timescale,num:1}),l=t.metadata.creationTime||0,d=t.metadata.modificationTime||0,h=o.layer||0,u=o.alternateGroup||0;let f=t.codecpar.width>0?t.codecpar.width:0,p=t.codecpar.height>0?t.codecpar.height:0;const m=(0,a.lb)(t.codecpar.sampleAspectRatio);0!==m&&m!==1/0&&(f=Math.floor(f*m)),f<r.zg&&(f<<=16),p<r.zg&&(p<<=16);let g=c<BigInt(r.f7)?0:1;g=l<r.f7?0:1,g=d<r.f7?0:1;let v=2;1&o.flags&&(v|=1),e.writeUint32(1===g?100:92),e.writeString("tkhd"),e.writeUint8(g),e.writeUint24(v),1===g?(e.writeUint64(l),e.writeUint64(d)):(e.writeUint32(Number(l)),e.writeUint32(Number(d))),e.writeUint32(o.trackId),e.writeUint32(0),1===g?e.writeUint64(c):e.writeUint32(Number(c)),e.writeUint32(0),e.writeUint32(0),e.writeInt16(h),e.writeInt16(o.perStreamGrouping?u:t.codecpar.codecType),1===t.codecpar.codecType?e.writeInt16(256):e.writeInt16(0),e.writeInt16(0);const y=t.metadata.matrix;y?(0,s.A)(e,y[0],y[1],y[3],y[4],y[6],y[7]):(0,s.A)(e,1,0,0,1,0,0),e.writeUint32(f),e.writeUint32(p)}},35010:(e,t,i)=>{"use strict";function r(e,t,i){var r,s,a;const n=i.currentFragment.tracks.find((e=>e.trackId===t.privData.trackId)),o=i.trexs.find((e=>{e.trackId,t.privData.trackId})),c=null!==(r=null==o?void 0:o.duration)&&void 0!==r?r:0,l=null!==(s=null==o?void 0:o.size)&&void 0!==s?s:0,d=null!==(a=null==o?void 0:o.flags)&&void 0!==a?a:0;e.writeUint32(32),e.writeString("trex"),e.writeUint8(0),e.writeUint24(0),e.writeUint32(n.trackId),e.writeUint32(1),e.writeUint32(c),e.writeUint32(l),e.writeUint32(d)}i.d(t,{A:()=>r})},48516:(e,t,i)=>{"use strict";function r(e,t,i){const r=t.privData,s=i.currentFragment.tracks.find((e=>e.trackId===r.trackId)),a=s.firstSampleFlags||0,n=s.dataOffset||0,o=s.sampleDurations,c=s.sampleSizes,l=s.sampleFlags,d=s.sampleCompositionTimeOffset,h=s.sampleCount,u=o.length>0,f=c.length>0,p=l.length>0,m=d.length>0,g=0!==a;let v=1;g&&(v|=4),u&&(v|=256),f&&(v|=512),p&&(v|=1024),m&&(v|=2048);const y=e.getPos();e.writeUint32(0),e.writeString("trun"),e.writeUint8(1),e.writeUint24(v),e.writeUint32(h),s.dataOffsetPos=e.getPos(),e.writeInt32(n),g&&e.writeUint32(a);for(let t=0;t<h;t++)u&&e.writeUint32(o[t]||0),f&&e.writeUint32(c[t]||0),p&&e.writeUint32(l[t]||0),m&&e.writeInt32(d[t]||0);i.boxsPositionInfo.push({pos:y,type:"trun",size:Number(e.getPos()-y)})}i.d(t,{A:()=>r})},54012:(e,t,i)=>{"use strict";function r(e,t,i){e.writeUint32(20),e.writeString("vmhd"),e.writeUint8(0),e.writeUint24(1),e.writeUint64(BigInt(0))}i.d(t,{A:()=>r})},99193:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(14686);function s(e,t,i){var s;e.writeUint32(12+(null!==(s=t.codecpar.extradataSize)&&void 0!==s?s:0)),e.writeString("vpcC"),e.writeUint8(1),e.writeUint24(0),i.fragment&&t.sideData[1]?(e.writeBuffer(t.sideData[1]),delete t.sideData[1]):t.codecpar.extradata&&e.writeBuffer((0,r.s3)(t.codecpar.extradata,t.codecpar.extradataSize))}},1263:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(14686),s=i(60264),a=i(59166);function n(e,t,i){let n;i.fragment&&t.sideData[1]?(n=t.sideData[1],delete t.sideData[1]):t.codecpar.extradata&&(n=(0,r.s3)(t.codecpar.extradata,t.codecpar.extradataSize)),n&&s.Bs(n)&&(n=a.S1(n)),e.writeUint32(12+(n?n.length:0)),e.writeString("vvcC"),e.writeUint8(0),e.writeUint24(0),n&&e.writeBuffer(n)}},57756:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(14686),s=i(4652);function a(e,t,i){const a=e.getPos();e.writeUint32(0),e.writeString("wave"),86035!==t.codecpar.codecId&&(e.writeUint32(12),e.writeString("frma"),e.writeUint32(t.codecpar.codecTag)),86018===t.codecpar.codecId?(e.writeUint32(12),e.writeString("mp4a"),e.writeUint32(0),(0,s.A)(e,t,i)):i.fragment&&t.sideData[1]?(e.writeBuffer(t.sideData[1]),delete t.sideData[1]):t.codecpar.extradata&&e.writeBuffer((0,r.s3)(t.codecpar.extradata,t.codecpar.extradataSize)),e.writeUint32(8),e.writeUint32(0),i.boxsPositionInfo.push({pos:a,type:"wave",size:Number(e.getPos()-a)})}},80025:(e,t,i)=>{"use strict";i.d(t,{A:()=>_});var r=i(86051),s=i(18387),a=i(20184),n=i(57247),o=i(84360),c=i(2204),l=i(34445),d=i(6e3),h=i(7114),u=i(59868),f=i(17923),p=i(69301),m=i(54012),g=i(44473),v=i(11573),y=i(12412),A=i(35010),b=i(31130),w=i(11903),x=i(11251),k=i(48516),T=i(48669),I=i(32366),S=i(37241),P=i(90842);const _={stts:r.A,ctts:s.A,stss:a.A,stsz:n.A,stsc:o.A,stco:c.A,co64:l.A,mdhd:d.A,mvhd:h.A,tkhd:u.A,hdlr:f.A,stsd:p.A,vmhd:m.A,edts:g.A,smhd:v.A,dref:y.A,trex:A.A,mfhd:b.A,tfhd:w.A,tfdt:x.A,trun:k.A,minf_hdlr:T.A,saio:S.A,saiz:I.A,senc:P.A}},59989:(e,t,i)=>{"use strict";function r(e,t=0){if(!e)return!1;if(e.length<2)return!0;let i=e[t],r=t+1;for(;r<e.length&&i===e[r];r++);return r===e.length}i.d(t,{A:()=>r})},31425:(e,t,i)=>{"use strict";i.d(t,{$:()=>n});var r=i(77231),s=i(72739),a=i(44328);function n(e){let t=!0;return s.__(e.streams,(e=>{switch(e.codecpar.codecType){case 1:e.codecpar.chLayout.nbChannels!==r.N_&&e.codecpar.sampleRate!==r.N_&&e.codecpar.frameSize!==r.N_&&e.codecpar.bitrate!==BigInt(0)||(t=!1);break;case 0:0!==(0,a.lb)(e.codecpar.framerate)&&e.codecpar.width!==r.N_&&e.codecpar.height!==r.N_&&e.codecpar.bitrate!==BigInt(0)||(t=!1),27!==e.codecpar.codecId&&173!==e.codecpar.codecId&&196!==e.codecpar.codecId&&12!==e.codecpar.codecId||e.codecpar.profile!==r.N_&&e.codecpar.level!==r.N_||(t=!1)}})),t}},61619:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(67672);function s(e,t=4){let i="";for(let s=0;s<t;s++)r.ai(e)?(i=String.fromCharCode(255&e)+i,e>>>=8):(i=String.fromCharCode(Number(e&BigInt(255)))+i,e>>=BigInt(8));return i}},55680:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(72739);function s(e){if(e.length<2)return 0;const t=e.slice().sort(((e,t)=>e>t?1:-1));let i=0,s=0,a=[];for(let n=0;n<e.length;n++){for(r._(a,e[n],(t=>t<e[n]?1:-1));a.length&&a[0]===t[s];)a.shift(),s++;i=Math.max(i,a.length)}return i}},89478:(e,t,i)=>{"use strict";function r(e,t){if(t.length<e)return t.slice().sort(((e,t)=>e>t?1:-1));const i=[],r=t.slice().sort(((e,t)=>e>t?1:-1));if(e){const t=r[r.length-1]-r[r.length-2];for(let s=e;s>0;s--)i.push((i.length?i[i.length-1]:BigInt(0))+(s>=r.length?t:r[s]-r[s-1]));i.reverse()}const s=[];for(let t=0;t<e;t++)s.push(r[0]-i[t]);return s.concat(r)}i.d(t,{A:()=>r})},65977:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(4624);const s="src/avformat/function/mktag.ts";function a(e){4!==e.length&&r.R8(`tag length is not 4, tag: ${e}`,s,30);let t=0;for(let i=0;i<4;i++)t=t<<8|e.charCodeAt(i);return t}},20841:(e,t,i)=>{"use strict";function r(e,t,i,r){const s=e.getPos(),a=e.getPointer(),n=s-BigInt(Math.floor(a));let o=!1;switch(t<s&&t>=n?(e.seekInline(a+Number(t-s)),o=!0):e.seek(t),r){case"uint8":e.writeUint8(255&i);break;case"int8":e.writeInt8(i);break;case"uint16":e.writeUint16(65535&i);break;case"int16":e.writeInt16(i);break;case"uint32":e.writeUint32(i>>>0);break;case"int32":e.writeInt32(i);break;case"uint64":e.writeUint64(BigInt.asUintN(64,i));break;case"int64":e.writeInt64(i);break;case"float":e.writeFloat(i);break;case"double":e.writeDouble(i)}o?e.seekInline(a):e.seek(s)}i.d(t,{A:()=>r})},31633:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(44328);const s=399;function a(e){return e<360?1001*(e+1):(e-=360)<30?1001*(e+31)*12:(e-=30)<3?1001*[80,120,240][e]*12:1e3*[24,30,60,12,15,48][e-=3]*12}function n(e){let t=0,i=.01;for(let n=0;n<s;n++){const s=Math.abs((0,r.lb)(e)/(0,r.lb)({num:a(n),den:12012})-1);s<i&&(i=s,t=a(n))}if(t){const i={num:t,den:12012};(0,r.iU)(i),e.num=i.num,e.den=i.den}}},92174:(e,t,i)=>{"use strict";i.d(t,{XA:()=>A,bX:()=>w,bx:()=>y,dJ:()=>b,ho:()=>v});var r=i(80662),s=i.n(r),a=i(63939),n=i(50932),o=i(95335),c=i(4624),l=i(51597),d=i(72739),h=i(9705),u=i(548),f=i(77231),p=i(43607);const m="src/avformat/mux.ts",g={zeroStart:!1,nonnegative:!1};function v(e,t={}){const i=o.X$({},g,t);e.ioWriter||c.h2("need ioWriter",m,58),e.oformat||c.h2("need oformat",m,61),e.options=i,e.privateData2={firstPts:new(s()),firstDts:new(s()),dtsPtsDelta:new(s())};let r=l.E[e.oformat.type];if(r)for(let t=0;t<e.streams.length;t++){const i=e.streams[t].codecpar.codecId,s=e.streams[t].codecpar.codecType;if(16===e.oformat.type){if(i<65536||i>69683)return c.z3(`format ${(0,u.L_)(e.oformat.type)} not support codecId ${(0,u.eG)(e.streams[t].codecpar.codecType,i)}`,m,80),h.r8}else if(2!==s&&4!==s&&!d.zy(r,i))return c.z3(`format ${(0,u.L_)(e.oformat.type)} not support codecId ${(0,u.eG)(e.streams[t].codecpar.codecType,i)}`,m,88),h.r8}return e.oformat.init(e)}function y(e){return e.oformat.writeHeader(e),0}function A(e,t){const i=e.privateData2;return i.firstDts.has(a.f[15](t+32))||i.firstDts.set(a.f[15](t+32),a.f[17](t+16)===f.Dh?BigInt(0):a.f[17](t+16)),i.firstPts.has(a.f[15](t+32))||(i.firstPts.set(a.f[15](t+32),a.f[17](t+8)===f.Dh?BigInt(0):a.f[17](t+8)),i.dtsPtsDelta.set(a.f[15](t+32),p.jk(i.firstDts.get(a.f[15](t+32)),i.firstPts.get(a.f[15](t+32))))),(e.options.zeroStart||e.options.nonnegative&&(i.firstDts.get(a.f[15](t+32))<0||i.firstPts.get(a.f[15](t+32))<0))&&(n.M[17](t+16,a.f[17](t+16)-i.dtsPtsDelta.get(a.f[15](t+32))),n.M[17](t+8,a.f[17](t+8)-i.dtsPtsDelta.get(a.f[15](t+32)))),e.oformat.writeAVPacket(e,t)}function b(e){return e.oformat.writeTrailer(e),0}function w(e){e.oformat.flush(e)}},49847:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});class r{constructor(){}get ext(){throw new Error("need implemented ext getter")}get flags(){return 0}get name(){return"CustomIOLoader."+Math.random()}get minBuffer(){return 4}write(e){throw new Error("need implemented write function")}}},77580:(e,t,i)=>{"use strict";i.d(t,{A:()=>u});var r=i(134),s=i(29967),a=i.n(s),n=i(13724),o=i(82800),c=i(95335),l=i(4624),d=i(9705);const h="src/avnetwork/ioLoader/FetchIOLoader.ts";class u extends o.A{constructor(e={}){super(e),(0,r.A)(this,"contentLength",void 0),(0,r.A)(this,"receivedLength",void 0),(0,r.A)(this,"info",void 0),(0,r.A)(this,"range",void 0),(0,r.A)(this,"startBytes",void 0),(0,r.A)(this,"endBytes",void 0),(0,r.A)(this,"eofIndex",void 0),(0,r.A)(this,"abortController",void 0),(0,r.A)(this,"reader",void 0),(0,r.A)(this,"buffers",void 0),(0,r.A)(this,"supportRange",void 0),(0,r.A)(this,"abortSleep_",void 0),(0,r.A)(this,"aborted",void 0)}async getTotalSize(e,t={}){var i,r,s;const n={method:e,headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};null!==(i=this.info.httpOptions)&&void 0!==i&&i.headers&&c.__(this.info.httpOptions.headers,((e,t)=>{n.headers[t]=e})),c.__(t,((e,t)=>{n.headers[t]=e})),null!==(r=this.info.httpOptions)&&void 0!==r&&r.credentials&&(n.credentials=this.info.httpOptions.credentials),null!==(s=this.info.httpOptions)&&void 0!==s&&s.referrerPolicy&&(n.referrerPolicy=this.info.httpOptions.referrerPolicy),"function"==typeof AbortController&&(this.abortController=new AbortController,n.signal=this.abortController.signal);try{const e=await fetch(this.info.url,n);if(e.ok&&e.status>=200&&e.status<=299){this.abortController&&(this.abortController.abort(),this.abortController=null);const t=e.headers.get("Accept-Ranges");t&&-1===t.indexOf("bytes")&&(this.supportRange=!1);const i=e.headers.get("Content-Range");if(i){const e=i.split("/")[1];if(e)return a()(e)}const r=e.headers.get("X-Content-Length")||e.headers.get("Content-Length");if(null!=r)return a()(r)}}catch(e){}return 0}async open(e,t={from:0,to:-1}){var i;if(this.info=e,this.range=t,this.range.to||(this.range.to=-1),this.range.from=Math.max(this.range.from,0),this.eofIndex<0&&(this.eofIndex=t.to),this.startBytes=0,this.endBytes=-1,this.receivedLength=0,this.buffers=[],this.supportRange=!0,this.aborted=!1,this.range&&!this.options.isLive&&(this.startBytes=null!==(i=this.range.from)&&void 0!==i?i:0),this.status=1,!this.options.isLive&&!this.options.disableSegment){let e=await this.getTotalSize("HEAD");e||(e=await this.getTotalSize("Get",{range:"bytes=0-1"})),e<=2&&(e=0),e?(this.contentLength=e,this.range.to<0&&(this.eofIndex=this.contentLength+this.range.to),this.supportRange&&(this.endBytes=Math.min(this.startBytes+this.options.preload-1,this.eofIndex))):this.endBytes=-1}return this.status=2,0}async openReader(){var e,t,i;const r={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};null!==(e=this.info.httpOptions)&&void 0!==e&&e.headers&&c.__(this.info.httpOptions.headers,((e,t)=>{r.headers[t]=e})),this.options.isLive||this.options.disableSegment||(r.headers.range=`bytes=${this.startBytes}-${this.endBytes>0?this.endBytes:""}`),null!==(t=this.info.httpOptions)&&void 0!==t&&t.credentials&&(r.credentials=this.info.httpOptions.credentials),null!==(i=this.info.httpOptions)&&void 0!==i&&i.referrerPolicy&&(r.referrerPolicy=this.info.httpOptions.referrerPolicy),this.abortController&&this.abortController.abort(),"function"==typeof AbortController&&(this.abortController=new AbortController,r.signal=this.abortController.signal);try{const e=await fetch(this.info.url,r);e.ok&&e.status>=200&&e.status<=299?this.reader=e.body.getReader():(this.status=3,l.h2(`FetchStreamLoader: Http code invalid, ${e.status} ${e.statusText}`,h,238))}catch(e){if(this.retryCount<this.options.retryCount&&(!this.options.isLive||!this.receivedLength)){if(this.retryCount++,this.status=1,this.abortSleep_=new n.A(this.options.retryInterval),await this.abortSleep_,this.abortSleep_=null,this.aborted)return;return this.openReader()}l.h2(`FetchStreamLoader: exception ${e.message}`,h,255)}}async readInterval(e,t=0){let i=0;for(;this.buffers.length&&i<e.length;){const t=this.buffers.shift();t.length>e.length-i?(e.set(t.subarray(0,e.length-i),i),this.buffers.unshift(t.subarray(e.length-i)),i=e.length):(e.set(t,i),i+=t.length)}if(i>=e.length)return e.length+t;if(4===this.status)return i>0?i+t:t>0?t:-1048576;if(!this.reader&&(await this.openReader(),this.aborted))return-1048576;const{value:r,done:s}=await this.reader.read();return s?null!==this.contentLength&&this.receivedLength+this.range.from<this.endBytes+1?(this.status=3,void l.h2("Fetch stream meet Early-EOF",h,297)):this.options.isLive||this.options.disableSegment||this.receivedLength+this.range.from>=this.eofIndex?(this.status=4,this.startBytes=0,i>0?i+t:t>0?t:-1048576):(await this.reader.cancel(),this.abortController&&(this.abortController.abort(),this.abortController=null),this.reader=null,this.startBytes=this.endBytes+1,this.endBytes=Math.min(this.startBytes+this.options.preload-1,this.eofIndex),this.readInterval(e.subarray(i,void 0,!0),i)):(this.receivedLength+=r.length,r.length>e.length-i?(e.set(r.subarray(0,e.length-i),i),this.buffers.push(r.subarray(e.length-i)),e.length+t):(e.set(r,i),i+=r.length,i+t))}async read(e){return this.readInterval(e)}async seek(e){return this.supportRange?(await this.abort(),this.aborted=!1,this.receivedLength=Number(e)-this.range.from,this.startBytes=Number(e),this.options.disableSegment||(this.endBytes=Math.min(this.startBytes+this.options.preload,this.eofIndex)),this.buffers.length=0,4===this.status&&(this.status=2),0):d.NU}async size(){return this.options.isLive?BigInt(0):BigInt(Math.floor(this.contentLength||0))}abortSleep(){this.aborted=!0,this.abortSleep_&&(this.abortSleep_.stop(),this.abortSleep_=null)}async abort(){this.abortSleep(),this.reader&&(await this.reader.cancel(),this.abortController&&(this.abortController.abort(),this.abortController=null),this.reader=null)}async stop(){this.status=0,await this.abort()}getUrl(){var e;return null===(e=this.info)||void 0===e?void 0:e.url}}},79686:(e,t,i)=>{"use strict";i.d(t,{A:()=>l});var r=i(134),s=i(54001),a=i.n(s),n=i(82800);const o=i(67672).Pc(Blob.prototype.arrayBuffer),c="function"==typeof FileReaderSync;class l extends n.A{constructor(...e){super(...e),(0,r.A)(this,"info",void 0),(0,r.A)(this,"range",void 0),(0,r.A)(this,"readPos",void 0),(0,r.A)(this,"endPos",void 0),(0,r.A)(this,"reader",void 0),(0,r.A)(this,"readerResolve",void 0)}async open(e,t={from:0,to:-1}){return this.info=e,this.range=t,this.readPos=0,this.endPos=this.info.file.size,t.from>0&&(this.readPos=t.from),t.to>0&&(this.endPos=t.to),this.status=2,0}readBufferByReaderSync(e){return this.reader||(this.reader=new FileReaderSync),this.reader.readAsArrayBuffer(this.info.file.slice(this.readPos,this.readPos+e))}async readBufferByReader(e){return this.reader||(this.reader=new FileReader,this.reader.onloadend=e=>{this.readerResolve&&this.readerResolve(e.target.result)}),new(a())((t=>{this.readerResolve=t,this.reader.readAsArrayBuffer(this.info.file.slice(this.readPos,this.readPos+e))}))}async read(e){if(this.readPos>=this.endPos)return this.status=4,-1048576;const t=Math.min(e.length,this.endPos-this.readPos);return c?e.set(new Uint8Array(this.readBufferByReaderSync(t)),0):o?e.set(new Uint8Array(await this.info.file.slice(this.readPos,this.readPos+t).arrayBuffer()),0):e.set(new Uint8Array(await this.readBufferByReader(t)),0),this.readPos+=t,this.readPos>=this.endPos&&(this.status=4),t}async seek(e){return this.readPos=Number(e),4===this.status&&(this.status=2),0}async size(){return BigInt(Math.floor(this.info.file.size))}async stop(){this.status=0}}},82800:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(134),s=i(95335);const a={isLive:!1,preload:5242880,retryCount:20,retryInterval:1};class n{constructor(e={}){(0,r.A)(this,"options",void 0),(0,r.A)(this,"status",void 0),(0,r.A)(this,"retryCount",void 0),(0,r.A)(this,"retryTimeout",void 0),this.options=e,this.status=0,this.retryCount=0,this.options=s.X$({},a),s.X$(this.options,e)}write(e){throw new Error("need implemented write function")}}},36773:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(134),s=i(54001),a=i.n(s),n=i(82800);class o extends n.A{constructor(e={}){super(e),(0,r.A)(this,"readQueue",void 0),(0,r.A)(this,"consume",void 0),this.readQueue=[]}async readInterval(e,t=0){let i=0;for(;this.readQueue.length&&i<e.length;){const t=this.readQueue.shift();t.length>e.length-i?(e.set(t.subarray(0,e.length-i),i),this.readQueue.unshift(t.subarray(e.length-i)),i=e.length):(e.set(t,i),i+=t.length)}return i>0||t?i+t:4===this.status||0===this.status?i>0?i+t:t>0?t:-1048576:3===this.status?i>0?i+t:t>0?t:-1048573:(await new(a())((e=>{this.consume=e})),this.consume=null,this.readInterval(e,t))}async read(e){return this.readInterval(e)}async write(e){return this.send(e)}}},14619:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(134),s=i(54001),a=i.n(s),n=i(36773);class o extends n.A{constructor(...e){super(...e),(0,r.A)(this,"info",void 0),(0,r.A)(this,"socket",void 0)}async send(e){return this.socket?(this.socket.send(e.slice()),0):-1048574}open(e){return this.info=e,this.status=1,new(a())((t=>{var i;this.socket=new WebSocket(e.url,null===(i=e.websocketOptions)||void 0===i?void 0:i.protocols),this.socket.binaryType="arraybuffer",this.socket.onopen=()=>{this.status=2,t(0)},this.socket.onerror=()=>{this.status=3,t(-1048573),this.consume&&this.consume()},this.socket.onmessage=e=>{let t=e.data;this.readQueue.push(new Uint8Array(t)),this.consume&&this.consume()}}))}seek(e,t){throw new Error("Method not implemented.")}size(){throw new Error("Method not implemented.")}async stop(){this.socket&&(this.socket.close(),this.socket=null),this.status=4,this.consume&&this.consume()}}},42383:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(134),s=i(54001),a=i.n(s),n=i(36773);class o extends n.A{constructor(...e){super(...e),(0,r.A)(this,"info",void 0),(0,r.A)(this,"transport",void 0),(0,r.A)(this,"datagramReader",void 0),(0,r.A)(this,"reader",void 0),(0,r.A)(this,"datagramWriter",void 0),(0,r.A)(this,"writer",void 0),(0,r.A)(this,"stream",void 0),(0,r.A)(this,"readPacketQueue",void 0),(0,r.A)(this,"consumePacket",void 0)}async send(e){return this.writer?(this.writer.write(e.slice()),0):-1048574}async handleRead(){let e=!1;for(;;)try{const{value:t,done:i}=await this.reader.read();if(i){e=i;break}this.readQueue.push(t)}catch(t){e||(this.status=3,this.consume&&this.consume());break}}async readDatagram(){let e=!1;for(;;)try{const{value:t,done:i}=await this.datagramReader.read();if(i){e=!0;break}this.readPacketQueue.push(t)}catch(t){e||(this.status=3,this.consumePacket&&this.consumePacket());break}}async open(e){return this.info=e,this.transport=new WebTransport(e.url,e.webtransportOptions),this.readPacketQueue=[],this.status=1,await this.transport.ready,this.transport.closed.then((()=>{this.transport?this.status=3:this.status=4})),this.status=2,this.stream=await this.transport.createBidirectionalStream(),this.reader=this.stream.readable.getReader(),this.writer=this.stream.writable.getWriter(),this.datagramReader=this.transport.datagrams.readable.getReader(),this.datagramWriter=this.transport.datagrams.writable.getWriter(),this.handleRead(),this.readDatagram(),0}async readPacket(e){for(;;){if(this.readPacketQueue.length){const t=this.readPacketQueue.shift();return e.set(t,0),t.length}if(4===this.status||0===this.status)return-1048576;if(3===this.status)return-1048573;await new(a())((e=>{this.consumePacket=e})),this.consumePacket=null}}async writePacket(e){return this.datagramWriter?(this.datagramWriter.write(e.slice()),0):-1048574}seek(e,t){throw new Error("Method not implemented.")}size(){throw new Error("Method not implemented.")}async stop(){this.transport&&(this.transport.close(),this.transport=null),this.status=4,this.consume&&this.consume()}}},18667:(e,t,i)=>{"use strict";i.d(t,{A:()=>P});var r=i(54001),s=i.n(r),a=i(63939),n=i(50932),o=i(12264),c=i(29170),l=i(44527),d=i(9705),h=i(84149),u=i(75742),f=i(4624),p=i(16041),m=(i(77162),i(77104)),g=i(84290),v=i(72739),y=i(86932),A=i(36204),b=i(94561),w=i(72703),x=i(71762),k=i(37837),T=i(71766),I=i(67672);const S="src/avpipeline/AudioDecodePipeline.ts";class P extends l.A{constructor(){super()}createWebcodecDecoder(e){return new m.A({onError:t=>{f.z3(`audio decode error, taskId: ${e.taskId}, error: ${t}`,S,91)},onReceiveAudioData(t){const i=(0,A.t)(t,e.avframePool.alloc());e.frameCaches.push(i),n.M[17](e.stats+56,a.f[17](e.stats+56)+BigInt(1)),n.M[15](e.stats+248,Math.max((0,y.A)()-e.lastDecodeTimestamp,a.f[15](e.stats+248))),t.close()}})}createWasmcodecDecoder(e,t){return new u.A({resource:t,onReceiveAVFrame(t){e.frameCaches.push(t),n.M[17](e.stats+56,a.f[17](e.stats+56)+BigInt(1)),n.M[15](e.stats+248,Math.max((0,y.A)()-e.lastDecodeTimestamp,a.f[15](e.stats+248)))},avframePool:e.avframePool})}async pullAVPacketInternal(e,t){const i=await t.request("pull");if(I.ai(i)||(0,w.A)(i))return i;{const t=e.avpacketPool.alloc();return(0,x.r0)(i,t),t}}async createTask(e){const t=new h.Ay(e.leftPort),i=new h.Ay(e.rightPort),r=[],s=new p.A((0,c.A)(e.avframeList,o.A),e.avframeListMutex),l={...e,resource:await(0,b.A)(e.resource),frameCaches:r,inputEnd:!1,decoder:null,parameters:0,lastDecodeTimestamp:0,avframePool:s,avpacketPool:new g.A((0,c.A)(e.avpacketList,o.A),e.avpacketListMutex)};return l.resource?l.decoder=this.createWasmcodecDecoder(l,l.resource):l.decoder=this.createWebcodecDecoder(l),this.tasks.set(e.taskId,l),i.on(h.S3,(async s=>{switch(s.method){case"pull":if(r.length){const e=r.shift();i.reply(s,e);break}if(!l.inputEnd){for(;;){if(r.length){const e=r.shift();i.reply(s,e);break}l.pending&&await l.pending,l.lastDecodeTimestamp=(0,y.A)();const o=await this.pullAVPacketInternal(l,t);if(-1048576===o){if(await l.decoder.flush(),l.inputEnd=!0,r.length){const e=r.shift();i.reply(s,e);break}f.pq(`audio decoder ended, taskId: ${l.taskId}`,S,198),i.reply(s,-1048576);break}if(!(o>0)){f.z3(`audio decode pull avpacket error, taskId: ${e.taskId}, ret: ${o}`,S,216),i.reply(s,o);break}{const t=l.decoder.decode(o);l.avpacketPool.release(o),t<0&&(n.M[15](l.stats+48,a.f[15](l.stats+48)+1),f.z3(`audio decode error, taskId: ${e.taskId}, ret: ${t}`,S,211))}}break}i.reply(s,-1048576)}})),0}async open(e,t,i={}){const r=this.tasks.get(e);if(r){r.wasmDecoderOptions=i;const e=(0,k.Gy)(168);return(0,w.A)(t)?(0,T.Yi)(e,t):(0,x.T8)(t,e),r.parameters&&(0,T.dn)(r.parameters),r.parameters=e,new(s())((async(t,i)=>{const s=await r.decoder.open(e,r.wasmDecoderOptions);if(s)return f.z3(`open audio decoder failed, error: ${s}`,S,250),void t(d.r8);t(0)}))}f.h2("task not found",S,257)}async beforeReopenDecoder(e){const t=this.tasks.get(e);t?t.pending=new(s())((e=>{t.pendingResolve=e})):f.h2("task not found",S,268)}async reopenDecoder(e,t,i,r){const a=this.tasks.get(e);if(a){r&&(a.wasmDecoderOptions=r);const e=(0,k.Gy)(168);let n;return(0,w.A)(t)?(0,T.Yi)(e,t):(0,x.T8)(t,e),a.parameters&&(0,T.dn)(a.parameters),a.parameters=e,i?(i=await(0,b.A)(i),n=this.createWasmcodecDecoder(a,i)):n=this.createWebcodecDecoder(a),new(s())((async(t,r)=>{const s=await n.open(e);if(s)return f.z3(`reopen audio decoder failed, error: ${s}`,S,305),void t(d.r8);i&&(a.resource=i),a.decoder.close(),a.decoder=n,f.Yz(`reopen audio decoder, taskId: ${a.taskId}`,S,315),t(0),a.pendingResolve&&(a.pendingResolve(),a.pending=null)}))}f.h2("task not found",S,323)}async resetTask(e){const t=this.tasks.get(e);t&&(t.decoder&&await t.decoder.flush(),v.__(t.frameCaches,(e=>{t.avframePool.release(e)})),t.frameCaches.length=0,t.inputEnd=!1,t.lastDecodeTimestamp=(0,y.A)(),f.pq(`reset audio decoder, taskId: ${t.taskId}`,S,339))}async registerTask(e){return this.tasks.has(e.taskId)?d.lh:this.createTask(e)}async unregisterTask(e){const t=this.tasks.get(e);t&&(t.rightPort.close(),t.leftPort.close(),t.decoder.close(),t.frameCaches.forEach((e=>{t.avframePool.release(e)})),t.parameters&&(0,T.dn)(t.parameters),this.tasks.delete(e),f.Yz(`unregisterTask task, taskId: ${e}`,S,363))}}},59377:(e,t,i)=>{"use strict";i.d(t,{A:()=>F});var r=i(134),s=i(80662),a=i.n(s),n=i(54001),o=i.n(n),c=i(61499),l=i(12264),d=i(74503),h=i(73783),u=i(29170),f=i(63939),p=(i(9599),i(50932)),m=i(94300),g=i(10278),v=i(44527),y=i(9705),A=i(84149),b=i(4624),w=i(16041),x=i(92246),k=i(47442),T=i(37837),I=i(70089),S=i(14686),P=i(44328),_=i(77231),M=i(86932),C=i(13724),B=i(43607),E=i(94561),D=i(47222),R=i(39638),U=i(74936);const L="src/avpipeline/AudioRenderPipeline.ts",$=BigInt(400);class F extends v.A{constructor(){super(),(0,r.A)(this,"avPCMBufferPool",void 0),(0,r.A)(this,"avPCMBufferList",void 0),(0,r.A)(this,"avPCMBufferListMutex",void 0),this.avPCMBufferList=(0,d.A)(l.A),this.avPCMBufferListMutex=(0,d.A)(h.eu),this.avPCMBufferPool=new k.A(this.avPCMBufferList,this.avPCMBufferListMutex[c.o9])}async createTask(e){const t=new A.Ay(e.leftPort),i=new A.Ay(e.rightPort),r=new A.Ay(e.controlPort),s={...e,leftIPCPort:t,rightIPCPort:i,controlIPCPort:r,resamplerResource:await(0,E.A)(e.resamplerResource),stretchpitcherResource:await(0,E.A)(e.stretchpitcherResource),resampler:null,stretchpitcher:new(a()),outPCMBuffer:null,waitPCMBuffer:0,waitAVFrame:0,waitPCMBufferPos:0,ended:!1,stretchpitcherEnded:!1,playRate:1,playTempo:1,playPitch:1,useStretchpitcher:!1,lastNotifyPTS:BigInt(0),currentPTS:_.Dh,lastMasterPts:_.Dh,masterTimer:new U.A,firstPlayed:!1,seeking:!1,pausing:!1,stopping:!1,seekSync:null,receivePCMSync:null,paddingAVFrame:0,fakePlayStartTimestamp:0,fakePlaySamples:BigInt(0),fakePlayTimer:null,fakePlayWorkerTimer:null,fakePlay:!1,lastRenderTimestamp:0,avframePool:new w.A((0,u.A)(e.avframeList,l.A),e.avframeListMutex)};for(let t=0;t<e.playChannels;t++){const i=new I.A({resource:s.stretchpitcherResource});s.stretchpitcher.set(t,i),await i.open({sampleRate:e.playSampleRate,channels:1}),i.setTempo(s.playTempo),i.setPitch(s.playPitch),i.setRate(s.playRate)}const n=async()=>{let e;if(s.paddingAVFrame?(e=s.paddingAVFrame,s.paddingAVFrame=0):e=await s.leftIPCPort.request("pull"),-1048576===e){for(let e=0;e<s.playChannels;e++)s.stretchpitcher.get(e).flush();return b.pq(`audio render ended, taskId: ${s.taskId}`,L,214),-1048576}if(e<0)return b.z3(`pull audio frame failed, taskId: ${s.taskId}`,L,218),e;{if(1!==s.playRate||1!==s.playTempo||1!==s.playPitch||s.enableJitterBuffer?s.useStretchpitcher=!0:s.useStretchpitcher=!1,!s.firstPlayed){const t=(0,P.Mr)(f.f[17](e+104),e+120,_.i0);s.firstPlayed=!0,b.Yz(`got first audio frame, pts: ${f.f[17](e+104)}(${t}ms), taskId: ${s.taskId}`,L,240)}const t=(0,P.Mr)(f.f[17](e+104),e+120,_.i0);(t>BigInt(0)&&s.masterTimer.getMasterTime()-t>$||s.isLive&&t-s.currentPTS>BigInt(4e3))&&s.masterTimer.setMasterTime(t),s.currentPTS=t,p.M[17](s.stats+72,f.f[17](s.stats+72)+BigInt(1)),p.M[17](s.stats+344,t),s.lastRenderTimestamp&&p.M[15](s.stats+252,Math.max((0,M.A)()-s.lastRenderTimestamp,f.f[15](s.stats+252))),s.lastRenderTimestamp=(0,M.A)();let i=!0;if(f.f[15](e+152)!==s.playSampleRate||f.f[15](e+80)!==s.playFormat||f.f[15](e+292)!==s.playChannels){if(s.resampler){const t=s.resampler.getInputPCMParameters();t.format===f.f[15](e+80)&&t.sampleRate===f.f[15](e+152)&&t.channels===f.f[15](e+292)||(s.resampler.close(),s.resampler=null)}s.resampler||(s.resampler=new x.A({resource:s.resamplerResource}),await s.resampler.open({sampleRate:f.f[15](e+152),format:f.f[15](e+80),channels:f.f[15](e+292)},{sampleRate:s.playSampleRate,format:s.playFormat,channels:s.playChannels}));let t=this.avPCMBufferPool.alloc(),i=s.resampler.resample(f.f[20](e+64),t,f.f[15](e+76));if(i<0)return b.z3(`resample error, ret: ${i}, taskId: ${s.taskId}`,L,300),this.avPCMBufferPool.release(t),i;if(s.useStretchpitcher){for(let e=0;e<s.playChannels;e++)s.stretchpitcher.get(e).sendSamples(f.f[20](f.f[20](t)+4*e),f.f[15](t+8));this.avPCMBufferPool.release(t)}else s.waitPCMBuffer=t,s.waitPCMBufferPos=0}else if(s.useStretchpitcher)for(let t=0;t<s.playChannels;t++)s.stretchpitcher.get(t).sendSamples(f.f[20](f.f[20](e+64)+4*t),f.f[15](e+76));else{let t=this.avPCMBufferPool.alloc();f.f[20](t)&&((0,T.aI)(f.f[20](t)),(0,T.aI)(t)),p.M[15](t+8,f.f[15](e+76)),p.M[15](t+12,f.f[15](e+76)),p.M[15](t+20,f.f[15](e+152)),p.M[15](t+16,f.f[15](e+292)),p.M[20](t,f.f[20](e+64)),s.waitAVFrame=e,s.waitPCMBuffer=t,s.waitPCMBufferPos=0,i=!1}p.M[15](s.stats+4,f.f[15](e+152)),p.M[15](s.stats,f.f[15](e+292)),p.M[15](s.stats+8,f.f[15](e+76)),i&&s.avframePool.release(e)}return 0},h=async e=>{let t=0;if(s.seeking&&(await new(o())((e=>{s.receivePCMSync=e})),s.stopping))return-1048576;if(s.enableJitterBuffer&&f.f[15](s.stats+32)/f.f[15](s.stats+244)*1e3<=f.f[15](s.stats+280)&&this.setPlayRate(s.taskId,1),s.ended&&s.useStretchpitcher){let i=0;for(let r=0;r<s.playChannels;r++){const a=s.stretchpitcher.get(r);f.f[20](f.f[20](e)+4*r)&&(i=a.receiveSamples(f.f[20](f.f[20](e)+4*r)+4*t,f.f[15](e+12)-t))}if(t+i<f.f[15](e+12)){s.stretchpitcherEnded=!0;for(let i=0;i<s.playChannels;i++)(0,S.sO)(f.f[20](f.f[20](e)+4*i)+t,0,4*(f.f[15](e+12)-t))}return p.M[15](e+8,t),0}for(;t<f.f[15](e+12);){let i=0;if(s.useStretchpitcher)for(let r=0;r<s.playChannels;r++){const a=s.stretchpitcher.get(r);f.f[20](f.f[20](e)+4*r)&&(i=a.receiveSamples(f.f[20](f.f[20](e)+4*r)+4*t,f.f[15](e+12)-t))}else if(s.waitPCMBuffer){if(i=Math.min(f.f[15](s.waitPCMBuffer+8)-s.waitPCMBufferPos,f.f[15](e+12)-t),i){for(let r=0;r<s.playChannels;r++)(0,S.Mr)(f.f[20](f.f[20](e)+4*r)+4*t,f.f[20](f.f[20](s.waitPCMBuffer)+4*r)+4*s.waitPCMBufferPos,4*i);s.waitPCMBufferPos+=i}f.f[15](s.waitPCMBuffer+8)===s.waitPCMBufferPos&&(s.waitAVFrame&&(p.M[20](s.waitPCMBuffer,0),p.M[15](s.waitPCMBuffer+12,0),s.avframePool.release(s.waitAVFrame),s.waitAVFrame=0),this.avPCMBufferPool.release(s.waitPCMBuffer),s.waitPCMBuffer=0)}if(t+=i,t<f.f[15](e+12)){let i=await n();if(-1048576===i){if(s.ended=!0,s.useStretchpitcher){for(let r=0;r<s.playChannels;r++){const a=s.stretchpitcher.get(r);f.f[20](f.f[20](e)+4*r)&&(a.flush(),i=a.receiveSamples(f.f[20](f.f[20](e)+4*r)+4*t,f.f[15](e+12)-t))}if(t+i<f.f[15](e+12)){s.stretchpitcherEnded=!0;for(let i=0;i<s.playChannels;i++)(0,S.sO)(f.f[20](f.f[20](e)+4*i)+t,0,4*(f.f[15](e+12)-t))}t+=i}break}if(i<0)return i}}return p.M[15](e+8,t),s.seekSync&&(s.seekSync(),s.seekSync=null),0};return i.on(A.S3,(async e=>{switch(e.method){case"pull":{if(s.fakePlay&&(s.fakePlay=!1,this.clearFakePlayTimer(s),s.fakePlaySamples=BigInt(0),s.fakePlayStartTimestamp=0),s.ended&&(s.stretchpitcherEnded||!s.useStretchpitcher))return void i.reply(e,-1048576);const t=e.params.buffer;if(!s.firstPlayed){s.masterTimer.setMasterTime(s.lastMasterPts===_.Dh?s.startPTS:s.lastMasterPts),s.lastMasterPts=_.Dh;let t=await n();if(t<0){i.reply(e,t);break}}if(s.currentPTS-s.masterTimer.getMasterTime()>$){(0,S.sO)(f.f[20](f.f[20](t)),0,4*f.f[15](t+12)*f.f[15](t+16)),i.reply(e,0),this.fakeSyncPts(s);break}this.syncPts(s,f.f[15](t+12));const r=await h(t);i.reply(e,r);break}case"pullBuffer":{if(s.fakePlay&&(s.fakePlay=!1,this.clearFakePlayTimer(s),s.fakePlaySamples=BigInt(0),s.fakePlayStartTimestamp=0),s.ended&&(s.stretchpitcherEnded||!s.useStretchpitcher))return void i.reply(e,-1048576);const t=e.params.nbSamples;if(!s.outPCMBuffer||s.outPCMBuffer.maxnbSamples!==t){s.outPCMBuffer&&((0,T.aI)(s.outPCMBuffer.data),(0,T.aI)(s.outPCMBuffer[c.o9]),(0,m.A)(s.outPCMBuffer)),s.outPCMBuffer=(0,d.A)(g.A),s.outPCMBuffer.data=(0,T.sY)(4*s.playChannels);const e=(0,T.Gy)(4*t*s.playChannels);for(let i=0;i<s.playChannels;i++)p.M[20](s.outPCMBuffer.data+4*i,e+4*t*i);s.outPCMBuffer.maxnbSamples=t}if(!s.firstPlayed){s.masterTimer.setMasterTime(s.lastMasterPts===_.Dh?s.startPTS:s.lastMasterPts),s.lastMasterPts=_.Dh;let t=await n();if(t<0){i.reply(e,t);break}}if(s.currentPTS-s.masterTimer.getMasterTime()>$){const t=new Uint8Array(4*s.outPCMBuffer.nbSamples*s.playChannels);i.reply(e,t.buffer,null,[t.buffer]),this.fakeSyncPts(s);break}this.syncPts(s,s.outPCMBuffer.maxnbSamples);const r=await h(s.outPCMBuffer[c.o9]);if(r<0)return void i.reply(e,r);const a=(0,S.s3)(f.f[20](s.outPCMBuffer.data),4*s.outPCMBuffer.nbSamples*s.playChannels).slice();i.reply(e,a.buffer,null,[a.buffer]);break}}})),this.tasks.set(e.taskId,s),0}checkUseStretchpitcher(e){const t=1!==e.playRate||1!==e.playTempo||1!==e.playPitch||e.enableJitterBuffer;if(e.useStretchpitcher&&!t)for(let t=0;t<e.playChannels;t++)e.stretchpitcher.get(t).flush()}setPlayRate(e,t){const i=this.tasks.get(e);if(i){i.enableJitterBuffer&&f.f[15](i.stats+32)/f.f[15](i.stats+244)*1e3<=f.f[15](i.stats+280)&&(t=1),i.playRate=t;for(let e=0;e<i.playChannels;e++)i.stretchpitcher.get(e).setRate(t);this.checkUseStretchpitcher(i),i.masterTimer.setRate(i.playRate*i.playTempo),i.fakePlay&&(i.fakePlayStartTimestamp=(0,M.A)(),i.fakePlaySamples=BigInt(0))}}async setPlayTempo(e,t){const i=this.tasks.get(e);if(i){i.playTempo=t;for(let e=0;e<i.playChannels;e++)i.stretchpitcher.get(e).setTempo(t);this.checkUseStretchpitcher(i),i.masterTimer.setRate(i.playRate*i.playTempo),i.fakePlay&&(i.fakePlayStartTimestamp=(0,M.A)(),i.fakePlaySamples=BigInt(0))}}setPlayPitch(e,t){const i=this.tasks.get(e);if(i){i.playPitch=t;for(let e=0;e<i.playChannels;e++)i.stretchpitcher.get(e).setPitch(t);this.checkUseStretchpitcher(i)}}async beforeSeek(e){const t=this.tasks.get(e);if(t){if(t.fakePlay||t.pausing?this.clearFakePlayTimer(t):(b.Yz(`wait current pull front frame before seek, taskId: ${t.taskId}`,L,676),await new(o())((e=>{t.seekSync=e}))),t.seeking=!0,t.stretchpitcher.size)for(const e of t.stretchpitcher.keys())t.stretchpitcher.get(e).clear();t.waitPCMBuffer&&(t.waitAVFrame&&(p.M[20](t.waitPCMBuffer,0),p.M[15](t.waitPCMBuffer+12,0),t.avframePool.release(t.waitAVFrame),t.waitAVFrame=0),this.avPCMBufferPool.release(t.waitPCMBuffer),t.waitPCMBuffer=0),b.Yz(`before seek end, taskId: ${t.taskId}`,L,704)}}async syncSeekTime(e,t,i){const r=this.tasks.get(e);if(r){let s=!1;for(;;){if(!r.leftIPCPort)return r.ended=!0,void b.R8(`pull audio frame end after unregisterTask, taskId: ${e}`,L,718);let a=(0,M.A)(),n=f.f[15](r.stats+120);for(;!s&&i&&f.f[15](r.stats+120)>i;)await new C.A(0),(0,M.A)()-a>200&&n===f.f[15](r.stats+120)&&(s=!0),n!==f.f[15](r.stats+120)&&(n=f.f[15](r.stats+120),a=(0,M.A)());let o=await r.leftIPCPort.request("pull");if(o<0){b.R8(`pull audio frame end after seek, taskId: ${e}`,L,740),r.ended=!0;break}if(t<BigInt(0)){b.pq(`use the first audio frame because of the seek time${t} < 0`,L,746);break}const c=(0,P.Mr)(f.f[17](o+104),o+120,_.i0);if(c>=t){r.paddingAVFrame=o,r.ended=!1,r.lastNotifyPTS=c,p.M[17](r.stats+328,c),r.currentPTS=c,r.masterTimer.setMasterTime(t),r.lastMasterPts=t;break}r.avframePool.release(o)}b.Yz(`sync seek time end, taskId: ${r.taskId}`,L,774)}}async afterSeek(e,t){const i=this.tasks.get(e);i&&(i.seeking=!1,i.receivePCMSync&&(i.receivePCMSync(),i.receivePCMSync=null),i.pausing||(i.fakePlay&&(i.fakePlayStartTimestamp=(0,M.A)(),i.fakePlaySamples=BigInt(0),this.fakePlayNext(i)),i.lastRenderTimestamp=(0,M.A)()),b.Yz(`after seek end, taskId: ${i.taskId}`,L,796))}async restart(e){const t=this.tasks.get(e);if(t){var i;if(t.lastNotifyPTS=BigInt(0),t.ended=!1,t.firstPlayed=!1,t.stretchpitcherEnded=!1,null!==(i=t.stretchpitcher)&&void 0!==i&&i.size)for(let e=0;e<t.playChannels;e++){var r;null===(r=t.stretchpitcher.get(e))||void 0===r||r.clear()}this.clearFakePlayTimer(t),t.fakePlaySamples=BigInt(0),t.fakePlayStartTimestamp=0,t.lastRenderTimestamp=(0,M.A)(),t.masterTimer.setMasterTime(t.startPTS),b.Yz(`restart task, taskId: ${t.taskId}`,L,818)}}async setMasterTime(e,t){const i=this.tasks.get(e);i&&i.masterTimer.setMasterTime(t)}fakeSyncPts(e){const t=e.masterTimer.getMasterTime();t-e.lastNotifyPTS>=BigInt(1e3)&&(e.lastNotifyPTS=t,p.M[17](e.stats+328,t),e.controlIPCPort.notify("syncPts",{pts:t}))}syncPts(e,t){const i=((e.useStretchpitcher?e.stretchpitcher.get(0).getLatency():0)+(3*t>>>1))/e.playSampleRate*1e3>>>0,r=B.T9(e.currentPTS-BigInt(Math.floor(i)),BigInt(0));p.M[17](e.stats+328,r),e.currentPTS-e.lastNotifyPTS>=BigInt(1e3)&&(e.lastNotifyPTS=e.currentPTS,e.controlIPCPort.notify("syncPts",{pts:r}))}clearFakePlayTimer(e){e.fakePlayTimer&&(e.fakePlayWorkerTimer?(e.fakePlayWorkerTimer.clearTimeout(e.fakePlayTimer),e.fakePlayWorkerTimer.destroy(),e.fakePlayWorkerTimer=null):clearTimeout(e.fakePlayTimer),e.fakePlayTimer=null)}setFakePlayTimer(e,t,i){return(0,R.A)()?setTimeout(t,i):(e.fakePlayWorkerTimer||(e.fakePlayWorkerTimer=new D.A),e.fakePlayWorkerTimer.setTimeout(t,i))}async fakePlayNext(e){const t=e.paddingAVFrame||await e.leftIPCPort.request("pull");if(e.paddingAVFrame=0,t<0)return e.ended=!0,b.pq(`audio fake render ended, taskId: ${e.taskId}`,L,889),void e.controlIPCPort.notify("ended");if(!e.fakePlay||e.pausing)return void e.avframePool.release(t);let i=f.f[15](t+76)/f.f[15](t+152)*1e3>>>0;i/=e.playRate*e.playTempo;const r=(0,P.Mr)(f.f[17](t+104),t+120,_.i0);if((r>BigInt(0)&&e.masterTimer.getMasterTime()-r>$||e.isLive&&r-e.currentPTS>BigInt(4e3))&&e.masterTimer.setMasterTime(r),e.currentPTS=r,e.currentPTS-e.masterTimer.getMasterTime()>$)return e.paddingAVFrame=t,this.fakeSyncPts(e),void(e.fakePlayTimer=this.setFakePlayTimer(e,(()=>{e.fakePlayTimer=null,this.fakePlayNext(e)}),i));this.syncPts(e,0);let s=BigInt(Math.floor((0,M.A)()-e.fakePlayStartTimestamp))*BigInt(0|f.f[15](t+152))/BigInt(1e3);s=s*BigInt(Math.floor(e.playRate*e.playTempo*100))/BigInt(100),i-=Number(s-e.fakePlaySamples)/f.f[15](t+152)*1e3>>>0,e.fakePlaySamples+=BigInt(0|f.f[15](t+76)),e.avframePool.release(t),e.currentPTS-e.lastNotifyPTS>=BigInt(1e3)&&(e.lastNotifyPTS=e.currentPTS,p.M[17](e.stats+328,e.currentPTS),e.controlIPCPort.notify("syncPts",{pts:e.currentPTS})),e.fakePlayTimer=this.setFakePlayTimer(e,(()=>{e.fakePlayTimer=null,this.fakePlayNext(e)}),i)}async fakePlay(e){const t=this.tasks.get(e);t&&(t.fakePlayStartTimestamp=(0,M.A)(),t.fakePlay=!0,t.fakePlaySamples=BigInt(0),this.fakePlayNext(t),b.pq(`start fake play, taskId: ${t.taskId}`,L,959))}async pause(e){const t=this.tasks.get(e);t&&(t.pausing=!0,t.lastMasterPts=t.masterTimer.getMasterTime(),t.fakePlay&&this.clearFakePlayTimer(t),b.pq(`task paused, taskId: ${t.taskId}`,L,972))}async unpause(e){const t=this.tasks.get(e);t&&(t.pausing=!1,t.masterTimer.setMasterTime(t.lastMasterPts),t.lastMasterPts=_.Dh,t.fakePlay&&(t.fakePlayStartTimestamp=(0,M.A)(),t.fakePlaySamples=BigInt(0),t.lastRenderTimestamp=(0,M.A)(),this.fakePlayNext(t)),b.pq(`task unpaused, taskId: ${t.taskId}`,L,989))}async stop(e){const t=this.tasks.get(e);t&&(t.stopping=!0,t.receivePCMSync&&(t.receivePCMSync(),t.receivePCMSync=null),b.pq(`task stopping, taskId: ${t.taskId}`,L,1001))}async registerTask(e){return this.tasks.has(e.taskId)?y.lh:this.createTask(e)}async unregisterTask(e){const t=this.tasks.get(e);if(t){if(this.clearFakePlayTimer(t),t.resampler&&t.resampler.close(),t.stretchpitcher.size){for(const e of t.stretchpitcher.keys())t.stretchpitcher.get(e).close();t.stretchpitcher.clear()}t.outPCMBuffer&&((0,T.aI)(t.outPCMBuffer.data),(0,T.aI)(t.outPCMBuffer[c.o9]),(0,m.A)(t.outPCMBuffer)),t.waitPCMBuffer&&(t.waitAVFrame&&(p.M[20](t.waitPCMBuffer,0),p.M[15](t.waitPCMBuffer+12,0),t.avframePool.release(t.waitAVFrame),t.waitAVFrame=0),this.avPCMBufferPool.release(t.waitPCMBuffer),t.waitPCMBuffer=0),t.paddingAVFrame&&t.avframePool.release(t.paddingAVFrame),t.leftIPCPort&&(t.leftIPCPort.destroy(),t.leftIPCPort=null),t.rightIPCPort&&(t.rightIPCPort.destroy(),t.rightIPCPort=null),t.controlIPCPort&&(t.controlIPCPort.destroy(),t.controlIPCPort=null),this.tasks.delete(e),b.Yz(`unregisterTask task, taskId: ${e}`,L,1058)}}async clear(){await super.clear(),this.avPCMBufferList.clear((e=>{f.f[20](e)&&((0,T.aI)(f.f[20](e)),(0,T.aI)(e))}),20),(0,m.A)(this.avPCMBufferList),(0,m.A)(this.avPCMBufferListMutex)}}},72480:(e,t,i)=>{"use strict";i.d(t,{A:()=>z});var r=i(80662),s=i.n(r),a=i(61499),n=i(12264),o=i(29170),c=i(63939),l=i(50932),d=(i(9599),i(44527)),h=i(9705),u=i(84149),f=i(44315),p=i(24175),m=i(34531),g=i(75),v=i(37837),y=i(79630),A=i(4624),b=i(84290),w=i(39148),x=i(72739),k=i(44328),T=i(77231),I=i(43607),S=i(71517),P=i(14686),_=i(49032),M=i(94561),C=i(39638),B=i(26429),E=i(71762),D=i(72703),R=i(67672),U=i(62815),L=i(67659),$=i(59166),F=i(95797);const O="src/avpipeline/DemuxPipeline.ts",N=-1;class z extends d.A{constructor(){super()}createTask(e){let t,i;if(e.mainTaskId){const r=this.tasks.get(e.mainTaskId);t=r.leftIPCPort,i=r.controlIPCPort}else t=new u.Ay(e.leftPort),e.controlPort&&(i=new u.Ay(e.controlPort));const r=e.bufferLength||1048576,a=(0,v.sY)(r);if(!a)return h.gR;const c=(0,v.sY)(r);if(!c)return h.gR;const l=new y.A(a,r),d=new p.A(r,!0,l),g=new y.A(c,r),A=new m.A(r,!0,g);e.isLive||(d.flags|=1),e.flags&&(d.flags|=e.flags),d.onFlush=async i=>{const r={pointer:i.byteOffset,length:i.length};e.ioloaderOptions&&(r.ioloaderOptions=e.ioloaderOptions);try{const e=await t.request("read",r);return R.ai(e)?e:((0,P.lW)(r.pointer,e.length,e),e.length)}catch(e){return-1048574}},d.onSeek=async i=>{try{const r={pos:i};return e.ioloaderOptions&&(r.ioloaderOptions=e.ioloaderOptions),t.request("seek",r)}catch(e){return-1048574}},d.onSize=async()=>{try{return t.request("size")}catch(e){return BigInt(-1048574)}},A.onFlush=async e=>{const i={pointer:e.byteOffset,length:e.length};try{return await t.request("write",i)}catch(e){return-1048574}};const w=(0,f.Xv)();return w.ioReader=d,w.ioWriter=A,F.A.wasmBaseSupported&&(w.getDecoderResource=async(e,t)=>{if(!i)return;const r=await i.request("getDecoderResource",{codecId:t,mediaType:e});return(0,M.A)(r,0===e)}),this.tasks.set(e.taskId,{...e,leftIPCPort:t,rightIPCPorts:new(s()),controlIPCPort:i,formatContext:w,ioReader:d,iBuffer:a,oBuffer:c,cacheAVPackets:new(s()),cacheRequests:new(s()),streamIndexFlush:new(s()),pendingAVPackets:new(s()),realFormat:-1,demuxEnded:!1,loop:null,gopCounter:0,lastKeyFramePts:BigInt(0),lastAudioDts:BigInt(0),lastVideoDts:BigInt(0),avpacketPool:new b.A((0,o.A)(e.avpacketList,n.A),e.avpacketListMutex)}),0}async openStream(e,t=3e3){const r=this.tasks.get(e);if(r){let e,s,a=await r.leftIPCPort.request("open");if(a<0)return A.z3(`open ioloader failed, ret: ${a}`,O,300),a;try{6!==r.format?(e=await(0,_.A)(r.ioReader,r.format),r.format=e):e=r.format}catch(e){return h.LR}switch(e){case 0:s=new((await Promise.all([i.e(171),i.e(969)]).then(i.bind(i,28773))).default)(r.formatOptions);break;case 1:s=new((await i.e(531).then(i.bind(i,92047))).default)(r.formatOptions);break;case 2:s=new((await Promise.all([i.e(217),i.e(331)]).then(i.bind(i,59331))).default);break;case 3:s=new((await Promise.all([i.e(217),i.e(855)]).then(i.bind(i,83855))).default);break;case 5:s=new((await i.e(634).then(i.bind(i,16634))).default);break;case 4:s=new((await Promise.all([i.e(904),i.e(118)]).then(i.bind(i,29118))).default);break;case 14:s=new((await i.e(839).then(i.bind(i,6839))).default);break;case 8:case 9:s=new((await i.e(941).then(i.bind(i,34577))).default);break;case 15:s=new((await i.e(94).then(i.bind(i,47094))).default);break;case 17:s=new((await Promise.all([i.e(904),i.e(453)]).then(i.bind(i,18453))).default);break;case 16:s=new((await Promise.all([i.e(897),i.e(791)]).then(i.bind(i,3791))).default);break;case 18:s=new((await i.e(611).then(i.bind(i,85611))).default);break;case 19:s=new((await i.e(70).then(i.bind(i,78070))).default);break;case 20:s=new((await i.e(344).then(i.bind(i,47344))).default);break;case 21:s=new((await i.e(854).then(i.bind(i,98854))).default);break;case 11:s=new((await i.e(299).then(i.bind(i,5299))).default)(r.formatOptions);break;case 12:s=new((await i.e(487).then(i.bind(i,85487))).default)(r.formatOptions);break;case 13:s=new((await i.e(808).then(i.bind(i,95808))).default)(r.formatOptions);break;case 6:s=new((await i.e(522).then(i.bind(i,50522))).default)(r.formatOptions);break;case 10:s=new((await Promise.all([i.e(897),i.e(527)]).then(i.bind(i,96635))).default)(r.formatOptions);break;default:return A.z3("format not support",O,503),h.E$}return r.realFormat=e,r.formatContext.iformat=s,g.ho(r.formatContext,{maxAnalyzeDuration:t,fastOpen:r.isLive})}A.h2("task not found",O,518)}async getFormat(e){const t=this.tasks.get(e);if(t)return t.realFormat;A.h2("task not found",O,528)}async analyzeStreams(e){const t=this.tasks.get(e);if(t){let e=await g.Ib(t.formatContext);if(e)return e;const i=[];for(let e=0;e<t.formatContext.streams.length;e++){const r=t.formatContext.streams[e];i.push({index:r.index,id:r.id,codecpar:r.codecpar[a.o9],nbFrames:r.nbFrames,metadata:r.metadata,duration:r.duration,startTime:r.startTime,disposition:r.disposition,timeBase:{den:r.timeBase.den,num:r.timeBase.num}})}return{metadata:t.formatContext.metadata,format:t.realFormat,chapters:t.formatContext.chapters,streams:i}}A.h2("task not found",O,568)}replyAVPacket(e,t,i,r){if((0,C.A)()&&!B.USE_THREADS&&(0,D.A)(r)){const s=(0,E.wm)(r),a=[s.data.buffer];return s.sideData.length&&s.sideData.forEach((e=>{a.push(e.data.buffer)})),t.reply(i,s,null,a),void e.avpacketPool.release(r)}t.reply(i,r)}async connectStreamTask(e,t,i){const r=this.tasks.get(e);if(r){const e=new u.Ay(i);r.cacheAVPackets.set(t,[]),e.streamIndex=t,e.on(u.S3,(async t=>{switch(t.method){case"pull":{const i=r.cacheAVPackets.get(e.streamIndex);if(i.length){const s=i.shift();0!==r.stats&&(1===r.formatContext.streams[c.f[15](s+32)].codecpar.codecType?l.M[15](r.stats+32,c.f[15](r.stats+32)-1):0===r.formatContext.streams[c.f[15](s+32)].codecpar.codecType&&l.M[15](r.stats+120,c.f[15](r.stats+120)-1)),this.replyAVPacket(r,e,t,s)}else r.demuxEnded?e.reply(t,-1048576):(r.cacheRequests.set(e.streamIndex,t),r.loop&&r.loop.isStarted()&&r.loop.resetInterval());break}}})),r.rightIPCPorts.set(t,e),A.Yz(`connect stream ${t}, taskId: ${r.taskId}`,O,629)}else A.h2("task not found",O,632)}async addPendingStream(e,t){const i=this.tasks.get(e);i?i.pendingAVPackets.set(t,[]):A.h2("task not found",O,642)}async changeConnectStream(e,t,i,r=!0,s=!1){const a=this.tasks.get(e);if(a){if(t===i)return;let e=a.cacheAVPackets.get(i);const n=a.rightIPCPorts.get(i),o=a.cacheRequests.get(i);e||A.R8(`oldStreamIndex ${i} not found`,O,659),await a.loop.stopBeforeNextTick(),r?a.pendingAVPackets.has(t)||(x.__(e,(e=>{a.avpacketPool.release(e)})),e.length=0):a.streamIndexFlush.set(t,!0),a.pendingAVPackets.has(t)&&(a.pendingAVPackets.set(i,e),e=a.pendingAVPackets.get(t),a.pendingAVPackets.delete(t)),1===a.formatContext.streams[t].codecpar.codecType?l.M[15](a.stats+32,e.length):0===a.formatContext.streams[t].codecpar.codecType&&l.M[15](a.stats+120,e.length),n.streamIndex=t,a.cacheAVPackets.set(t,e),a.rightIPCPorts.set(t,n),a.cacheAVPackets.delete(i),a.rightIPCPorts.delete(i),o&&(a.cacheRequests.set(t,o),a.cacheRequests.delete(i)),r&&!s||a.loop.start(),A.Yz(`changed connect stream, new ${t}, old: ${i}, force: ${r}, taskId: ${a.taskId}`,O,705)}else A.h2("task not found",O,708)}async doDemux(e,t){const i=e.avpacketPool.alloc();let r=await g.Cj(e.formatContext,i);if(r){e.avpacketPool.release(i),-1048576!==r&&-1048572!==r&&A.z3(`demux error, ret: ${r}, taskId: ${e.taskId}`,O,865);for(let t of e.cacheRequests.keys())e.cacheAVPackets.get(t).length||(e.rightIPCPorts.get(t).reply(e.cacheRequests.get(t),-1048576),e.cacheRequests.delete(t))}else{const r=c.f[15](i+32);if(0!==e.stats)if(1===e.formatContext.streams[r].codecpar.codecType&&e.cacheAVPackets.has(r)){if(l.M[17](e.stats+24,c.f[17](e.stats+24)+BigInt(1)),l.M[17](e.stats+16,c.f[17](e.stats+16)+BigInt(0|c.f[15](i+28))),c.f[17](e.stats+24)>1&&c.f[17](i+16)>e.lastAudioDts){const t=e.cacheAVPackets.get(r);t&&t.length?l.M[15](e.stats+244,Math.round(c.f[15](i+76)/c.f[15](i+72)/(Number(BigInt.asIntN(32,c.f[17](i+16)-c.f[17](t[0]+16)))/t.length))):l.M[15](e.stats+244,Math.round(c.f[15](i+76)/c.f[15](i+72)/Number(BigInt.asIntN(32,c.f[17](i+16)-e.lastAudioDts))))}e.lastAudioDts=c.f[17](i+16)}else if(0===e.formatContext.streams[r].codecpar.codecType&&e.cacheAVPackets.has(r)){if(l.M[17](e.stats+112,c.f[17](e.stats+112)+BigInt(1)),l.M[17](e.stats+104,c.f[17](e.stats+104)+BigInt(0|c.f[15](i+28))),1&c.f[15](i+36)?(l.M[17](e.stats+176,c.f[17](e.stats+176)+BigInt(1)),c.f[17](e.stats+176)>1&&c.f[17](i+8)>e.lastKeyFramePts&&(l.M[15](e.stats+96,e.gopCounter),e.gopCounter=1,l.M[15](e.stats+92,Number(BigInt.asIntN(32,(0,k.Mr)(c.f[17](i+8)-e.lastKeyFramePts,i+72,T.i0))))),e.lastKeyFramePts=c.f[17](i+8)):e.gopCounter++,c.f[17](e.stats+112)>1&&c.f[17](i+16)>e.lastVideoDts){const t=e.cacheAVPackets.get(r);t&&t.length?l.M[15](e.stats+232,Math.round(c.f[15](i+76)/c.f[15](i+72)/(Number(BigInt.asIntN(32,c.f[17](i+16)-c.f[17](t[0]+16)))/t.length))):l.M[15](e.stats+232,Math.round(c.f[15](i+76)/c.f[15](i+72)/Number(BigInt.asIntN(32,c.f[17](i+16)-e.lastVideoDts))))}e.lastVideoDts=c.f[17](i+16)}if(e.streamIndexFlush.get(r)){const t=e.formatContext.streams.find((e=>e.index===r));if(!(0,S.rU)(i,1)&&t&&t.codecpar.extradataSize){const e=(0,v.sY)(t.codecpar.extradataSize);(0,P.Mr)(e,t.codecpar.extradata,t.codecpar.extradataSize),(0,S.Ow)(i,1,e,t.codecpar.extradataSize)}e.streamIndexFlush.set(r,!1)}if(e.cacheRequests.has(r))this.replyAVPacket(e,e.rightIPCPorts.get(r),e.cacheRequests.get(r),i),e.cacheRequests.delete(r);else if(e.cacheAVPackets.has(r))e.cacheAVPackets.get(r).push(i),0!==e.stats&&(1===e.formatContext.streams[r].codecpar.codecType?l.M[15](e.stats+32,c.f[15](e.stats+32)+1):0===e.formatContext.streams[r].codecpar.codecType&&l.M[15](e.stats+120,c.f[15](e.stats+120)+1)),3===e.formatContext.streams[r].codecpar.codecType&&e.cacheAVPackets.get(r).length>t&&e.avpacketPool.release(e.cacheAVPackets.get(r).shift());else if(e.pendingAVPackets.has(r)){const s=e.pendingAVPackets.get(r);if(s.push(i),0!==e.stats){const i=e.formatContext.streams[r].codecpar.codecType;for(;s.length;){const r=s[0],a=(0,k.Mr)(c.f[17](r+8),r+72,T.i0),n=I.T9(c.f[17](e.stats+328),c.f[17](e.stats+336));if(1===i&&a>=n||0===i&&a>=n||1!==i&&0!==i&&s.length<=t)break;e.avpacketPool.release(s.shift())}}else s.length>t&&e.avpacketPool.release(s.shift())}else e.rightIPCPorts.has(N)?e.cacheRequests.has(N)?(this.replyAVPacket(e,e.rightIPCPorts.get(N),e.cacheRequests.get(N),i),e.cacheRequests.delete(N)):e.cacheAVPackets.get(N).push(i):e.avpacketPool.release(i)}return r}async startDemux(e,t,i){const r=this.tasks.get(e);if(r){if(i=Math.max(i,2===r.format?20:10),r.loop&&r.loop.destroy(),r.loop=new w.A((async()=>{if(!t){let e=!1,t=!1;if(r.cacheAVPackets.forEach(((s,a)=>{const n=r.formatContext.streams.find((e=>e.index===a));s.length<i&&(3!==n.codecpar.codecType||1===r.cacheAVPackets.size)&&(e=!0),s.length>Math.max(2*i,5e3)&&(t=!0)})),!e||t)return void r.loop.emptyTask()}await this.doDemux(r,i)&&(r.demuxEnded=!0,A.pq(`demuxer ended, taskId: ${r.taskId}`,O,916),r.loop.stop())}),0,0,!0,!1),t&&r.cacheAVPackets.size)for(;;){let e=!1;if(r.cacheAVPackets.forEach(((t,r)=>{t.length>=i&&(e=!0)})),e)break;if(await this.doDemux(r,i))return void(r.demuxEnded=!0)}r.loop.start(),A.Yz(`start demux loop, taskId: ${r.taskId}`,O,944)}else A.h2("task not found",O,947)}async seek(e,t,i,r=-1){const s=this.tasks.get(e);if(s){if(s.loop){await s.loop.stopBeforeNextTick();let a=await g.jF(s.formatContext,r,t,i);if(a>=BigInt(0)){function n(e){x.__(e,(e=>{if(2&s.formatContext.ioReader.flags){const t=(0,S.rU)(e,1),i=s.formatContext.streams[c.f[15](e+32)];!i.sideData[1]&&t&&(i.sideData[1]=(0,P.s3)(c.f[20](t),c.f[25](t+4)).slice())}s.avpacketPool.release(e)})),e.length=0}s.cacheAVPackets.forEach(n),s.pendingAVPackets.forEach(n),0!==s.stats&&s.cacheAVPackets.forEach(((e,t)=>{const i=s.formatContext.streams.find((e=>e.index===t));1===i.codecpar.codecType?l.M[15](s.stats+32,0):0===i.codecpar.codecType&&l.M[15](s.stats+120,0)}));const o=s.avpacketPool.alloc();for(;a=await g.Cj(s.formatContext,o),!(a<0||s.cacheAVPackets.has(c.f[15](o+32))););if(a>=0){s.demuxEnded=!1;const d=c.f[15](o+32);return s.cacheAVPackets.get(d).push(o),0!==s.stats&&(1===s.formatContext.streams[c.f[15](o+32)].codecpar.codecType?l.M[15](s.stats+32,c.f[15](s.stats+32)+1):0===s.formatContext.streams[c.f[15](o+32)].codecpar.codecType&&l.M[15](s.stats+120,c.f[15](s.stats+120)+1)),s.loop.start(),(0,k.Mr)(I.T9(c.f[17](o+8),BigInt(0)),o+72,T.i0)}return A.R8(`got first packet failed after seek, taskId: ${s.taskId}`,O,1018),s.avpacketPool.release(o),s.demuxEnded=!0,t}return a}{A.pq("seek before demux loop start",O,1029);let h=await g.jF(s.formatContext,-1,t,i);return h<0?h:t}}}async croppingAVPacketQueue(e,t){const i=this.tasks.get(e);if(i){let r=t;const a=new(s());function n(e,t){if(!(1&c.f[15](e+36)))return!1;let i=0!==(0,S.rU)(e,1);return!i&&64&c.f[15](e+36)&&(27===t?i=!!U.sL((0,S.iI)(e)):173===t?i=!!L.sL((0,S.iI)(e)):196===t&&(i=!!$.sL((0,S.iI)(e)))),i}const o=new(s());i.cacheAVPackets.forEach(((e,t)=>{o.set(t,e)})),i.pendingAVPackets.forEach(((e,t)=>{o.set(t,e)})),o.forEach(((e,s)=>{const o=i.formatContext.streams[s].codecpar.codecType,l=i.formatContext.streams[s].codecpar.codecId;if(0===o){const i=c.f[17](e[e.length-1]+16);let o=e.length-2;for(o=e.length-2;o>=0;o--)if(1&c.f[15](e[o]+36)&&(0,k.Mr)(i-c.f[17](e[o]+16),e[o]+72,T.i0)>=t){r=I.T9(r,(0,k.Mr)(i-c.f[17](e[o]+16),e[o]+72,T.i0));break}if((27===l||173===l||196===l)&&o>0&&!n(e[o],l))for(let t=o-1;t>0;t--)if(1&c.f[15](e[t]+36)&&n(e[t],l)){r=I.T9(r,(0,k.Mr)(i-c.f[17](e[t]+16),e[t]+72,T.i0)),o=t;break}o>0&&a.set(s,o)}})),o.forEach(((e,t)=>{if(0!==i.formatContext.streams[t].codecpar.codecType){const i=c.f[17](e[e.length-1]+16);let s=e.length-2;for(s=e.length-2;s>=0&&!((0,k.Mr)(i-c.f[17](e[s]+16),e[s]+72,T.i0)>=r);s--);s>=0&&a.set(t,s)}})),a.size===o.size&&a.forEach(((e,t)=>{const r=o.get(t);r.splice(0,e).forEach((e=>{i.avpacketPool.release(e)}));const s=i.formatContext.streams[t].codecpar.codecType;0!==i.stats&&(1===s?l.M[15](i.stats+32,r.length):0===s&&l.M[15](i.stats+120,r.length))}))}}async stop(e){const t=this.tasks.get(e);t&&(t.formatContext.ioReader.flags|=8)}async registerTask(e){return this.tasks.has(e.taskId)?h.lh:this.createTask(e)}async unregisterTask(e){const t=this.tasks.get(e);t&&(t.ioReader&&4&t.ioReader.flags&&t.ioReader.abort(),t.loop&&(await t.loop.stopBeforeNextTick(),t.loop.destroy()),t.cacheAVPackets.forEach((e=>{e.forEach((e=>{t.avpacketPool.release(e)}))})),t.pendingAVPackets.forEach((e=>{e.forEach((e=>{t.avpacketPool.release(e)}))})),t.cacheRequests.forEach(((e,i)=>{t.rightIPCPorts.get(i).reply(e,-1048576)})),t.cacheRequests.clear(),await t.formatContext.destroy(),t.mainTaskId||(t.leftIPCPort.destroy(),t.controlIPCPort&&t.controlIPCPort.destroy()),t.rightIPCPorts.forEach((e=>{e.destroy()})),t.rightIPCPorts.clear(),t.iBuffer&&((0,v.Eb)(t.iBuffer),t.iBuffer=0),t.oBuffer&&((0,v.Eb)(t.oBuffer),t.oBuffer=0),this.tasks.delete(e),A.Yz(`unregisterTask task, taskId: ${e}`,O,1223))}}},87243:(e,t,i)=>{"use strict";i.d(t,{A:()=>m});var r=i(63939),s=i(50932),a=i(44527),n=i(77580),o=i(9705),c=i(84149),l=i(14686),d=i(79686),h=i(4624),u=i(14619),f=i(42383);const p="src/avpipeline/IOPipeline.ts";class m extends a.A{constructor(){super()}async createTask(e){let t;switch(e.type){case 0:t=new n.A(e.options);break;case 1:t=new d.A(e.options);break;case 2:t=new u.A(e.options);break;case 3:t=new f.A(e.options);break;case 4:t=new((await i.e(433).then(i.bind(i,15433))).default)(e.options);break;case 5:t=new((await i.e(576).then(i.bind(i,41576))).default)(e.options);break;case 6:t=new((await Promise.all([i.e(171),i.e(543)]).then(i.bind(i,67543))).default)(e.options)}if(!t)return o.UY;const a=new c.Ay(e.rightPort),m={...e,ioLoader:t,ipcPort:a};return a.on(c.S3,(async i=>{switch(i.method){case"open":try{const r=await t.open(e.info,e.range);if(r<0){h.z3(`loader open error, ${r}, taskId: ${e.taskId}`,p,128),a.reply(i,null,r);break}a.reply(i,r)}catch(t){h.z3(`loader open error, ${t}, taskId: ${e.taskId}`,p,135),a.reply(i,null,t)}break;case"read":{const n=i.params.pointer,c=i.params.length,d=i.params.ioloaderOptions,u=(0,l.JW)(n,c);try{const e=await t.read(u,d);s.M[17](m.stats+192,r.f[17](m.stats+192)+BigInt(0|e)),a.reply(i,e)}catch(t){if(!this.tasks.has(e.taskId))return;h.z3(`loader read error, ${t}, taskId: ${e.taskId}`,p,159),a.reply(i,o.LR)}break}case"write":{const n=i.params.pointer,c=i.params.length,d=(0,l.JW)(n,c);try{const e=await t.write(d);s.M[17](m.stats+200,r.f[17](m.stats+200)+BigInt(0|c)),a.reply(i,e)}catch(t){h.z3(`loader write error, ${t}, taskId: ${e.taskId}`,p,181),a.reply(i,o.LR)}break}case"seek":{const r=i.params.pos,s=i.params.ioloaderOptions;try{const n=await t.seek(r,s);if(n<0){h.z3(`loader seek error, ${n}, taskId: ${e.taskId}`,p,197),a.reply(i,null,n);break}a.reply(i,n)}catch(t){h.z3(`loader seek error, ${t}, taskId: ${e.taskId}`,p,204),a.reply(i,null,t)}break}case"size":a.reply(i,await t.size())}})),this.tasks.set(e.taskId,m),0}async open(e){const t=this.tasks.get(e);if(t)return await t.ioLoader.open(t.info,t.range),0}async getDuration(e){const t=this.tasks.get(e);if(t)return 4===t.type||5===t.type?t.ioLoader.getDuration():0}async hasAudio(e){const t=this.tasks.get(e);if(t){if(5===t.type)return t.ioLoader.hasAudio();if(4===t.type)return t.ioLoader.hasAudio()}return!1}async hasVideo(e){const t=this.tasks.get(e);if(t){if(5===t.type)return t.ioLoader.hasVideo();if(4===t.type)return t.ioLoader.hasVideo()}return!1}async hasSubtitle(e){const t=this.tasks.get(e);if(t){if(5===t.type)return t.ioLoader.hasSubtitle();if(4===t.type)return t.ioLoader.hasSubtitle()}return!1}async getVideoList(e){const t=this.tasks.get(e);if(t){if(5===t.type)return t.ioLoader.getVideoList();if(4===t.type)return t.ioLoader.getVideoList()}return{list:[],selectedIndex:0}}async getAudioList(e){const t=this.tasks.get(e);if(t){if(5===t.type)return t.ioLoader.getAudioList();if(4===t.type)return t.ioLoader.getAudioList()}return{list:[],selectedIndex:0}}async getSubtitleList(e){const t=this.tasks.get(e);if(t){if(5===t.type)return t.ioLoader.getSubtitleList();if(4===t.type)return t.ioLoader.getSubtitleList()}return{list:[],selectedIndex:0}}async selectVideo(e,t){const i=this.tasks.get(e);if(i){if(5===i.type)return i.ioLoader.selectVideo(t);if(4===i.type)return i.ioLoader.selectVideo(t)}}async selectAudio(e,t){const i=this.tasks.get(e);if(i){if(5===i.type)return i.ioLoader.selectAudio(t);if(4===i.type)return i.ioLoader.selectAudio(t)}}async selectSubtitle(e,t){const i=this.tasks.get(e);if(i){if(5===i.type)return i.ioLoader.selectSubtitle(t);if(4===i.type)return i.ioLoader.selectSubtitle(t)}}async getCurrentProtection(e,t){const i=this.tasks.get(e);if(i&&5===i.type)return i.ioLoader.getCurrentProtection(t)}async getMinBuffer(e){const t=this.tasks.get(e);if(t){if(5===t.type)return t.ioLoader.getMinBuffer();if(4===t.type)return t.ioLoader.getMinBuffer()}return 0}async registerTask(e){return this.tasks.has(e.taskId)?o.lh:this.createTask(e)}async unregisterTask(e){const t=this.tasks.get(e);t&&(await t.ioLoader.stop().catch((e=>{h.R8(`stop ioloader error: ${e}, we will ignore it`,p,422)})),t.ipcPort.destroy(),this.tasks.delete(e),h.Yz(`unregisterTask task, taskId: ${e}`,p,426))}}},44527:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(134),s=i(80662),a=i.n(s),n=i(4624);class o{constructor(){(0,r.A)(this,"tasks",void 0),this.tasks=new(a())}async clear(){if(this.tasks.size)for(const e of this.tasks.keys())await this.unregisterTask(e)}async setLogLevel(e){n.V$(e)}async getTaskCount(){return this.tasks.size}}},31138:(e,t,i)=>{"use strict";i.d(t,{A:()=>F});var r=i(54001),s=i.n(r),a=i(63939),n=i(50932),o=i(12264),c=i(29170),l=i(9599),d=i(44527),h=i(9705),u=i(84149),f=i(40417),p=i(71039),m=i(4624),g=i(16041),v=i(67672),y=i(72739),A=i(13724),b=(i(77162),i(84290)),w=i(39638),x=i(44328),k=i(86932),T=i(77231),I=i(95797),S=i(72703),P=i(94561),_=i(71762),M=i(37837),C=i(71766),B=i(71517),E=i(14686),D=i(62815),R=i(67659),U=i(59166),L=i(39381);const $="src/avpipeline/VideoDecodePipeline.ts";class F extends d.A{constructor(){super()}createWebCodecDecoder(e,t=!0){return new p.A({onError:t=>{e.hardwareRetryCount>3||!e.firstDecoded?e.targetDecoder===e.hardwareDecoder&&(e.targetDecoder=e.softwareDecoder,e.hardwareDecoder.close(),e.hardwareDecoder=null,e.decoderFallbackReady=this.openSoftwareDecoder(e),m.R8(`video decode error by hardware decoder(${e.hardwareRetryCount}), taskId: ${e.taskId}, error: ${t}, try to fallback to software decoder`,$,132)):(e.hardwareRetryCount++,m.pq(`retry open hardware decoder(${e.hardwareRetryCount}), taskId: ${e.taskId}`,$,137),e.decoderFallbackReady=e.hardwareDecoder.open(e.parameters)),e.needKeyFrame=!0,e.leftIPCPort.request("requestKeyframe")},onReceiveVideoFrame(t){e.firstDecoded=!0,e.frameCaches.push(t),n.M[17](e.stats+144,a.f[17](e.stats+144)+BigInt(1)),e.lastDecodeTimestamp!==T.N_&&(n.M[15](e.stats+256,Math.max((0,k.A)()-e.lastDecodeTimestamp,a.f[15](e.stats+256))),e.lastDecodeTimestamp=T.N_)},enableHardwareAcceleration:t})}createWasmcodecDecoder(e,t){return new f.A({resource:t,onReceiveAVFrame(t){e.firstDecoded=!0,e.frameCaches.push(t),n.M[17](e.stats+144,a.f[17](e.stats+144)+BigInt(1)),e.lastDecodeTimestamp!==T.N_&&(n.M[15](e.stats+256,Math.max((0,k.A)()-e.lastDecodeTimestamp,a.f[15](e.stats+256))),e.lastDecodeTimestamp=T.N_)},avframePool:e.avframePool})}async pullAVPacketInternal(e,t){const i=await t.request("pull");if(v.ai(i)||(0,S.A)(i))return i;{const t=e.avpacketPool.alloc();return(0,_.r0)(i,t),t}}async createTask(e){const t=new u.Ay(e.leftPort),i=new u.Ay(e.rightPort),r=[],l=new g.A((0,c.A)(e.avframeList,o.A),e.avframeListMutex),d={...e,resource:await(0,P.A)(e.resource,!0),leftIPCPort:t,rightIPCPort:i,softwareDecoder:null,hardwareDecoder:null,frameCaches:r,inputEnd:!1,targetDecoder:null,needKeyFrame:!0,parameters:0,hardwareRetryCount:0,lastDecodeTimestamp:0,firstDecoded:!1,decoderFallbackReady:null,softwareDecoderOpened:!1,discard:0,playRate:1,avframePool:l,avpacketPool:new b.A((0,c.A)(e.avpacketList,o.A),e.avpacketListMutex)};return d.softwareDecoder=d.resource?this.createWasmcodecDecoder(d,d.resource):I.A.videoDecoder?this.createWebCodecDecoder(d,!1):null,d.softwareDecoder?(I.A.videoDecoder&&e.enableHardware&&(d.hardwareDecoder=this.createWebCodecDecoder(d)),d.targetDecoder=d.hardwareDecoder||d.softwareDecoder,this.tasks.set(e.taskId,d),i.on(u.S3,(async o=>{switch(o.method){case"pull":if(r.length){const e=r.shift();i.reply(o,e,null,(0,S.A)(e)||v.ai(e)?null:[e]);break}if(!d.inputEnd){for(;;){if(r.length){const e=r.shift();i.reply(o,e,null,(0,S.A)(e)||v.ai(e)?null:[e]);break}if(d.decoderFallbackReady){let e=await d.decoderFallbackReady;if(e&&(d.targetDecoder===d.hardwareDecoder&&(d.targetDecoder=d.softwareDecoder,d.hardwareDecoder.close(),d.hardwareDecoder=null,m.R8(`video decode error by hardware decoder(${d.hardwareRetryCount}), taskId: ${d.taskId}, error: ${e}, try to fallback to software decoder`,$,265),e=await this.openSoftwareDecoder(d)),e)){m.pq(`video decoder open error, taskId: ${d.taskId}`,$,269),i.reply(o,h.r8);break}d.decoderFallbackReady=null}d.lastDecodeTimestamp===T.N_&&(d.lastDecodeTimestamp=(0,k.A)());const c=await this.pullAVPacketInternal(d,t);if(-1048576===c){if(d.targetDecoder===d.hardwareDecoder?await s().race([new A.A(2),d.targetDecoder.flush()])&&m.R8(`video hardware decoder flush failed, ignore it, taskId: ${d.taskId}`,$,289):await d.targetDecoder.flush(),d.inputEnd=!0,d.targetDecoder===d.hardwareDecoder&&await new A.A(0),r.length){const e=r.shift();i.reply(o,e,null,d.targetDecoder===d.hardwareDecoder?[e]:null);break}m.pq(`video decoder ended, taskId: ${d.taskId}`,$,306),i.reply(o,-1048576);break}if(!(c>0)){m.z3(`video decode pull avpacket error, taskId: ${e.taskId}, ret: ${c}`,$,450),i.reply(o,c);break}{if(d.needKeyFrame){if(!(1&a.f[15](c+36)&&27!==a.f[15](d.parameters+4)||27===a.f[15](d.parameters+4)&&D.KD(c,a.f[20](d.parameters+12)?1+(3&L.r8(a.f[20](d.parameters+12)+4)):4)||173===a.f[15](d.parameters+4)&&R.KD(c,a.f[20](d.parameters+12)?1+(3&L.r8(a.f[20](d.parameters+12)+21)):4)||196===a.f[15](d.parameters+4)&&U.KD(c,a.f[20](d.parameters+12)?1+(L.r8(a.f[20](d.parameters+12))>>>1&3):4))){d.avpacketPool.release(c);continue}d.needKeyFrame=!1,n.M[15](c+36,1|a.f[15](c+36))}let t=d.targetDecoder.decode(c);if(1&a.f[15](c+36)){const e=(0,B.rU)(c,1);0!==e&&(a.f[20](d.parameters+12)&&(0,M.Eb)(a.f[20](d.parameters+12)),n.M[15](d.parameters+16,0|a.f[25](e+4)),n.M[20](d.parameters+12,(0,M.sY)(a.f[25](e+4))),(0,E.Mr)(a.f[20](d.parameters+12),a.f[20](e),a.f[25](e+4)))}if(t<0){if(n.M[15](d.stats+136,a.f[15](d.stats+136)+1),d.targetDecoder instanceof p.A&&d.softwareDecoder){if(m.R8(`video decode error from hardware, taskId: ${d.taskId}, error: ${t}, try to fallback to software decoder`,$,371),d.targetDecoder===d.hardwareDecoder)d.hardwareDecoder.close(),d.hardwareDecoder=null;else{if(!d.resource){m.z3(`cannot fallback to wasm video decoder because of resource not found , taskId: ${e.taskId}`,$,383),i.reply(o,h.r8);break}d.softwareDecoder.close(),d.softwareDecoder=this.createWasmcodecDecoder(d,d.resource),d.softwareDecoderOpened=!1}try{await this.openSoftwareDecoder(d),d.targetDecoder=d.softwareDecoder}catch(t){m.z3(`video software decoder open error, taskId: ${e.taskId}`,$,393),i.reply(o,h.r8);break}if(!(1&a.f[15](c+36))){d.avpacketPool.release(c),d.needKeyFrame=!0,d.leftIPCPort.request("requestKeyframe");continue}if(t=d.targetDecoder.decode(c),t>=0){d.avpacketPool.release(c);continue}if(d.targetDecoder instanceof p.A&&d.resource){m.R8(`video decode error by webcodecs soft decoder, taskId: ${d.taskId}, error: ${t}, try to fallback to wasm software decoder`,$,407),d.softwareDecoder.close(),d.softwareDecoder=this.createWasmcodecDecoder(d,d.resource),d.softwareDecoderOpened=!1;try{await this.openSoftwareDecoder(d),d.targetDecoder=d.softwareDecoder}catch(t){m.z3(`video wasm software decoder open error, taskId: ${e.taskId}`,$,417),i.reply(o,h.r8);break}if(t=d.targetDecoder.decode(c),t>=0){d.avpacketPool.release(c);continue}}}d.avpacketPool.release(c),m.z3(`video decode error, taskId: ${e.taskId}, ret: ${t}`,$,436),i.reply(o,t);break}for(d.avpacketPool.release(c);d.targetDecoder instanceof p.A&&d.targetDecoder.getQueueLength()>20;)await new A.A(0)}}break}m.pq(`video decoder ended, taskId: ${d.taskId}`,$,457),i.reply(o,-1048576)}})),0):(m.z3("software decoder not support",$,230),h.lh)}async openSoftwareDecoder(e){if(e.softwareDecoder&&!e.softwareDecoderOpened){const t=e.parameters;let i=1;if((0,w.A)()){let e=a.f[15](t+56)*a.f[15](t+60),r=(0,x.lb)((0,c.A)(t+72,l.P));e>=2073600&&e<=2211840?(173!==a.f[15](t+4)&&196!==a.f[15](t+4)&&225!==a.f[15](t+4)||(i=2),r>30?(i=2,173!==a.f[15](t+4)&&196!==a.f[15](t+4)&&225!==a.f[15](t+4)||(i=4)):r>60&&(i=4,173!==a.f[15](t+4)&&196!==a.f[15](t+4)&&225!==a.f[15](t+4)||(i=6))):e>2211840&&e<=8294400?(i=4,173!==a.f[15](t+4)&&196!==a.f[15](t+4)&&225!==a.f[15](t+4)||(i=6)):e>8294400&&(i=6,173!==a.f[15](t+4)&&196!==a.f[15](t+4)&&225!==a.f[15](t+4)||(i=8)),i=Math.min(i,navigator.hardwareConcurrency)}m.Yz(`open software(${e.softwareDecoder instanceof p.A?"webcodecs":"wasm"}) decoder`,$,522);let r=await e.softwareDecoder.open(t,i,e.wasmDecoderOptions);if(r){if(!(e.softwareDecoder instanceof p.A&&e.resource))return r;if(m.R8(`webcodecs software decoder open failed, ${r}, try to fallback to wasm software decoder`,$,528),e.softwareDecoder.close(),e.softwareDecoder=this.createWasmcodecDecoder(e,e.resource),r=await e.softwareDecoder.open(t,i),r)return r;e.targetDecoder=e.softwareDecoder}e.softwareDecoderOpened=!0}return 0}async reopenDecoder(e,t,i,r){const a=this.tasks.get(e);if(a){const e=(0,M.Gy)(168);let n;(0,S.A)(t)?(0,C.Yi)(e,t):(0,_.T8)(t,e),a.parameters&&(0,C.dn)(a.parameters),a.parameters=e,r&&(a.wasmDecoderOptions=r),i&&(i=await(0,P.A)(i,!0)),n=a.preferWebCodecs&&I.A.videoDecoder&&p.A.isSupported(e,!1)?this.createWebCodecDecoder(a,!1):i?this.createWasmcodecDecoder(a,i):I.A.videoDecoder?this.createWebCodecDecoder(a,!1):null;let o=I.A.videoDecoder&&a.enableHardware?this.createWebCodecDecoder(a,!0):null;return new(s())((async(t,r)=>{if(a.softwareDecoder&&a.softwareDecoder.close(),a.hardwareDecoder&&a.hardwareDecoder.close(),a.softwareDecoder=n,a.hardwareDecoder=o,a.targetDecoder=a.hardwareDecoder||a.softwareDecoder,a.hardwareRetryCount=0,a.hardwareDecoder){const t=await a.hardwareDecoder.open(e);t?(m.z3(`cannot reopen hardware decoder, ${t}, taskId: ${a.taskId}`,$,604),a.hardwareDecoder.close(),a.hardwareDecoder=null,a.targetDecoder=a.softwareDecoder):m.Yz(`reopen video hardware decoder, taskId: ${a.taskId}`,$,610)}if(i&&(a.resource=i),a.targetDecoder===a.softwareDecoder){const e=await this.openSoftwareDecoder(a);if(e){if(m.z3(`reopen video software decoder failed, error: ${e}`,$,621),!a.hardwareDecoder)return void t(h.r8)}else m.Yz(`reopen video soft decoder, taskId: ${a.taskId}`,$,628)}t(0)}))}m.h2("task not found",$,634)}async open(e,t,i={}){const r=this.tasks.get(e);if(r){r.wasmDecoderOptions=i;const e=(0,M.Gy)(168);if((0,S.A)(t)?(0,C.Yi)(e,t):(0,_.T8)(t,e),r.parameters&&(0,C.dn)(r.parameters),r.parameters=e,r.preferWebCodecs&&I.A.videoDecoder&&p.A.isSupported(e,!1)&&r.softwareDecoder instanceof f.A){r.softwareDecoder.close();const e=this.createWebCodecDecoder(r,!1);r.softwareDecoder===r.targetDecoder&&(r.targetDecoder=e),r.softwareDecoder=e}return new(s())((async(t,i)=>{if(r.hardwareDecoder){m.Yz("open hardware decoder",$,669);const t=await r.hardwareDecoder.open(e);t&&(m.R8(`cannot open hardware decoder, ${t}, try to open software decoder`,$,672),r.hardwareDecoder.close(),r.hardwareDecoder=null,r.targetDecoder=r.softwareDecoder)}if(r.targetDecoder===r.softwareDecoder){const e=await this.openSoftwareDecoder(r);if(e&&(m.z3(`open video software decoder failed, error: ${e}`,$,682),!r.hardwareDecoder))return void t(h.r8)}t(0)}))}m.h2("task not found",$,692)}async setPlayRate(e,t){const i=this.tasks.get(e);if(i&&i.softwareDecoder){let e=0,r=(0,x.lb)((0,c.A)(i.parameters+72,l.P));e=r>=120?t<=1?0:t<1.5||t<3?8:32:r>=60?t<1.5?0:t<3?8:t<8?24:32:t>=8?32:t>=4?24:0,i.softwareDecoder.setSkipFrameDiscard(e),i.playRate<t?i.discard=e:i.discard=Math.max(i.discard,e),i.playRate=t}}async setNextDiscard(e){const t=this.tasks.get(e);t&&t.softwareDecoder&&t.discard<32&&(t.discard+=8,t.softwareDecoder.setSkipFrameDiscard(t.discard),m.pq(`set next discard, taskId: ${t.taskId}, discard: ${t.discard}`,$,759))}async setPrevDiscard(e){const t=this.tasks.get(e);t&&t.softwareDecoder&&t.discard>0&&(t.discard-=8,t.softwareDecoder.setSkipFrameDiscard(t.discard),m.pq(`set prev discard, taskId: ${t.taskId}, discard: ${t.discard}`,$,771))}async resetTask(e){const t=this.tasks.get(e);t&&(t.targetDecoder===t.softwareDecoder?await t.targetDecoder.flush():t.targetDecoder===t.hardwareDecoder&&(t.hardwareDecoder.close(),t.hardwareDecoder=this.createWebCodecDecoder(t),await t.hardwareDecoder.open(t.parameters)&&m.h2("reopen hardware decoder failed",$,788),t.targetDecoder=t.hardwareDecoder),y.__(t.frameCaches,(e=>{(0,S.A)(e)?t.avframePool.release(e):e.close()})),t.frameCaches.length=0,t.needKeyFrame=!0,t.inputEnd=!1,t.lastDecodeTimestamp=(0,k.A)(),m.pq(`reset video decoder, taskId: ${t.taskId}`,$,805))}async registerTask(e){return this.tasks.has(e.taskId)?h.lh:this.createTask(e)}async unregisterTask(e){const t=this.tasks.get(e);t&&(t.rightPort.close(),t.leftPort.close(),t.softwareDecoder&&t.softwareDecoder.close(),t.hardwareDecoder&&t.hardwareDecoder.close(),t.frameCaches.forEach((e=>{(0,S.A)(e)?t.avframePool.release(e):e.close()})),t.parameters&&(0,C.dn)(t.parameters),this.tasks.delete(e),m.Yz(`unregisterTask task, taskId: ${e}`,$,839))}async getTasksInfo(){const e=[];return this.tasks.forEach((t=>{e.push({codecId:a.f[15](t.parameters+4),width:a.f[15](t.parameters+56),height:a.f[15](t.parameters+60),framerate:(0,x.lb)((0,c.A)(t.parameters+72,l.P)),hardware:t.targetDecoder===t.hardwareDecoder})})),e}}},33968:(e,t,i)=>{"use strict";i.d(t,{A:()=>V});var r=i(54001),s=i.n(r),a=i(12264),n=i(29170),o=i(63939),c=(i(9599),i(50932)),l=i(44527),d=i(9705),h=i(84149),u=i(67672),f=i(72739),p=i(16041),m=i(95797),g=i(39148),v=i(86932),y=i(44328),A=i(77231),b=i(86834),w=i(4624),x=i(43607),k=i(15045),T=i(88103),I=i(54750),S=i(69047),P=i(3016),_=i(38222),M=i(87623),C=i(63849),B=i(39638),E=i(7972),D=i(72703),R=i(44690),U=i(74936);const L="src/avpipeline/VideoRenderPipeline.ts",$=[_.A];$.push(M.A);const F=[S.A];var O;F.push(P.A),function(e){e[e.None=0]="None",e[e.Accelerate=1]="Accelerate",e[e.Decelerate=2]="Decelerate"}(O||(O={}));let N=!1;const z=["bt2020","bt2100","st2048","p3-dcl","hlg"];class V extends l.A{constructor(){super()}async createTask(e){const t=new h.Ay(e.leftPort),i=new h.Ay(e.controlPort),r={...e,leftIPCPort:t,controlIPCPort:i,render:null,frontFrame:null,backFrame:null,renderFrame:null,renderFrameCount:BigInt(0),loop:null,renderRedyed:!1,currentPTS:A.Dh,adjust:O.None,adjustDiff:BigInt(0),lastAdjustTimestamp:BigInt(0),lastMasterPts:A.Dh,masterTimer:new U.A,lastNotifyPTS:BigInt(0),playRate:BigInt(100),firstRendered:!1,canvasUpdated:!1,renderCreating:!1,renderRecreateCount:0,skipRender:!1,isSupport:()=>!1,frontBuffered:!1,ended:!1,seeking:!1,seekSync:null,afterPullResolver:null,pausing:!1,lastRenderTimestamp:0,avframePool:new p.A((0,n.A)(e.avframeList,a.A),e.avframeListMutex)};return i.on(h.Wo,(async e=>{switch(e.method){case"syncPts":{const t=e.params.pts,i=r.masterTimer.getMasterTime(),s=Math.abs(Number(t-i));s>100&&r.currentPTS>BigInt(0)&&(t>i?(r.adjust=O.Accelerate,w.Yz(`video render sync master time accelerate, targetMaster: ${t}, currentMaster: ${i}, diff: ${s}, taskId: ${r.taskId}`,L,225)):(r.adjust=O.Decelerate,w.Yz(`video render sync master time decelerate, targetMaster: ${t}, currentMaster: ${i}, diff: ${s} taskId: ${r.taskId}`,L,229)),r.adjustDiff=BigInt(Math.floor(s)));break}case"skipRender":r.skipRender=e.params.skipRender}})),this.tasks.set(e.taskId,r),0}swap(e){if(!e.seeking){if(e.backFrame&&((0,D.A)(e.backFrame)?e.avframePool.release(e.backFrame):e.backFrame.close()),e.backFrame=null,!e.frontBuffered)return!1;if(e.backFrame=e.frontFrame,e.frontFrame=null,c.M[17](e.stats+352,(0,D.A)(e.backFrame)?(0,y.Mr)(o.f[17](e.backFrame+104),e.backFrame+120,A.i0):(0,y.k)(BigInt(e.backFrame.timestamp),A.KR,A.i0)),!e.ended)return e.frontBuffered=!1,e.leftIPCPort.request("pull").then((t=>(e.afterPullResolver&&e.afterPullResolver(),u.ai(t)&&t<0?(e.ended=!0,void(e.frontFrame=null)):(e.frontFrame=t,e.frontBuffered=!0,e.seekSync?(e.seekSync(),void(e.seekSync=null)):void(e.backFrame||this.swap(e)))))),!0}}fakeSyncPts(e){const t=e.masterTimer.getMasterTime();t-e.lastNotifyPTS>=BigInt(1e3)&&(e.lastNotifyPTS=t,c.M[17](e.stats+336,t),e.controlIPCPort.notify("syncPts",{pts:t}))}async createRender(e,t,i=!1){if(!e.renderCreating){var r;if(e.renderCreating=!0,e.renderRedyed=!1,e.render&&e.render.destroy(),"function"==typeof WritableStream&&e.canvas instanceof WritableStream?(e.render=new C.A(e.canvas),e.isSupport=C.A.isSupport):(0,D.A)(t)?(e.enableWebGPU&&m.A.webgpu&&!N&&f.__($,(i=>{if(i.isSupport(t))return e.render=new i(e.canvas,{sar:e.sar,devicePixelRatio:e.devicePixelRatio,renderMode:e.renderMode,onRenderContextLost:()=>{e.canvasUpdated=!1,e.renderRedyed=!1,w.R8("render context lost",L,397),e.controlIPCPort.notify("updateCanvas")}}),e.isSupport=i.isSupport,!1})),e.render||f.__(F,(i=>{if(i.isSupport(t))return e.render=new i(e.canvas,{sar:e.sar,devicePixelRatio:e.devicePixelRatio,renderMode:e.renderMode,onRenderContextLost:()=>{e.canvasUpdated=!1,e.renderRedyed=!1,w.R8("render context lost",L,416),e.controlIPCPort.notify("updateCanvas")}}),e.isSupport=i.isSupport,!1}))):e.enableWebGPU&&m.A.webgpu&&!N&&((b.A.chrome||b.A.newEdge)&&b.A.checkVersion(b.A.majorVersion,"116",!0)||b.A.safari&&b.A.checkVersion(b.A.majorVersion,"17.4",!0)||R.A.ios&&b.A.checkVersion(R.A.version,"17.4",!0)||b.A.firefox&&b.A.checkVersion(b.A.majorVersion,"129",!0))&&(r=t.colorSpace.primaries,!f.zy(z,r))?(e.render=new I.A(e.canvas,{sar:e.sar,devicePixelRatio:e.devicePixelRatio,renderMode:e.renderMode,onRenderContextLost:()=>{e.canvasUpdated=!1,e.renderRedyed=!1,w.R8("render context lost",L,357),e.controlIPCPort.notify("updateCanvas")}}),e.isSupport=I.A.isSupport):(e.render=new T.A(e.canvas,{sar:e.sar,devicePixelRatio:e.devicePixelRatio,renderMode:e.renderMode,colorSpace:"pq"===t.colorSpace.transfer?"rec2100-pq":"hlg"===t.colorSpace.transfer?"rec2100-hlg":void 0}),e.isSupport=T.A.isSupport),!e.render)return w.z3(`not found format ${t.format} render`,L,428),void(e.renderCreating=!1);try{var s,a,n;await e.render.init(),e.render.viewport(e.viewportWidth,e.viewportHeight),e.render.setRotate(null!==(s=e.renderRotate)&&void 0!==s?s:0,!1),e.render.enableHorizontalFlip(null!==(a=e.flipHorizontal)&&void 0!==a&&a),e.render.enableVerticalFlip(null!==(n=e.flipVertical)&&void 0!==n&&n),e.render.render(t),e.render.clear()}catch(r){if(e.render instanceof k.A&&!i)return N=!0,e.renderCreating=!1,w.R8("not support webgpu render, try to fallback to webgl render",L,447),this.createRender(e,t,!0);if(i){if(e.renderCreating=!1,w.R8("canvas context lost after fallback, wait for recreate canvas",L,452),e.renderRecreateCount<3)return e.renderRecreateCount++,void e.controlIPCPort.notify("updateCanvas");throw r}}e.renderRedyed=!0,e.renderCreating=!1,e.renderRecreateCount=0}}async play(e){const t=this.tasks.get(e);if(t){if(t.loop&&w.h2("task has already call play",L,474),t.backFrame=await t.leftIPCPort.request("pull"),u.ai(t.backFrame)&&t.backFrame<0)return t.backFrame=0,w.pq(`video render ended, taskId: ${t.taskId}`,L,481),void t.controlIPCPort.notify("ended");t.frontFrame=await t.leftIPCPort.request("pull"),t.frontBuffered=!0,t.ended=!1,u.ai(t.frontFrame)&&t.frontFrame<0&&(t.ended=!0,t.frontBuffered=!1,t.frontFrame=0),await this.createRender(t,t.backFrame),t.currentPTS=(0,D.A)(t.backFrame)?(0,y.Mr)(o.f[17](t.backFrame+104),t.backFrame+120,A.i0):(0,y.k)(BigInt(t.backFrame.timestamp),A.KR,A.i0),w.Yz(`got first video frame, pts: ${(0,D.A)(t.backFrame)?o.f[17](t.backFrame+104):BigInt(t.backFrame.timestamp)}(${t.currentPTS}ms), taskId: ${t.taskId}`,L,511),t.masterTimer.setMasterTime(t.lastMasterPts===A.Dh?t.startPTS:t.lastMasterPts),t.lastMasterPts=A.Dh,c.M[17](t.stats+352,t.currentPTS);const e=(0,B.A)(),i=e&&m.A.shareArrayBuffer?0:10;t.loop=new g.A((()=>{if(!t.backFrame)return void(t.ended?(t.loop.stop(),t.adjust=O.None,w.pq(`video render ended, taskId: ${t.taskId}`,L,532),t.controlIPCPort.notify("ended")):t.loop.emptyTask());if(!t.isSupport(t.backFrame)){if(t.render){if(!t.renderRedyed)return;return t.renderRedyed=!1,t.renderFrame=t.backFrame,void t.controlIPCPort.notify("updateCanvas")}this.createRender(t,t.backFrame)}const i=(0,D.A)(t.backFrame)?(0,y.Mr)(o.f[17](t.backFrame+104),t.backFrame+120,A.i0):(0,y.k)(BigInt(t.backFrame.timestamp),A.KR,A.i0);if(i<t.currentPTS){if(!(t.currentPTS-i>BigInt(5e3)))return w.R8(`dropping frame with pts ${i}, which is earlier then the last rendered frame(${t.currentPTS}), taskId: ${t.taskId}`,L,571),void this.swap(t);t.masterTimer.setMasterTime(i)}else i-t.currentPTS>BigInt(4e3)&&t.isLive&&t.masterTimer.setMasterTime(i);if(t.adjust===O.Accelerate){if(t.adjustDiff<=0)t.adjust=O.None,t.lastAdjustTimestamp=BigInt(0);else if(BigInt(Math.floor((0,v.A)()))-t.lastAdjustTimestamp>=BigInt(200)){const e=x.jk(t.adjustDiff,BigInt(100));t.masterTimer.setMasterTime(t.masterTimer.getMasterTime()+e),t.adjustDiff-=e,w.Yz(`video render accelerate master time add: ${e}, taskId: ${t.taskId}`,L,593),t.lastAdjustTimestamp=BigInt(Math.floor((0,v.A)()))}}else if(t.adjust===O.Decelerate)if(t.adjustDiff<=0)t.adjust=O.None,t.lastAdjustTimestamp=BigInt(0);else if(BigInt(Math.floor((0,v.A)()))-t.lastAdjustTimestamp>=BigInt(300)){const e=x.jk(t.adjustDiff,BigInt(50));t.masterTimer.setMasterTime(t.masterTimer.getMasterTime()-e),t.adjustDiff-=e,w.Yz(`video render decelerate master time sub: ${e}, taskId: ${t.taskId}`,L,611),t.lastAdjustTimestamp=BigInt(Math.floor((0,v.A)()))}t.enableJitterBuffer&&o.f[15](t.stats+120)/o.f[15](t.stats+232)*1e3<=o.f[15](t.stats+280)&&this.setPlayRate(t.taskId,1);const r=i-t.masterTimer.getMasterTime();r<=0?(t.renderRedyed&&!t.skipRender&&(e||-r<BigInt(100)||t.renderFrameCount&BigInt(1))?(t.render.render(t.backFrame),c.M[17](t.stats+160,o.f[17](t.stats+160)+BigInt(1)),t.lastRenderTimestamp&&c.M[15](t.stats+260,Math.max((0,v.A)()-t.lastRenderTimestamp,o.f[15](t.stats+260))),t.lastRenderTimestamp=(0,v.A)()):c.M[15](t.stats+168,o.f[15](t.stats+168)+1),c.M[17](t.stats+336,i),t.renderFrameCount++,(0,D.A)(t.backFrame)?(c.M[15](t.stats+84,o.f[15](t.backFrame+68)),c.M[15](t.stats+88,o.f[15](t.backFrame+72))):(c.M[15](t.stats+84,t.backFrame.displayWidth),c.M[15](t.stats+88,t.backFrame.displayHeight)),t.firstRendered||(t.controlIPCPort.notify(t.canvasUpdated?"firstRenderedAfterUpdateCanvas":"firstRendered"),t.firstRendered=!0,t.canvasUpdated=!1),t.currentPTS=i,i-t.lastNotifyPTS>=BigInt(1e3)&&(t.lastNotifyPTS=i,t.controlIPCPort.notify("syncPts",{pts:i})),this.swap(t),t.masterTimer.getMasterTime()-i>=BigInt(2e3)&&t.masterTimer.setMasterTime(i)):(this.fakeSyncPts(t),t.loop.emptyTask())}),0,i),t.loop.start()}else w.h2("task not found",L,683)}async restart(e){const t=this.tasks.get(e);t&&(t.loop||w.h2("task has not played",L,691),t.loop.isStarted()&&w.h2("task has already run",L,695),t.backFrame||(t.backFrame=await t.leftIPCPort.request("pull")),t.frontFrame||(t.frontFrame=await t.leftIPCPort.request("pull")),t.frontBuffered=!0,t.ended=!1,t.adjust=O.None,t.lastNotifyPTS=A.Dh,t.firstRendered=!1,t.pausing=!1,t.seeking=!1,(!t.frontFrame||u.ai(t.frontFrame)&&t.frontFrame<0)&&(t.frontBuffered=!1,t.ended=!0),t.currentPTS=(0,D.A)(t.backFrame)?(0,y.Mr)(o.f[17](t.backFrame+104),t.backFrame+120,A.i0):(0,y.k)(BigInt(t.backFrame.timestamp),A.KR,A.i0),t.masterTimer.setMasterTime(x.T9(t.startPTS,t.currentPTS)),t.loop.start())}async pause(e){const t=this.tasks.get(e);t&&(t.loop||w.h2("task has not played",L,740),t.loop.stop(),t.pausing=!0,t.lastMasterPts=t.masterTimer.getMasterTime(),w.pq(`task paused, taskId: ${t.taskId}`,L,746))}async unpause(e){const t=this.tasks.get(e);if(t){if(t.seeking)return;t.loop||w.h2("task has not played",L,757),t.masterTimer.setMasterTime(t.lastMasterPts),t.lastMasterPts=A.Dh,t.seeking||t.loop.start(),t.pausing=!1,t.lastRenderTimestamp=(0,v.A)(),w.pq(`task unpaused, taskId: ${t.taskId}`,L,767)}}async updateCanvas(e,t){const i=this.tasks.get(e);i?(i.canvas=t,i.render&&(i.render.destroy(),i.render=null),i.isSupport=()=>!1,i.canvasUpdated=!0,i.firstRendered=!1,i.renderRedyed=!1):w.h2("task not found",L,785)}async setPlayRate(e,t){const i=this.tasks.get(e);i&&(i.enableJitterBuffer&&o.f[15](i.stats+120)/o.f[15](i.stats+232)*1e3<=o.f[15](i.stats+280)&&(t=1),i.masterTimer.setRate(t),i.playRate=BigInt(Math.floor(Math.floor(100*t))))}async setRenderMode(e,t){const i=this.tasks.get(e);i&&i.render&&(i.renderMode=t,i.render.setRenderMode(t),(0,E.A)((()=>{i.pausing&&i.backFrame&&i.render&&i.render.render(i.backFrame)})))}async setRenderRotate(e,t){const i=this.tasks.get(e);i&&i.render&&(i.renderRotate=t,i.render.setRotate(t),(0,E.A)((()=>{i.pausing&&i.backFrame&&i.render&&i.render.render(i.backFrame)})))}async enableHorizontalFlip(e,t){const i=this.tasks.get(e);i&&i.render&&(i.flipHorizontal=t,i.render.enableHorizontalFlip(t),(0,E.A)((()=>{i.pausing&&i.backFrame&&i.render&&i.render.render(i.backFrame)})))}async enableVerticalFlip(e,t){const i=this.tasks.get(e);i&&i.render&&(i.flipVertical=t,i.render.enableVerticalFlip(t),(0,E.A)((()=>{i.pausing&&i.backFrame&&i.render&&i.render.render(i.backFrame)})))}async resize(e,t,i){const r=this.tasks.get(e);r&&r.render&&(r.render.viewport(t,i),(0,E.A)((()=>{r.pausing&&r.backFrame&&r.render&&r.render.render(r.backFrame)})))}async setSkipRender(e,t){const i=this.tasks.get(e);i&&(i.skipRender=t,c.M[15](i.stats+260,0),i.lastRenderTimestamp=(0,v.A)())}async setMasterTime(e,t){const i=this.tasks.get(e);i&&i.masterTimer.setMasterTime(t)}async beforeSeek(e){const t=this.tasks.get(e);t&&(t.ended||t.frontBuffered||(w.Yz(`wait current pull front frame before seek, taskId: ${t.taskId}`,L,898),await new(s())((e=>{t.seekSync=e}))),t.seeking=!0,t.loop.stop(),t.backFrame&&((0,D.A)(t.backFrame)?t.avframePool.release(t.backFrame):t.backFrame.close()),t.frontFrame&&((0,D.A)(t.frontFrame)?t.avframePool.release(t.frontFrame):t.frontFrame.close()),t.frontFrame=null,t.backFrame=null,t.currentPTS=A.Dh,w.Yz(`before seek end, taskId: ${t.taskId}`,L,926))}async syncSeekTime(e,t,i){const r=this.tasks.get(e);if(r){for(;;){if(r.afterPullResolver)return r.ended=!0,r.adjust=O.None,r.backFrame=null,void w.R8(`pull video frame end after unregisterTask, taskId: ${e}`,L,939);if(r.backFrame=await r.leftIPCPort.request("pull"),u.ai(r.backFrame)&&r.backFrame<0)return r.ended=!0,r.adjust=O.None,r.backFrame=null,void w.R8(`pull video frame end after seek, taskId: ${e}`,L,949);if(t<BigInt(0)){w.pq(`use the first video frame because of the seek time${t} < 0`,L,954);break}const i=(0,D.A)(r.backFrame)?(0,y.Mr)(o.f[17](r.backFrame+104),r.backFrame+120,A.i0):(0,y.k)(BigInt(r.backFrame.timestamp),A.KR,A.i0);if(i>=t){r.ended=!1,c.M[17](r.stats+336,i),r.lastNotifyPTS=i,r.currentPTS=i,r.masterTimer.setMasterTime(t),r.lastMasterPts=t,w.Yz(`got first video frame after syncSeekTime, pts: ${(0,D.A)(r.backFrame)?o.f[17](r.backFrame+104):BigInt(r.backFrame.timestamp)}(${r.currentPTS}ms), taskId: ${r.taskId}`,L,977);break}(0,D.A)(r.backFrame)?r.avframePool.release(r.backFrame):r.backFrame.close()}w.Yz(`sync seek time end, taskId: ${r.taskId}`,L,997)}}async afterSeek(e,t){const i=this.tasks.get(e);if(i){if(i.ended)return i.seeking=!1,i.controlIPCPort.notify("ended"),i.afterPullResolver&&(i.afterPullResolver(),i.afterPullResolver=null),void w.Yz(`after seek end with task ended, taskId: ${i.taskId}`,L,1012);if(i.frontFrame=await i.leftIPCPort.request("pull"),u.ai(i.frontFrame)&&i.frontFrame<0?(i.frontFrame=null,i.frontBuffered=!1,i.ended=!0):(i.frontBuffered=!0,i.ended=!1),i.afterPullResolver)return i.backFrame&&((0,D.A)(i.backFrame)?i.avframePool.release(i.backFrame):i.backFrame.close(),i.backFrame=null),i.frontFrame&&((0,D.A)(i.frontFrame)?i.avframePool.release(i.frontFrame):i.frontFrame.close(),i.frontFrame=null),i.seeking=!1,i.ended=!0,i.afterPullResolver(),i.afterPullResolver=null,void w.Yz(`after seek end with unregisterTask call, taskId: ${i.taskId}`,L,1051);i.adjust=O.None,i.lastRenderTimestamp=(0,v.A)(),i.currentPTS=(0,D.A)(i.backFrame)?(0,y.Mr)(o.f[17](i.backFrame+104),i.backFrame+120,A.i0):(0,y.k)(BigInt(i.backFrame.timestamp),A.KR,A.i0),c.M[17](i.stats+336,i.currentPTS),i.seeking=!1,i.pausing?i.backFrame&&i.render.render(i.backFrame):i.loop.start(),w.Yz(`after seek end, taskId: ${i.taskId}`,L,1079)}}async renderNextFrame(e){const t=this.tasks.get(e);if(t&&t.backFrame){const e=(0,D.A)(t.backFrame)?(0,y.Mr)(o.f[17](t.backFrame+104),t.backFrame+120,A.i0):(0,y.k)(BigInt(t.backFrame.timestamp),A.KR,A.i0);t.render.render(t.backFrame),c.M[17](t.stats+336,e),c.M[17](t.stats+160,o.f[17](t.stats+160)+BigInt(1)),t.currentPTS=e,t.lastMasterPts=e,this.swap(t)}}async registerTask(e){return this.tasks.has(e.taskId)?d.lh:await this.createTask(e)}async unregisterTask(e){const t=this.tasks.get(e);if(t){const i=!!t.loop;t.loop&&(await t.loop.stopBeforeNextTick(),t.loop.destroy(),t.loop=null),!i||t.ended||t.frontFrame||await new(s())((e=>{t.afterPullResolver=e})),t.render&&(t.renderRedyed&&t.render.clear(),t.render.destroy(),t.render=null),t.backFrame&&((0,D.A)(t.backFrame)&&t.backFrame>0?t.avframePool.release(t.backFrame):t.backFrame.close(),t.backFrame=null),t.frontFrame&&((0,D.A)(t.frontFrame)&&t.frontFrame>0?t.avframePool.release(t.frontFrame):t.frontFrame.close(),t.frontFrame=null),t.leftIPCPort.destroy(),t.controlIPCPort.destroy(),this.tasks.delete(e),w.Yz(`unregisterTask task, taskId: ${e}`,L,1158)}}}},30128:(e,t,i)=>{"use strict";i.d(t,{A:()=>h});var r,s,a=i(134),n=i(80662),o=i.n(n),c=i(61499),l=i(12085);class d{constructor(){(0,a.A)(this,"min",void 0),(0,a.A)(this,"max",void 0)}}r=d.prototype,(s=new(o())).set("min",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("max",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,l.A)(r,c.Og,!0),(0,l.A)(r,c.dc,4),(0,l.A)(r,c.g7,8),(0,l.A)(r,c.JY,s);class h{constructor(){(0,a.A)(this,"channels",void 0),(0,a.A)(this,"sampleRate",void 0),(0,a.A)(this,"audioFrameSize",void 0),(0,a.A)(this,"audioPacketBytes",void 0),(0,a.A)(this,"audioPacketCount",void 0),(0,a.A)(this,"audioPacketQueueLength",void 0),(0,a.A)(this,"audioDropPacketCount",void 0),(0,a.A)(this,"audioDecodeErrorPacketCount",void 0),(0,a.A)(this,"audioEncodeErrorFrameCount",void 0),(0,a.A)(this,"audioFrameDecodeCount",void 0),(0,a.A)(this,"audioPacketEncodeCount",void 0),(0,a.A)(this,"audioFrameRenderCount",void 0),(0,a.A)(this,"audioFrameDropCount",void 0),(0,a.A)(this,"width",void 0),(0,a.A)(this,"height",void 0),(0,a.A)(this,"keyFrameInterval",void 0),(0,a.A)(this,"gop",void 0),(0,a.A)(this,"videoPacketBytes",void 0),(0,a.A)(this,"videoPacketCount",void 0),(0,a.A)(this,"videoPacketQueueLength",void 0),(0,a.A)(this,"videoDropPacketCount",void 0),(0,a.A)(this,"videoDecodeErrorPacketCount",void 0),(0,a.A)(this,"videoEncodeErrorFrameCount",void 0),(0,a.A)(this,"videoFrameDecodeCount",void 0),(0,a.A)(this,"videoPacketEncodeCount",void 0),(0,a.A)(this,"videoFrameRenderCount",void 0),(0,a.A)(this,"videoFrameDropCount",void 0),(0,a.A)(this,"keyFrameCount",void 0),(0,a.A)(this,"bufferDropBytes",void 0),(0,a.A)(this,"bufferReceiveBytes",void 0),(0,a.A)(this,"bufferSendBytes",void 0),(0,a.A)(this,"bufferOutputBytes",void 0),(0,a.A)(this,"audioBitrate",void 0),(0,a.A)(this,"videoBitrate",void 0),(0,a.A)(this,"videoDecodeFramerate",void 0),(0,a.A)(this,"videoRenderFramerate",void 0),(0,a.A)(this,"videoEncodeFramerate",void 0),(0,a.A)(this,"audioDecodeFramerate",void 0),(0,a.A)(this,"audioRenderFramerate",void 0),(0,a.A)(this,"audioEncodeFramerate",void 0),(0,a.A)(this,"audioFrameDecodeIntervalMax",void 0),(0,a.A)(this,"audioFrameRenderIntervalMax",void 0),(0,a.A)(this,"videoFrameDecodeIntervalMax",void 0),(0,a.A)(this,"videoFrameRenderIntervalMax",void 0),(0,a.A)(this,"bandwidth",void 0),(0,a.A)(this,"jitter",void 0),(0,a.A)(this,"jitterBuffer",void 0),(0,a.A)(this,"audioStutter",void 0),(0,a.A)(this,"videoStutter",void 0),(0,a.A)(this,"audiocodec",void 0),(0,a.A)(this,"videocodec",void 0),(0,a.A)(this,"firstAudioMuxDts",void 0),(0,a.A)(this,"lastAudioMuxDts",void 0),(0,a.A)(this,"firstVideoMuxDts",void 0),(0,a.A)(this,"lastVideoMuxDts",void 0),(0,a.A)(this,"audioCurrentTime",void 0),(0,a.A)(this,"videoCurrentTime",void 0),(0,a.A)(this,"audioNextTime",void 0),(0,a.A)(this,"videoNextTime",void 0)}}!function(e){var t=new(o());t.set("channels",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),t.set("audioFrameSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),t.set("audioPacketBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),t.set("audioPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),t.set("audioPacketQueueLength",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),t.set("audioDropPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:40,8:0}),t.set("audioDecodeErrorPacketCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:48,8:0}),t.set("audioEncodeErrorFrameCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:52,8:0}),t.set("audioFrameDecodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:56,8:0}),t.set("audioPacketEncodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:64,8:0}),t.set("audioFrameRenderCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),t.set("audioFrameDropCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),t.set("width",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),t.set("height",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:88,8:0}),t.set("keyFrameInterval",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:92,8:0}),t.set("gop",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:96,8:0}),t.set("videoPacketBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:104,8:0}),t.set("videoPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:112,8:0}),t.set("videoPacketQueueLength",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:120,8:0}),t.set("videoDropPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:128,8:0}),t.set("videoDecodeErrorPacketCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:136,8:0}),t.set("videoEncodeErrorFrameCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:140,8:0}),t.set("videoFrameDecodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:144,8:0}),t.set("videoPacketEncodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:152,8:0}),t.set("videoFrameRenderCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:160,8:0}),t.set("videoFrameDropCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:168,8:0}),t.set("keyFrameCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:176,8:0}),t.set("bufferDropBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:184,8:0}),t.set("bufferReceiveBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:192,8:0}),t.set("bufferSendBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:200,8:0}),t.set("bufferOutputBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:208,8:0}),t.set("audioBitrate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:216,8:0}),t.set("videoBitrate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:220,8:0}),t.set("videoDecodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:224,8:0}),t.set("videoRenderFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:228,8:0}),t.set("videoEncodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:232,8:0}),t.set("audioDecodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:236,8:0}),t.set("audioRenderFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:240,8:0}),t.set("audioEncodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:244,8:0}),t.set("audioFrameDecodeIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:248,8:0}),t.set("audioFrameRenderIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:252,8:0}),t.set("videoFrameDecodeIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:256,8:0}),t.set("videoFrameRenderIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:260,8:0}),t.set("bandwidth",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:264,8:0}),t.set("jitter",{0:19,1:0,2:0,3:0,4:0,5:0,6:0,7:272,8:0}),t.set("jitterBuffer",{0:d,1:0,2:0,3:0,4:0,5:0,6:0,7:280,8:0}),t.set("audioStutter",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:288,8:0}),t.set("videoStutter",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:292,8:0}),t.set("firstAudioMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:296,8:0}),t.set("lastAudioMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:304,8:0}),t.set("firstVideoMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:312,8:0}),t.set("lastVideoMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:320,8:0}),t.set("audioCurrentTime",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:328,8:0}),t.set("videoCurrentTime",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:336,8:0}),t.set("audioNextTime",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:344,8:0}),t.set("videoNextTime",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:352,8:0}),(0,l.A)(e,c.Og,!0),(0,l.A)(e,c.dc,8),(0,l.A)(e,c.g7,360),(0,l.A)(e,c.JY,t)}(h.prototype)},61634:(e,t,i)=>{"use strict";i.d(t,{Ay:()=>je,KU:()=>ze});var r=i(134),s=i(66681),a=i.n(s),n=i(73146),o=i.n(n),c=i(54001),l=i.n(c),d=i(80662),h=i.n(d),u=i(61499),f=i(52277),p=i(74503),m=i(63939),g=i(9599),v=i(29170),y=i(77162),A=i(94300),b=i(87243),w=i(72480),x=i(31138),k=i(18667),T=i(88506),I=i(96172),S=i(8284),P=i(67672),_=i(95335),M=i(76045),C=i(56024),B=i(71517),E=i(59377),D=i(33968),R=i(8507),U=i(26429),L=i(41324),$=i(88397),F=i(11473),O=i(11628),N=i(28090),z=i(47595),V=i(4624),W=i(95797),j=i(48641),G=i(36),H=i(86834),q=i(44328),Y=i(77231),K=(i(30128),i(14686)),Q=i(67593),X=i(28875),J=i(10333),Z=i(85224),ee=i(25115),te=i(39365),ie=i(13724),re=i(78201),se=i(73783),ae=i(43607),ne=i(76750),oe=i(2368),ce=i(79756),le=i(62751),de=i(548),he=i(72739),ue=i(24310),fe=i(93147),pe=i(40031),me=i(94561),ge=i(44690),ve=i(84149),ye=i(9705),Ae=i(77580),be=i(79686),we=i(49847),xe=i(71762),ke=i(29998),Te=i(40097),Ie=i(21678),Se=i(21862),Pe=i(364),_e=i(14619),Me=i(36773),Ce=i(42383),Be=i(67603),Ee=i(50315),De=i(3680),Re=i(61619),Ue=i(37837),Le=i(80089),$e=i(30691),Fe=i(50011);const Oe="src/avplayer/AVPlayer.ts",Ne={1:"cover",0:"contain"},ze=[27,173,12,196,225,139,167,30,2,1,3,4,20,19,14,15,16,5,6,68,69,17,18,71,7,86018,86017,86076,86028,86051,86021,86019,86056,86020,86023,86024,86052,86054,86053,86036,86057,86073,94226,94225,94230,94212,94232,94213,94210],Ve=[27,173,225,139,167,86018,86017,86076,86028,86021],We={enableHardware:!0,enableWebGPU:!0,enableWorker:!0,enableWebCodecs:!0,loop:!1,enableJitterBuffer:!0,jitterBufferMax:4,jitterBufferMin:1,lowLatency:!1,preLoadTime:4};class je extends I.A{constructor(e){super(!0),(0,r.A)(this,"VideoDecoderThread",void 0),(0,r.A)(this,"VideoRenderThread",void 0),(0,r.A)(this,"VideoPipelineProxy",void 0),(0,r.A)(this,"GlobalData",void 0),(0,r.A)(this,"taskId",void 0),(0,r.A)(this,"subTaskId",void 0),(0,r.A)(this,"subtitleTaskId",void 0),(0,r.A)(this,"ext",void 0),(0,r.A)(this,"source",void 0),(0,r.A)(this,"ioIPCPort",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"ioloader2DemuxerChannel",void 0),(0,r.A)(this,"demuxer2VideoDecoderChannel",void 0),(0,r.A)(this,"demuxer2AudioDecoderChannel",void 0),(0,r.A)(this,"videoDecoder2VideoRenderChannel",void 0),(0,r.A)(this,"audioDecoder2AudioRenderChannel",void 0),(0,r.A)(this,"audioRender2AudioWorkletChannel",void 0),(0,r.A)(this,"audioSourceNode",void 0),(0,r.A)(this,"gainNode",void 0),(0,r.A)(this,"formatContext",void 0),(0,r.A)(this,"canvas",void 0),(0,r.A)(this,"updateCanvas",void 0),(0,r.A)(this,"video",void 0),(0,r.A)(this,"audio",void 0),(0,r.A)(this,"controller",void 0),(0,r.A)(this,"volume",void 0),(0,r.A)(this,"playRate",void 0),(0,r.A)(this,"renderMode",void 0),(0,r.A)(this,"renderRotate",void 0),(0,r.A)(this,"flipHorizontal",void 0),(0,r.A)(this,"flipVertical",void 0),(0,r.A)(this,"useMSE",void 0),(0,r.A)(this,"audioEnded",void 0),(0,r.A)(this,"videoEnded",void 0),(0,r.A)(this,"status",void 0),(0,r.A)(this,"lastStatus",void 0),(0,r.A)(this,"playChannels",void 0),(0,r.A)(this,"seekedTimestamp",void 0),(0,r.A)(this,"isLive_",void 0),(0,r.A)(this,"drmSystemKey",void 0),(0,r.A)(this,"drmSession",void 0),(0,r.A)(this,"stopPending",void 0),(0,r.A)(this,"statsController",void 0),(0,r.A)(this,"jitterBufferController",void 0),(0,r.A)(this,"selectedVideoStream",void 0),(0,r.A)(this,"selectedAudioStream",void 0),(0,r.A)(this,"selectedSubtitleStream",void 0),(0,r.A)(this,"lastSelectedInnerSubtitleStreamIndex",void 0),(0,r.A)(this,"subtitleRender",void 0),(0,r.A)(this,"externalSubtitleTasks",void 0),this.options=_.X$({},We,e),this.taskId=(0,S.A)(),this.status=0,this.volume=1,this.playRate=1,this.renderMode=0,this.renderRotate=0,this.flipHorizontal=!1,this.flipVertical=!1,this.seekedTimestamp=Y.Dh,this.isLive_=!!e.isLive,this.GlobalData=(0,p.A)(f.M),this.statsController=new re.A(this.GlobalData[u.o9]+32,!(U.USE_THREADS||!W.A.worker||!this.options.enableWorker),this),this.externalSubtitleTasks=[],this.lastSelectedInnerSubtitleStreamIndex=-1,se.Ts(this.GlobalData[u.o9]+24),se.Ts(this.GlobalData[u.o9]+28),je.Instances.push(this),V.pq(`create player, taskId: ${this.taskId}`,Oe,618)}get currentTime(){var e;return this.useMSE?BigInt(Math.floor(1e3*((null===(e=this.video||this.audio)||void 0===e?void 0:e.currentTime)||0))):this.selectedAudioStream&&this.selectedVideoStream?ae.T9(this.GlobalData.stats.audioCurrentTime,this.GlobalData.stats.videoCurrentTime):this.selectedAudioStream?this.GlobalData.stats.audioCurrentTime:this.selectedVideoStream?this.GlobalData.stats.videoCurrentTime:BigInt(0)}isCodecIdSupported(e,t,i=!1){return e>65536&&e<=65572||e>=69632&&e<=69683||he.zy(!i||1!==t&&0!==t?ze:Ve,e)}findBestStream(e,t,i=!1){if(this.options.findBestStream)return this.options.findBestStream(e,t);const r=e.filter((e=>m.f[15](e.codecpar)===t));if(r.length){if(1===r.length)return r[0];const e=r.find((e=>!!(1&e.disposition)));return e&&this.isCodecIdSupported(m.f[15](e.codecpar+4),m.f[15](e.codecpar),i)?e:r.find((e=>this.isCodecIdSupported(m.f[15](e.codecpar+4),m.f[15](e.codecpar),i)))||r[0]}}async checkUseMSE(e){{if(!W.A.mse)return V.R8("disable mse because of not support mse",Oe,682),!1;if(!W.A.wasmPlayerSupported)return V.R8("use mse because of not support wasm",Oe,688),!0;const t=this.findBestStream(this.formatContext.streams,0,!0),i=this.findBestStream(this.formatContext.streams,1,!0);if(e.video&&t&&!(0,ne.A)().isTypeSupported((0,J.A)(t.codecpar)))return V.R8(`can not support mse for codec: ${(0,J.A)(t.codecpar)}, taskId: ${this.taskId}`,Oe,697),!1;if(e.audio&&i&&!(0,ne.A)().isTypeSupported((0,Z.A)(i.codecpar)))return V.R8(`can not support mse for codec: ${(0,Z.A)(i.codecpar)}, taskId: ${this.taskId}`,Oe,701),!1;if(e.video&&t&&t.metadata.encryption||e.audio&&i&&i.metadata.encryption)return!0;if(10===this.formatContext.format)return!1;if(this.options.checkUseMES)return this.options.checkUseMES(this.formatContext.streams);if(t&&e.video){if((0,ue.A)(t.codecpar))return V.R8("use mse because of hdr",Oe,725),!0;if(this.isMediaStreamMode()&&!W.A.trackGenerator){if(H.A.firefox&&(0,z.A)()&&(U.USE_THREADS||W.A.worker&&this.options.enableWorker))return V.R8("use mse because of cannot use captureStream in OffscreenCanvas on firefox",Oe,740),!0;if(H.A.safari||ge.A.ios)return V.R8("disable mse because of cannot use captureStream in HTMLMediaElement on safari",Oe,745),!1}if(m.f[15](t.codecpar+56)*m.f[15](t.codecpar+60)>2073600){if(!W.A.videoDecoder)return V.R8("use mse because of cannot use webcodec VideoDecoder with resolution more then 1080p",Oe,754),!0;if(this.isMediaStreamMode()&&!W.A.trackGenerator)return V.R8("use mse because of cannot use MediaStreamTrackGenerator with resolution more then 1080p in MediaStream mode",Oe,759),!0;let e=null;0!==m.f[20](t.codecpar+12)&&(e=(0,K.s3)(m.f[20](t.codecpar+12),m.f[15](t.codecpar+16)));try{const i={codec:(0,X.A)(t.codecpar),codedWidth:m.f[15](t.codecpar+56),codedHeight:m.f[15](t.codecpar+60),description:1&m.f[15](t.codecpar+160)?void 0:e,hardwareAcceleration:(0,te.C)(!0)};if(i.description||delete i.description,!(await VideoDecoder.isConfigSupported(i)).supported)return V.R8("use mse because of cannot use webcodec hardwareAcceleration VideoDecoder with resolution more then 1080p",Oe,783),!0}catch(e){}}else if(m.f[15](t.codecpar+56)*m.f[15](t.codecpar+60)==2073600&&(H.A.safari&&!H.A.checkVersion(H.A.version,"16.1",!0)||ge.A.ios&&!H.A.checkVersion(ge.A.version,"16.1",!0))&&(0,q.lb)((0,v.A)(t.codecpar+72,g.P))>30)return!0}}return!1}createCanvas(){const e=document.createElement("canvas");return e.id="avplayer-canvas-"+(0,S.A)(),e.className="avplayer-canvas",e.style.cssText="\n      width: 100%;\n      height: 100%;\n    ",e.ondragstart=()=>!1,a()(e,"currentTime",{enumerable:!0,configurable:!1,get:()=>Number(this.currentTime)/1e3,set:e=>{this.seek(BigInt(Math.floor(Math.floor(1e3*e))))}}),e}createVideo(){this.video&&!this.isMediaStreamMode()&&this.options.container.removeChild(this.video);const e=document.createElement("video");e.autoplay=!0,e.className="avplayer-video",e.style.cssText="\n      width: 100%;\n      height: 100%;\n    ",this.isMediaStreamMode()||this.options.container.appendChild(e),this.video=e}createAudio(){this.audio&&!this.isMediaStreamMode()&&this.options.container.removeChild(this.audio);const e=document.createElement("audio");e.autoplay=!0,e.className="avplayer-audio",this.isMediaStreamMode()||this.options.container.appendChild(e),this.audio=e}handleTimeupdate(e){let t=0;e.ontimeupdate=()=>{const i=e.currentTime;Math.abs(i-t)>=1&&(6===this.status&&(this.fire(N.E9,[this.currentTime]),je.MSEThread.setCurrentTime(this.taskId,i)),t=i)},e.onended=()=>{this.audioEnded=!0,this.videoEnded=!0,this.handleEnded()},e.onwaiting=()=>{this.audio===e?this.GlobalData.stats.audioStutter++:(this.GlobalData.stats.audioStutter++,this.GlobalData.stats.videoStutter++)},e.oncanplay=()=>{6===this.status&&e.play()},e.onencrypted=async t=>{if(this.drmSession)return;this.drmSession=e.mediaKeys.createSession(),this.drmSession.onmessage=async e=>{var t;let i,r;if(this.isDash()){if(this.hasVideo()){const e=await je.IOThread.getCurrentProtection(this.taskId,0);null!=e&&e.url&&(i=e.url)}if(!i&&this.hasAudio()){const e=await je.IOThread.getCurrentProtection(this.taskId,1);null!=e&&e.url&&(i=e.url)}}if(null!==(t=this.options.drmSystemOptions)&&void 0!==t&&t.onRequest)r=await this.options.drmSystemOptions.onRequest(this.drmSystemKey,e.messageType,e.message,i);else if(this.options.drmSystemOptions.requestUrl){var s,a,n;r=await fetch(this.options.drmSystemOptions.requestUrl,{method:null!==(s=null===(a=this.options.drmSystemOptions)||void 0===a?void 0:a.method)&&void 0!==s?s:"POST",headers:null===(n=this.options.drmSystemOptions)||void 0===n?void 0:n.header,body:e.message}).then((e=>e.arrayBuffer()))}else if(i){var o,c,l,d;r=await fetch(i,{method:null!==(o=null===(c=this.options.drmSystemOptions)||void 0===c?void 0:c.method)&&void 0!==o?o:"POST",headers:null!==(l=null===(d=this.options.drmSystemOptions)||void 0===d?void 0:d.header)&&void 0!==l?l:{"Content-Type":"application/json"},body:e.message}).then((e=>e.arrayBuffer()))}r&&await this.drmSession.update(r)};let i=t.initDataType,r=t.initData;if(this.drmSystemKey===Le.s.CLEARKEY){const e=[];if(this.selectedAudioStream){const t=this.selectedAudioStream.metadata.encryption;null!=t&&t.kid&&e.push((0,$e.A)(t.kid))}if(this.selectedVideoStream){const t=this.selectedVideoStream.metadata.encryption;if(null!=t&&t.kid){const i=(0,$e.A)(t.kid);i!==e[0]&&e.push(i)}}i="keyids",r=Fe.encode(o()({kids:e})).buffer}await this.drmSession.generateRequest(i,r)}}async replayTo(e){let t=-BigInt(1);this.isDash()||this.isHls()?(t=await je.DemuxerThread.seek(this.taskId,e,16),this.subTaskId&&await je.DemuxerThread.seek(this.subTaskId,e,16),this.subtitleTaskId&&await je.DemuxerThread.seek(this.subtitleTaskId,e,16)):t=await je.DemuxerThread.seek(this.taskId,e,8);for(let t=0;t<this.externalSubtitleTasks.length;t++)await je.DemuxerThread.seek(this.externalSubtitleTasks[0].taskId,e,8);if(this.fire(N.E9,[e]),this.useMSE){var i;null!==(i=this.video||this.audio)&&void 0!==i&&i.src&&URL.revokeObjectURL((this.video||this.audio).src),await je.MSEThread.restart(this.taskId);const t=await je.MSEThread.getMediaSource(this.taskId);var r,s;t&&(W.A.workerMSE&&t instanceof MediaSourceHandle?(this.video||this.audio).srcObject=t:(this.video||this.audio).src=URL.createObjectURL(t),this.video?(this.video.currentTime=Number(e)/1e3,this.video.playbackRate=this.playRate):this.audio&&(this.audio.currentTime=Number(e)/1e3,this.audio.playbackRate=this.playRate),await l().all([null===(r=this.video)||void 0===r?void 0:r.play(),null===(s=this.audio)||void 0===s?void 0:s.play()]))}else{let i=20;this.formatContext.streams.forEach((e=>{0===m.f[15](e.codecpar)&&(i=Math.max(Math.ceil((0,q.lb)((0,v.A)(e.codecpar+72,g.P))),i))})),this.audioDecoder2AudioRenderChannel&&(await je.AudioDecoderThread.resetTask(this.taskId),await je.AudioRenderThread.syncSeekTime(this.taskId,t>=0?t>e?t:e:Y.Dh,i),await je.AudioRenderThread.restart(this.taskId),this.controller.setTimeUpdateListenType(1)),this.audioSourceNode&&(await this.audioSourceNode.request("restart"),"suspended"===je.audioContext.state&&await je.AudioRenderThread.fakePlay(this.taskId),this.audioEnded=!1),this.videoDecoder2VideoRenderChannel&&(await this.VideoDecoderThread.resetTask(this.taskId),await this.VideoRenderThread.beforeSeek(this.taskId),await this.VideoRenderThread.syncSeekTime(this.taskId,t>=0?t>e?t:e:Y.Dh,i),await this.VideoRenderThread.restart(this.taskId),this.videoEnded=!1)}this.subtitleRender&&(this.subtitleRender.reset(),this.subtitleRender.start())}async handleEnded(){this.audioEnded&&this.videoEnded&&(V.pq(`player ended, taskId: ${this.taskId}`,Oe,1065),this.options.loop&&!this.isLive_?(V.pq(`loop play, taskId: ${this.taskId}`,Oe,1069),await this.replayTo(BigInt(0))):(this.status=7,this.fire(N.hV)))}isHls(){return"m3u8"===this.ext||"m3u"===this.ext}isDash(){return"mpd"===this.ext}getMinStartPTS(){let e=Y.Dh;for(const t of this.formatContext.streams)t.startTime!==Y.Dh&&(e=e===Y.Dh?(0,q.k)(t.startTime,t.timeBase,Y.i0):ae.jk(e,(0,q.k)(t.startTime,t.timeBase,Y.i0)));return e<BigInt(1e3)?BigInt(0):e}async getResource(e,t,i){var r;const s=null!=t?`${e}-${t}`:e;if(je.Resource.has(s))return je.Resource.get(s);const a=this.options.getWasm?this.options.getWasm(e,t,i):(0,Be.A)(null!==(r=this.options.wasmBaseUrl)&&void 0!==r?r:`https://cdn.jsdelivr.net/gh/zhaohappy/libmedia@${"v0.6.1-201-g886de17a".split("-")[0].replace(/^[v|n]/,"")}/dist`,e,t);if(a){let e;if((H.A.safari&&!H.A.checkVersion(H.A.version,"16.3",!1)||ge.A.ios&&!H.A.checkVersion(ge.A.version,"16.3",!1))&&(P.Yj(a)||P.sv(a)))if(P.Yj(a)){const t={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"},i=await fetch(a,t);e=await i.arrayBuffer()}else e=a;else e=await(0,me.A)(a,0===i);return je.Resource.set(s,e),e}}createSubtitleRender(e,t){var i,r,s,a;this.isMediaStreamMode()||(this.subtitleRender=new pe.A({dom:this.canvas||this.video||this.options.container,getCurrentTime:()=>this.currentTime,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24,codecpar:e.codecpar,container:this.options.container,videoWidth:null!==(i=m.f[15]((null===(r=this.selectedVideoStream)||void 0===r?void 0:r.codecpar)+56))&&void 0!==i?i:0,videoHeight:null!==(s=m.f[15]((null===(a=this.selectedVideoStream)||void 0===a?void 0:a.codecpar)+60))&&void 0!==s?s:0}),this.subtitleRender.setDemuxTask(t),this.selectedSubtitleStream=e,t===this.taskId&&(this.lastSelectedInnerSubtitleStreamIndex=e.index),je.DemuxerThread.connectStreamTask.transfer(this.subtitleRender.getDemuxerPort(t)).invoke(t,e.index,this.subtitleRender.getDemuxerPort(t)))}async loadExternalSubtitle(e){if(1!==this.status&&2!==this.status||V.h2("player has already destroyed",Oe,1207),e.source||V.h2("external subtitle must has source",Oe,1211),this.externalSubtitleTasks.some((t=>t.source===e.source)))return void V.R8("external subtitle has already loaded",Oe,1215);const t=(0,S.A)(),i=(0,Q.A)(this.options.enableWorker),r=_.X$({taskId:t,streamId:-1,ioloader2DemuxerChannel:i},e);let s="",a=0,n=0;P.Yj(e.source)?(n|=4,s=R.qg(e.source).file.split(".").pop(),a=await je.IOThread.registerTask.transfer(i.port1).invoke({type:0,info:{url:e.source},range:{from:-1,to:-1},taskId:t,options:{isLive:this.isLive_},rightPort:i.port1,stats:this.GlobalData[u.o9]+32})):(s=e.source.name.split(".").pop(),a=await je.IOThread.registerTask.transfer(i.port1).invoke({type:1,info:{file:e.source},range:{from:-1,to:-1},taskId:t,options:{isLive:this.isLive_},rightPort:i.port1,stats:this.GlobalData[u.o9]+32})),a<0&&V.h2(`register io task failed, ret: ${a}, taskId: ${this.taskId}`,Oe,1279),await je.DemuxerThread.registerTask.transfer(i.port2).invoke({taskId:t,leftPort:i.port2,format:le.HR[s],stats:0,isLive:!1,flags:n,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24}),a=await je.DemuxerThread.openStream(t),a<0&&V.h2(`open external subtitle failed, ret: ${a}, taskId: ${t}`,Oe,1296);let o=await je.DemuxerThread.analyzeStreams(t);if(P.ai(o))return void V.h2(`analyze stream failed, ret: ${o}`,Oe,1300);o.streams.length||V.h2("not found any stream",Oe,1304);const c=o.streams[0];this.formatContext.streams.push(c),r.streamId=c.id,e.lang&&(c.metadata.language=e.lang),e.title&&(c.metadata.title=e.title);const l=8===this.status||6===this.status||9===this.status||10===this.status;return l&&await je.DemuxerThread.seek(t,this.currentTime,8),l&&!this.subtitleRender?(this.createSubtitleRender(c,t),this.subtitleRender.start()):this.subtitleRender&&await je.DemuxerThread.connectStreamTask.transfer(this.subtitleRender.getDemuxerPort(t)).invoke(t,c.index,this.subtitleRender.getDemuxerPort(t)),await je.DemuxerThread.startDemux(t,!1,10),this.externalSubtitleTasks.push(r),this.fire(N.xv),0}async load(e,t={}){7===this.status&&await this.stop(!0),V.pq(`call load, taskId: ${this.taskId}`,Oe,1360),this.status=3,this.fire(N.F5),P.zM(t.isLive)?this.isLive_=t.isLive:this.isLive_=!!this.options.isLive,this.controller=new O.A(this,this.options.enableWorker),this.ioloader2DemuxerChannel=(0,Q.A)(this.options.enableWorker),(0,K.sO)(this.GlobalData[u.o9]+32,0,360),this.externalSubtitleTasks.length=0,await je.startDemuxPipeline(this.options.enableWorker);let i=0,r=0;if(P.Yj(e)){i|=4;let{info:s,type:a,ext:n}=await(0,Pe.A)(e,t.ext,t.http);this.ext=n,r=await je.IOThread.registerTask.transfer(this.ioloader2DemuxerChannel.port1).invoke({type:a,info:{...s,httpOptions:t.http,webtransportOptions:t.webtransport,websocketOptions:t.websocket,uri:t.uri},range:{from:-1,to:-1},taskId:this.taskId,options:{isLive:this.isLive_},rightPort:this.ioloader2DemuxerChannel.port1,stats:this.GlobalData[u.o9]+32})}else e instanceof File?(this.isLive_=!1,this.ext=e.name.split(".").pop(),r=await je.IOThread.registerTask.transfer(this.ioloader2DemuxerChannel.port1).invoke({type:1,info:{file:e},range:{from:-1,to:-1},taskId:this.taskId,options:{isLive:!1},rightPort:this.ioloader2DemuxerChannel.port1,stats:this.GlobalData[u.o9]+32})):e instanceof we.A?(i|=e.flags||0,this.ext=e.ext,this.ioIPCPort=new ve.Ay(this.ioloader2DemuxerChannel.port1),this.ioIPCPort.on(ve.S3,(async t=>{switch(t.method){case"open":try{const i=await e.open();if(i<0){V.z3(`custom loader open error, ${i}, taskId: ${this.taskId}`,Oe,1445),this.ioIPCPort.reply(t,null,i);break}this.ioIPCPort.reply(t,i)}catch(e){V.z3(`loader open error, ${e}, taskId: ${this.taskId}`,Oe,1452),this.ioIPCPort.reply(t,null,e)}break;case"read":{const i=t.params.pointer,r=t.params.length,s=t.params.ioloaderOptions,a=je.IODemuxProxy?new Uint8Array(r):(0,K.JW)(i,r);try{const i=await e.read(a,s);i<0?this.ioIPCPort.reply(t,i,null):(this.GlobalData.stats.bufferReceiveBytes+=BigInt(0|i),this.ioIPCPort.reply(t,je.IODemuxProxy?a.subarray(0,i):i,null,je.IODemuxProxy?[a.buffer]:null))}catch(e){V.z3(`loader read error, ${e}, taskId: ${this.taskId}`,Oe,1475),this.ioIPCPort.reply(t,ye.LR)}break}case"write":{const i=t.params.pointer,r=t.params.length,s=(0,K.JW)(i,r);try{const i=await e.write(s);this.GlobalData.stats.bufferSendBytes+=r,this.ioIPCPort.reply(t,i)}catch(e){V.z3(`loader write error, ${e}, taskId: ${this.taskId}`,Oe,1497),this.ioIPCPort.reply(t,ye.LR)}break}case"seek":{const i=t.params.pos,r=t.params.ioloaderOptions;try{const s=await e.seek(i,r);if(s<0){V.z3(`custom loader seek error, ${s}, taskId: ${this.taskId}`,Oe,1513),this.ioIPCPort.reply(t,null,s);break}this.ioIPCPort.reply(t,s)}catch(e){V.z3(`loader seek error, ${e}, taskId: ${this.taskId}`,Oe,1520),this.ioIPCPort.reply(t,null,e)}break}case"size":this.ioIPCPort.reply(t,await e.size())}}))):V.h2("invalid source",Oe,1534);r<0&&V.h2(`register io task failed, ret: ${r}, taskId: ${this.taskId}`,Oe,1538),(this.isDash()||this.isHls())&&(i|=2);const s=_.X$({},t.formatOptions||{});if(this.isDash()||this.isHls()){await je.IOThread.open(this.taskId);const e=await je.IOThread.hasAudio(this.taskId),t=await je.IOThread.hasVideo(this.taskId);e&&t?(this.subTaskId=(0,S.A)(),await je.DemuxerThread.registerTask.transfer(this.ioloader2DemuxerChannel.port2,this.controller.getDemuxerControlPort()).invoke({taskId:this.taskId,leftPort:this.ioloader2DemuxerChannel.port2,controlPort:this.controller.getDemuxerControlPort(),format:le.HR[this.ext],stats:this.GlobalData[u.o9]+32,isLive:this.isLive_,flags:i,ioloaderOptions:{mediaType:1},formatOptions:s,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24}),await je.DemuxerThread.registerTask({taskId:this.subTaskId,mainTaskId:this.taskId,flags:i,format:le.HR[this.ext],stats:this.GlobalData[u.o9]+32,isLive:this.isLive_,ioloaderOptions:{mediaType:0},formatOptions:s,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24})):(e||t)&&await je.DemuxerThread.registerTask.transfer(this.ioloader2DemuxerChannel.port2,this.controller.getDemuxerControlPort()).invoke({taskId:this.taskId,leftPort:this.ioloader2DemuxerChannel.port2,controlPort:this.controller.getDemuxerControlPort(),format:le.HR[this.ext],stats:this.GlobalData[u.o9]+32,isLive:this.isLive_,flags:i,ioloaderOptions:{mediaType:e?1:0},formatOptions:s,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24})}else"rtsp"!==this.ext&&"rtmp"!==this.ext||(s.uri=t.uri||e.replace(/^\S+:\/\//,this.ext+"://")),await je.DemuxerThread.registerTask.transfer(this.ioloader2DemuxerChannel.port2,this.controller.getDemuxerControlPort()).invoke({taskId:this.taskId,leftPort:this.ioloader2DemuxerChannel.port2,controlPort:this.controller.getDemuxerControlPort(),format:le.HR[this.ext],formatOptions:s,stats:this.GlobalData[u.o9]+32,isLive:this.isLive_,flags:i,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24});(this.isDash()||this.isHls())&&await je.IOThread.hasSubtitle(this.taskId)&&(this.subtitleTaskId=(0,S.A)(),await je.DemuxerThread.registerTask({taskId:this.subtitleTaskId,mainTaskId:this.taskId,flags:i,format:le.HR[this.ext],stats:this.GlobalData[u.o9]+32,isLive:this.isLive_,ioloaderOptions:{mediaType:3},avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24})),this.fire(N.Gd,[0]),r=await je.DemuxerThread.openStream(this.taskId),r<0&&V.h2(`open stream failed, ret: ${r}, taskId: ${this.taskId}`,Oe,1656),this.fire(N.Gd,[1,this.ext]);let a=await je.DemuxerThread.analyzeStreams(this.taskId);if(P.ai(a))V.h2(`analyze stream failed, ret: ${a}`,Oe,1663);else{if(a.streams.length||V.h2("not found any stream",Oe,1667),this.subTaskId){r=await je.DemuxerThread.openStream(this.subTaskId),r<0&&V.h2(`open stream failed, ret: ${r}, taskId: ${this.subTaskId}`,Oe,1673);const e=await je.DemuxerThread.analyzeStreams(this.subTaskId);if(P.ai(e))return void V.h2(`analyze stream failed, ret: ${e}`,Oe,1677);e.streams.length||V.h2("not found any stream",Oe,1681),a.streams=a.streams.concat(e.streams)}if(this.subtitleTaskId){r=await je.DemuxerThread.openStream(this.subtitleTaskId),r<0&&V.h2(`open subtitle stream failed, ret: ${r}, taskId: ${this.subtitleTaskId}`,Oe,1689);const e=await je.DemuxerThread.analyzeStreams(this.subtitleTaskId);if(P.ai(e))return void V.h2(`analyze subtitle stream failed, ret: ${e}`,Oe,1693);e.streams.length||V.h2("not found any stream",Oe,1697),a.streams=a.streams.concat(e.streams)}if(this.formatContext=a,this.source=e,t.externalSubtitles)for(let e=0;e<t.externalSubtitles.length;e++)await this.loadExternalSubtitle(t.externalSubtitles[e]);if(a.streams.forEach((e=>{1===m.f[15](e.codecpar)?this.GlobalData.stats.audiocodec=(0,ce.A)(e.codecpar):0===m.f[15](e.codecpar)&&(this.GlobalData.stats.videocodec=(0,X.A)(e.codecpar))})),this.isHls()||this.isDash()){const e=1e3*await je.IOThread.getDuration(this.taskId);if(e>0)for(let t=0;t<this.formatContext.streams.length;t++)this.formatContext.streams[t].duration=(0,q.k)(BigInt(Math.floor(e)),Y.i0,this.formatContext.streams[t].timeBase)}if(this.isLive_&&this.options.enableJitterBuffer){const e=Math.max(this.source instanceof we.A?this.source.minBuffer:await je.IOThread.getMinBuffer(this.taskId),this.options.jitterBufferMin);let t=this.options.jitterBufferMax;t<=e&&(t=e+(this.isHls()||this.isDash()?e:1)),this.jitterBufferController=new oe.A({stats:this.GlobalData[u.o9]+32,jitterBuffer:this.GlobalData.stats[u.o9]+280,lowLatencyStart:!(this.isHls()||this.isDash()),lowLatency:this.options.lowLatency,useMse:this.useMSE,max:t,min:e,observer:{onCroppingBuffer:e=>{var t;V.Yz(`cropping buffer by jitter buffer, max: ${e}, taskId: ${this.taskId}`,Oe,1757),null===(t=je.DemuxerThread)||void 0===t||t.croppingAVPacketQueue(this.taskId,BigInt(0|e))},onSetPlayRate:e=>{V.Yz(`set play rate by jitter buffer, rate: ${e}, taskId: ${this.taskId}`,Oe,1761),this.useMSE?(je.MSEThread.setPlayRate(this.taskId,e),this.video?this.video.playbackRate=e:this.audio&&(this.audio.playbackRate=e)):(this.audioDecoder2AudioRenderChannel&&je.AudioRenderThread.setPlayTempo(this.taskId,e),this.videoDecoder2VideoRenderChannel&&this.VideoRenderThread.setPlayRate(this.taskId,e))}}})}if(V.pq(`taskId: ${this.taskId}\nAVPlayer version v0.6.1-201-g886de17a Copyright (c) 2024-present the libmedia developers\n`+(0,de.Ay)([a],[{from:P.Yj(e)?e:e.name,tag:"Input",isLive:this.isLive_}]),Oe,1784),!this.isLive_){let e=Y.Dh;a.streams.forEach((t=>{const i=(0,q.k)(t.startTime,t.timeBase,Y.i0);1!==m.f[15](t.codecpar)&&0!==m.f[15](t.codecpar)||(i<e||e===-BigInt(1))&&(e=i)})),e<BigInt(0)&&e!==Y.Dh&&await this.seek(BigInt(0))}this.status=4,this.fire(N.S2)}}async playUseMSE(e){{await je.startMSEPipeline(this.options.enableWorker);const i=this.findBestStream(this.formatContext.streams,0,!0),r=this.findBestStream(this.formatContext.streams,1,!0);let s=!1,a="",n=[];const o=async e=>{const t=(0,B.Un)(e.codecpar+20,e.codecpar+24,24);let i;if(t)i=(0,Ee.ZK)((0,K.s3)(m.f[20](t),m.f[25](t+4)));else if(this.isDash()){const t=await je.IOThread.getCurrentProtection(this.taskId,m.f[15](e.codecpar));if(t){i=[{systemId:t.systemId,keyIds:[t.kid],data:new Uint8Array(0)}];const r=(0,Ee.bE)(i),s=(0,Ue.sY)(r.length);(0,K.lW)(s,r.length,r),(0,B.$W)(e.codecpar+20,e.codecpar+24,24,s,r.length)}}const r=e.metadata.encryption;if(i&&r){for(let t=0;t<i.length;t++){const o=(0,De.A)(i[t].systemId);if((!a||a===o)&&o)try{const t=[{initDataTypes:["keyids","cenc"]}];var s;if(0===m.f[15](e.codecpar))t[0].videoCapabilities=[{contentType:(0,J.A)(e.codecpar),encryptionScheme:(0,Re.A)(r.schemeType),robustness:null===(s=this.options.drmSystemOptions)||void 0===s?void 0:s.videoRobustness}];else if(1===m.f[15](e.codecpar)){var n;t[0].audioCapabilities=[{contentType:(0,Z.A)(e.codecpar),robustness:null===(n=this.options.drmSystemOptions)||void 0===n?void 0:n.audioRobustness}]}return await navigator.requestMediaKeySystemAccess(o,t),{key:o,config:t}}catch(e){V.R8(`drm system ${o} error ${e}`,Oe,1887)}}a&&V.h2("audio and video has different drm system key",Oe,1892)}};if(await je.MSEThread.registerTask.transfer(this.controller.getMuxerControlPort()).invoke({taskId:this.taskId,stats:this.GlobalData[u.o9]+32,controlPort:this.controller.getMuxerControlPort(),isLive:this.isLive_,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24,enableJitterBuffer:!!this.jitterBufferController},this.seekedTimestamp>=BigInt(0)?this.seekedTimestamp:Y.Dh),i&&e.video){this.fire(N.Gd,[3,i]),s=!0,this.selectedVideoStream=i,this.videoEnded=!1,this.demuxer2VideoDecoderChannel=(0,Q.A)(this.options.enableWorker);const e=await o(i);e&&(a=e.key,n.push(...e.config)),await je.DemuxerThread.connectStreamTask.transfer(this.demuxer2VideoDecoderChannel.port1).invoke(this.subTaskId||this.taskId,i.index,this.demuxer2VideoDecoderChannel.port1),await je.MSEThread.addStream.transfer(this.demuxer2VideoDecoderChannel.port2).invoke(this.taskId,i.index,(0,xe.Wu)(i.codecpar),i.timeBase,i.metadata,i.startTime,this.demuxer2VideoDecoderChannel.port2)}if(r&&e.audio){this.fire(N.Gd,[2,r]),this.selectedAudioStream=r,this.audioEnded=!1,this.demuxer2AudioDecoderChannel=(0,Q.A)(this.options.enableWorker);const e=await o(r);e&&(a=e.key,n.push(...e.config)),await je.DemuxerThread.connectStreamTask.transfer(this.demuxer2AudioDecoderChannel.port1).invoke(this.taskId,r.index,this.demuxer2AudioDecoderChannel.port1),await je.MSEThread.addStream.transfer(this.demuxer2AudioDecoderChannel.port2).invoke(this.taskId,r.index,(0,xe.Wu)(r.codecpar),r.timeBase,r.metadata,r.startTime,this.demuxer2AudioDecoderChannel.port2)}if(s?this.createVideo():this.createAudio(),a){var t;const e=await navigator.requestMediaKeySystemAccess(a,n),i=await e.createMediaKeys();null!==(t=this.options.drmSystemOptions)&&void 0!==t&&t.certificate&&await i.setServerCertificate(this.options.drmSystemOptions.certificate).catch((e=>{V.z3(`setServerCertificate failed, ${e}`,Oe,1975)})),await(this.video||this.audio).setMediaKeys(i),this.drmSystemKey=a}je.MSEThread.setPlayRate(this.taskId,this.playRate);const c=await je.MSEThread.getMediaSource(this.taskId);c&&(W.A.workerMSE&&c instanceof MediaSourceHandle?(this.video||this.audio).srcObject=c:(this.video||this.audio).src=URL.createObjectURL(c),this.handleTimeupdate(this.video||this.audio)),this.video&&!this.selectedAudioStream&&(this.video.muted=!0),(this.video||this.audio).playbackRate=this.playRate}}async playUseDecoder(e){let t=BigInt(0),i=BigInt(0);const r=this.findBestStream(this.formatContext.streams,0),s=this.findBestStream(this.formatContext.streams,1);if(r&&e.video){this.fire(N.Gd,[3,r]),this.selectedVideoStream=r,await je.startVideoRenderPipeline(this.options.enableWorker),await this.createVideoDecoderThread(this.options.enableWorker),i=(0,q.k)(r.startTime,r.timeBase,Y.i0),this.demuxer2VideoDecoderChannel=(0,Q.A)(this.options.enableWorker),this.videoDecoder2VideoRenderChannel=(0,Q.A)(this.options.enableWorker);let e=await this.getResource("decoder",m.f[15](r.codecpar+4),m.f[15](r.codecpar));e||(W.A.videoDecoder?(await VideoDecoder.isConfigSupported({codec:(0,X.A)(r.codecpar)})).supported||V.h2(`${(0,de.eG)(m.f[15](r.codecpar),m.f[15](r.codecpar+4))} codecId ${m.f[15](r.codecpar+4)} not support`,Oe,2030):V.h2(`${(0,de.eG)(m.f[15](r.codecpar),m.f[15](r.codecpar+4))} codecId ${m.f[15](r.codecpar+4)} not support`,Oe,2034)),await this.VideoDecoderThread.registerTask.transfer(this.demuxer2VideoDecoderChannel.port2,this.videoDecoder2VideoRenderChannel.port1).invoke({taskId:this.taskId,resource:e,leftPort:this.demuxer2VideoDecoderChannel.port2,rightPort:this.videoDecoder2VideoRenderChannel.port1,stats:this.GlobalData[u.o9]+32,enableHardware:this.options.enableHardware&&this.options.enableWebCodecs,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24,avframeList:this.GlobalData[u.o9]+12,avframeListMutex:this.GlobalData[u.o9]+28,preferWebCodecs:!(0,ue.A)(r.codecpar)&&!(0,fe.A)(r.codecpar)&&!!this.options.enableWebCodecs}),await this.VideoDecoderThread.open(this.taskId,(0,xe.Wu)(r.codecpar))<0&&V.h2(`cannot open video ${(0,de.eG)(m.f[15](r.codecpar),m.f[15](r.codecpar+4))} decoder`,Oe,2057),await je.DemuxerThread.connectStreamTask.transfer(this.demuxer2VideoDecoderChannel.port1).invoke(this.subTaskId||this.taskId,r.index,this.demuxer2VideoDecoderChannel.port1),this.VideoDecoderThread.setPlayRate(this.taskId,this.playRate)}if(s&&e.audio){this.fire(N.Gd,[2,s]),this.selectedAudioStream=s,await je.startAudioPipeline(this.options.enableWorker),"suspended"===je.audioContext.state&&await l().race([je.audioContext.resume(),new ie.A(.1)]),t=(0,q.k)(s.startTime,s.timeBase,Y.i0),this.demuxer2AudioDecoderChannel=(0,Q.A)(this.options.enableWorker),this.audioDecoder2AudioRenderChannel=(0,Q.A)(this.options.enableWorker);let e=await this.getResource("decoder",m.f[15](s.codecpar+4),m.f[15](s.codecpar));e||(W.A.audioDecoder?(await AudioDecoder.isConfigSupported({codec:(0,ce.A)(s.codecpar),sampleRate:m.f[15](s.codecpar+136),numberOfChannels:m.f[15](s.codecpar+116)})).supported||V.h2(`${(0,de.eG)(m.f[15](s.codecpar),m.f[15](s.codecpar+4))} codecId ${m.f[15](s.codecpar+4)} not support`,Oe,2093):V.h2(`${(0,de.eG)(m.f[15](s.codecpar),m.f[15](s.codecpar+4))} codecId ${m.f[15](s.codecpar+4)} not support`,Oe,2097)),await je.AudioDecoderThread.registerTask.transfer(this.demuxer2AudioDecoderChannel.port2,this.audioDecoder2AudioRenderChannel.port1).invoke({taskId:this.taskId,resource:e,leftPort:this.demuxer2AudioDecoderChannel.port2,rightPort:this.audioDecoder2AudioRenderChannel.port1,stats:this.GlobalData[u.o9]+32,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24,avframeList:this.GlobalData[u.o9]+12,avframeListMutex:this.GlobalData[u.o9]+28}),await je.AudioDecoderThread.open(this.taskId,(0,xe.Wu)(s.codecpar))<0&&V.h2(`cannot open audio ${(0,de.eG)(m.f[15](s.codecpar),m.f[15](s.codecpar+4))} decoder`,Oe,2118),await je.DemuxerThread.connectStreamTask.transfer(this.demuxer2AudioDecoderChannel.port1).invoke(this.taskId,s.index,this.demuxer2AudioDecoderChannel.port1);const i=this.formatContext.streams.filter((e=>1===m.f[15](e.codecpar)));if(i.length>1)for(let e=0;e<i.length;e++)i[e]!==s&&await je.DemuxerThread.addPendingStream(this.taskId,i[e].index)}if(this.videoDecoder2VideoRenderChannel){let e;if(this.isMediaStreamMode())if(W.A.trackGenerator){const t=new MediaStreamTrackGenerator({kind:"video"});e=t.writable;const i=this.options.container,r=i.getVideoTracks()[0];r&&i.removeTrack(r),i.addTrack(t)}else{this.canvas=this.createCanvas(),this.canvas.width=m.f[15](r.codecpar+56),this.canvas.height=m.f[15](r.codecpar+60),e=(0,z.A)()&&(U.USE_THREADS||W.A.worker&&this.options.enableWorker)?this.canvas.transferControlToOffscreen():this.canvas;const t=this.canvas.captureStream(),i=this.options.container,s=i.getVideoTracks()[0];s&&i.removeTrack(s),i.addTrack(t.getVideoTracks()[0])}else this.canvas=this.createCanvas(),this.canvas.width=this.options.container.offsetWidth*devicePixelRatio,this.canvas.height=this.options.container.offsetHeight*devicePixelRatio,this.options.container.appendChild(this.canvas),e=(0,z.A)()&&(U.USE_THREADS||W.A.worker&&this.options.enableWorker)?this.canvas.transferControlToOffscreen():this.canvas;r.metadata.matrix&&!this.useMSE&&(this.renderRotate=-Math.atan2(r.metadata.matrix[3],r.metadata.matrix[0])*(180/Math.PI)),await this.VideoRenderThread.registerTask.transfer(this.videoDecoder2VideoRenderChannel.port2,this.controller.getVideoRenderControlPort(),e).invoke({taskId:this.taskId,isLive:this.isLive_,leftPort:this.videoDecoder2VideoRenderChannel.port2,controlPort:this.controller.getVideoRenderControlPort(),canvas:e,renderMode:this.renderMode,renderRotate:this.renderRotate,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical,viewportWidth:this.isMediaStreamMode()?m.f[15](r.codecpar+56):this.options.container.offsetWidth,viewportHeight:this.isMediaStreamMode()?m.f[15](r.codecpar+60):this.options.container.offsetHeight,devicePixelRatio:this.isMediaStreamMode()?1:devicePixelRatio,stats:this.GlobalData[u.o9]+32,enableWebGPU:this.options.enableWebGPU,startPTS:this.isLive_?(0,q.k)(r.startTime<BigInt(1e3)?BigInt(0):r.startTime,r.timeBase,Y.i0):this.getMinStartPTS(),avframeList:this.GlobalData[u.o9]+12,avframeListMutex:this.GlobalData[u.o9]+28,enableJitterBuffer:!!this.jitterBufferController&&!this.audioDecoder2AudioRenderChannel,sar:(0,q.lb)((0,v.A)(r.codecpar+64,g.P))}),this.videoEnded=!1,this.VideoRenderThread.setPlayRate(this.taskId,this.playRate)}if(this.audioDecoder2AudioRenderChannel){this.audioRender2AudioWorkletChannel=new MessageChannel,this.isMediaStreamMode()?this.playChannels=2:this.playChannels=Math.min(m.f[15](s.codecpar+116),je.audioContext.destination.maxChannelCount||2);let e,t=await this.getResource("resampler"),i=await this.getResource("stretchpitcher");if(t||V.h2("resampler not found",Oe,2246),i||V.h2("stretch pitcher not found",Oe,2249),await je.AudioRenderThread.registerTask.transfer(this.audioDecoder2AudioRenderChannel.port2,this.audioRender2AudioWorkletChannel.port1,this.controller.getAudioRenderControlPort()).invoke({taskId:this.taskId,isLive:this.isLive_,leftPort:this.audioDecoder2AudioRenderChannel.port2,rightPort:this.audioRender2AudioWorkletChannel.port1,controlPort:this.controller.getAudioRenderControlPort(),playFormat:8,playSampleRate:je.audioContext.sampleRate,playChannels:this.playChannels,resamplerResource:t,stretchpitcherResource:i,stats:this.GlobalData[u.o9]+32,startPTS:this.isLive_?(0,q.k)(s.startTime<BigInt(1e3)?BigInt(0):s.startTime,s.timeBase,Y.i0):this.getMinStartPTS(),avframeList:this.GlobalData[u.o9]+12,avframeListMutex:this.GlobalData[u.o9]+28,enableJitterBuffer:!!this.jitterBufferController}),e=W.A.audioWorklet?$.A:j.A,this.audioSourceNode=new e(je.audioContext,{onEnded:()=>{this.onAudioEnded()},onFirstRendered:()=>{this.onFirstAudioRendered()},onStutter:()=>{this.onAudioStutter()}},{numberOfInputs:1,numberOfOutputs:1,outputChannelCount:[this.playChannels],isMainWorker:!!je.AudioPipelineProxy}),await this.audioSourceNode.request("init",{memory:!U.USE_THREADS||H.A.safari&&!H.A.checkVersion(H.A.version,"16.1",!0)||ge.A.ios&&!H.A.checkVersion(ge.A.version,"16.1",!0)?null:F.ce,bufferLength:this.options.audioWorkletBufferLength}),je.AudioRenderThread.setPlayTempo(this.taskId,this.playRate),this.gainNode=je.audioContext.createGain(),this.audioSourceNode.connect(this.gainNode),this.isMediaStreamMode()){const e=je.audioContext.createMediaStreamDestination();this.gainNode.connect(e);const t=this.options.container,i=t.getAudioTracks()[0];i&&t.removeTrack(i),t.addTrack(e.stream.getAudioTracks()[0])}else this.gainNode.connect(je.audioContext.destination);this.setVolume(this.volume),this.audioEnded=!1}this.audioDecoder2AudioRenderChannel?this.controller.setTimeUpdateListenType(1):this.videoDecoder2VideoRenderChannel&&this.controller.setTimeUpdateListenType(0),this.videoDecoder2VideoRenderChannel&&this.audioDecoder2AudioRenderChannel&&ae.tn(i-t)>BigInt(1e4)&&this.controller.setEnableAudioVideoSync(!1)}async play(e={audio:!0,video:!0,subtitle:!0}){if(V.pq(`call play, options: ${o()(e)}, status: ${this.status} taskId: ${this.taskId}`,Oe,2370),6===this.status)return;e.audio||e.video||(V.R8(`video and audio must play one, ignore options, we will try to play video and audio, taskId: ${this.taskId}`,Oe,2377),e.audio=!0,e.video=!0);const t=[];if(8===this.status)return this.useMSE?(t.push(je.MSEThread.unpause(this.taskId)),this.audio?this.audio.play():this.video&&this.video.play()):(this.selectedAudioStream&&this.selectedVideoStream&&this.GlobalData.stats.videoCurrentTime-this.GlobalData.stats.audioCurrentTime>BigInt(400)&&await je.AudioRenderThread.syncSeekTime(this.taskId,this.GlobalData.stats.videoCurrentTime),this.audioSourceNode&&(t.push(this.audioSourceNode.request("unpause")),t.push(je.AudioRenderThread.unpause(this.taskId))),this.videoDecoder2VideoRenderChannel&&t.push(this.VideoRenderThread.unpause(this.taskId))),l().all(t).then((()=>{this.status=6,this.fire(N.CN),this.jitterBufferController&&this.jitterBufferController.start(),this.subtitleRender&&this.subtitleRender.start()}));this.status=5,this.fire(N.d6),this.useMSE=await this.checkUseMSE(e),this.audioEnded=!0,this.videoEnded=!0,this.useMSE?await this.playUseMSE(e):await this.playUseDecoder(e);{const t=this.findBestStream(this.formatContext.streams,3);if(t&&e.subtitle&&this.isCodecIdSupported(m.f[15](t.codecpar+4),m.f[15](t.codecpar))){const e=this.externalSubtitleTasks.find((e=>e.streamId===t.id));this.createSubtitleRender(t,e?e.taskId:this.subtitleTaskId||this.taskId)}if(this.subtitleRender&&this.externalSubtitleTasks.length)for(let e=0;e<this.externalSubtitleTasks.length;e++){const i=this.formatContext.streams.find((t=>t.id===this.externalSubtitleTasks[e].streamId));i!==t&&await je.DemuxerThread.connectStreamTask.transfer(this.subtitleRender.getDemuxerPort(this.externalSubtitleTasks[e].taskId)).invoke(this.externalSubtitleTasks[e].taskId,i.index,this.subtitleRender.getDemuxerPort(this.externalSubtitleTasks[e].taskId))}}let i=10;if(P.Yj(this.source)||this.source instanceof we.A){let e=this.isLive_?this.options.jitterBufferMin:this.options.preLoadTime;this.source instanceof we.A&&(e=Math.max(e,this.source.minBuffer)),this.formatContext.streams.forEach((t=>{0===m.f[15](t.codecpar)?i=Math.max(Math.ceil((0,q.lb)((0,v.A)(t.codecpar+72,g.P))*e),i):1===m.f[15](t.codecpar)&&m.f[15](t.codecpar+144)&&(i=Math.max(Math.ceil(m.f[15](t.codecpar+136)/m.f[15](t.codecpar+144)*e),i))}))}if(t.push(je.DemuxerThread.startDemux(this.taskId,this.isLive_,i)),this.subTaskId&&t.push(je.DemuxerThread.startDemux(this.subTaskId,this.isLive_,i)),this.subtitleTaskId&&t.push(je.DemuxerThread.startDemux(this.subtitleTaskId,this.isLive_,10)),this.seekedTimestamp>=BigInt(0)){let e=20;this.formatContext.streams.forEach((t=>{0===m.f[15](t.codecpar)&&(e=Math.max(Math.ceil((0,q.lb)((0,v.A)(t.codecpar+72,g.P))),e))})),this.videoDecoder2VideoRenderChannel&&t.push(this.VideoRenderThread.syncSeekTime(this.taskId,this.seekedTimestamp,e)),this.audioDecoder2AudioRenderChannel&&t.push(je.AudioRenderThread.syncSeekTime(this.taskId,this.seekedTimestamp,e)),this.seekedTimestamp=Y.Dh}return l().all(t).then((async()=>{if(this.useMSE){var e,t;if(await l().all([null===(e=this.video)||void 0===e?void 0:e.play(),null===(t=this.audio)||void 0===t?void 0:t.play()]).catch((e=>{if(this.fire(N.IY),V.R8("the audioContext was not started. It must be resumed after a user gesture",Oe,2501),this.video)return this.video.muted=!0,this.video.play()})),this.isMediaStreamMode()){H.A.firefox||((this.video||this.audio).muted=!0);const e=this.options.container,t=((this.video||this.audio).captureStream||(this.video||this.audio).mozCaptureStream).bind(this.video||this.audio)(),i=e.getAudioTracks()[0],r=e.getVideoTracks()[0];i&&e.removeTrack(i),r&&e.removeTrack(r);const s=t.getAudioTracks()[0],a=t.getVideoTracks()[0];s&&e.addTrack(s),a&&e.addTrack(a)}}else{const e=[];this.videoDecoder2VideoRenderChannel&&e.push(this.VideoRenderThread.play(this.taskId)),this.audioDecoder2AudioRenderChannel&&e.push(this.audioSourceNode.request("start",{port:this.audioRender2AudioWorkletChannel.port2,channels:this.playChannels},[this.audioRender2AudioWorkletChannel.port2])),await l().all(e),this.audioSourceNode&&"suspended"===je.audioContext.state&&("suspended"===je.audioContext.state&&(this.fire(N.IY),V.R8("the audioContext was not started. It must be resumed after a user gesture",Oe,2548)),this.videoDecoder2VideoRenderChannel&&(await je.AudioRenderThread.fakePlay(this.taskId),this.controller.setTimeUpdateListenType(0)))}this.status=6,this.fire(N.CN),this.statsController.start(),this.jitterBufferController&&this.jitterBufferController.start(),this.subtitleRender&&this.subtitleRender.start()}))}async pause(){if(V.pq(`call pause, taskId: ${this.taskId}`,Oe,2573),!this.isLive_){const e=[];return this.useMSE?(this.audio&&this.audio.pause(),this.video&&this.video.pause(),e.push(je.MSEThread.pause(this.taskId))):(this.audioSourceNode&&(e.push(this.audioSourceNode.request("pause")),e.push(je.AudioRenderThread.pause(this.taskId))),this.videoDecoder2VideoRenderChannel&&e.push(this.VideoRenderThread.pause(this.taskId))),l().all(e).then((()=>{9===this.status?this.lastStatus=8:this.status=8,this.fire(N.NN),this.jitterBufferController&&this.jitterBufferController.stop(),this.subtitleRender&&this.subtitleRender.pause()}))}V.R8(`pause can only used in vod, taskId: ${this.taskId}`,Oe,2613)}async doSeek(e,t,i={}){var r,s;this.useMSE?await je.MSEThread.beforeSeek(this.taskId):await l().all([null===(r=je.AudioRenderThread)||void 0===r?void 0:r.beforeSeek(this.taskId),null===(s=this.VideoRenderThread)||void 0===s?void 0:s.beforeSeek(this.taskId)]),i.onBeforeSeek&&await i.onBeforeSeek();let a=-BigInt(1);if(this.isDash()||this.isHls()?(a=await je.DemuxerThread.seek(this.taskId,e,16),this.subTaskId&&await je.DemuxerThread.seek(this.subTaskId,e,16)):a=await je.DemuxerThread.seek(this.taskId,e,8,t),this.subtitleTaskId&&await je.DemuxerThread.seek(this.subtitleTaskId,e,16),a>=BigInt(0)?V.Yz(`seeked to packet timestamp: ${a}, taskId: ${this.taskId}`,Oe,2654):V.z3(`demuxer seek failed, code: ${a}, taskId: ${this.taskId}`,Oe,2657),this.useMSE)if(a>=BigInt(0)){const t=await je.MSEThread.afterSeek(this.taskId,a>e?a:e);this.video?this.video.currentTime=t:this.audio&&(this.audio.currentTime=t)}else await je.MSEThread.afterSeek(this.taskId,Y.Dh);else{let t=20;var n,o,c,d,h,u,f,p,y,A;this.formatContext.streams.forEach((e=>{0===m.f[15](e.codecpar)&&(t=Math.max(Math.ceil((0,q.lb)((0,v.A)(e.codecpar+72,g.P))),t))})),a>=BigInt(0)?(await l().all([null===(n=je.AudioDecoderThread)||void 0===n?void 0:n.resetTask(this.taskId),null===(o=this.VideoDecoderThread)||void 0===o?void 0:o.resetTask(this.taskId)]),await l().all([null===(c=je.AudioRenderThread)||void 0===c?void 0:c.syncSeekTime(this.taskId,a>e?a:e,t),null===(d=this.VideoRenderThread)||void 0===d?void 0:d.syncSeekTime(this.taskId,a>e?a:e,t)]),await l().all([null===(h=je.AudioRenderThread)||void 0===h?void 0:h.afterSeek(this.taskId,a>e?a:e),null===(u=this.VideoRenderThread)||void 0===u?void 0:u.afterSeek(this.taskId,a>e?a:e)])):(await l().all([null===(f=je.AudioRenderThread)||void 0===f?void 0:f.syncSeekTime(this.taskId,Y.Dh,t),null===(p=this.VideoRenderThread)||void 0===p?void 0:p.syncSeekTime(this.taskId,Y.Dh,t)]),await l().all([null===(y=je.AudioRenderThread)||void 0===y?void 0:y.afterSeek(this.taskId,Y.Dh),null===(A=this.VideoRenderThread)||void 0===A?void 0:A.afterSeek(this.taskId,Y.Dh)])),this.jitterBufferController&&this.jitterBufferController.reset()}(4===this.lastStatus||3===this.lastStatus)&&a>=BigInt(0)&&(this.seekedTimestamp=a>e?a:e);for(let e=0;e<this.externalSubtitleTasks.length;e++)await je.DemuxerThread.seek(this.externalSubtitleTasks[e].taskId,this.currentTime,8);this.subtitleRender&&(this.subtitleRender.reset(),this.subtitleRender.start())}async seek(e){if(V.pq(`call seek, timestamp: ${e}, taskId: ${this.taskId}`,Oe,2741),this.formatContext.streams.length)if(9!==this.status)if(this.isLive_)V.R8(`seek can only used in vod, taskId: ${this.taskId}`,Oe,2780);else{this.lastStatus=this.status,this.status=9,this.fire(N.Nz);let t=-1;this.selectedVideoStream?t=this.selectedVideoStream.index:this.selectedAudioStream&&(t=this.selectedAudioStream.index),7===this.lastStatus?(await this.replayTo(e),this.status=6,this.fire(N.mQ),this.fire(N.CN)):(await this.doSeek(e,t),this.status=this.lastStatus,this.fire(N.mQ))}else V.R8(`player is seeking now, taskId: ${this.taskId}`,Oe,2749);else V.z3(`cannot found any stream to seek, taskId: ${this.taskId}`,Oe,2744)}getStreams(){return this.formatContext.streams.map((e=>({...e,mediaType:(0,de.yl)(le.Mb,m.f[15](e.codecpar)),codecparProxy:(0,v.A)(e.codecpar,y.A)})))}getSelectedVideoStreamId(){return this.selectedVideoStream?this.selectedVideoStream.id:-1}getSelectedAudioStreamId(){return this.selectedAudioStream?this.selectedAudioStream.id:-1}getSelectedSubtitleStreamId(){return this.selectedSubtitleStream?this.selectedSubtitleStream.id:-1}getChapters(){return this.formatContext.chapters}getDuration(){if(!this.isLive_){let e=BigInt(0);return this.formatContext.streams.forEach((t=>{if(1===m.f[15](t.codecpar)||0===m.f[15](t.codecpar)){const i=(0,q.k)(t.duration,{den:t.timeBase.den,num:t.timeBase.num},Y.i0);i>e&&(e=i)}})),e}return BigInt(0)}async stop(e=!1){var t;if(V.pq(`call stop, taskId: ${this.taskId}`,Oe,2884),0===this.status)return void V.pq(`player has already stopped, taskId: ${this.taskId}`,Oe,2887);if(this.stopPending)return this.stopPending;let i;this.stopPending=new(l())((e=>{i=e})),this.audioSourceNode&&(9===this.status&&await je.AudioRenderThread.stop(this.taskId),await this.audioSourceNode.request("stop"),this.audioSourceNode.disconnect(),this.audioSourceNode=null),9===this.status&&je.DemuxerThread&&(await je.DemuxerThread.stop(this.taskId),this.subTaskId&&await je.DemuxerThread.stop(this.subTaskId),this.subtitleTaskId&&await je.DemuxerThread.stop(this.subtitleTaskId)),this.VideoRenderThread&&await this.VideoRenderThread.unregisterTask(this.taskId),je.AudioRenderThread&&await je.AudioRenderThread.unregisterTask(this.taskId),this.VideoDecoderThread&&await this.VideoDecoderThread.unregisterTask(this.taskId),je.AudioDecoderThread&&await je.AudioDecoderThread.unregisterTask(this.taskId),je.MSEThread&&await je.MSEThread.unregisterTask(this.taskId),je.DemuxerThread&&(this.subTaskId&&await je.DemuxerThread.unregisterTask(this.subTaskId),this.subtitleTaskId&&await je.DemuxerThread.unregisterTask(this.subtitleTaskId),await je.DemuxerThread.unregisterTask(this.taskId)),je.IOThread&&await je.IOThread.unregisterTask(this.taskId),this.ioIPCPort&&(await this.source.stop().catch((e=>{V.z3(`stop custom ioloader error, ${e}`,Oe,2949)})),this.ioIPCPort.destroy(),this.ioIPCPort=null);for(let e=0;e<this.externalSubtitleTasks.length;e++)await je.DemuxerThread.unregisterTask(this.externalSubtitleTasks[e].taskId),await je.IOThread.unregisterTask(this.externalSubtitleTasks[e].taskId);if(this.subtitleRender&&(this.subtitleRender.destroy(),this.subtitleRender=null),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=null),this.controller&&this.controller.destroy(),this.drmSession&&(await this.drmSession.close(),this.drmSession=null),null!==(t=this.video||this.audio)&&void 0!==t&&t.src&&URL.revokeObjectURL((this.video||this.audio).src),!this.isMediaStreamMode()){const e=this.options.container;this.video&&(e.removeChild(this.video),this.video=null),this.audio&&(e.removeChild(this.audio),this.audio=null),this.canvas&&(e.removeChild(this.canvas),this.canvas=null)}this.ioloader2DemuxerChannel=null,this.demuxer2VideoDecoderChannel=null,this.demuxer2AudioDecoderChannel=null,this.videoDecoder2VideoRenderChannel=null,this.audioDecoder2AudioRenderChannel=null,this.audioRender2AudioWorkletChannel=null,this.selectedAudioStream=null,this.selectedVideoStream=null,this.selectedSubtitleStream=null,this.lastSelectedInnerSubtitleStreamIndex=-1,this.source=null,this.ext="",this.subTaskId="",this.subtitleTaskId="",this.seekedTimestamp=Y.Dh,this.statsController.stop(),this.jitterBufferController&&(this.jitterBufferController.stop(),this.jitterBufferController=null),this.status=0,i(),this.stopPending=null,e||this.fire(N.yd),V.pq(`avplayer stopped, task: ${this.taskId}`,Oe,3027)}setPlaybackRate(e){var t,i,r,s;this.isLive_?V.R8(`setPlaybackRate can only used in playback, taskId: ${this.taskId}`,Oe,3055):(this.playRate=(0,G.A)(e,.5,2),this.useMSE?(null===(t=je.MSEThread)||void 0===t||t.setPlayRate(this.taskId,this.playRate),this.video?this.video.playbackRate=this.playRate:this.audio&&(this.audio.playbackRate=this.playRate)):(null===(i=je.AudioRenderThread)||void 0===i||i.setPlayTempo(this.taskId,this.playRate),null===(r=this.VideoRenderThread)||void 0===r||r.setPlayRate(this.taskId,this.playRate),null===(s=this.VideoDecoderThread)||void 0===s||s.setPlayRate(this.taskId,this.playRate)),V.pq(`player call setPlaybackRate, set ${this.playRate}, taskId: ${this.taskId}`,Oe,3052))}getPlaybackRate(){return this.playRate}async resume(){var e,t;"suspended"!==(null===(e=je.audioContext)||void 0===e?void 0:e.state)&&"interrupted"!==(null===(t=je.audioContext)||void 0===t?void 0:t.state)||(await l().race([je.audioContext.resume(),new ie.A(.1)]),"suspended"===je.audioContext.state?V.R8("the audioContext was not allowed to start. It must be resumed after a user gesture",Oe,3081):(this.audioSourceNode&&this.controller.setTimeUpdateListenType(1),this.fire(N.dQ))),this.video?(this.video.muted=!1,this.video.paused&&await this.video.play()):this.audio&&(this.audio.muted=!1,this.audio.paused&&await this.audio.play()),V.pq(`call resume, taskId: ${this.taskId}`,Oe,3103)}isSuspended(){var e;return"suspended"===(null===(e=je.audioContext)||void 0===e?void 0:e.state)}getVolume(){return this.volume}setVolume(e,t=!1){this.volume=this.useMSE?(0,G.A)(e,0,1):(0,G.A)(e,0,3),this.gainNode&&je.audioContext?(this.gainNode.gain.cancelScheduledValues(je.audioContext.currentTime),H.A.firefox&&!t?this.gainNode.gain.setValueAtTime(this.volume,je.audioContext.currentTime+1):0===this.gainNode.gain.value||0===this.volume||t?this.gainNode.gain.value=this.volume:this.gainNode.gain.exponentialRampToValueAtTime(this.volume,je.audioContext.currentTime+1)):this.video?this.video.volume=this.volume:this.audio&&(this.audio.volume=this.volume),this.fire(N.Wu,[this.volume]),V.pq(`player call setVolume, set ${e}, used ${this.volume}, taskId: ${this.taskId}`,Oe,3153)}getRenderMode(){return this.renderMode}setRenderMode(e){var t;this.renderMode=e,this.useMSE&&this.video?this.video.style["object-fit"]=Ne[this.renderMode]:null===(t=this.VideoRenderThread)||void 0===t||t.setRenderMode(this.taskId,e),V.pq(`player call setRenderMode, mode: ${e}, taskId: ${this.taskId}`,Oe,3183)}getVideoTransformContext(){let e="";return 0!==this.renderRotate&&(e+=`rotateZ(${this.renderRotate}deg)`),this.flipHorizontal&&(e+=(e.length?" ":"")+"scaleX(-1)"),this.flipVertical&&(e+=(e.length?" ":"")+"scaleY(-1)"),e}setRotate(e){var t;this.renderRotate=e,this.useMSE&&this.video?this.video.style.transform=this.getVideoTransformContext():null===(t=this.VideoRenderThread)||void 0===t||t.setRenderRotate(this.taskId,e),V.pq(`player call setRotate, angle: ${e}, taskId: ${this.taskId}`,Oe,3213)}enableHorizontalFlip(e){var t;this.flipHorizontal=e,this.useMSE&&this.video?this.video.style.transform=this.getVideoTransformContext():null===(t=this.VideoRenderThread)||void 0===t||t.enableHorizontalFlip(this.taskId,e),V.pq(`player call enableHorizontalFlip, enable: ${e}, taskId: ${this.taskId}`,Oe,3224)}enableVerticalFlip(e){var t;this.flipVertical=e,this.useMSE&&this.video?this.video.style.transform=this.getVideoTransformContext():null===(t=this.VideoRenderThread)||void 0===t||t.enableVerticalFlip(this.taskId,e),V.pq(`player call enableVerticalFlip, enable: ${e}, taskId: ${this.taskId}`,Oe,3235)}setLoop(e){this.options.loop=e,V.pq(`call setLoop, enable: ${e}, taskId: ${this.taskId}`,Oe,3247)}setSubtitleDelay(e){this.subtitleRender&&this.getSubtitleDelay()!==e&&(this.subtitleRender.setDelay(BigInt(0|e)),V.pq(`set subtitle delay ${e}`,Oe,3260),this.fire(N.W1,[e]))}getSubtitleDelay(){return this.subtitleRender?Number(BigInt.asIntN(32,this.subtitleRender.getDelay())):0}setSubtitleEnable(e){if(this.subtitleRender&&this.selectedSubtitleStream)if(e){const e=this.externalSubtitleTasks.find((e=>e.streamId===this.selectedSubtitleStream.id));e&&je.DemuxerThread.seek(e.taskId,this.currentTime,8),this.subtitleRender.reset(),this.subtitleRender.start()}else this.subtitleRender.stop()}resize(e,t){var i;this.useMSE||null===(i=this.VideoRenderThread)||void 0===i||i.resize(this.taskId,e,t),V.pq(`player call resize, width: ${e}, height: ${t}, taskId: ${this.taskId}`,Oe,3311)}isMSE(){return this.useMSE}isMediaStreamMode(){return"function"==typeof MediaStream&&this.options.container instanceof MediaStream}isLive(){return this.isLive_}async getVideoList(){var e;return null===(e=je.IOThread)||void 0===e?void 0:e.getVideoList(this.taskId)}async getAudioList(){var e;return null===(e=je.IOThread)||void 0===e?void 0:e.getAudioList(this.taskId)}async getSubtitleList(){var e;return null===(e=je.IOThread)||void 0===e?void 0:e.getSubtitleList(this.taskId)}getStatus(){return this.status}hasAudio(){return!!this.selectedAudioStream}hasVideo(){return!!this.selectedVideoStream}hasSubtitle(){return!!this.selectedSubtitleStream}getSource(){return this.source}getFormatContext(){return this.formatContext}getExternalSubtitle(){return this.externalSubtitleTasks.map((e=>({source:e.source,lang:e.lang,title:e.title})))}getOptions(){return this.options}getAudioOutputNode(){return this.gainNode}isPictureInPicture(){return this.useMSE?this.video&&document.pictureInPictureElement===this.video:!(!this.canvas||"object"!=typeof documentPictureInPicture)&&documentPictureInPicture.window&&documentPictureInPicture.window.document.body.querySelector("#"+this.canvas.id)===this.canvas}async selectVideo(e){var t;if(this.isHls()||this.isDash())return V.pq(`call IOThread selectVideo, index: ${e}, taskId: ${this.taskId}`,Oe,3475),null===(t=je.IOThread)||void 0===t?void 0:t.selectVideo(this.taskId,e);{const t=this.formatContext.streams.find((t=>t.id===e));if(this.selectedVideoStream&&t&&0===m.f[15](t.codecpar)&&t!==this.selectedVideoStream){if(10===this.status)return void V.R8(`player is changing now, taskId: ${this.taskId}`,Oe,3483);this.lastStatus=this.status,this.status=10,this.fire(N.Wt,[0,t.id,this.selectedVideoStream.id]),this.useMSE?(H.A.safari&&(this.status=this.lastStatus,V.h2("safari not support switch stream in mse, please use chrome",Oe,3493)),(0,ne.A)().isTypeSupported((0,J.A)(t.codecpar))||(this.status=this.lastStatus,V.h2(`select video stream(${t.index}) not support mse`,Oe,3497)),await this.doSeek(this.currentTime,t.index,{onBeforeSeek:async()=>{await je.DemuxerThread.changeConnectStream(this.taskId,t.index,this.selectedVideoStream.index),await je.MSEThread.reAddStream(this.taskId,t.index,(0,xe.Wu)(t.codecpar),t.timeBase,t.metadata,t.startTime)}})):(he.zy(ze,m.f[15](t.codecpar+4))||(this.status=this.lastStatus,V.h2(`select video stream(${t.index}) not support`,Oe,3516)),await this.doSeek(this.currentTime,t.index,{onBeforeSeek:async()=>{await je.DemuxerThread.changeConnectStream(this.taskId,t.index,this.selectedVideoStream.index),await this.VideoDecoderThread.reopenDecoder(this.taskId,(0,xe.Wu)(t.codecpar),await this.getResource("decoder",m.f[15](t.codecpar+4),0))}})),V.pq(`changed selected video stream, from ${this.selectedVideoStream.id} to ${t.id}, taskId: ${this.taskId}`,Oe,3530),this.selectedVideoStream=t,this.subtitleRender&&this.subtitleRender.updateVideoResolution(m.f[15](t.codecpar+56),m.f[15](t.codecpar+60)),this.status=this.lastStatus,this.fire(N.Rj,[0,t.id,this.selectedVideoStream.id])}}}async selectAudio(e){var t;if(this.isHls()||this.isDash())return V.pq(`call IOThread selectAudio, index: ${e}, taskId: ${this.taskId}`,Oe,3551),null===(t=je.IOThread)||void 0===t?void 0:t.selectAudio(this.taskId,e);{const t=this.formatContext.streams.find((t=>t.id===e));if(this.selectedAudioStream&&t&&1===m.f[15](t.codecpar)&&t!==this.selectedAudioStream){if(10===this.status)return void V.R8(`player is changing now, taskId: ${this.taskId}`,Oe,3558);if(this.lastStatus=this.status,this.status=10,this.fire(N.Wt,[1,t.id,this.selectedAudioStream.id]),m.f[15](t.codecpar+4)!==m.f[15](this.selectedAudioStream.codecpar+4)||m.f[15](t.codecpar+136)!==m.f[15](this.selectedAudioStream.codecpar+136)||m.f[15](t.codecpar+116)!==m.f[15](this.selectedAudioStream.codecpar+116)||m.f[15](t.codecpar+48)!==m.f[15](this.selectedAudioStream.codecpar+48))if(this.useMSE){H.A.safari&&(this.status=this.lastStatus,V.h2("safari not support switch stream in mse, please use chrome",Oe,3573));let e=t.index;this.selectedVideoStream&&(e=this.selectedVideoStream.index),(0,ne.A)().isTypeSupported((0,Z.A)(t.codecpar))||(this.status=this.lastStatus,V.h2(`select audio stream(${t.index}) not support mse`,Oe,3581)),await this.doSeek(this.currentTime,e,{onBeforeSeek:async()=>{await je.DemuxerThread.changeConnectStream(this.taskId,t.index,this.selectedAudioStream.index),await je.MSEThread.reAddStream(this.taskId,t.index,(0,xe.Wu)(t.codecpar),t.timeBase,t.metadata,t.startTime)}})}else he.zy(ze,m.f[15](t.codecpar+4))||(this.status=this.lastStatus,V.h2(`select audio stream(${t.index}) not support`,Oe,3593)),await je.AudioDecoderThread.beforeReopenDecoder(this.taskId),await je.DemuxerThread.changeConnectStream(this.taskId,t.index,this.selectedAudioStream.index,!0,!0),await je.AudioDecoderThread.reopenDecoder(this.taskId,(0,xe.Wu)(t.codecpar),await this.getResource("decoder",m.f[15](t.codecpar+4),1)),this.audioEnded&&(this.audioDecoder2AudioRenderChannel&&(await je.AudioDecoderThread.resetTask(this.taskId),await je.AudioRenderThread.restart(this.taskId),await je.AudioRenderThread.syncSeekTime(this.taskId,this.currentTime),this.controller.setTimeUpdateListenType(1)),this.audioSourceNode&&(await this.audioSourceNode.request("restart"),"suspended"===je.audioContext.state&&await je.AudioRenderThread.fakePlay(this.taskId)),this.audioEnded=!1);else await je.DemuxerThread.changeConnectStream(this.taskId,t.index,this.selectedAudioStream.index,!1);V.pq(`changed selected audio stream, from ${this.selectedAudioStream.id} to ${t.id}, taskId: ${this.taskId}`,Oe,3623),this.selectedAudioStream=t,this.status=this.lastStatus,this.fire(N.Rj,[1,t.id,this.selectedAudioStream.id])}}}async selectSubtitle(e){if(this.isHls()||this.isDash()){var t;V.pq(`call IOThread selectSubtitle, index: ${e}, taskId: ${this.taskId}`,Oe,3642),await(null===(t=je.IOThread)||void 0===t?void 0:t.selectSubtitle(this.taskId,e)),this.subtitleTaskId&&await je.DemuxerThread.seek(this.subtitleTaskId,this.currentTime,16),this.subtitleRender&&(this.subtitleRender.reset(),this.subtitleRender.start())}else{const t=this.formatContext.streams.find((t=>t.id===e));if(this.selectedSubtitleStream&&t&&3===m.f[15](t.codecpar)&&t!==this.selectedSubtitleStream){if(10===this.status)return void V.R8(`player is changing now, taskId: ${this.taskId}`,Oe,3656);this.lastStatus=this.status,this.status=10,this.fire(N.Wt,[3,t.id,this.selectedSubtitleStream.id]),this.subtitleRender.reopenDecoder(t.codecpar);const e=this.externalSubtitleTasks.find((e=>e.streamId===t.id));e?(this.subtitleRender.setDemuxTask(e.taskId),this.subtitleRender.reset(),await je.DemuxerThread.seek(e.taskId,this.currentTime,8,t.index)):(this.subtitleRender.setDemuxTask(this.taskId),-1===this.lastSelectedInnerSubtitleStreamIndex?await je.DemuxerThread.connectStreamTask.transfer(this.subtitleRender.getDemuxerPort(this.taskId)).invoke(this.taskId,t.index,this.subtitleRender.getDemuxerPort(this.taskId)):await je.DemuxerThread.changeConnectStream(this.taskId,t.index,this.lastSelectedInnerSubtitleStreamIndex,!1),this.externalSubtitleTasks.find((e=>e.streamId===this.selectedSubtitleStream.id))&&this.subtitleRender.reset(),this.lastSelectedInnerSubtitleStreamIndex=t.index),this.subtitleRender&&this.subtitleRender.start(),V.pq(`changed selected subtitle stream, from ${this.selectedSubtitleStream.id} to ${t.id}, taskId: ${this.taskId}`,Oe,3695),this.selectedSubtitleStream=t,this.status=this.lastStatus,this.fire(N.Rj,[3,t.id,this.selectedSubtitleStream.id])}else V.z3(`call selectSubtitle failed, id: ${e}, taskId: ${this.taskId}`,Oe,3703)}}async playNextFrame(){!this.useMSE&&8===this.status&&this.selectedVideoStream&&await this.VideoRenderThread.renderNextFrame(this.taskId)}enterFullscreen(){if(this.isMediaStreamMode())return;const e=this.options.container;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),V.pq(`player call enterFullscreen, taskId: ${this.taskId}`,Oe,3738)}exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozExitFullScreen?document.mozExitFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),V.pq(`player call exitFullscreen, taskId: ${this.taskId}`,Oe,3754)}snapshot(e="png",t=1){if(this.useMSE&&this.video){const i=document.createElement("canvas");return i.width=this.video.videoWidth,i.height=this.video.videoHeight,i.getContext("2d").drawImage(this.video,0,0),i.toDataURL(`image/${e}`,t)}if(this.canvas)return this.canvas.toDataURL(`image/${e}`,t)}getStats(){return this.GlobalData.stats}async destroy(){V.pq(`call destroy, taskId: ${this.taskId}`,Oe,3793),2!==this.status?(await this.stop(),this.VideoPipelineProxy&&(await this.VideoDecoderThread.clear(),await this.VideoRenderThread.clear(),await this.VideoPipelineProxy.destroy(),this.VideoDecoderThread=null,this.VideoPipelineProxy=null),this.VideoDecoderThread&&(await this.VideoDecoderThread.clear(),(0,T.nE)(this.VideoDecoderThread),this.VideoDecoderThread=null),this.VideoRenderThread=null,this.GlobalData&&(this.GlobalData.avframeList.clear((e=>{(0,C.to)(e)}),20),this.GlobalData.avpacketList.clear((e=>{(0,B.Up)(e)}),20),se.zr(this.GlobalData[u.o9]+24),se.zr(this.GlobalData[u.o9]+28),(0,A.A)(this.GlobalData),this.GlobalData=null),he.TF(je.Instances,this),this.status=2):V.R8(`player has already destroyed, taskId: ${this.taskId}`,Oe,3796)}onVideoEnded(){this.videoEnded=!0,this.handleEnded()}onAudioEnded(){this.audioEnded=!0,this.selectedVideoStream&&this.controller.setTimeUpdateListenType(0),this.handleEnded()}onCanvasUpdated(){this.updateCanvas=this.createCanvas(),this.updateCanvas.width=this.options.container.offsetWidth*devicePixelRatio,this.updateCanvas.height=this.options.container.offsetHeight*devicePixelRatio;const e=(0,z.A)()&&(U.USE_THREADS||W.A.worker&&this.options.enableWorker)?this.updateCanvas.transferControlToOffscreen():this.updateCanvas;this.VideoRenderThread.updateCanvas.transfer(e).invoke(this.taskId,e)}async onGetDecoderResource(e,t){return this.getResource("decoder",t,e)}onFirstVideoRendered(){V.pq(`first video frame rendered, taskId: ${this.taskId}`,Oe,3889),this.fire(N.NX)}onFirstAudioRendered(){V.pq(`first audio frame rendered, taskId: ${this.taskId}`,Oe,3897),this.fire(N.Sw)}onAudioStutter(){6===this.status&&this.GlobalData.stats.audioStutter++}onVideoStutter(){6===this.status&&this.GlobalData.stats.videoStutter++}onVideoDiscard(){6===this.status&&this.VideoDecoderThread.setNextDiscard(this.taskId)}onFirstVideoRenderedAfterUpdateCanvas(){if(this.updateCanvas&&!this.isMediaStreamMode()){const e=this.options.container;this.canvas&&e.removeChild(this.canvas),this.canvas=this.updateCanvas,e.appendChild(this.canvas),this.updateCanvas=null}}onTimeUpdate(e){this.fire(N.E9,[this.currentTime])}onMSESeek(e){const t=this.audio||this.video;t.buffered.length?t.currentTime=e:setTimeout((()=>{t.currentTime=e}),500)}onMasterTimerUpdate(e){var t,i;null===(t=je.AudioRenderThread)||void 0===t||t.setMasterTime(this.taskId,e),null===(i=je.VideoRenderThread)||void 0===i||i.setMasterTime(this.taskId,e)}onAudioContextStateChange(){"interrupted"!==je.audioContext.state&&"suspended"!==je.audioContext.state||6!==this.status&&8!==this.status||(V.R8(`the audioContext state changed to ${je.audioContext.state}. It may be resumed after a user gesture`,Oe,3979),je.AudioRenderThread.fakePlay(this.taskId),this.fire(N.IY))}async createVideoDecoderThread(e=!0){this.VideoDecoderThread||(!U.USE_THREADS&&W.A.worker&&e&&(0,z.A)()?(this.VideoPipelineProxy=new Ie.A,await this.VideoPipelineProxy.run(),this.VideoPipelineProxy.setLogLevel(je.level),this.VideoDecoderThread=this.VideoPipelineProxy.VideoDecodePipeline,this.VideoRenderThread=this.VideoPipelineProxy.VideoRenderPipeline):(this.VideoDecoderThread=await(0,T.pt)(x.A,{name:"VideoDecoderThread"},31138).run(),this.VideoDecoderThread.setLogLevel(je.level),this.VideoRenderThread=je.VideoRenderThread))}static async startDemuxPipeline(e=!0){return je.DemuxThreadReady?je.DemuxThreadReady:je.DemuxThreadReady=new(l())((async t=>{!U.USE_THREADS&&W.A.worker&&e?(je.IODemuxProxy=new ke.A,await je.IODemuxProxy.run(),je.IODemuxProxy.setLogLevel(je.level),je.IOThread=je.IODemuxProxy.IOPipeline,je.DemuxerThread=je.IODemuxProxy.DemuxPipeline):(je.IOThread=await(0,T.pt)(b.A,{name:"IOThread"},87243).run(),je.IOThread.setLogLevel(je.level),je.DemuxerThread=await(0,T.pt)(w.A,{name:"DemuxerThread"},72480).run(),je.DemuxerThread.setLogLevel(je.level)),t()}))}static async startAudioPipeline(e=!0){return je.AudioThreadReady?je.AudioThreadReady:je.AudioThreadReady=new(l())((async t=>{je.audioContext||(je.audioContext=new(AudioContext||webkitAudioContext)),je.audioContext.addEventListener("statechange",(()=>{he.__(je.Instances,(e=>{e.onAudioContextStateChange()}))})),W.A.audioWorklet&&await(0,L.A)(je.audioContext,!U.USE_THREADS||H.A.safari&&!H.A.checkVersion(H.A.version,"16.1",!0)||ge.A.ios&&!H.A.checkVersion(ge.A.version,"16.1",!0)?34268:5676),!U.USE_THREADS&&W.A.worker&&e?(je.AudioPipelineProxy=new Te.A,await je.AudioPipelineProxy.run(),je.AudioPipelineProxy.setLogLevel(je.level),je.AudioDecoderThread=je.AudioPipelineProxy.AudioDecodePipeline,je.AudioRenderThread=je.AudioPipelineProxy.AudioRenderPipeline):(je.AudioDecoderThread=await(0,T.pt)(k.A,{name:"AudioDecoderThread"},18667).run(),je.AudioDecoderThread.setLogLevel(je.level),je.AudioRenderThread=await(0,T.pt)(E.A,{name:"AudioRenderThread"},59377).run(),je.AudioRenderThread.setLogLevel(je.level)),t()}))}static async startVideoRenderPipeline(e=!0){return je.VideoThreadReady?je.VideoThreadReady:je.VideoThreadReady=new(l())((async t=>{!U.USE_THREADS&&W.A.worker&&e&&(0,z.A)()||(je.VideoRenderThread=await(0,T.pt)(D.A,{name:"VideoRenderThread",disableWorker:!(0,z.A)()},33968).run(),je.VideoRenderThread.setLogLevel(je.level)),t()}))}static async startMSEPipeline(e=!0){return je.MSEThreadReady?je.MSEThreadReady:je.MSEThreadReady=new(l())((async t=>{!U.USE_THREADS&&W.A.worker&&e&&W.A.workerMSE?(je.MSEPipelineProxy=new Se.A,await je.MSEPipelineProxy.run(),je.MSEPipelineProxy.setLogLevel(je.level),je.MSEThread=je.MSEPipelineProxy.MSEPipeline):(je.MSEThread=await(0,T.pt)(ee.A,{name:"MSEThread",disableWorker:!W.A.workerMSE},25115).run(),je.MSEThread.setLogLevel(je.level)),t()}))}static async startPipelines(e=!0){await je.startDemuxPipeline(e),await je.startAudioPipeline(e),await je.startVideoRenderPipeline(e),await je.startMSEPipeline(e),V.pq("AVPlayer pipelines started",Oe,4162)}static async stopPipelines(){je.VideoRenderThread&&(await je.VideoRenderThread.clear(),(0,T.nE)(je.VideoRenderThread)),je.AudioPipelineProxy&&(await je.AudioRenderThread.clear(),await je.AudioDecoderThread.clear(),await je.AudioPipelineProxy.destroy(),je.AudioRenderThread=null,je.AudioDecoderThread=null),je.AudioRenderThread&&(await je.AudioRenderThread.clear(),(0,T.nE)(je.AudioRenderThread)),je.AudioDecoderThread&&(await je.AudioDecoderThread.clear(),(0,T.nE)(je.AudioDecoderThread)),je.IODemuxProxy&&(await je.DemuxerThread.clear(),await je.IOThread.clear(),await je.IODemuxProxy.destroy(),je.DemuxerThread=null,je.IOThread=null),je.DemuxerThread&&(await je.DemuxerThread.clear(),(0,T.nE)(je.DemuxerThread)),je.IOThread&&(await je.IOThread.clear(),(0,T.nE)(je.IOThread)),je.MSEPipelineProxy&&(await je.MSEThread.clear(),je.MSEPipelineProxy.destroy(),je.MSEThread=null),je.MSEThread&&(await je.MSEThread.clear(),(0,T.nE)(je.MSEThread)),je.AudioPipelineProxy=null,je.AudioDecoderThread=null,je.IODemuxProxy=null,je.DemuxerThread=null,je.IOThread=null,je.audioContext=null,je.MSEThread=null,V.pq("AVPlayer pipelines stopped",Oe,4226)}static setLogLevel(e){je.level=e,V.V$(e),je.IOThread&&je.IOThread.setLogLevel(e),je.DemuxerThread&&je.DemuxerThread.setLogLevel(e),je.AudioDecoderThread&&je.AudioDecoderThread.setLogLevel(e),je.AudioRenderThread&&je.AudioRenderThread.setLogLevel(e),je.VideoRenderThread&&je.VideoRenderThread.setLogLevel(e),je.MSEThread&&je.MSEThread.setLogLevel(e),V.pq(`set log level: ${e}`,Oe,4258)}on(e,t,i={}){return super.on(e,_.X$({fn:t},i)),this}one(e,t,i={}){return super.on(e,_.X$({fn:t,max:1},i)),this}}(0,r.A)(je,"Instances",[]),(0,r.A)(je,"Util",{compile:M.A,browser:H.A,os:ge.A}),(0,r.A)(je,"IOLoader",{CustomIOLoader:we.A,FetchIOLoader:Ae.A,FileIOLoader:be.A,WebSocketIOLoader:_e.A,SocketIOLoader:Me.A,WebTransportIOLoader:Ce.A}),(0,r.A)(je,"level",V.rD),(0,r.A)(je,"DemuxThreadReady",void 0),(0,r.A)(je,"AudioThreadReady",void 0),(0,r.A)(je,"VideoThreadReady",void 0),(0,r.A)(je,"MSEThreadReady",void 0),(0,r.A)(je,"IODemuxProxy",void 0),(0,r.A)(je,"AudioPipelineProxy",void 0),(0,r.A)(je,"MSEPipelineProxy",void 0),(0,r.A)(je,"IOThread",void 0),(0,r.A)(je,"DemuxerThread",void 0),(0,r.A)(je,"AudioDecoderThread",void 0),(0,r.A)(je,"AudioRenderThread",void 0),(0,r.A)(je,"VideoRenderThread",void 0),(0,r.A)(je,"MSEThread",void 0),(0,r.A)(je,"audioContext",void 0),(0,r.A)(je,"Resource",new(h()))},11628:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(134),s=i(84149),a=i(67593);class n{constructor(e,t){(0,r.A)(this,"videoRenderControlChannel",void 0),(0,r.A)(this,"audioRenderControlChannel",void 0),(0,r.A)(this,"muxerControlChannel",void 0),(0,r.A)(this,"demuxerControlChannel",void 0),(0,r.A)(this,"videoRenderControlIPCPort",void 0),(0,r.A)(this,"audioRenderControlIPCPort",void 0),(0,r.A)(this,"muxerControlIPCPort",void 0),(0,r.A)(this,"demuxerControlIPCPort",void 0),(0,r.A)(this,"observer",void 0),(0,r.A)(this,"visibilityHidden",void 0),(0,r.A)(this,"onVisibilityChange",void 0),(0,r.A)(this,"timeUpdateListenType",void 0),(0,r.A)(this,"enableAudioVideoSync",void 0),this.observer=e,this.videoRenderControlChannel=(0,a.A)(t),this.audioRenderControlChannel=(0,a.A)(t),this.muxerControlChannel=(0,a.A)(t),this.demuxerControlChannel=(0,a.A)(t),this.videoRenderControlIPCPort=new s.Ay(this.videoRenderControlChannel.port2),this.audioRenderControlIPCPort=new s.Ay(this.audioRenderControlChannel.port2),this.muxerControlIPCPort=new s.Ay(this.muxerControlChannel.port2),this.demuxerControlIPCPort=new s.Ay(this.demuxerControlChannel.port2),this.enableAudioVideoSync=!0,this.videoRenderControlIPCPort.on(s.Wo,(e=>{switch(e.method){case"ended":this.observer.onVideoEnded();break;case"updateCanvas":this.observer.onCanvasUpdated();break;case"firstRendered":this.observer.onFirstVideoRendered();break;case"firstRenderedAfterUpdateCanvas":this.observer.onFirstVideoRenderedAfterUpdateCanvas();break;case"syncPts":0===this.timeUpdateListenType&&this.observer.onTimeUpdate(e.params.pts)}})),this.audioRenderControlIPCPort.on(s.Wo,(e=>{switch(e.method){case"syncPts":this.enableAudioVideoSync&&this.videoRenderControlIPCPort.notify("syncPts",e.params),1===this.timeUpdateListenType&&this.observer.onTimeUpdate(e.params.pts);break;case"ended":this.observer.onAudioEnded(),this.timeUpdateListenType=0}})),this.muxerControlIPCPort.on(s.Wo,(e=>{"seek"===e.method&&this.observer.onMSESeek(e.params.time)})),this.demuxerControlIPCPort.on(s.S3,(async e=>{"getDecoderResource"===e.method&&this.demuxerControlIPCPort.reply(e,await this.observer.onGetDecoderResource(e.params.mediaType,e.params.codecId))})),this.onVisibilityChange=t=>{this.visibilityHidden="hidden"===document.visibilityState&&!this.observer.isPictureInPicture(),e.isMediaStreamMode()||this.videoRenderControlIPCPort.notify("skipRender",{skipRender:this.visibilityHidden}),this.muxerControlIPCPort.notify("visibilitychange",{visibilityHidden:this.visibilityHidden})},this.visibilityHidden="hidden"===document.visibilityState&&!this.observer.isPictureInPicture(),document.addEventListener("visibilitychange",this.onVisibilityChange),this.muxerControlIPCPort.notify("visibilitychange",{visibilityHidden:this.visibilityHidden})}getVideoRenderControlPort(){return this.videoRenderControlChannel.port1}getAudioRenderControlPort(){return this.audioRenderControlChannel.port1}getMuxerControlPort(){return this.muxerControlChannel.port1}getDemuxerControlPort(){return this.demuxerControlChannel.port1}setTimeUpdateListenType(e){this.timeUpdateListenType=e}setEnableAudioVideoSync(e){this.enableAudioVideoSync=e}destroy(){this.videoRenderControlIPCPort&&this.videoRenderControlIPCPort.destroy(),this.audioRenderControlIPCPort&&this.audioRenderControlIPCPort.destroy(),this.muxerControlIPCPort&&this.muxerControlIPCPort.destroy(),this.demuxerControlIPCPort&&this.demuxerControlIPCPort.destroy(),this.onVisibilityChange&&(document.removeEventListener("visibilitychange",this.onVisibilityChange),this.onVisibilityChange=null),this.videoRenderControlIPCPort=this.audioRenderControlIPCPort=this.muxerControlIPCPort=this.videoRenderControlChannel=this.audioRenderControlChannel=this.demuxerControlChannel=this.muxerControlChannel=null}}},2368:(e,t,i)=>{"use strict";i.d(t,{A:()=>l});var r=i(134),s=i(63939),a=i(50932),n=i(54058),o=i(38724);const c=500;class l{constructor(e){(0,r.A)(this,"timer",void 0),(0,r.A)(this,"interval",void 0),(0,r.A)(this,"data",void 0),(0,r.A)(this,"lastIncomingPacketCount",void 0),(0,r.A)(this,"shutterCount",void 0),(0,r.A)(this,"lastShutterCount",void 0),(0,r.A)(this,"isFirst",void 0),(0,r.A)(this,"max",void 0),(0,r.A)(this,"min",void 0),(0,r.A)(this,"targetPlaybackRate",void 0),(0,r.A)(this,"currentPlaybackRate",void 0),(0,r.A)(this,"playbackRateTimer",void 0),(0,r.A)(this,"options",void 0),this.options=e,this.interval=1e3,this.isFirst=!0,this.data=[],this.lastIncomingPacketCount=BigInt(0),this.shutterCount=0,this.lastShutterCount=0,this.max=1e3*e.max>>>0,this.min=1e3*e.min>>>0,a.M[15](this.options.jitterBuffer,this.min),a.M[15](this.options.jitterBuffer+4,this.max),e.lowLatencyStart&&a.M[15](this.options.jitterBuffer+4,this.min+c),this.targetPlaybackRate=1,this.currentPlaybackRate=1,this.playbackRateTimer=new n.A((()=>{if(this.currentPlaybackRate>this.targetPlaybackRate){const e=Math.max(this.targetPlaybackRate,this.currentPlaybackRate-.01);this.options.observer.onSetPlayRate(e),this.currentPlaybackRate=e}else if(this.currentPlaybackRate<this.targetPlaybackRate){const e=Math.min(this.targetPlaybackRate,this.currentPlaybackRate+.01);this.options.observer.onSetPlayRate(e),this.currentPlaybackRate=e}else this.playbackRateTimer.stop()}),0,200),this.timer=new o.A(this.onTimer.bind(this),1e3,this.interval)}start(){this.timer.start(),this.isFirst=!0,this.lastIncomingPacketCount=s.f[17](this.options.stats+24)+s.f[17](this.options.stats+112),this.shutterCount=0,this.lastShutterCount=s.f[15](this.options.stats+292)+s.f[15](this.options.stats+288),this.computePlayRate()}stop(){this.timer.stop(),this.data.length=0,this.isFirst=!0,this.playbackRateTimer.isStarted()&&(this.playbackRateTimer.stop(),this.targetPlaybackRate=this.currentPlaybackRate=1,this.options.observer.onSetPlayRate(1))}reset(){this.data.length=0,this.isFirst=!0,this.lastIncomingPacketCount=s.f[17](this.options.stats+24)+s.f[17](this.options.stats+112),this.shutterCount=0,this.lastShutterCount=s.f[15](this.options.stats+292)+s.f[15](this.options.stats+288),this.targetPlaybackRate=this.currentPlaybackRate=1}setPlayRate(e){this.targetPlaybackRate=e,this.options.useMse?(this.options.observer.onSetPlayRate(this.targetPlaybackRate),this.currentPlaybackRate=this.targetPlaybackRate):this.currentPlaybackRate===e||this.playbackRateTimer.isStarted()||this.playbackRateTimer.start()}computePlayRate(){let e=s.f[15](this.options.stats+244)?s.f[15](this.options.stats+32)/s.f[15](this.options.stats+244)*1e3:s.f[15](this.options.stats+232)?s.f[15](this.options.stats+120)/s.f[15](this.options.stats+232)*1e3:s.f[15](this.options.jitterBuffer);const t=(s.f[15](this.options.jitterBuffer)+s.f[15](this.options.jitterBuffer+4))/2;e<s.f[15](this.options.jitterBuffer)>>1&&e<2e3?this.setPlayRate(.9):e<s.f[15](this.options.jitterBuffer)-c&&e<2e3?this.setPlayRate(.95):e>s.f[15](this.options.jitterBuffer+4)+c?this.setPlayRate(1.05):(this.currentPlaybackRate<1&&e>=t||this.currentPlaybackRate>1&&e<=t)&&this.setPlayRate(1),e>2e3&&this.max>2e3&&e>this.max<<1&&this.options.observer.onCroppingBuffer(s.f[15](this.options.jitterBuffer+4))}process(){const e=this.data.reduce(((e,t,i)=>e+t*(i+1)),0)/55,t=this.data.reduce(((t,i)=>t+Math.pow(i-e,2)),0)/this.data.length,i=Math.sqrt(t);if(this.options.lowLatency){const t=Math.round(e/(this.interval/1e3)),r=s.f[15](this.options.stats+232)+s.f[15](this.options.stats+244);t<r>>1||this.shutterCount>3?(a.M[15](this.options.jitterBuffer,Math.min(2*s.f[15](this.options.jitterBuffer),this.max-c)),a.M[15](this.options.jitterBuffer+4,Math.min(2*s.f[15](this.options.jitterBuffer+4),this.max))):t>=r&&i<50?(a.M[15](this.options.jitterBuffer,Math.max(s.f[15](this.options.jitterBuffer)-c,this.min)),a.M[15](this.options.jitterBuffer+4,Math.max(s.f[15](this.options.jitterBuffer+4)-c,this.min+c))):i>100?(a.M[15](this.options.jitterBuffer,Math.min(s.f[15](this.options.jitterBuffer)+c,this.max-c)),a.M[15](this.options.jitterBuffer+4,Math.min(s.f[15](this.options.jitterBuffer+4)+c,this.max))):i<20?s.f[15](this.options.jitterBuffer)===this.min?a.M[15](this.options.jitterBuffer+4,Math.max(s.f[15](this.options.jitterBuffer+4)-c,this.min+c)):a.M[15](this.options.jitterBuffer,Math.max(s.f[15](this.options.jitterBuffer)-c,this.min)):s.f[15](this.options.jitterBuffer+4)===this.max?a.M[15](this.options.jitterBuffer,Math.min(s.f[15](this.options.jitterBuffer)+c,this.max-c)):a.M[15](this.options.jitterBuffer+4,Math.min(s.f[15](this.options.jitterBuffer+4)+c,this.max))}this.computePlayRate(),a.M[19](this.options.stats+272,i)}onTimer(){const e=s.f[17](this.options.stats+24)+s.f[17](this.options.stats+112);this.isFirst?this.isFirst=!1:this.data.push(Number(BigInt.asIntN(32,e-this.lastIncomingPacketCount))),this.lastIncomingPacketCount=e,s.f[15](this.options.stats+292)+s.f[15](this.options.stats+288)>this.lastShutterCount?this.shutterCount++:this.shutterCount=0,this.lastShutterCount=s.f[15](this.options.stats+292)+s.f[15](this.options.stats+288),this.data.length>10&&this.data.shift(),10===this.data.length&&this.process()}}},78201:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(134),s=i(63939),a=i(50932),n=i(54058),o=i(43607);class c{constructor(e,t,i){(0,r.A)(this,"stats",void 0),(0,r.A)(this,"timer",void 0),(0,r.A)(this,"videoFrameRenderCount",void 0),(0,r.A)(this,"videoFrameDecodeCount",void 0),(0,r.A)(this,"audioFrameRenderCount",void 0),(0,r.A)(this,"audioFrameDecodeCount",void 0),(0,r.A)(this,"videoPacketBytes",void 0),(0,r.A)(this,"audioPacketBytes",void 0),(0,r.A)(this,"bufferReceiveBytes",void 0),(0,r.A)(this,"observer",void 0),(0,r.A)(this,"isWorkerMain",void 0),(0,r.A)(this,"videoDecodeMaxIntervalCounter",void 0),(0,r.A)(this,"lastAudioStutterCount",void 0),(0,r.A)(this,"lastAVDelta",void 0),this.stats=e,this.observer=i,this.isWorkerMain=t,this.timer=new n.A(this.onTimer.bind(this),1e3,1e3)}reset(){this.videoFrameRenderCount=s.f[17](this.stats+160),this.videoFrameDecodeCount=s.f[17](this.stats+144),this.audioFrameRenderCount=s.f[17](this.stats+72),this.audioFrameDecodeCount=s.f[17](this.stats+56),this.videoPacketBytes=s.f[17](this.stats+104),this.audioPacketBytes=s.f[17](this.stats+16),this.bufferReceiveBytes=s.f[17](this.stats+192),this.isWorkerMain||(a.M[15](this.stats+248,0),a.M[15](this.stats+252,0),a.M[15](this.stats+256,0),a.M[15](this.stats+260,0))}start(){this.reset(),this.videoDecodeMaxIntervalCounter=0,this.lastAudioStutterCount=0,this.lastAVDelta=BigInt(0),this.timer.start()}stop(){this.timer.stop()}onTimer(){a.M[15](this.stats+228,Number(BigInt.asIntN(32,s.f[17](this.stats+160)-this.videoFrameRenderCount))),a.M[15](this.stats+224,Number(BigInt.asIntN(32,s.f[17](this.stats+144)-this.videoFrameDecodeCount))),a.M[15](this.stats+240,Number(BigInt.asIntN(32,s.f[17](this.stats+72)-this.audioFrameRenderCount))),a.M[15](this.stats+236,Number(BigInt.asIntN(32,s.f[17](this.stats+56)-this.audioFrameDecodeCount))),a.M[15](this.stats+220,Number(BigInt.asIntN(32,s.f[17](this.stats+104)-this.videoPacketBytes))),a.M[15](this.stats+216,Number(BigInt.asIntN(32,s.f[17](this.stats+16)-this.audioPacketBytes))),a.M[15](this.stats+264,Number(BigInt.asIntN(32,s.f[17](this.stats+192)-this.bufferReceiveBytes))),"visible"===document.visibilityState&&(s.f[15](this.stats+228)<.5*s.f[15](this.stats+232)||s.f[15](this.stats+260)>6e3/s.f[15](this.stats+232))&&this.observer.onVideoStutter(),s.f[15](this.stats+256)>1e3/s.f[15](this.stats+232)&&s.f[15](this.stats+224)<.9*s.f[15](this.stats+232)&&(s.f[17](this.stats+328)>0&&s.f[17](this.stats+336)>0&&s.f[17](this.stats+328)-s.f[17](this.stats+336)>BigInt(1e3)&&s.f[17](this.stats+328)-s.f[17](this.stats+336)>this.lastAVDelta||s.f[15](this.stats+288)>this.lastAudioStutterCount)?this.videoDecodeMaxIntervalCounter++:this.videoDecodeMaxIntervalCounter=0,this.videoDecodeMaxIntervalCounter>5&&(this.observer.onVideoDiscard(),this.videoDecodeMaxIntervalCounter=0),this.lastAudioStutterCount=s.f[15](this.stats+288),this.lastAVDelta=s.f[17](this.stats+328)-s.f[17](this.stats+336),this.reset();const e=s.f[17](this.stats+344),t=s.f[17](this.stats+352),i=s.f[17](this.stats+328),r=s.f[17](this.stats+336);if(e&&t&&e-i>2e3&&t-r>2e3||e&&!t&&e-i>2e3||t&&!e&&t-r>2e3){const i=e&&t?o.jk(e,t):e||t;this.observer.onMasterTimerUpdate(i)}}}},80089:(e,t,i)=>{"use strict";var r;i.d(t,{s:()=>r}),function(e){e.WIDEVINE="com.widevine.alpha",e.PLAYREADY="com.microsoft.playready",e.CLEARKEY="org.w3.clearkey",e.FAIRPLAY="com.apple.fps.1_0"}(r||(r={}))},3680:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(80089);function s(e){const t={edef8ba979d64acea3c827dcd51d21ed:r.s.WIDEVINE,"9a04f07998404286ab92e65be0885f95":r.s.PLAYREADY,e2719d58a985b3c9781ab030af78d30e:r.s.CLEARKEY,"94ce86fb07ff4f43adb893d2fa968ca2":r.s.FAIRPLAY};let i="";return e.forEach((e=>{let t=e.toString(16);1===t.length&&(t="0"+t),i+=t})),t[i]}},30691:(e,t,i)=>{"use strict";function r(e){let t="";return e.forEach((e=>{t+=String.fromCharCode(e)})),t=btoa(t),t.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}i.d(t,{A:()=>r})},28090:(e,t,i)=>{"use strict";i.d(t,{CN:()=>n,E9:()=>p,F5:()=>r,Gd:()=>b,IY:()=>m,NN:()=>o,NX:()=>y,Nz:()=>d,Rj:()=>f,S2:()=>s,Sw:()=>v,W1:()=>x,Wt:()=>u,Wu:()=>w,d6:()=>a,dQ:()=>g,hV:()=>l,mQ:()=>h,xv:()=>A,yd:()=>c});const r="loading",s="loaded",a="playing",n="played",o="paused",c="stopped",l="ended",d="seeking",h="seeked",u="changing",f="changed",p="time",m="resume",g="audioContextRunning",v="firstAudioRendered",y="firstVideoRendered",A="streamUpdate",b="progress",w="volumeChange",x="subtitleDelayChange"},67593:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(26429),s=i(42577),a=i(95797);function n(e){return r.USE_THREADS||a.A.worker&&e?new MessageChannel:new s.A}},76750:(e,t,i)=>{"use strict";function r(){if("function"==typeof MediaSource)return MediaSource;if("function"==typeof ManagedMediaSource)return ManagedMediaSource;throw new Error("not support mse")}i.d(t,{A:()=>r})},47595:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(95797),s=i(86834),a=i(44690);function n(){let e=r.A.offscreenCanvas;return(s.A.safari&&!s.A.checkVersion(s.A.version,"17",!0)||a.A.ios&&!s.A.checkVersion(a.A.version,"17",!0))&&(e=!1),e}},25115:(e,t,i)=>{"use strict";i.d(t,{A:()=>Y});var r=i(54001),s=i.n(r),a=i(14686),n=i(61499),o=i(63939),c=i(9599),l=i(29170),d=i(50932),h=i(12264),u=i(44315),f=i(44527),p=i(9705),m=i(84149),g=i(4624),v=i(35336),y=i(92174),A=i(69765),b=(i(77162),i(71766)),w=i(39148),x=i(60120),k=i(84290),T=i(77231),I=i(44328),S=i(86932),P=i(85224),_=i(10333),M=i(22343),C=i(71517),B=i(37837),E=i(86834),D=i(85103),R=i(13724),U=i(43607),L=i(65977),$=i(76750),F=i(39381),O=i(62815),N=i(67659),z=i(71762),V=i(72703),W=i(67672),j=i(44690),G=i(38724);const H="src/avplayer/mse/MSEPipeline.ts";function q(e,t,i,r){if(t!==r)return!0;let s=!1;for(let r=0;r<t;r++)if(o.f[2](e+r)!==o.f[2](i+r)){s=!0;break}return s}class Y extends f.A{constructor(){super()}async syncToKeyframe(e){let t=!0;if(e.video)for(;;){if(e.video.backPacket=await this.pullAVPacket(e.video,e),e.video.backPacket<0){e.video.packetEnded=!0,e.video.backPacket=0;break}if(e.audio&&!e.audio.packetEnded&&(!e.audio.backPacket||(0,I.Mr)(o.f[17](e.audio.backPacket+8),e.audio.backPacket+72,T.i0)<(0,I.Mr)(o.f[17](e.video.backPacket+8),e.video.backPacket+72,T.i0)))for(;;){if(e.audio.backPacket>0&&e.avpacketPool.release(e.audio.backPacket),e.audio.backPacket=await this.pullAVPacket(e.audio,e),e.audio.backPacket<0){e.audio.packetEnded=!0,e.audio.backPacket=0;break}if((0,I.Mr)(o.f[17](e.audio.backPacket+8),e.audio.backPacket+72,T.i0)>(0,I.Mr)(o.f[17](e.video.backPacket+8),e.video.backPacket+72,T.i0))break}if(1&o.f[15](e.video.backPacket+36)||27===o.f[15](e.video.codecpar+4)&&O.KD(e.video.backPacket,o.f[20](e.video.codecpar+12)?1+(3&F.r8(o.f[20](e.video.codecpar+12)+4)):4)||173===o.f[15](e.video.codecpar+4)&&N.KD(e.video.backPacket,o.f[20](e.video.codecpar+12)?1+(3&F.r8(o.f[20](e.video.codecpar+12)+21)):4))break;t=!1,e.avpacketPool.release(e.video.backPacket)}return t}getSourceOpenHandler(e,t=BigInt(0)){return async()=>{var i,r;await this.syncToKeyframe(e);let h=t,u=t;if(!e.audio||e.audio.backPacket||e.audio.packetEnded||(e.audio.backPacket=await this.pullAVPacket(e.audio,e),e.audio.backPacket<0&&(e.audio.packetEnded=!0,e.audio.backPacket=0)),e.video&&!e.video.backPacket&&e.video.packetEnded&&(e.video.backPacket=await this.pullAVPacket(e.video,e),e.video.backPacket<0&&(e.video.packetEnded=!0,e.video.backPacket=0)),(null===(i=e.audio)||void 0===i?void 0:i.backPacket)>0&&(h=U.T9(h,(0,I.Mr)(o.f[17](e.audio.backPacket+16),e.audio.backPacket+72,T.i0))),(null===(r=e.video)||void 0===r?void 0:r.backPacket)>0&&(u=U.T9(u,(0,I.Mr)(o.f[17](e.video.backPacket+16),e.video.backPacket+72,T.i0))),e.audio&&e.video&&U.tn(h-u)>1e3)if(u>h){const t=(0,I.k)(h,T.i0,(0,l.A)(e.video.backPacket+72,c.P));d.M[17](e.video.backPacket+48,o.f[17](e.video.backPacket+16)-t),d.M[17](e.video.backPacket+16,t),d.M[17](e.video.backPacket+8,t),u=h}else if(h>u&&86018===e.audio.oformatContext.streams[0].codecpar.codecId&&2===e.audio.oformatContext.streams[0].codecpar.profile&&e.audio.oformatContext.streams[0].codecpar.chLayout.nbChannels<3){const t=e.avpacketPool.alloc();(0,C.rN)(t,e.audio.backPacket);const i=1===e.audio.oformatContext.streams[0].codecpar.chLayout.nbChannels?new Uint8Array([0,200,0,128,35,128]):new Uint8Array([33,0,73,144,2,25,0,35,128]),r=(0,B.sY)(i.length);(0,a.lW)(r,i.length,i),(0,C.NX)(t,r,i.length),d.M[17](t+16,(0,I.k)(u,T.i0,(0,l.A)(t+72,c.P))),d.M[17](t+8,(0,I.k)(u,T.i0,(0,l.A)(t+72,c.P)));const s=BigInt(1024e3)/BigInt(0|e.audio.oformatContext.streams[0].codecpar.sampleRate),n=Number(BigInt.asIntN(32,(h-u)/s));let f=o.f[17](t+16)+(0,I.k)(s,T.i0,(0,l.A)(e.audio.backPacket+72,c.P));for(let i=0;i<n-1;i++){const i=e.avpacketPool.alloc();(0,C.rN)(i,t),d.M[17](i+16,f),d.M[17](i+8,f),e.audio.pullQueue.queue.push(i),f+=(0,I.k)(s,T.i0,(0,l.A)(e.audio.backPacket+72,c.P))}e.audio.pullQueue.queue.push(e.audio.backPacket),e.audio.backPacket=t,h=u}const f=[];e.audio&&(e.audio.track.setSourceBuffer(this.createSourceBuffer(e.mediaSource,e.audio.oformatContext.streams[0].codecpar[n.o9])),e.audio.enableRawMpeg||(y.ho(e.audio.oformatContext),y.bx(e.audio.oformatContext)),f.push(this.startMux(e.audio,e,U.T9(h,u)))),e.video&&(e.video.track.setSourceBuffer(this.createSourceBuffer(e.mediaSource,e.video.oformatContext.streams[0].codecpar[n.o9])),e.video.enableRawMpeg||(y.ho(e.video.oformatContext),y.bx(e.video.oformatContext)),f.push(this.startMux(e.video,e,U.T9(h,u)))),await s().all(f);let p=!1,m=!1;e.audio&&(e.audio.backPacket=await this.pullAVPacket(e.audio,e),e.audio.backPacket>0?(p=!0,e.audio.frontPacket=await this.pullAVPacket(e.audio,e),e.audio.frontPacket>0?e.audio.frontBuffered=!0:(e.audio.frontPacket=0,e.audio.packetEnded=!0)):e.audio.packetEnded=!0,e.audio.enableRawMpeg||e.audio.oformatContext.ioWriter.flush(),e.audio.track.addBuffer(e.audio.bufferQueue.flush())),e.video&&(e.video.backPacket=await this.pullAVPacket(e.video,e),e.video.backPacket>0?(m=!0,e.video.frontPacket=await this.pullAVPacket(e.video,e),e.video.frontPacket>0?e.video.frontBuffered=!0:(e.video.frontPacket=0,e.video.packetEnded=!0)):e.video.packetEnded=!0,e.video.enableRawMpeg||e.video.oformatContext.ioWriter.flush(),e.video.track.addBuffer(e.video.bufferQueue.flush())),e.audio&&(p?(this.createLoop(e.audio,e),e.audio.loop.start()):e.audio.track.end()),e.video&&(m?(this.createLoop(e.video,e),e.video.loop.start()):e.video.track.end()),await new R.A(.1);let g=0;e.audio?g=e.video?Math.max(e.audio.track.getBufferedStart(),e.video.track.getBufferedStart()):e.audio.track.getBufferedStart():e.video&&(g=e.video.track.getBufferedStart()),e.currentTimeNTP=(0,S.A)(),t>BigInt(0)?(e.currentTime=(0,D.yw)(t),e.controlIPCPort.notify("seek",{time:e.currentTime})):(E.A.safari||j.A.ios||g>.1||e.playRate>BigInt(100))&&(e.currentTime=g,e.currentTimeNTP=(0,S.A)(),e.controlIPCPort.notify("seek",{time:g}))}}getMimeType(e){let t="";return 1===o.f[15](e)?t=(0,P.A)(e):0===o.f[15](e)&&(t=(0,_.A)(e)),t||g.h2("invalid stream",H,445),t}createSourceBuffer(e,t){return e.addSourceBuffer(this.getMimeType(t))}mixExtradata(e,t,i){const r=e.oformatContext.streams[0].codecpar;r.extradata&&(0,B.Eb)(r.extradata),r.extradata=(0,B.sY)(i),(0,a.Mr)(r.extradata,t,i),r.extradataSize=i,e.track.changeMimeType(this.getMimeType(r[n.o9]),e.enableRawMpeg?"sequence":"segments");const s=new A.A({fragmentMode:1,fragment:!0,fastOpen:!0,movMode:0,defaultBaseIsMoof:!0,reverseSpsInAvcc:!0});e.oformatContext.oformat=s,e.timestampOffsetUpdated=!1,e.enableRawMpeg||(y.ho(e.oformatContext),y.bx(e.oformatContext))}checkEnableEncryption(e,t){if(e.oformatContext.streams[0].metadata.encryption){const i=(0,C.fQ)(t,25);if(!i&&!e.ignoreEncryption||i&&e.ignoreEncryption){e.track.changeMimeType(this.getMimeType(e.oformatContext.streams[0].codecpar[n.o9]),e.enableRawMpeg?"sequence":"segments");const t=new A.A({fragmentMode:1,fragment:!0,fastOpen:!0,movMode:0,defaultBaseIsMoof:!0,reverseSpsInAvcc:!0,ignoreEncryption:!i});e.ignoreEncryption=!i,e.oformatContext.oformat=t,e.timestampOffsetUpdated=!1,e.enableRawMpeg||(y.ho(e.oformatContext),y.bx(e.oformatContext))}}}async pullAVPacketInternal(e,t){const i=await t.request("pull");if(W.ai(i)||(0,V.A)(i))return i;{const t=e.avpacketPool.alloc();return(0,z.r0)(i,t),t}}async pullAVPacket(e,t){const i=e.pullQueue;if(i.ended&&!i.queue.length)return-1048576;const r=i.queue.length?i.queue.shift():await this.pullAVPacketInternal(t,e.pullIPC);if(r<0)return i.ended=!0,-1048576;if(o.f[17](r+16)<BigInt(0))return r;if(o.f[17](r+16)<i.lastDTS&&g.R8(`got packet with dts ${o.f[17](r+16)}, which is earlier then the last packet(${i.lastDTS})`,H,548),d.M[17](r+48,T.Dh),"audio"===e.type&&o.f[17](r+16)>0)d.M[17](r+8,o.f[17](r+16));else if("video"===e.type&&!t.isLive)if(1&o.f[15](r+36)&&(27===o.f[15](t.video.codecpar+4)&&O.KD(r,o.f[20](t.video.codecpar+12)?1+(3&F.r8(o.f[20](t.video.codecpar+12)+4)):4)||173===o.f[15](t.video.codecpar+4)&&N.KD(r,o.f[20](t.video.codecpar+12)?1+(3&F.r8(o.f[20](t.video.codecpar+12)+21)):4)))if(o.f[17](r+8)<i.lastPTS){g.R8(`got video packet with pts ${o.f[17](r+8)}, which is earlier then the last packet(${i.lastPTS}), try to fix it!`,H,585),d.M[17](r+8,i.lastPTS+(o.f[17](r+16)-i.lastDTS));const s=await this.pullAVPacketInternal(t,e.pullIPC);if(s<0)i.ended=!0;else{i.queue.push(s);let a=o.f[17](s+8);const n=o.f[17](s+8);for(;;){const r=await this.pullAVPacketInternal(t,e.pullIPC);if(r<0){i.ended=!0;break}if(i.queue.push(r),o.f[17](r+8)>n)break;a=U.jk(a,o.f[17](r+8))}a<o.f[17](r+8)&&(i.diff=o.f[17](r+16)-i.lastDTS)}}else i.diff=BigInt(0);else d.M[17](r+8,o.f[17](r+8)+i.diff);return o.f[17](r+8)>i.lastPTS&&(i.lastPTS=o.f[17](r+8)),i.lastDTS=o.f[17](r+16),"audio"===e.type&&i.useSampleRateTimeBase&&(i.frameCount===T.Dh?(i.frameCount=(0,I.Mr)(o.f[17](r+16),r+72,e.oformatContext.streams[0].timeBase),d.M[17](r+16,i.frameCount),d.M[17](r+8,i.frameCount)):(i.frameCount=i.frameCount+BigInt(0|o.f[15](e.codecpar+144)),d.M[17](r+16,i.frameCount),d.M[17](r+8,i.frameCount)),(0,a.Mr)(r+72,e.oformatContext.streams[0].timeBase[n.o9],8)),r}writeAVPacket(e,t,i=!1){if(t.enableRawMpeg){if(!t.timestampOffsetUpdated){const i=(0,I.Mr)(o.f[17](e+8),e+72,T.i0);t.track.updateTimestampOffset(Number(BigInt.asIntN(32,i))/1e3),t.timestampOffsetUpdated=!0}t.bufferQueue.write((0,a.s3)(o.f[20](e+24),o.f[15](e+28)).slice())}else this.checkEnableEncryption(t,e),y.XA(t.oformatContext,e),i&&t.oformatContext.ioWriter.flush()}swap(e,t){if(e.backPacket&&t.avpacketPool.release(e.backPacket),e.backPacket=0,!e.frontBuffered)return!1;e.backPacket=e.frontPacket,e.frontPacket=0,e.frontBuffered=!1;const i=(0,S.A)();return this.pullAVPacket(e,t).then((r=>{if(r<0)return e.packetEnded=!0,void(e.frontPacket=0);const s=(0,S.A)()-i;s>5&&(e.startTimestamp+=BigInt(Math.floor(s))),e.frontPacket=r,e.frontBuffered=!0,e.seekSync&&(e.seekSync(),e.seekSync=null),e.backPacket||this.swap(e,t)})),!0}createLoop(e,t){e.loop=new w.A((()=>{const i=e.track.getBufferedDuration(t.currentTime+((0,S.A)()-t.currentTimeNTP)/1e3);if(i>t.maxBuffer*(t.playRate>BigInt(100)?Number(t.playRate)/100:1))return e.loop.emptyTask(),void this.checkWaiting(t);if(!e.backPacket)return void(e.packetEnded&&!e.frontPacket?(e.ended=!0,e.loop.stop(),e.enableRawMpeg||(y.dJ(e.oformatContext),y.bX(e.oformatContext)),e.bufferQueue.size&&e.track.addBuffer(e.bufferQueue.flush()),e.track.end()):e.loop.emptyTask());let r=e.backPacket;const s=(0,I.Mr)(o.f[17](r+16),r+72,T.i0);if(e.lastDTS!==T.Dh&&s-e.lastDTS>1e3&&(y.bX(e.oformatContext),e.startTimestamp-=s-e.lastDTS),e.lastDTS=s,t.enableJitterBuffer&&(o.f[15](t.stats+244)?o.f[15](t.stats+32)/o.f[15](t.stats+244)*1e3:o.f[15](t.stats+232)?o.f[15](t.stats+120)/o.f[15](t.stats+232)*1e3:0)<=o.f[15](t.stats+280)&&this.setPlayRate(t.taskId,1),s*BigInt(100)/t.playRate+e.startTimestamp-BigInt(Math.floor((0,S.A)()))<=0||i<t.minBuffer*(t.playRate>BigInt(100)?Number(t.playRate)/100:1)){e.track.isPaused()&&e.track.enqueue(),d.M[15](r+32,e.oformatContext.streams[0].index);const i=(0,C.rU)(r,1);i&&q(e.oformatContext.streams[0].codecpar.extradata,e.oformatContext.streams[0].codecpar.extradataSize,o.f[20](i),0|o.f[25](i+4))&&this.mixExtradata(e,o.f[20](i),0|o.f[25](i+4)),this.writeAVPacket(r,e,!0),e.track.addBuffer(e.bufferQueue.flush());const a=e.oformatContext.streams[0].codecpar.codecType;if(0===a?(d.M[17](t.stats+144,o.f[17](t.stats+144)+BigInt(1)),d.M[17](t.stats+160,o.f[17](t.stats+160)+BigInt(1))):1===a&&(d.M[17](t.stats+56,o.f[17](t.stats+56)+BigInt(1)),d.M[17](t.stats+72,o.f[17](t.stats+72)+BigInt(1))),t.playRate!==t.targetRate&&(e.startTimestamp=BigInt(Math.floor((0,S.A)()))-s*BigInt(100)/t.targetRate,t.playRate=t.targetRate),e.packetEnded&&!e.frontPacket)return e.ended=!0,e.loop.stop(),e.enableRawMpeg||(y.dJ(e.oformatContext),y.bX(e.oformatContext)),e.bufferQueue.size&&e.track.addBuffer(e.bufferQueue.flush()),void e.track.end();this.swap(e,t)}else e.loop.emptyTask()}),0,0)}async startMux(e,t,i=BigInt(0)){let r,s=T.Dh,a=T.Dh,n=BigInt(0),c=t.cacheDuration;const l=e.oformatContext.streams[0].timeBase;for(e.backPacket>0&&(s=o.f[17](e.backPacket+16),a=o.f[17](e.backPacket+8),i>a&&(c+=i-(0,I.k)(s,l,T.i0)),d.M[15](e.backPacket+32,e.oformatContext.streams[0].index),this.writeAVPacket(e.backPacket,e),t.avpacketPool.release(e.backPacket),e.backPacket=0);s===T.Dh||(0,I.k)(n-s,l,T.i0)<c;){if(r=await this.pullAVPacket(e,t),r<0){e.packetEnded=!0;break}if(n=o.f[17](r+16),s===T.Dh&&(s=n,a=o.f[17](r+8)),o.f[17](r+8)<a&&(a=o.f[17](r+8)),t.video&&t.video.streamIndex===o.f[15](r+32)){const t=(0,C.rU)(r,1);t&&q(e.oformatContext.streams[0].codecpar.extradata,e.oformatContext.streams[0].codecpar.extradataSize,o.f[20](t),0|o.f[25](t+4))&&this.mixExtradata(e,o.f[20](t),0|o.f[25](t+4))}d.M[15](r+32,e.oformatContext.streams[0].index),this.writeAVPacket(r,e),t.avpacketPool.release(r)}a!==T.Dh&&e.startPTS<=BigInt(0)&&(e.startPTS=a),e.pullQueue.diff=BigInt(0),t.currentTimeNTP=(0,S.A)(),t.currentTime=0,e.startTimestamp=BigInt(Math.floor((0,S.A)()))-(0,I.k)(n,l,T.i0)*BigInt(100)/t.playRate}resetResource(e,t){e.bufferQueue.flush(),e.oformatContext.oformat.destroy(e.oformatContext);const i=new A.A({fragmentMode:1,fragment:!0,fastOpen:!0,movMode:0,defaultBaseIsMoof:!0,reverseSpsInAvcc:!0});e.oformatContext.oformat=i;const r=new x.A;r.onQuotaExceededError=()=>{e.startTimestamp-=BigInt(100)},r.onEnded=()=>{t.audio&&!t.audio.ended||t.video&&!t.video.ended||(t.mediaSource.endOfStream(),g.pq(`muxer ended, taskId: ${t.taskId}`,H,922))},e.track=r,e.packetEnded=!1,e.ended=!1,e.startTimestamp=BigInt(0),e.frontBuffered=!1,e.seekSync=null,e.loop&&(e.loop.destroy(),e.loop=null),e.frontPacket&&(t.avpacketPool.release(e.frontPacket),e.frontPacket=0),e.backPacket&&(t.avpacketPool.release(e.backPacket),e.backPacket=0),e.pullQueue.ended=!1,e.pullQueue.index=0,e.pullQueue.frameCount=T.Dh,e.pullQueue.lastPTS=BigInt(0),e.pullQueue.lastDTS=BigInt(0),e.pullQueue.diff=BigInt(0),e.lastDTS=T.Dh}async addStream(e,t,i,r,s,a,c){const l=this.tasks.get(e);if(l){const h=(0,B.Gy)(168);(0,V.A)(i)?(0,b.Yi)(h,i):(0,z.T8)(i,h);const f=new v.A(1048576),y=(0,u.fG)(),w=new A.A({fragmentMode:1,fragment:!0,fastOpen:!0,movMode:0,defaultBaseIsMoof:!0,reverseSpsInAvcc:!0}),k=new M.A;f.onFlush=e=>(k.write(e.slice()),0),f.onSeek=e=>k.seek(e)?0:p.lh;const S=y.createStream();(0,b.Yi)(S.codecpar[n.o9],h),S.metadata=s,86017===o.f[15](h+4)&&(S.codecpar.codecTag=(0,L.A)(".mp3"));const P=1===o.f[15](h)&&o.f[15](h+144)&&!l.isLive&&(0,I.lb)(r)>(0,I.lb)({num:1,den:o.f[15](h+136)});P?(S.timeBase.den=o.f[15](h+136),S.timeBase.num=1):(S.timeBase.den=r.den,S.timeBase.num=r.num),y.oformat=w,y.ioWriter=f;const _=new x.A,C={type:"audio",codecpar:h,ioWriter:f,oformatContext:y,oformat:w,track:_,bufferQueue:k,streamIndex:t,pullIPC:new m.Ay(c),loop:null,frontPacket:0,backPacket:0,frontBuffered:!1,startTimestamp:BigInt(0),packetEnded:!1,ended:!1,seekSync:null,startPTS:a,lastDTS:T.Dh,pullQueue:{queue:[],index:0,frameCount:T.Dh,diff:BigInt(0),lastPTS:BigInt(0),lastDTS:BigInt(0),ended:!1,useSampleRateTimeBase:P},enableRawMpeg:86017===o.f[15](h+4)&&!E.A.firefox,timestampOffsetUpdated:!1,ignoreEncryption:!1};_.onQuotaExceededError=()=>{C.startTimestamp-=BigInt(100)},_.onEnded=()=>{l.audio&&!l.audio.ended||l.video&&!l.video.ended||(l.mediaSource.endOfStream(),g.pq(`muxer ended, taskId: ${l.taskId}`,H,1069))},1===o.f[15](h)?(l.audio=C,d.M[15](l.stats+4,o.f[15](h+136)),d.M[15](l.stats,o.f[15](h+116))):0===o.f[15](h)&&(C.type="video",l.video=C,d.M[15](l.stats+84,o.f[15](h+56)),d.M[15](l.stats+88,o.f[15](h+60)),o.f[15](l.stats+84)*o.f[15](l.stats+88)>8294400&&(E.A.safari||j.A.ios)&&(l.cacheDuration=U.T9(BigInt(3e3),l.cacheDuration))),g.Yz(`add stream ${t}, taskId: ${e}`,H,1089)}else g.h2("task not found",H,1092)}async reAddStream(e,t,i,r,a,c){const l=this.tasks.get(e);if(l){const d=(0,B.Gy)(168);(0,V.A)(i)?(0,b.Yi)(d,i):(0,z.T8)(i,d);const h=1===o.f[15](d)?l.audio:l.video;if(h){h.bufferQueue.flush(),await new(s())((e=>{h.track.removeAllBuffer((()=>{e()}))})),h.track.reset();const e=new A.A({fragmentMode:1,fragment:!0,fastOpen:!0,movMode:0,defaultBaseIsMoof:!0,reverseSpsInAvcc:!0});h.oformatContext.oformat=e,h.codecpar&&(0,b.dn)(h.codecpar),h.codecpar=d,h.streamIndex=t,h.startPTS=c;const i=h.oformatContext.streams[0];(0,b.Yi)(i.codecpar[n.o9],d),i.metadata=a,86017===o.f[15](d+4)&&(i.codecpar.codecTag=(0,L.A)(".mp3"));const u=1===o.f[15](d)&&o.f[15](d+144)&&!l.isLive&&(0,I.lb)(r)>(0,I.lb)({num:1,den:o.f[15](d+136)});u?(i.timeBase.den=o.f[15](d+136),i.timeBase.num=1):(i.timeBase.den=r.den,i.timeBase.num=r.num),h.enableRawMpeg=86017===o.f[15](d+4)&&!E.A.firefox,h.timestampOffsetUpdated=!1,h.pullQueue.useSampleRateTimeBase=u;try{h.track.changeMimeType(this.getMimeType(i.codecpar[n.o9]),h.enableRawMpeg?"sequence":"segments")}catch(e){if(!E.A.firefox||e.message.indexOf("An attempt was made to use an object that is not")<0)throw e}h.enableRawMpeg||(y.ho(h.oformatContext),y.bx(h.oformatContext))}else(0,b.dn)(d);g.Yz(`readd stream ${t}, taskId: ${e}`,H,1194)}else g.h2("task not found",H,1197)}async pause(e){const t=this.tasks.get(e);var i,r,s,a;t?(null!==(i=t.audio)&&void 0!==i&&i.loop||null!==(r=t.video)&&void 0!==r&&r.loop||g.h2("task has not played",H,1205),t.pausing=!0,t.pauseTimestamp=(0,S.A)(),null===(s=t.audio)||void 0===s||s.loop.stop(),null===(a=t.video)||void 0===a||a.loop.stop(),t.fakePlayTimer&&t.fakePlayTimer.stop(),g.Yz(`pause taskId: ${e}`,H,1215)):g.h2("task not found",H,1218)}async unpause(e){const t=this.tasks.get(e);var i,r;t?(null!==(i=t.audio)&&void 0!==i&&i.loop||null!==(r=t.video)&&void 0!==r&&r.loop||g.h2("task has not played",H,1226),t.pausing=!1,t.seeking||(t.audio&&(t.audio.startTimestamp+=BigInt(Math.floor((0,S.A)()-t.pauseTimestamp)),t.audio.loop.start()),t.video&&(t.video.startTimestamp+=BigInt(Math.floor((0,S.A)()-t.pauseTimestamp)),t.video.loop.start())),t.fakePlayTimer&&t.fakePlayTimer.start(),g.Yz(`unpause taskId: ${e}`,H,1244)):g.h2("task not found",H,1247)}async beforeSeek(e){const t=this.tasks.get(e);if(t){var i,r;const a=[];t.audio&&(t.audio.ended||t.audio.frontBuffered||a.push(new(s())((e=>{t.audio.seekSync=e})))),t.video&&(t.video.ended||t.video.frontBuffered||a.push(new(s())((e=>{t.video.seekSync=e})))),await s().all(a),t.seeking=!0,null===(i=t.audio)||void 0===i||i.loop.stop(),null===(r=t.video)||void 0===r||r.loop.stop(),t.audio&&(t.audio.enableRawMpeg||y.bX(t.audio.oformatContext),t.audio.bufferQueue.flush(),(E.A.safari||j.A.ios)&&await new(s())((e=>{t.audio.track.removeAllBuffer((()=>{e()}))})),t.audio.track.reset(),t.audio.packetEnded=!1,t.audio.timestampOffsetUpdated=!1,t.audio.backPacket&&(t.avpacketPool.release(t.audio.backPacket),t.audio.backPacket=0),t.audio.frontPacket&&(t.avpacketPool.release(t.audio.frontPacket),t.audio.frontPacket=0),t.audio.pullQueue.queue.length&&t.audio.pullQueue.queue.forEach((e=>{t.avpacketPool.release(e)})),t.audio.pullQueue.queue.length=0,t.audio.pullQueue.ended=!1,t.audio.pullQueue.index=0,t.audio.pullQueue.lastPTS=BigInt(0),t.audio.pullQueue.lastDTS=BigInt(0),t.audio.pullQueue.diff=BigInt(0),t.audio.pullQueue.frameCount=T.Dh,t.audio.lastDTS=T.Dh),t.video&&(t.video.enableRawMpeg||y.bX(t.video.oformatContext),t.video.bufferQueue.flush(),(E.A.safari||j.A.ios)&&await new(s())((e=>{t.video.track.removeAllBuffer((()=>{e()}))})),t.video.track.reset(),t.video.packetEnded=!1,t.video.timestampOffsetUpdated=!1,t.video.backPacket&&(t.avpacketPool.release(t.video.backPacket),t.video.backPacket=0),t.video.frontPacket&&(t.avpacketPool.release(t.video.frontPacket),t.video.frontPacket=0),t.video.pullQueue.queue.length&&t.video.pullQueue.queue.forEach((e=>{t.avpacketPool.release(e)})),t.video.pullQueue.queue.length=0,t.video.pullQueue.ended=!1,t.video.pullQueue.index=0,t.video.pullQueue.diff=BigInt(0),t.video.pullQueue.lastPTS=BigInt(0),t.video.pullQueue.lastDTS=BigInt(0),t.video.lastDTS=T.Dh),g.Yz(`before seek end taskId: ${e}`,H,1358)}}async afterSeek(e,t){const i=this.tasks.get(e);if(i){let r=t,a=t,n=await this.syncToKeyframe(i);i.audio&&i.audio.backPacket>0&&((!n||t<BigInt(0))&&(r=(0,I.Mr)(o.f[17](i.audio.backPacket+8),i.audio.backPacket+72,T.i0)),d.M[15](i.audio.backPacket+32,i.audio.oformatContext.streams[0].index),this.writeAVPacket(i.audio.backPacket,i.audio),i.avpacketPool.release(i.audio.backPacket),i.audio.backPacket=0),i.video&&i.video.backPacket>0&&((!n||t<BigInt(0))&&(a=(0,I.Mr)(o.f[17](i.video.backPacket+8),i.video.backPacket+72,T.i0)),d.M[15](i.video.backPacket+32,i.video.oformatContext.streams[0].index),this.writeAVPacket(i.video.backPacket,i.video),i.avpacketPool.release(i.video.backPacket),i.video.backPacket=0);const c=U.T9(r,a);for(;;){if(i.audio&&!i.audio.packetEnded){if(i.audio.backPacket=await this.pullAVPacket(i.audio,i),i.audio.backPacket<0&&(i.audio.packetEnded=!0,i.audio.backPacket=0,!i.video||i.video.packetEnded))break;if(r<BigInt(0)&&(r=(0,I.Mr)(o.f[17](i.audio.backPacket+8),i.audio.backPacket+72,T.i0)),!((0,I.Mr)(o.f[17](i.audio.backPacket+8),i.audio.backPacket+72,T.i0)<c+i.cacheDuration))break;d.M[15](i.audio.backPacket+32,i.audio.oformatContext.streams[0].index),this.writeAVPacket(i.audio.backPacket,i.audio),i.audio.enableRawMpeg||y.bX(i.audio.oformatContext),i.audio.track.addBuffer(i.audio.bufferQueue.flush()),i.avpacketPool.release(i.audio.backPacket),i.audio.backPacket=0}if(i.video&&!i.video.packetEnded){if(i.video.backPacket=await this.pullAVPacket(i.video,i),i.video.backPacket<0&&(i.video.packetEnded=!0,i.video.backPacket=0,!i.audio||i.audio.packetEnded))break;if(!((0,I.Mr)(o.f[17](i.video.backPacket+8),i.video.backPacket+72,T.i0)<c+i.cacheDuration))break;d.M[15](i.video.backPacket+32,i.video.oformatContext.streams[0].index),this.writeAVPacket(i.video.backPacket,i.video),i.video.enableRawMpeg||y.bX(i.video.oformatContext),i.video.track.addBuffer(i.video.bufferQueue.flush()),i.avpacketPool.release(i.video.backPacket),i.video.backPacket=0}}const l=[];i.audio&&(i.audio.enableRawMpeg||y.bX(i.audio.oformatContext),l.push(new(s())((e=>{i.audio.track.addBuffer(i.audio.bufferQueue.flush(),(()=>{e()}))})))),i.video&&(i.video.enableRawMpeg||y.bX(i.video.oformatContext),l.push(new(s())((e=>{i.video.track.addBuffer(i.video.bufferQueue.flush(),(()=>{e()}))})))),await s().all(l),i.audio&&!i.audio.packetEnded&&(i.audio.backPacket<=0&&(i.audio.backPacket=await this.pullAVPacket(i.audio,i),i.audio.backPacket<0&&(i.audio.packetEnded=!0,i.audio.backPacket=0)),i.audio.packetEnded||(i.audio.frontPacket=await this.pullAVPacket(i.audio,i),i.audio.frontPacket<0?(i.audio.frontPacket=0,i.audio.packetEnded=!0,i.audio.frontBuffered=!1):(i.audio.packetEnded=!1,i.audio.frontBuffered=!0),i.audio.startTimestamp=BigInt(Math.floor((0,S.A)()))-(r+i.cacheDuration+(0,I.k)(i.audio.startPTS,i.audio.oformatContext.streams[0].timeBase,T.i0))*BigInt(100)/i.playRate,i.pausing?i.pauseTimestamp=(0,S.A)():i.audio.loop.start())),i.video&&!i.video.packetEnded&&(i.video.backPacket<=0&&(i.video.backPacket=await this.pullAVPacket(i.video,i),i.video.backPacket<0&&(i.video.packetEnded=!0,i.video.backPacket=0)),i.video.packetEnded||(i.video.frontPacket=await this.pullAVPacket(i.video,i),i.video.frontPacket<0?(i.video.packetEnded=!0,i.video.frontBuffered=!1,i.video.frontPacket=0):(i.video.packetEnded=!1,i.video.frontBuffered=!0),i.video.startTimestamp=BigInt(Math.floor((0,S.A)()))-(a+i.cacheDuration+(0,I.k)(i.video.startPTS,i.video.oformatContext.streams[0].timeBase,T.i0))*BigInt(100)/i.playRate,i.pausing?i.pauseTimestamp=(0,S.A)():i.video.loop.start())),await s().all([new(s())((e=>{i.audio?i.audio.track.insertEnqueueCallback(e):e()})),new(s())((e=>{i.video?i.video.track.insertEnqueueCallback(e):e()}))]);let h=0,u=0;i.audio?i.video?(h=Math.max(i.audio.track.getBufferedStart(),i.video.track.getBufferedStart()),u=Math.min(i.audio.track.getBufferedEnd(),i.video.track.getBufferedEnd())):(h=i.audio.track.getBufferedStart(),u=i.audio.track.getBufferedEnd()):i.video&&(h=i.video.track.getBufferedStart(),u=i.video.track.getBufferedEnd());let f=(0,D.yw)(c);return f>=h&&f<=u||(f=Math.abs(f-h)>Math.abs(f-u)?u:h),i.currentTimeNTP=(0,S.A)(),i.currentTime=f,i.seeking=!1,g.Yz(`after seek end, seekTime: ${f} taskId: ${e}`,H,1596),f}return 0}async setPlayRate(e,t){const i=this.tasks.get(e);if(i){if(i.enableJitterBuffer){let e=o.f[15](i.stats+244)?o.f[15](i.stats+32)/o.f[15](i.stats+244)*1e3:o.f[15](i.stats+232)?o.f[15](i.stats+120)/o.f[15](i.stats+232)*1e3:0;e&&e<=o.f[15](i.stats+280)&&(t=1)}i.targetRate=BigInt(Math.floor(Math.floor(100*t))),i.enableJitterBuffer||(i.audio&&i.audio.loop&&i.audio.loop.resetInterval(),i.video&&i.video.loop&&i.video.loop.resetInterval())}}async restart(e){const t=this.tasks.get(e);if(t){t.audio&&this.resetResource(t.audio,t),t.video&&this.resetResource(t.video,t);const e=new((0,$.A)());e.onsourceopen=this.getSourceOpenHandler(t),t.mediaSource=e}}async setCurrentTime(e,t){const i=this.tasks.get(e);i?(i.audio&&i.audio.track.removeBuffer(t),i.video&&o.f[15](i.stats+92)>0&&(i.video.track.setMediaBufferMax(Math.max(i.video.track.getMediaBufferMax(),Math.ceil(o.f[15](i.stats+92)/1e3*1.5),10)),i.video.track.removeBuffer(t)),i.currentTime=t,i.currentTimeNTP=(0,S.A)()):g.h2("task not found",H,1669)}async checkWaiting(e){let t=-1,i=-1;const r=e.currentTime+((0,S.A)()-e.currentTimeNTP)/1e3;if(e.audio){const i=e.audio.track.getSourceBuffer();i&&2===i.buffered.length&&i.buffered.end(1)-i.buffered.start(1)>=e.maxBuffer&&i.buffered.end(0)<r&&e.currentTime<i.buffered.start(1)&&(t=i.buffered.start(1))}if(e.video){const t=e.video.track.getSourceBuffer();t&&2===t.buffered.length&&t.buffered.end(1)-t.buffered.start(1)>=e.maxBuffer&&t.buffered.end(0)<r&&e.currentTime<t.buffered.start(1)&&(i=t.buffered.start(1))}if(e.audio&&e.video){if(t>0&&i>0){const r=Math.min(t,i);e.currentTime=r,e.controlIPCPort.notify("seek",{time:r})}}else t>0?(e.currentTime=t,e.controlIPCPort.notify("seek",{time:t})):i>0&&(e.currentTime=i,e.controlIPCPort.notify("seek",{time:i}))}async getMediaSource(e){const t=this.tasks.get(e);if(t)return t.mediaSource.handle?(this.getMediaSource.transfer.push(t.mediaSource.handle),t.mediaSource.handle):t.mediaSource;g.h2("task not found",H,1734)}createTask(e,t){const i=new m.Ay(e.controlPort),r=new((0,$.A)()),s={...e,mediaSource:r,audio:null,video:null,playRate:BigInt(100),targetRate:BigInt(100),pauseTimestamp:0,seeking:!1,pausing:!1,controlIPCPort:i,currentTime:0,currentTimeNTP:0,cacheDuration:BigInt(Math.floor(500)),avpacketPool:new k.A((0,l.A)(e.avpacketList,h.A),e.avpacketListMutex),maxBuffer:e.isLive?1:4,minBuffer:e.isLive?.5:2,visibilityHidden:!1,fakePlayTimer:null};return this.tasks.set(e.taskId,s),r.onsourceopen=this.getSourceOpenHandler(s,t),i.on(m.Wo,(t=>{"visibilitychange"===t.method&&this.setVisibilityHidden(e.taskId,t.params.visibilityHidden)})),0}async setVisibilityHidden(e,t){const i=this.tasks.get(e);i&&(i.visibilityHidden=t,t?i.isLive&&i.video&&!i.audio&&(i.fakePlayTimer&&i.fakePlayTimer.destroy(),i.fakePlayTimer=new G.A((()=>{this.setCurrentTime(i.taskId,i.currentTime+((0,S.A)()-i.currentTimeNTP)/1e3)}),0,1e3),i.fakePlayTimer.start()):i.fakePlayTimer&&(i.fakePlayTimer.destroy(),i.fakePlayTimer=null,i.video.track.getBufferedTime()>(i.isLive?2:4)&&(this.setCurrentTime(i.taskId,Math.max(i.video.track.getBufferedEnd()-(i.isLive?1:4),i.video.track.getBufferedStart())),i.controlIPCPort.notify("seek",{time:i.currentTime}))))}async registerTask(e,t=BigInt(0)){return this.tasks.has(e.taskId)?p.lh:this.createTask(e,t)}async unregisterTask(e){const t=this.tasks.get(e);t&&(t.audio&&(t.audio.loop&&(await t.audio.oformatContext.destroy(),t.audio.loop.destroy()),t.audio.pullIPC&&t.audio.pullIPC.destroy(),t.audio.pullQueue.queue.length&&(t.audio.pullQueue.queue.forEach((e=>{t.avpacketPool.release(e)})),t.audio.pullQueue.queue.length=0),t.audio.codecpar&&(0,b.dn)(t.audio.codecpar)),t.video&&(t.video.loop&&(await t.video.oformatContext.destroy(),t.video.loop.destroy()),t.video.pullIPC&&t.video.pullIPC.destroy(),t.video.pullQueue.queue.length&&(t.video.pullQueue.queue.forEach((e=>{t.avpacketPool.release(e)})),t.video.pullQueue.queue.length=0),t.video.codecpar&&(0,b.dn)(t.video.codecpar)),t.controlIPCPort&&t.controlIPCPort.destroy(),this.tasks.delete(e))}}},52277:(e,t,i)=>{"use strict";i.d(t,{M:()=>f});var r,s,a=i(134),n=i(80662),o=i.n(n),c=i(61499),l=i(12085),d=i(12264),h=i(73783),u=i(30128);class f{constructor(){(0,a.A)(this,"avpacketList",void 0),(0,a.A)(this,"avframeList",void 0),(0,a.A)(this,"avpacketListMutex",void 0),(0,a.A)(this,"avframeListMutex",void 0),(0,a.A)(this,"stats",void 0)}}r=f.prototype,(s=new(o())).set("avpacketList",{0:d.A,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("avframeList",{0:d.A,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),s.set("avpacketListMutex",{0:h.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),s.set("avframeListMutex",{0:h.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:28,8:0}),s.set("stats",{0:u.A,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),(0,l.A)(r,c.Og,!0),(0,l.A)(r,c.dc,8),(0,l.A)(r,c.g7,392),(0,l.A)(r,c.JY,s)},57038:(e,t,i)=>{"use strict";i.d(t,{A:()=>m});var r=i(134),s=i(77658),a=i(21194),n=i(77334),o=i(8284),c=i(65749),l=i(49963),d=i(78040),h=i(47924),u=i(95335);const f='.ASS-box{font-family:Arial;overflow:hidden;pointer-events:none;position:absolute}.ASS-dialogue{font-size:0;width:max-content;position:absolute;z-index:0;transform:translate(calc(var(--ass-align-h)*-1),calc(var(--ass-align-v)*-1));span{display:inline-block}[data-text]{display:inline-block;color:var(--ass-fill-color);font-size:calc(var(--ass-scale)*var(--ass-real-fs)*1px);line-height:calc(var(--ass-scale)*var(--ass-tag-fs)*1px);letter-spacing:calc(var(--ass-scale)*var(--ass-tag-fsp)*1px);filter:blur(calc(var(--ass-scale-stroke)*var(--ass-tag-blur)*(1-round(up,sin(var(--ass-tag-xbord))*sin(var(--ass-tag-xbord))))*(1-round(up,sin(var(--ass-tag-ybord))*sin(var(--ass-tag-ybord))))*1px))}[data-is="br"]+[data-is="br"]{height:calc(var(--ass-scale)*var(--ass-tag-fs)*1px/2)}}.ASS-dialogue[data-wrap-style="0"],.ASS-dialogue[data-wrap-style="3"]{text-wrap:balance;white-space:pre-wrap}.ASS-dialogue[data-wrap-style="1"]{word-break:break-word;white-space:pre-wrap}.ASS-dialogue[data-wrap-style="2"]{word-break:normal;white-space:pre}.ASS-dialogue[data-border-style="1"]{position:relative;&::before,&::after{content:attr(data-text);position:absolute;top:0;left:0;z-index:-1;filter:blur(calc(var(--ass-scale-stroke)*var(--ass-tag-blur)*1px))}&::before{color:var(--ass-shadow-color);-webkit-text-stroke:calc(var(--ass-scale-stroke)*var(--ass-border-width)*1px) var(--ass-shadow-color);transform:translate(calc(var(--ass-scale-stroke)*var(--ass-tag-xshad)*1px),calc(var(--ass-scale-stroke)*var(--ass-tag-yshad)*1px))}&::after{color:var(--ass-border-color);-webkit-text-stroke:calc(var(--ass-scale-stroke)*var(--ass-border-width)*1px) var(--ass-border-color)}&[data-stroke="svg"]{color:#000;&::before,&::after{opacity:0}}}@container style(--ass-tag-xbord:0) and style(--ass-tag-ybord:0){.ASS-dialogue[data-border-style="1"]::after{display:none}}@container style(--ass-tag-xshad:0) and style(--ass-tag-yshad:0){.ASS-dialogue[data-border-style="1"]::before{display:none}}.ASS-dialogue[data-border-style="3"]{padding:calc(var(--ass-scale-stroke)*var(--ass-tag-xbord)*1px)calc(var(--ass-scale-stroke)*var(--ass-tag-ybord)*1px);position:relative;filter:blur(calc(var(--ass-scale-stroke)*var(--ass-tag-blur)*1px));&::before,&::after{content:"";width:100%;height:100%;position:absolute;z-index:-1}&::before{background-color:var(--ass-shadow-color);left:calc(var(--ass-scale-stroke)*var(--ass-tag-xshad)*1px);top:calc(var(--ass-scale-stroke)*var(--ass-tag-yshad)*1px)}&::after{background-color:var(--ass-border-color);left:0;top:0}}@container style(--ass-tag-xbord:0) and style(--ass-tag-ybord:0){.ASS-dialogue [data-border-style="3"]::after{background-color:transparent}}@container style(--ass-tag-xshad:0) and style(--ass-tag-yshad:0){.ASS-dialogue [data-border-style="3"]::before{background-color:transparent}}.ASS-dialogue[data-rotate]{transform:perspective(312.5px) rotateY(calc(var(--ass-tag-fry) * 1deg)) rotateX(calc(var(--ass-tag-frx) * 1deg)) rotateZ(calc(var(--ass-tag-frz) * -1deg));&[data-text]{transform-style:preserve-3d;word-break:normal;white-space:nowrap}}.ASS-dialogue[data-scale],.ASS-dialogue[data-skew]{display:inline-block;transform:scale(var(--ass-tag-fscx), var(--ass-tag-fscy)) skew(calc(var(--ass-tag-fax)*1rad),calc(var(--ass-tag-fay) * 1rad));transform-origin:var(--ass-align-h) var(--ass-align-v)}.ASS-fix-font-size{font-family:Arial;line-height:normal;width:0;height:0;position:absolute;visibility:hidden;overflow:hidden;span{position:absolute}}.ASS-clip-area{width:100%;height:100%;position:absolute;top:0;left:0}.ASS-effect-area{position:absolute;display:flex;width:100%;height:fit-content;overflow:hidden;mask-composite:intersect;&[data-effect="banner"]{flex-direction:column;height:100%}.ASS-dialogue{position:static;transform:none}}',p={Name:"Default",Fontname:"Arial",Fontsize:"16",PrimaryColour:"&Hffffff",SecondaryColour:"&Hffffff",OutlineColour:"&H0",BackColour:"&H0",Bold:"0",Italic:"0",Underline:"0",StrikeOut:"0",ScaleX:"100",ScaleY:"100",Spacing:"0",Angle:"0",BorderStyle:"1",Outline:"1",Shadow:"0",Alignment:"2",MarginL:"10",MarginR:"10",MarginV:"10",Encoding:"0"};class m{constructor(e,t={container:e.parentNode}){if((0,r.A)(this,"store",void 0),(0,r.A)(this,"resampling_","video_height"),(0,r.A)(this,"resize_",void 0),(0,r.A)(this,"options",void 0),this.options=u.X$({},t),this.store={video:e,box:document.createElement("div"),svg:(0,n.An)("svg"),defs:(0,n.An)("defs"),observer:null,scale:1,width:0,height:0,scriptRes:{width:t.videoWidth||e.clientWidth,height:t.videoHeight||e.clientHeight},layoutRes:{width:t.videoWidth||e.clientWidth,height:t.videoHeight||e.clientHeight},resampledRes:{width:0,height:0},sbas:!0,styles:null,space:[],actives:[],delay:0,index:0,dialogues:[]},null==t.videoWidth&&(e.videoWidth=t.videoWidth),null==t.videoHeight&&(e.videoHeight=t.videoHeight),!t.container)throw new Error("Missing container.");this.resize_=(0,a.By)(this,this.store),this.updateHeader(t.header),s.Y&&t.container.append(s.Y);const{svg:i,defs:o,scriptRes:c,box:l}=this.store;i.setAttributeNS(null,"viewBox",`0 0 ${c.width} ${c.height}`),i.append(o),t.container.append(i),l.className="ASS-box",t.container.append(l),function(e){const t=e.getRootNode()||document;let i=t instanceof Document;!i&&"object"==typeof documentPictureInPicture&&documentPictureInPicture.window&&(i=t===documentPictureInPicture.window.document);const r=i?t.head:t;let s=r.querySelector("#ASS-global-style");s||(s=document.createElement("style"),s.type="text/css",s.id="ASS-global-style",s.append(document.createTextNode(f)),r.append(s)),document.head.querySelector("#ASS-global-style")||(s=document.createElement("style"),s.type="text/css",s.id="ASS-global-style",s.append(document.createTextNode(f)),document.head.append(s))}(t.container),this.resampling_=t.resampling||"video_height";const d=new ResizeObserver(this.resize.bind(this));return d.observe(e),this.store.observer=d,this}framing(e){const t=(0,h.U)(e,this.store);t.animations&&t.animations.forEach((e=>{e.currentTime=Number(this.store.video.currentTime)-1e3*t.start})),(0,n.MA)(t,"play"),t.__dialogue=e,this.store.actives.push(t)}updateHeader(e){if(e){const{info:t,width:i,height:r,styles:s}=(0,c.wE)(e,{defaultStyle:p});this.store.sbas=/yes/i.test(t.ScaledBorderAndShadow),this.store.layoutRes={width:+t.LayoutResX||this.options.videoWidth||this.store.video.clientWidth,height:+t.LayoutResY||this.options.videoHeight||this.store.video.clientHeight},this.store.scriptRes={width:i||this.store.layoutRes.width,height:r||this.store.layoutRes.height},this.store.styles=s}else this.store.styles=(0,d.W)({info:{WrapStyle:""},style:[],defaultStyle:p}),this.store.scriptRes={width:384,height:288};this.resize_(),this.options.header=e}updateVideoResolution(e,t){if(this.options.header){const{info:i,width:r,height:s}=(0,c.wE)(this.options.header,{defaultStyle:p});this.store.layoutRes={width:+i.LayoutResX||e||this.store.video.clientWidth,height:+i.LayoutResY||t||this.store.video.clientHeight},this.store.scriptRes={width:r||this.store.layoutRes.width,height:s||this.store.layoutRes.height}}else this.store.layoutRes={width:e,height:t}}render(e){if(1===e.type){var t;e.Start=Number(e.Start)/1e3,e.End=Number(e.End)/1e3;const i=(0,l.b)({styles:this.store.styles,dialogues:[e]})[0];u.X$(i,{effect:["banner","scroll up","scroll down"].includes(null===(t=i.effect)||void 0===t?void 0:t.name)?i.effect:null,d:`ASS-${(0,o.A)()}`,align:{h:(i.alignment+2)%3,v:Math.trunc((i.alignment-1)/3)}}),this.framing(i)}}clear(e){const t=Number(e)/1e3;for(let e=this.store.actives.length-1;e>=0;e-=1){const i=this.store.actives[e],{end:r}=i;r<t&&(i.$div.remove(),this.store.actives.splice(e,1))}}clearAll(){for(let e=this.store.actives.length-1;e>=0;e-=1)this.store.actives[e].$div.remove();this.store.actives.length=0,this.store.space.length=0}resize(){const e=this.store.actives.slice();this.resize_();for(let t=0;t<e.length;t++)this.framing(e[t].__dialogue)}destroy(){const{video:e,box:t,svg:i,observer:r}=this.store;return(0,a.IU)(this.store),s.Y&&s.Y.remove(),i.remove(),t.remove(),r.unobserve(e),this.store.styles={},this}show(){return this.store.box.style.visibility="visible",this}hide(){return this.store.box.style.visibility="hidden",this}get resampling(){return this.resampling_}set resampling(e){e!==this.resampling_&&/^(video|script)_(width|height)$/.test(e)&&(this.resampling_=e,this.resize())}}},40031:(e,t,i)=>{"use strict";i.d(t,{A:()=>I});var r=i(134),s=i(80662),a=i.n(s),n=i(12264),o=i(29170),c=i(63939),l=(i(9599),i(50932)),d=i(53616),h=i(84149),u=i(39148),f=i(4624),p=i(57038),m=i(50011),g=i(14686),v=i(51785),y=i(84290),A=i(44328),b=i(77231),w=i(95335),x=i(71517);const k="src/avplayer/subtitle/SubtitleRender.ts",T=[{reg:/<i>/g,value:"{\\i1}"},{reg:/<\/i>/g,value:"{\\i0}"},{reg:/<b>/g,value:"{\\b1}"},{reg:/<\/b>/g,value:"{\\b0}"},{reg:/<u>/g,value:"{\\u1}"},{reg:/<\/u>/g,value:"{\\u0}"},{reg:/{/g,value:"\\{"},{reg:/}/g,value:"\\}"},{reg:/&gt;/g,value:">"},{reg:/&lt;/g,value:"<"},{reg:/&lrm;/g,value:""},{reg:/&rlm;/g,value:""},{reg:/&amp;/g,value:"&"},{reg:/&nbsp;/g,value:"\\h"},{reg:/(<br\s*\/?>)|\n>/g,value:"\\N"}];class I{constructor(e){(0,r.A)(this,"decoder",void 0),(0,r.A)(this,"loop",void 0),(0,r.A)(this,"demuxer2SubtitleRenderChannels",void 0),(0,r.A)(this,"leftPorts",void 0),(0,r.A)(this,"currentPort",void 0),(0,r.A)(this,"render",void 0),(0,r.A)(this,"queue",void 0),(0,r.A)(this,"ended",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"pulling",void 0),(0,r.A)(this,"formats",void 0),(0,r.A)(this,"avpacketPool",void 0),(0,r.A)(this,"delay",void 0),(0,r.A)(this,"enable",void 0),this.options=w.X$({},e),this.ended=!1,this.pulling=!1,this.queue=[],this.delay=BigInt(0),this.demuxer2SubtitleRenderChannels=new(a()),this.leftPorts=new(a()),e.avpacketList&&(this.avpacketPool=new y.A((0,o.A)(e.avpacketList,n.A),e.avpacketListMutex)),this.createDecoder(),this.render=new p.A(this.options.dom,{header:this.getAssHeader(this.options.codecpar),container:this.options.container,videoWidth:this.options.videoWidth,videoHeight:this.options.videoHeight}),this.loop=new u.A((()=>{!this.queue.length&&this.ended&&this.loop.stop(),this.queue.length<6&&!this.ended&&this.pull();const e=this.options.getCurrentTime()-this.delay;for(this.render.clear(e);this.queue.length;){const t=this.queue[0];if(t.Start>e)break;t.End>e&&this.render.render(t),this.queue.shift()}}),0,50,!1)}getAssHeader(e){let t="";if(94230===c.f[15](e+4)&&c.f[15](e+16)){t=m.decode((0,g.s3)(c.f[20](e+12),c.f[15](e+16)));const i=t.split(/\r?\n/);let r=!1;for(let e=0;e<i.length;e++){const t=i[e].trim();"[Events]"===t&&(r=!0),/^Format:/.test(t)&&r&&(this.formats=v.Bp(t.trim()))}}return t}createDecoder(){this.decoder&&this.decoder.close(),this.decoder=new d.A({onReceiveSubtitle:e=>{for(let t=0;t<e.rects.length;t++){const i=e.rects[t];if(3===i.type){const t=v.wj(this.formats,i.text);null==t.Start&&(t.Start=e.pts),null==t.End&&(t.End=e.pts+e.duration),this.queue.push(t)}else 2===i.type?this.queue.push(this.webvtt2AssEvent(i.text,e.pts,e.pts+e.duration)):this.queue.push(this.text2AssEvent(i.text,e.pts,e.pts+e.duration))}}}),this.decoder.open(this.options.codecpar)}text2AssEvent(e,t,i){return{type:1,ReadOrder:0,Layer:0,Start:t,End:i,Style:"Default",Name:"",MarginL:0,MarginR:0,MarginV:0,Text:{raw:e,combined:e,parsed:[{tags:[],text:e,drawing:[]}]}}}webvtt2AssEvent(e,t,i){for(let t=0;t<T.length;t++)e=e.replace(T[t].reg,T[t].value);return this.text2AssEvent(e,t,i)}async pull(){if(this.pulling&&!this.ended)return;this.pulling=!0;const e=this.currentPort,t=await this.leftPorts.get(this.currentPort).request("pull");var i;if(-1048576===t)f.Yz("SubtitleRender end",k,290),null===(i=this.decoder)||void 0===i||i.flush(),this.ended=!0;else if(t<0)f.Yz(`SubtitleRender pull avpacket error, ret: ${t}`,k,295),this.ended=!0;else if(this.loop&&e===this.currentPort){l.M[17](t+8,(0,A.Mr)(c.f[17](t+8),t+72,b.i0)),l.M[17](t+48,(0,A.Mr)(c.f[17](t+48),t+72,b.i0));const e=this.decoder.decode(t);this.avpacketPool?this.avpacketPool.release(t):(0,x.Qe)(t),e<0&&(f.Yz(`SubtitleRender decode avpacket error, ret: ${t}`,k,309),this.ended=!0)}else this.avpacketPool?this.avpacketPool.release(t):(0,x.Qe)(t);this.pulling=!1}getDemuxerPort(e){if(this.demuxer2SubtitleRenderChannels.has(e))return this.demuxer2SubtitleRenderChannels.get(e).port1;const t=new MessageChannel,i=new h.Ay(t.port2);return this.demuxer2SubtitleRenderChannels.set(e,t),this.leftPorts.set(e,i),t.port1}start(){this.loop.isStarted()||this.loop.start(),this.ended=!1}stop(){this.loop.stop(),this.render.clearAll()}pause(){this.loop.stop()}reset(){this.queue.length=0,this.render.clearAll()}reopenDecoder(e){this.options.codecpar=e,this.createDecoder(),this.render.updateHeader(this.getAssHeader(e))}updateVideoResolution(e,t){e===this.options.videoWidth&&t===this.options.videoHeight||(this.render.updateVideoResolution(e,t),this.options.videoWidth=e,this.options.videoHeight=t)}setDemuxTask(e){this.currentPort!==e&&(this.pulling=!1),this.currentPort=e}destroy(){this.loop.destroy(),this.loop=null,this.leftPorts.clear(),this.demuxer2SubtitleRenderChannels.clear(),this.queue.length=0,this.render.destroy(),this.render=null,this.decoder.close(),this.decoder=null}setDelay(e){this.delay=e}getDelay(){return this.delay}}},27089:(e,t,i)=>{"use strict";i.d(t,{A:()=>w});var r=i(134),s=i(80662),a=i.n(s),n=i(61499),o=i(52277),c=i(74503),l=i(94300),d=i(67672),h=i(4624),u=i(18667),f=i(59377),p=i(56024),m=i(71517),g=i(73783),v=i(84149),y=i(54058),A=i(95335);const b="src/avplayer/worker/AudioPipeline.ts";class w{constructor(){(0,r.A)(this,"decoder",void 0),(0,r.A)(this,"render",void 0),(0,r.A)(this,"globalDataMap",void 0),(0,r.A)(this,"controlPort",void 0),(0,r.A)(this,"timer",void 0),this.decoder=new u.A,this.render=new f.A,this.globalDataMap=new(a())}createGlobalData(e){const t=(0,c.A)(o.M);return g.Ts(t[n.o9]+24),g.Ts(t[n.o9]+28),this.globalDataMap.set(e,t),t}releaseGlobalData(e){e.avframeList.clear((e=>{(0,p.to)(e)}),20),e.avpacketList.clear((e=>{(0,m.Up)(e)}),20),g.zr(e[n.o9]+24),g.zr(e[n.o9]+28),(0,l.A)(e)}async init(e){this.controlPort=new v.Ay(e);let t=0;this.timer=new y.A((()=>{t++;const e=[];this.globalDataMap.forEach(((i,r)=>{const s=i.stats;e.push({taskId:r,stats:{audioFrameDecodeCount:s.audioFrameDecodeCount,audioFrameDecodeIntervalMax:s.audioFrameDecodeIntervalMax,audioDecodeErrorPacketCount:s.audioDecodeErrorPacketCount,audioFrameRenderCount:s.audioFrameRenderCount,audioFrameRenderIntervalMax:s.audioFrameRenderIntervalMax,sampleRate:s.sampleRate,channels:s.channels,audioFrameSize:s.audioFrameSize,audioCurrentTime:s.audioCurrentTime}}),2===t&&(s.audioFrameDecodeIntervalMax=0,s.audioFrameRenderIntervalMax=0)})),this.controlPort.notify("stats",{data:e}),2===t&&(t=0)}),0,500),this.controlPort.on(v.Wo,(e=>{if("stats"===e.method){const t=e.params.data;for(let e=0;e<t.length;e++){const i=this.globalDataMap.get(t[e].taskId).stats;i&&(A.__(t[e].stats,((e,t)=>{i[t]=e})),i.jitterBuffer.min=t[e].jitterBuffer.min,i.jitterBuffer.max=t[e].jitterBuffer.max)}}})),this.timer.start()}async invoke(e,t,i){const r=this;function s(e,t,i){if("unregisterTask"===e){const e=r.globalDataMap.get(t[0]);e&&(r.releaseGlobalData(e),r.globalDataMap.delete(t[0]))}else if("clear"===e)r.globalDataMap.forEach((e=>{r.releaseGlobalData(e)})),r.globalDataMap.clear();else if("syncSeekTime"===e){const e=r.globalDataMap.get(t[0]);if(e)return e.stats.audioCurrentTime}return i}if("decoder"===e){if("registerTask"===t){const e=this.globalDataMap.get(i[0].taskId)||this.createGlobalData(i[0].taskId);i[0].stats=e[n.o9]+32,i[0].avpacketList=e[n.o9],i[0].avpacketListMutex=e[n.o9]+24,i[0].avframeList=e[n.o9]+12,i[0].avframeListMutex=e[n.o9]+28}if(d.Pc(this.decoder[t]))return this.decoder[t](...i).then((e=>s(t,i,e)));h.h2(`method ${t} not found`,b,179)}else{if("registerTask"===t){const e=this.globalDataMap.get(i[0].taskId)||this.createGlobalData(i[0].taskId);i[0].stats=e[n.o9]+32,i[0].avframeList=e[n.o9]+12,i[0].avframeListMutex=e[n.o9]+28}if(d.Pc(this.render[t]))return this.render[t](...i).then((e=>s(t,i,e)));h.h2(`method ${t} not found`,b,197)}}async setLogLevel(e){h.V$(e)}}},40097:(e,t,i)=>{"use strict";i.d(t,{A:()=>u});var r=i(134),s=i(80662),a=i.n(s),n=i(30128),o=i(29170),c=i(88506),l=i(27089),d=i(84149),h=i(95335);class u{constructor(){(0,r.A)(this,"thread",void 0),(0,r.A)(this,"controlMessageChannel",void 0),(0,r.A)(this,"controlPort",void 0),(0,r.A)(this,"statsMap",void 0),this.statsMap=new(a())}async run(){this.thread=await(0,c.pt)(l.A,{name:"AudioPipeline",dispatchToWorker:!0},27089).run(),this.controlMessageChannel=new MessageChannel,this.controlPort=new d.Ay(this.controlMessageChannel.port1),this.controlPort.on(d.Wo,(e=>{if("stats"===e.method){const t=e.params.data,i=[];for(let e=0;e<t.length;e++){const r=this.statsMap.get(t[e].taskId);r&&(h.__(t[e].stats,((e,t)=>{r[t]=e})),i.push({taskId:t[e].taskId,stats:{audioPacketQueueLength:r.audioPacketQueueLength,audioEncodeFramerate:r.audioEncodeFramerate,videoPacketQueueLength:r.videoPacketQueueLength},jitterBuffer:{min:r.jitterBuffer.min,max:r.jitterBuffer.max}}))}this.controlPort.notify("stats",{data:{stats:i}})}})),await this.thread.init.transfer(this.controlMessageChannel.port2).invoke(this.controlMessageChannel.port2)}async destroy(){await(0,c.nx)(this.thread),this.thread=null}setLogLevel(e){this.thread.setLogLevel(e)}transformResult(e,t,i){if("unregisterTask"===e)this.statsMap.delete(t[0]);else if("clear"===e)this.statsMap.clear();else if("registerTask"===e)this.statsMap.set(t[0].taskId,(0,o.A)(t[0].stats,n.A));else if("syncSeekTime"===e){const e=this.statsMap.get(t[0]);if(e)return void(e.audioCurrentTime=i)}return i}get AudioDecodePipeline(){const e=this;return new Proxy({},{get(t,i,r){if(t[i])return t[i];const s=async function(...t){return e.thread.invoke("decoder",i,t).then((r=>e.transformResult(i,t,r)))};return s.transfer=function(...t){return{invoke:async function(...r){return e.thread.invoke.transfer(...t).invoke("decoder",i,r).then((t=>e.transformResult(i,r,t)))}}},t[i]=s,t[i]}})}get AudioRenderPipeline(){const e=this;return new Proxy({},{get(t,i,r){if(t[i])return t[i];const s=async function(...t){return e.thread.invoke("render",i,t).then((r=>e.transformResult(i,t,r)))};return s.transfer=function(...t){return{invoke:async function(...r){return e.thread.invoke.transfer(...t).invoke("render",i,r).then((t=>e.transformResult(i,r,t)))}}},t[i]=s,t[i]}})}}},59016:(e,t,i)=>{"use strict";i.d(t,{A:()=>w});var r=i(134),s=i(80662),a=i.n(s),n=i(61499),o=i(52277),c=i(74503),l=i(94300),d=i(87243),h=i(72480),u=i(67672),f=i(4624),p=i(71762),m=i(56024),g=i(71517),v=i(73783),y=i(84149),A=i(54058);const b="src/avplayer/worker/IODemuxPipeline.ts";class w{constructor(){(0,r.A)(this,"ioThread",void 0),(0,r.A)(this,"demuxPipeline",void 0),(0,r.A)(this,"globalDataMap",void 0),(0,r.A)(this,"controlPort",void 0),(0,r.A)(this,"timer",void 0),this.ioThread=new d.A,this.demuxPipeline=new h.A,this.globalDataMap=new(a())}createGlobalData(e){const t=(0,c.A)(o.M);return v.Ts(t[n.o9]+24),v.Ts(t[n.o9]+28),this.globalDataMap.set(e,t),t}releaseGlobalData(e){e.avframeList.clear((e=>{(0,m.to)(e)}),20),e.avpacketList.clear((e=>{(0,g.Up)(e)}),20),v.zr(e[n.o9]+24),v.zr(e[n.o9]+28),(0,l.A)(e)}async init(e){this.controlPort=new y.Ay(e),this.timer=new A.A((()=>{const e=[];this.globalDataMap.forEach(((t,i)=>{const r=t.stats;e.push({taskId:i,stats:{bufferReceiveBytes:r.bufferReceiveBytes,audioPacketQueueLength:r.audioPacketQueueLength,videoPacketQueueLength:r.videoPacketQueueLength,audioPacketCount:r.audioPacketCount,audioPacketBytes:r.audioPacketBytes,audioEncodeFramerate:r.audioEncodeFramerate,videoPacketCount:r.videoPacketCount,videoPacketBytes:r.videoPacketBytes,keyFrameCount:r.keyFrameCount,gop:r.gop,keyFrameInterval:r.keyFrameInterval,videoEncodeFramerate:r.videoEncodeFramerate}})})),this.controlPort.notify("stats",{data:e})}),0,500),this.timer.start()}async invoke(e,t,i){const r=this;function s(e,t,i){if("unregisterTask"===e){const e=r.globalDataMap.get(t[0]);e&&(r.releaseGlobalData(e),r.globalDataMap.delete(t[0]))}else"clear"===e?(r.globalDataMap.forEach((e=>{r.releaseGlobalData(e)})),r.globalDataMap.clear()):"analyzeStreams"!==e||u.ai(i)||i.streams.forEach((e=>{e.codecpar=(0,p.Wu)(e.codecpar)}))}if("io"===e){if("registerTask"===t){const e=this.globalDataMap.get(i[0].taskId)||this.createGlobalData(i[0].taskId);i[0].stats=e[n.o9]+32}if(u.Pc(this.ioThread[t]))return this.ioThread[t](...i).then((e=>(s(t,i,e),e)));f.h2(`method ${t} not found`,b,150)}else{if("registerTask"===t){const e=this.globalDataMap.get(i[0].taskId)||this.createGlobalData(i[0].taskId);i[0].stats=e[n.o9]+32,i[0].avpacketList=e[n.o9],i[0].avpacketListMutex=e[n.o9]+24}if(u.Pc(this.demuxPipeline[t]))return this.demuxPipeline[t](...i).then((e=>(s(t,i,e),e)));f.h2(`method ${t} not found`,b,168)}}async setLogLevel(e){f.V$(e)}}},29998:(e,t,i)=>{"use strict";i.d(t,{A:()=>g});var r=i(134),s=i(80662),a=i.n(s),n=i(30128),o=i(29170),c=i(88506),l=i(59016),d=i(71762),h=i(67672),u=i(72703),f=i(71766),p=i(84149),m=i(95335);class g{constructor(){(0,r.A)(this,"thread",void 0),(0,r.A)(this,"codecparMap",void 0),(0,r.A)(this,"controlMessageChannel",void 0),(0,r.A)(this,"controlPort",void 0),(0,r.A)(this,"statsMap",void 0),this.codecparMap=new(a()),this.statsMap=new(a())}async run(){this.thread=await(0,c.pt)(l.A,{name:"IODemuxPipeline",dispatchToWorker:!0},59016).run(),this.controlMessageChannel=new MessageChannel,this.controlPort=new p.Ay(this.controlMessageChannel.port1),this.controlPort.on(p.Wo,(e=>{if("stats"===e.method){const t=e.params.data;for(let e=0;e<t.length;e++){const i=this.statsMap.get(t[e].taskId);i&&m.__(t[e].stats,((e,t)=>{i[t]=e}))}}})),await this.thread.init.transfer(this.controlMessageChannel.port2).invoke(this.controlMessageChannel.port2)}setLogLevel(e){this.thread.setLogLevel(e)}async destroy(){await(0,c.nx)(this.thread),this.thread=null}get IOPipeline(){const e=this;return new Proxy({},{get(t,i,r){if(t[i])return t[i];const s=async function(...t){return e.thread.invoke("io",i,t)};return s.transfer=function(...t){return{invoke:async function(...r){return e.thread.invoke.transfer(...t).invoke("io",i,r)}}},t[i]=s,t[i]}})}get DemuxPipeline(){const e=this;function t(t,i,r){if("analyzeStreams"!==t||h.ai(r))if("unregisterTask"===t){const t=e.codecparMap.get(i[0]);t&&(t.forEach((e=>{(0,f.dn)(e)})),e.codecparMap.delete(i[0])),e.statsMap.delete(i[0])}else"clear"===t?(e.codecparMap.forEach((e=>{e.forEach((e=>{(0,f.dn)(e)}))})),e.codecparMap.clear(),e.statsMap.clear()):"registerTask"===t&&e.statsMap.set(i[0].taskId,(0,o.A)(i[0].stats,n.A));else{const t=[];r.streams.forEach((r=>{(0,u.A)(r.codecpar)||(r.codecpar=(0,d.T8)(r.codecpar),t.push(r.codecpar)),e.codecparMap.set(i[0],t)}))}}return new Proxy({},{get(i,r,s){if(i[r])return i[r];const a=async function(...i){return e.thread.invoke("demux",r,i).then((e=>(t(r,i,e),e)))};return a.transfer=function(...i){return{invoke:async function(...s){return e.thread.invoke.transfer(...i).invoke("demux",r,s).then((e=>(t(r,s,e),e)))}}},i[r]=a,i[r]}})}}},75392:(e,t,i)=>{"use strict";i.d(t,{A:()=>A});var r=i(134),s=i(80662),a=i.n(s),n=i(61499),o=i(52277),c=i(74503),l=i(94300),d=i(67672),h=i(4624),u=i(56024),f=i(71517),p=i(73783),m=i(84149),g=i(54058),v=i(95335),y=i(25115);class A{constructor(){(0,r.A)(this,"mse",void 0),(0,r.A)(this,"globalDataMap",void 0),(0,r.A)(this,"controlPort",void 0),(0,r.A)(this,"timer",void 0),this.mse=new y.A,this.globalDataMap=new(a())}createGlobalData(e){const t=(0,c.A)(o.M);return p.Ts(t[n.o9]+24),p.Ts(t[n.o9]+28),this.globalDataMap.set(e,t),t}releaseGlobalData(e){e.avframeList.clear((e=>{(0,u.to)(e)}),20),e.avpacketList.clear((e=>{(0,f.Up)(e)}),20),p.zr(e[n.o9]+24),p.zr(e[n.o9]+28),(0,l.A)(e)}async init(e){this.controlPort=new m.Ay(e),this.timer=new g.A((()=>{const e=[];this.globalDataMap.forEach(((t,i)=>{const r=t.stats;e.push({taskId:i,stats:{audioFrameDecodeCount:r.audioFrameDecodeCount,audioFrameRenderCount:r.audioFrameRenderCount,sampleRate:r.sampleRate,channels:r.channels,videoFrameDecodeCount:r.videoFrameDecodeCount,videoFrameRenderCount:r.videoFrameRenderCount,width:r.width,height:r.height}})})),this.controlPort.notify("stats",{data:e})}),0,500),this.controlPort.on(m.Wo,(e=>{if("stats"===e.method){const t=e.params.data;for(let e=0;e<t.length;e++){const i=this.globalDataMap.get(t[e].taskId).stats;i&&(v.__(t[e].stats,((e,t)=>{i[t]=e})),i.jitterBuffer.min=t[e].jitterBuffer.min,i.jitterBuffer.max=t[e].jitterBuffer.max)}}})),this.timer.start()}async invoke(e,t){const i=this;if("registerTask"===e){const e=this.globalDataMap.get(t[0].taskId)||this.createGlobalData(t[0].taskId);t[0].stats=e[n.o9]+32,t[0].avpacketList=e[n.o9],t[0].avpacketListMutex=e[n.o9]+24}if(d.Pc(this.mse[e]))return this.mse[e].transfer||(this.mse[e].transfer=[]),this.mse[e](...t).then((r=>(this.mse[e].transfer.length&&(this.invoke.transfer=this.mse[e].transfer),r=function(e,t,r){if("unregisterTask"===e){const e=i.globalDataMap.get(t[0]);e&&(i.releaseGlobalData(e),i.globalDataMap.delete(t[0]))}else"clear"===e&&(i.globalDataMap.forEach((e=>{i.releaseGlobalData(e)})),i.globalDataMap.clear());return r}(e,t,r),r)));h.h2(`method ${e} not found`,"src/avplayer/worker/MSEPipeline.ts",162)}async setLogLevel(e){h.V$(e)}}},21862:(e,t,i)=>{"use strict";i.d(t,{A:()=>u});var r=i(134),s=i(80662),a=i.n(s),n=i(30128),o=i(29170),c=i(88506),l=i(84149),d=i(95335),h=i(75392);class u{constructor(){(0,r.A)(this,"thread",void 0),(0,r.A)(this,"controlMessageChannel",void 0),(0,r.A)(this,"controlPort",void 0),(0,r.A)(this,"statsMap",void 0),this.statsMap=new(a())}async run(){this.thread=await(0,c.pt)(h.A,{name:"MSEPipeline",dispatchToWorker:!0},75392).run(),this.controlMessageChannel=new MessageChannel,this.controlPort=new l.Ay(this.controlMessageChannel.port1),this.controlPort.on(l.Wo,(e=>{if("stats"===e.method){const t=e.params.data,i=[];for(let e=0;e<t.length;e++){const r=this.statsMap.get(t[e].taskId);r&&(d.__(t[e].stats,((e,t)=>{r[t]=e})),i.push({taskId:t[e].taskId,stats:{videoEncodeFramerate:r.videoEncodeFramerate,videoPacketQueueLength:r.videoPacketQueueLength,audioPacketQueueLength:r.audioPacketQueueLength,audioEncodeFramerate:r.audioEncodeFramerate},jitterBuffer:{min:r.jitterBuffer.min,max:r.jitterBuffer.max}}))}this.controlPort.notify("stats",{data:{stats:i}})}})),await this.thread.init.transfer(this.controlMessageChannel.port2).invoke(this.controlMessageChannel.port2)}setLogLevel(e){this.thread.setLogLevel(e)}async destroy(){await(0,c.nx)(this.thread),this.thread=null}transformResult(e,t,i){return"unregisterTask"===e?this.statsMap.delete(t[0]):"clear"===e?this.statsMap.clear():"registerTask"===e&&this.statsMap.set(t[0].taskId,(0,o.A)(t[0].stats,n.A)),i}get MSEPipeline(){const e=this;return new Proxy({},{get(t,i,r){if(t[i])return t[i];const s=async function(...t){return e.thread.invoke(i,t).then((r=>e.transformResult(i,t,r)))};return s.transfer=function(...t){return{invoke:async function(...r){return e.thread.invoke.transfer(...t).invoke(i,r).then((t=>e.transformResult(i,r,t)))}}},t[i]=s,t[i]}})}}},71272:(e,t,i)=>{"use strict";i.d(t,{A:()=>w});var r=i(134),s=i(80662),a=i.n(s),n=i(61499),o=i(52277),c=i(74503),l=i(94300),d=i(67672),h=i(4624),u=i(31138),f=i(33968),p=i(56024),m=i(71517),g=i(73783),v=i(84149),y=i(54058),A=i(95335);const b="src/avplayer/worker/VideoPipeline.ts";class w{constructor(){(0,r.A)(this,"decoder",void 0),(0,r.A)(this,"render",void 0),(0,r.A)(this,"globalDataMap",void 0),(0,r.A)(this,"controlPort",void 0),(0,r.A)(this,"timer",void 0),this.decoder=new u.A,this.render=new f.A,this.globalDataMap=new(a())}createGlobalData(e){const t=(0,c.A)(o.M);return g.Ts(t[n.o9]+24),g.Ts(t[n.o9]+28),this.globalDataMap.set(e,t),t}releaseGlobalData(e){e.avframeList.clear((e=>{(0,p.to)(e)}),20),e.avpacketList.clear((e=>{(0,m.Up)(e)}),20),g.zr(e[n.o9]+24),g.zr(e[n.o9]+28),(0,l.A)(e)}async init(e){this.controlPort=new v.Ay(e);let t=0;this.timer=new y.A((()=>{t++;const e=[];this.globalDataMap.forEach(((i,r)=>{const s=i.stats;e.push({taskId:r,stats:{videoFrameDecodeCount:s.videoFrameDecodeCount,videoFrameDecodeIntervalMax:s.videoFrameDecodeIntervalMax,videoDecodeErrorPacketCount:s.videoDecodeErrorPacketCount,videoCurrentTime:s.videoCurrentTime,videoFrameRenderCount:s.videoFrameRenderCount,videoFrameRenderIntervalMax:s.videoFrameRenderIntervalMax,videoFrameDropCount:s.videoFrameDropCount,width:s.width,height:s.height}}),2===t&&(s.videoFrameDecodeIntervalMax=0,s.videoFrameRenderIntervalMax=0)})),this.controlPort.notify("stats",{data:e}),2===t&&(t=0)}),0,500),this.controlPort.on(v.Wo,(e=>{if("stats"===e.method){const t=e.params.data;for(let e=0;e<t.length;e++){const i=this.globalDataMap.get(t[e].taskId).stats;i&&(A.__(t[e].stats,((e,t)=>{i[t]=e})),i.jitterBuffer.min=t[e].jitterBuffer.min,i.jitterBuffer.max=t[e].jitterBuffer.max)}}})),this.timer.start()}async invoke(e,t,i){const r=this;function s(e,t,i){if("unregisterTask"===e){const e=r.globalDataMap.get(t[0]);e&&(r.releaseGlobalData(e),r.globalDataMap.delete(t[0]))}else if("clear"===e)r.globalDataMap.forEach((e=>{r.releaseGlobalData(e)})),r.globalDataMap.clear();else if("syncSeekTime"===e){const e=r.globalDataMap.get(t[0]);if(e)return e.stats.videoCurrentTime}return i}if("decoder"===e){if("registerTask"===t){const e=this.globalDataMap.get(i[0].taskId)||this.createGlobalData(i[0].taskId);i[0].stats=e[n.o9]+32,i[0].avpacketList=e[n.o9],i[0].avpacketListMutex=e[n.o9]+24,i[0].avframeList=e[n.o9]+12,i[0].avframeListMutex=e[n.o9]+28}if(d.Pc(this.decoder[t]))return this.decoder[t](...i).then((e=>s(t,i,e)));h.h2(`method ${t} not found`,b,179)}else{if("registerTask"===t){const e=this.globalDataMap.get(i[0].taskId)||this.createGlobalData(i[0].taskId);i[0].stats=e[n.o9]+32,i[0].avframeList=e[n.o9]+12,i[0].avframeListMutex=e[n.o9]+28}if(d.Pc(this.render[t]))return this.render[t](...i).then((e=>s(t,i,e)));h.h2(`method ${t} not found`,b,197)}}async setLogLevel(e){h.V$(e)}}},21678:(e,t,i)=>{"use strict";i.d(t,{A:()=>u});var r=i(134),s=i(80662),a=i.n(s),n=i(30128),o=i(29170),c=i(88506),l=i(71272),d=i(84149),h=i(95335);class u{constructor(){(0,r.A)(this,"thread",void 0),(0,r.A)(this,"controlMessageChannel",void 0),(0,r.A)(this,"controlPort",void 0),(0,r.A)(this,"statsMap",void 0),this.statsMap=new(a())}async run(){this.thread=await(0,c.pt)(l.A,{name:"VideoPipeline",dispatchToWorker:!0},71272).run(),this.controlMessageChannel=new MessageChannel,this.controlPort=new d.Ay(this.controlMessageChannel.port1),this.controlPort.on(d.Wo,(e=>{if("stats"===e.method){const t=e.params.data,i=[];for(let e=0;e<t.length;e++){const r=this.statsMap.get(t[e].taskId);r&&(h.__(t[e].stats,((e,t)=>{r[t]=e})),i.push({taskId:t[e].taskId,stats:{videoEncodeFramerate:r.videoEncodeFramerate,videoPacketQueueLength:r.videoPacketQueueLength},jitterBuffer:{min:r.jitterBuffer.min,max:r.jitterBuffer.max}}))}this.controlPort.notify("stats",{data:{stats:i}})}})),await this.thread.init.transfer(this.controlMessageChannel.port2).invoke(this.controlMessageChannel.port2)}setLogLevel(e){this.thread.setLogLevel(e)}async destroy(){await(0,c.nx)(this.thread),this.thread=null}transformResult(e,t,i){if("unregisterTask"===e)this.statsMap.delete(t[0]);else if("clear"===e)this.statsMap.clear();else if("registerTask"===e)this.statsMap.set(t[0].taskId,(0,o.A)(t[0].stats,n.A));else if("syncSeekTime"===e){const e=this.statsMap.get(t[0]);if(e)return void(e.videoCurrentTime=i)}return i}get VideoDecodePipeline(){const e=this;return new Proxy({},{get(t,i,r){if(t[i])return t[i];const s=async function(...t){return e.thread.invoke("decoder",i,t).then((r=>e.transformResult(i,t,r)))};return s.transfer=function(...t){return{invoke:async function(...r){return e.thread.invoke.transfer(...t).invoke("decoder",i,r).then((t=>e.transformResult(i,r,t)))}}},t[i]=s,t[i]}})}get VideoRenderPipeline(){const e=this;return new Proxy({},{get(t,i,r){if(t[i])return t[i];const s=async function(...t){return e.thread.invoke("render",i,t).then((r=>e.transformResult(i,t,r)))};return s.transfer=function(...t){return{invoke:async function(...r){return e.thread.invoke.transfer(...t).invoke("render",i,r).then((t=>e.transformResult(i,r,t)))}}},t[i]=s,t[i]}})}}},88103:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(134),s=i(43356),a=i(4624);class n extends s.A{constructor(e,t){super(e,t),(0,r.A)(this,"context",void 0),(0,r.A)(this,"paddingLeft",void 0),(0,r.A)(this,"paddingTop",void 0),(0,r.A)(this,"flipX",void 0),(0,r.A)(this,"flipY",void 0),this.paddingLeft=0,this.paddingTop=0,this.flipX=1,this.flipY=1}async init(){if("rec2100-hlg"===this.options.colorSpace||"rec2100-pq"===this.options.colorSpace)try{this.context=this.canvas.getContext("2d",{colorSpace:this.options.colorSpace,pixelFormat:"float16"})}catch(e){a.R8("cannot got hdr context, video rendering colors may not be correct, please use the latest version of chrome then in chrome://flags, set: Experimental Web Platform features: Enabled","src/avrender/image/Canvas2dRender.ts",63)}this.context||(this.context=this.canvas.getContext("2d"))}clear(){const e=this.canvas.width>>1,t=this.canvas.height>>1;this.rotate&&(this.context.translate(e,t),this.context.rotate(-this.rotate*Math.PI/180),this.context.translate(-e,-t)),this.context.clearRect(0,0,this.canvasWidth*this.options.devicePixelRatio,this.canvasHeight*this.options.devicePixelRatio),this.rotate&&(this.context.translate(e,t),this.context.rotate(this.rotate*Math.PI/180),this.context.translate(-e,-t))}checkFrame(e){e.codedWidth===this.textureWidth&&e.codedHeight===this.videoHeight&&e.codedWidth===this.videoWidth||(this.videoWidth=e.codedWidth,this.videoHeight=e.codedHeight,this.textureWidth=e.codedWidth,this.layout())}render(e){this.lost||(this.checkFrame(e),this.context.drawImage(e,this.paddingLeft,this.paddingTop,this.canvasWidth*this.options.devicePixelRatio-2*this.paddingLeft,this.canvasHeight*this.options.devicePixelRatio-2*this.paddingTop))}layout(){let e=this.videoWidth,t=this.videoHeight,i=this.canvasWidth,r=this.canvasHeight;this.options.sar&&1!==this.options.sar&&(e=Math.floor(this.videoWidth*this.options.sar));let s=0,a=0;90!==this.rotate&&270!==this.rotate||(a=Math.floor((r-i)/2),s=Math.floor((i-r)/2),i=this.canvasHeight,r=this.canvasWidth);const n=e/i,o=t/r;let c;if(c=n>1?!(n<o):n>o,1===this.renderMode&&(c=!c),c){const n=(r-t*i/e)/r;this.paddingTop=(Math.floor(n/2*r)+a)*this.options.devicePixelRatio,this.paddingLeft=s*this.options.devicePixelRatio}else{const n=(i-e*r/t)/i;this.paddingLeft=(Math.floor(n/2*i)+s)*this.options.devicePixelRatio,this.paddingTop=a*this.options.devicePixelRatio}if(this.context){let e=1,t=1;this.flipHorizontal&&(e=-1),this.flipVertical&&(t=-1);const i=this.canvas.width>>1,r=this.canvas.height>>1;this.context.translate(i,r),e!==this.flipX&&this.context.scale(-1,1),t!==this.flipY&&this.context.scale(1,-1),this.context.translate(-i,-r),this.flipX=e,this.flipY=t}}setRotate(e,t=!0){if((e%=360)===this.rotate)return;const i=this.canvas.width>>1,r=this.canvas.height>>1;this.rotate&&(this.context.translate(i,r),this.context.rotate(-this.rotate*Math.PI/180),this.context.translate(-i,-r)),t&&this.clear(),this.rotate=e,this.context&&(this.context.translate(i,r),this.context.rotate(this.rotate*Math.PI/180),this.context.translate(-i,-r)),this.layout()}destroy(){this.context=null,super.destroy()}static isSupport(e){return e instanceof VideoFrame||e instanceof ImageBitmap}}},43356:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(134),s=i(6110);class a{constructor(e,t){(0,r.A)(this,"canvas",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"textureWidth",void 0),(0,r.A)(this,"videoWidth",void 0),(0,r.A)(this,"videoHeight",void 0),(0,r.A)(this,"canvasWidth",void 0),(0,r.A)(this,"canvasHeight",void 0),(0,r.A)(this,"rotate",void 0),(0,r.A)(this,"renderMode",void 0),(0,r.A)(this,"format",void 0),(0,r.A)(this,"lost",void 0),(0,r.A)(this,"destroyed",void 0),(0,r.A)(this,"srcColorSpace",void 0),(0,r.A)(this,"dstColorSpace",void 0),(0,r.A)(this,"flipHorizontal",void 0),(0,r.A)(this,"flipVertical",void 0),this.canvas=e,this.options=t,this.canvasWidth=e.width,this.canvasHeight=e.height,this.videoWidth=0,this.videoHeight=0,this.textureWidth=0,this.rotate=0,this.renderMode=t.renderMode,this.flipHorizontal=!1,this.flipVertical=!1,this.lost=!1,this.destroyed=!1,t.dstColorSpace?this.dstColorSpace=t.dstColorSpace:this.dstColorSpace=new s.A(1,1,1,1)}getRotateMatrix(e){e=Math.PI*e/180;const t=Math.sin(e),i=Math.cos(e);return[i,-t,0,0,t,i,0,0,0,0,1,0,0,0,0,1]}setRenderMode(e){this.renderMode!==e&&(this.renderMode=e,this.layout(),this.clear())}enableHorizontalFlip(e){this.flipHorizontal!==e&&(this.flipHorizontal=e,this.layout(),this.clear())}enableVerticalFlip(e){this.flipVertical!==e&&(this.flipVertical=e,this.layout(),this.clear())}viewport(e,t){if(this.canvasWidth!==e||this.canvasHeight!==t){const i=this.options.devicePixelRatio;this.canvasWidth=e,this.canvasHeight=t,this.canvas.width=e*i,this.canvas.height=t*i,this.videoWidth&&this.videoHeight&&this.layout()}}getVideoWidth(){return this.videoWidth}getVideoHeight(){return this.videoHeight}destroy(){this.canvas=null,this.destroyed=!0}setDstColorSpace(e){this.dstColorSpace=e}static isSupport(e){return!1}}},3016:(e,t,i)=>{"use strict";i.d(t,{A:()=>v});var r=i(134),s=i(20088),a=i(74503),n=i(63939),o=i(94300),c=i(14686),l=i(97317),d=i(10243),h=i(25669),u=i(57517),f=i(6110),p=i(56024),m=i(25408),g=i(72703);class v extends d.A{constructor(e,t){super(e,t),(0,r.A)(this,"linesize",void 0),(0,r.A)(this,"hdrMetadata",void 0),this.hdrMetadata=(0,a.A)(s.A),this.hdrMetadata.multiplier=1}async init(){if(await super.init(),!(this.gl instanceof WebGL2RenderingContext))throw new Error("not support webgl2")}generateVertexSource(){return"#version 300 es\n      precision highp float;\n      in vec3 point;\n      in vec4 color;\n      out vec4 v_color;\n      uniform mat4 rotateMatrix;\n      void main(void) {\n        gl_Position = rotateMatrix * vec4(point, 1.0);\n        v_color = color;\n      }\n    "}generateFragmentSource(e,t){t.outputRGB=!0;const i=(0,h.A)(this.srcColorSpace,this.dstColorSpace,t),r=["y","u","v","a"],s=["r","g","b","a"],a=[],n=[],o=[];e.comp.forEach(((e,t)=>{a[t]=e.depth+7>>>3,n[t]=e.shift,o[t]=(1<<e.depth)-1}));let c=`texture(${r[e.comp[0].plane]}_Sampler, v_color.xy).${s[e.comp[0].offset/a[0]]}`,l=e.comp[1]?`texture(${r[e.comp[1].plane]}_Sampler, v_color.xy).${s[e.comp[1].offset/a[1]]}`:32&e.flags?"0.0":"0.5",d=e.comp[2]?`texture(${r[e.comp[2].plane]}_Sampler, v_color.xy).${s[e.comp[2].offset/a[2]]}`:32&e.flags?"0.0":"0.5",u="1.0";function f(e){return/^texture/.test(e)}128&e.flags&&(u=`texture(${r[e.comp[e.comp.length-1].plane]}_Sampler, v_color.xy).${s[e.comp[e.comp.length-1].offset/a[e.comp.length-1]]}`,2===e.comp.length&&(l=32&e.flags?"0.0":"0.5")),this.fragmentSource=`#version 300 es\n      precision highp float;\n      precision highp usampler2D;\n      in vec4 v_color;\n      out vec4 outColor;\n      uniform usampler2D y_Sampler;\n      uniform usampler2D u_Sampler;\n      uniform usampler2D v_Sampler;\n      uniform usampler2D a_Sampler;\n      uniform float offset;\n      uniform float multiplier;\n      uniform float pq_tonemap_a;\n      uniform float pq_tonemap_b;\n      uniform float hlg_ootf_gamma_minus_one;\n      uniform float nits_to_sdr_relative_factor;\n      uniform float sdr_relative_to_nits_factor;\n      ${1&e.flags?"\n        uint swap(uint x) {\n          uint l = x & 0xFFu;\n          uint h = (x >> 8u) & 0xFFu;\n          return (l << 8u) | h;\n        }\n      ":""}\n      void main () {\n        float y = ${f(c)?`float(${1&e.flags?`swap(${c})`:c} >> ${n[0]}) / float(${o[0]})`:c};\n        float u = ${f(l)?`float(${1&e.flags?`swap(${l})`:l} >> ${n[1]}) / float(${o[1]})`:l};\n        float v = ${f(d)?`float(${1&e.flags?`swap(${d})`:d} >> ${n[2]}) / float(${o[2]})`:d};\n        float a = ${f(u)?`float(${1&e.flags?`swap(${u})`:u} >> ${n[e.comp.length-1]}) / float(${o[e.comp.length-1]})`:u};\n        vec4 color = vec4(y, u, v, a);\n        if (color.a > 0.0) {\n          color.r /= color.a;\n          color.g /= color.a;\n          color.b /= color.a;\n        }\n        color.r -= offset;\n        color.g -= offset;\n        color.b -= offset;\n        color.r *= multiplier;\n        color.g *= multiplier;\n        color.b *= multiplier;\n        ${i.reduce(((e,t)=>e+t),"")}\n        color.r *= color.a;\n        color.g *= color.a;\n        color.b *= color.a;\n        outColor = color;\n      }\n    `}checkFrame(e){if(n.f[15](e+32)!==this.linesize||n.f[15](e+72)!==this.videoHeight||n.f[15](e+68)!==this.videoWidth||n.f[15](e+80)!==this.format){const t=(0,l.I)(n.f[15](e+80));this.srcColorSpace=new f.A(n.f[15](e+220),n.f[15](e+212),n.f[15](e+216),n.f[15](e+208));const i={type:0,bitDepth:t.comp[0].depth,toneMapPQAndHlgToDst:!0,metadata:this.hdrMetadata,dstSdrMaxLuminanceNits:u.kH,dstMaxLuminanceRelative:1},r=(0,p.aH)(e,14);if(r){const e=n.f[20](r+4);n.f[8](e)>0&&(i.maxContentLightLevel=n.f[8](e))}if(this.generateFragmentSource(t,i),this.program=new m.A(this.fragmentSource,this.generateVertexSource()),this.useProgram(!0),this.program.setMetaData(this.hdrMetadata),this.yTexture.setFormat(this.gl.RED_INTEGER),this.yTexture.setInternalformat(this.gl.R16UI),this.yTexture.setDataType(this.gl.UNSIGNED_SHORT),this.uTexture.setFormat(this.gl.RED_INTEGER),this.uTexture.setInternalformat(this.gl.R16UI),this.uTexture.setDataType(this.gl.UNSIGNED_SHORT),this.vTexture.setFormat(this.gl.RED_INTEGER),this.vTexture.setInternalformat(this.gl.R16UI),this.vTexture.setDataType(this.gl.UNSIGNED_SHORT),this.aTexture.setFormat(this.gl.RED_INTEGER),this.aTexture.setInternalformat(this.gl.R16UI),this.aTexture.setDataType(this.gl.UNSIGNED_SHORT),16&t.flags){let i=0;if(this.yTexture.setSize(n.f[15](e+32+4*i++)>>>1,n.f[15](e+72)),t.comp.length>2){const r=t.comp[1].plane===t.comp[2].plane;this.uTexture.setSize(n.f[15](e+32+4*i++)>>>(r?2:1),n.f[15](e+72)>>>t.log2ChromaH),r||this.vTexture.setSize(n.f[15](e+32+4*i++)>>>1,n.f[15](e+72)>>>t.log2ChromaH),r&&(this.uTexture.setFormat(this.gl.RG_INTEGER),this.uTexture.setInternalformat(this.gl.RG16UI))}128&t.flags&&this.aTexture.setSize(n.f[15](e+32+4*i++)>>>1,n.f[15](e+72)),this.textureWidth=n.f[15](e+32)>>>1}else{const i=t.comp[0].depth+7>>>3;let r=t.comp[0].step/i;const s=[0,this.gl.RED_INTEGER,this.gl.RG_INTEGER,this.gl.RGB_INTEGER,this.gl.RGBA_INTEGER],a=[0,this.gl.R16UI,this.gl.RG16UI,this.gl.RGB16UI,this.gl.RGBA16UI];this.yTexture.setFormat(s[r]),this.yTexture.setInternalformat(a[r]),this.yTexture.setSize(n.f[15](e+32)/r>>>1,n.f[15](e+72)),this.textureWidth=n.f[15](e+32)/r>>>1}this.linesize=n.f[15](e+32),this.videoWidth=n.f[15](e+68),this.videoHeight=n.f[15](e+72),this.format=n.f[15](e+80),this.layout()}}render(e){if(this.lost)return;let t=(0,l.I)(n.f[15](e+80));if(!t)return;this.checkFrame(e);let i=0;this.yTexture.fill((0,c.bg)(n.f[20](e+4*i),(n.f[15](e+32+4*i++)>>>1)*this.yTexture.height)),16&t.flags&&(t.comp.length>2&&(this.uTexture.fill((0,c.bg)(n.f[20](e+4*i),(n.f[15](e+32+4*i++)>>>1)*this.uTexture.height)),t.comp[1].plane!==t.comp[2].plane&&this.vTexture.fill((0,c.bg)(n.f[20](e+4*i),(n.f[15](e+32+4*i++)>>>1)*this.vTexture.height))),128&t.flags&&this.aTexture.fill((0,c.bg)(n.f[20](e+4*i),(n.f[15](e+32+4*i++)>>>1)*this.aTexture.height))),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}destroy(){this.hdrMetadata&&((0,o.A)(this.hdrMetadata),this.hdrMetadata=null),super.destroy()}static isSupport(e){if((0,g.A)(e)){const t=(0,l.I)(n.f[15](e+80));if(t)return t.comp[0].depth+7>>>3==2}return!1}}},69047:(e,t,i)=>{"use strict";i.d(t,{A:()=>u});var r=i(134),s=i(63939),a=i(14686),n=i(97317),o=i(10243),c=i(18915),l=i(25669),d=i(6110),h=i(72703);class u extends o.A{constructor(e,t){super(e,t),(0,r.A)(this,"linesize",void 0)}async init(){await super.init()}generateFragmentSource(e){const t=(0,l.A)(this.srcColorSpace,this.dstColorSpace,{bitDepth:8,type:0,outputRGB:!0}),i=["y","u","v","a"],r=16&e.flags&&e.comp.length>2&&e.comp[1].plane===e.comp[2].plane?["r","a"]:["r","g","b","a"];let s=`texture2D(${i[e.comp[0].plane]}_Sampler, v_color.xy).${r[e.comp[0].offset]}`,a=e.comp[1]?`texture2D(${i[e.comp[1].plane]}_Sampler, v_color.xy).${r[e.comp[1].offset]}`:32&e.flags?"0.0":"0.5",n=e.comp[2]?`texture2D(${i[e.comp[2].plane]}_Sampler, v_color.xy).${r[e.comp[2].offset]}`:32&e.flags?"0.0":"0.5",o="1.0";128&e.flags&&(o=`texture2D(${i[e.comp[e.comp.length-1].plane]}_Sampler, v_color.xy).${r[e.comp[e.comp.length-1].offset]}`,2===e.comp.length&&(a=32&e.flags?"0.0":"0.5")),this.fragmentSource=`\n      precision highp float;\n      varying vec4 v_color;\n      uniform sampler2D y_Sampler;\n      uniform sampler2D u_Sampler;\n      uniform sampler2D v_Sampler;\n      uniform sampler2D a_Sampler;\n      void main () {\n        float y = ${s};\n        float u = ${a};\n        float v = ${n};\n        float alpha = ${o};\n        vec4 color = vec4(y, u, v, alpha);\n        ${t.reduce(((e,t)=>e+t),"")}\n        gl_FragColor = color;\n      }\n    `}checkFrame(e){if(s.f[15](e+32)!==this.linesize||s.f[15](e+72)!==this.videoHeight||s.f[15](e+68)!==this.videoWidth){const t=(0,n.I)(s.f[15](e+80));if(this.srcColorSpace=new d.A(s.f[15](e+220),s.f[15](e+212),s.f[15](e+216),s.f[15](e+208)),this.generateFragmentSource(t),this.program=new c.A(this.fragmentSource),this.useProgram(),16&t.flags){let i=0;if(this.yTexture.setSize(s.f[15](e+32+4*i++),s.f[15](e+72)),t.comp.length>2){const r=t.comp[1].plane===t.comp[2].plane;this.uTexture.setSize(s.f[15](e+32+4*i++)>>>(r?1:0),s.f[15](e+72)>>>t.log2ChromaH),r||this.vTexture.setSize(s.f[15](e+32+4*i++),s.f[15](e+72)>>>t.log2ChromaH),r&&(this.uTexture.setFormat(this.gl.LUMINANCE_ALPHA),this.uTexture.setInternalformat(this.gl.LUMINANCE_ALPHA))}128&t.flags&&this.aTexture.setSize(s.f[15](e+32+4*i++),s.f[15](e+72)),this.textureWidth=s.f[15](e+32)}else{const i=t.comp[0].depth+7>>>3;let r=t.comp[0].step/i;const a=[0,this.gl.LUMINANCE,this.gl.LUMINANCE_ALPHA,this.gl.RGB,this.gl.RGBA];this.yTexture.setFormat(a[r]),this.yTexture.setInternalformat(a[r]),this.yTexture.setSize(s.f[15](e+32)/r,s.f[15](e+72)),this.textureWidth=s.f[15](e+32)/r}this.linesize=s.f[15](e+32),this.videoWidth=s.f[15](e+68),this.videoHeight=s.f[15](e+72),this.format=s.f[15](e+80),this.layout()}}render(e){if(this.lost)return;let t=(0,n.I)(s.f[15](e+80));if(!t)return;this.checkFrame(e);let i=0;this.yTexture.fill((0,a.s3)(s.f[20](e+4*i),s.f[15](e+32+4*i++)*this.yTexture.height)),16&t.flags&&(t.comp.length>2&&(this.uTexture.fill((0,a.s3)(s.f[20](e+4*i),s.f[15](e+32+4*i++)*this.uTexture.height)),t.comp[1].plane!==t.comp[2].plane&&this.vTexture.fill((0,a.s3)(s.f[20](e+4*i),s.f[15](e+32+4*i++)*this.vTexture.height))),128&t.flags&&this.aTexture.fill((0,a.s3)(s.f[20](e+4*i),s.f[15](e+32+4*i)*this.aTexture.height))),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}static isSupport(e){if((0,h.A)(e)){const t=(0,n.I)(s.f[15](e+80));if(t)return t.comp[0].depth+7>>>3==1}return!1}}},10243:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(134),s=i(18105),a=i(94012);class n extends a.A{constructor(e,t){super(e,t),(0,r.A)(this,"yTexture",void 0),(0,r.A)(this,"uTexture",void 0),(0,r.A)(this,"vTexture",void 0),(0,r.A)(this,"aTexture",void 0)}useProgram(e=!1){super.useProgram(),this.yTexture=new s.A(this.gl),e&&this.yTexture.setFilter(this.gl.NEAREST),this.yTexture.bind(0),this.yTexture.init(),this.program.bindYTexture(0),this.uTexture=new s.A(this.gl),e&&this.uTexture.setFilter(this.gl.NEAREST),this.uTexture.bind(1),this.uTexture.init(),this.program.bindUTexture(1),this.vTexture=new s.A(this.gl),e&&this.vTexture.setFilter(this.gl.NEAREST),this.vTexture.bind(2),this.vTexture.init(),this.program.bindVTexture(2),this.aTexture=new s.A(this.gl),e&&this.aTexture.setFilter(this.gl.NEAREST),this.aTexture.bind(3),this.aTexture.init(),this.program.bindATexture(3)}destroy(){this.yTexture&&(this.yTexture.destroy(),this.yTexture=null),this.uTexture&&(this.uTexture.destroy(),this.uTexture=null),this.vTexture&&(this.vTexture.destroy(),this.vTexture=null),this.aTexture&&(this.aTexture.destroy(),this.aTexture=null),super.destroy()}}},94012:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(134),s=i(4624),a=i(43356),n=i(38469);const o="src/avrender/image/WebGLRender.ts";class c extends a.A{constructor(e,t){super(e,t),(0,r.A)(this,"gl",void 0),(0,r.A)(this,"vbo",void 0),(0,r.A)(this,"program",void 0),(0,r.A)(this,"vertex",void 0),(0,r.A)(this,"webglContextLostTimer",void 0),(0,r.A)(this,"onWebglContextLost",void 0),(0,r.A)(this,"onWebglContextRestored",void 0),(0,r.A)(this,"fragmentSource",void 0),(0,r.A)(this,"vertexSource",void 0)}async init(){this.gl=this.canvas.getContext("webgl2",{alpha:!1,antialias:!1,preserveDrawingBuffer:this.options.preserveDrawingBuffer}),this.gl||(this.gl=this.canvas.getContext("webgl",{alpha:!1,antialias:!1,preserveDrawingBuffer:this.options.preserveDrawingBuffer})),this.gl||(this.gl=this.canvas.getContext("experimental-webgl",{alpha:!1,antialias:!1,preserveDrawingBuffer:this.options.preserveDrawingBuffer})),this.gl||s.h2("can not support webgl, got WebGLRenderingContext failed",o,96),this.vbo=this.gl.createBuffer(),this.vbo||s.h2("create vao buffer failed",o,101),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.enable(this.gl.BLEND),this.gl.clearColor(0,0,0,0),this.gl.clearDepth(1),this.viewport(this.canvasWidth||this.canvas.width,this.canvasHeight||this.canvas.height),this.onWebglContextLost=e=>{this.destroyed||(this.webglContextLostTimer=setTimeout((()=>{this.lost=!0,this.webglContextLostTimer=null,s.z3("webgl context lost",o,118),this.options.onRenderContextLost&&this.options.onRenderContextLost()}),3e3))},this.onWebglContextRestored=e=>{this.webglContextLostTimer&&(clearTimeout(this.webglContextLostTimer),this.webglContextLostTimer=null)},this.canvas.addEventListener("webglcontextlost",this.onWebglContextLost),this.canvas.addEventListener("webglcontextrestored",this.onWebglContextRestored)}viewport(e,t){this.gl.viewport(0,0,e*this.options.devicePixelRatio,t*this.options.devicePixelRatio),super.viewport(e,t)}useProgram(){this.program.link(this.gl),this.program.bind(),this.program.setRotateMatrix(this.getRotateMatrix(this.rotate))}clear(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}layout(){let e=this.videoWidth,t=this.videoHeight,i=this.canvasWidth,r=this.canvasHeight,s=this.textureWidth;this.options.sar&&1!==this.options.sar&&(e=Math.floor(this.videoWidth*this.options.sar),s=Math.floor(this.textureWidth*this.options.sar)),90!==this.rotate&&270!==this.rotate||(i=this.canvasHeight,r=this.canvasWidth);const a=e/i,o=t/r;let c;c=a>1?!(a<o):a>o,1===this.renderMode&&(c=!c);let l=0;if(s!==e&&(l=(s-e)/s),c){const s=(r-t*i/e)/r;this.vertex=[-1,1-s,0,0,0,0,0,-1,-1+s,0,0,1,0,0,1,1-s,0,1-l,0,0,0,1,-1+s,0,1-l,1,0,0]}else{const s=(i-e*r/t)/i;this.vertex=[-1+s,1,0,0,0,0,0,-1+s,-1,0,0,1,0,0,1-s,1,0,1-l,0,0,0,1-s,-1,0,1-l,1,0,0]}(0,n.A)(this.vertex,this.flipHorizontal,this.flipVertical),this.gl&&this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.vertex),this.gl.STATIC_DRAW)}setRotate(e,t=!0){(e%=360)!==this.rotate&&(this.rotate=e,this.gl&&this.program.setRotateMatrix(this.getRotateMatrix(this.rotate)),this.layout(),t&&this.clear())}destroy(){this.vbo&&(this.gl.deleteBuffer(this.vbo),this.vbo=null),this.program&&this.program.stop(),this.gl=null,this.vertex=null,this.onWebglContextLost&&(this.canvas.removeEventListener("webglcontextlost",this.onWebglContextLost),this.onWebglContextLost=null),this.onWebglContextRestored&&(this.canvas.removeEventListener("webglcontextrestored",this.onWebglContextRestored),this.onWebglContextRestored=null),super.destroy()}}},87623:(e,t,i)=>{"use strict";i.d(t,{A:()=>y});var r=i(134),s=i(61499),a=i(20088),n=i(74503),o=i(63939),c=i(94300),l=i(54024),d=i(97317),h=i(14686),u=i(6110),f=i(57517),p=i(25669),m=i(56024),g=i(72703),v=i(11473);class y extends l.A{constructor(e,t){super(e,t),(0,r.A)(this,"linesize",void 0),(0,r.A)(this,"hdrMetadata",void 0),(0,r.A)(this,"hdrMetadataBuffer",void 0),this.hdrMetadata=(0,n.A)(a.A),this.hdrMetadata.multiplier=1}generateFragmentSource(e,t){t.outputRGB=!0;const i=(0,p.A)(this.srcColorSpace,this.dstColorSpace,t),r=["y","u","v","a"],s=["r","g","b","a"],a=[],n=[],o=[];e.comp.forEach(((e,t)=>{a[t]=e.depth+7>>>3,n[t]=e.shift,o[t]=(1<<e.depth)-1}));let c=`textureLoad(${r[e.comp[0].plane]}Texture,\n      vec2<i32>(coord.xy * vec2<f32>(\n        ${this[`${r[e.comp[0].plane]}Texture`].width}.0,\n        ${this[`${r[e.comp[0].plane]}Texture`].height}.0\n      )), 0).${s[e.comp[0].offset/a[0]]}`,l=e.comp[1]?`textureLoad(${r[e.comp[1].plane]}Texture,\n          vec2<i32>(coord.xy * vec2<f32>(\n            ${this[`${r[e.comp[1].plane]}Texture`].width}.0,\n            ${this[`${r[e.comp[1].plane]}Texture`].height}.0\n          )), 0).${s[e.comp[1].offset/a[1]]}`:32&e.flags?"0.0":"0.5",d=e.comp[2]?`textureLoad(${r[e.comp[2].plane]}Texture,\n          vec2<i32>(coord.xy * vec2<f32>(\n            ${this[`${r[e.comp[2].plane]}Texture`].width}.0,\n            ${this[`${r[e.comp[2].plane]}Texture`].height}.0\n          )), 0).${s[e.comp[2].offset/a[2]]}`:32&e.flags?"0.0":"0.5",h="1.0";function u(e){return/^textureLoad/.test(e)}128&e.flags&&(h=`textureLoad(${r[e.comp[e.comp.length-1].plane]}Texture,\n        vec2<i32>(coord.xy * vec2<f32>(\n          ${this[`${r[e.comp[e.comp.length-1].plane]}Texture`].width}.0,\n          ${this[`${r[e.comp[e.comp.length-1].plane]}Texture`].height}.0\n        )), 0).${s[e.comp[e.comp.length-1].offset/a[e.comp.length-1]]}`,2===e.comp.length&&(l=32&e.flags?"0.0":"0.5")),this.fragmentSource=`\n      struct HdrMetadata {\n        offset: f32,\n        multiplier: f32,\n        pqTonemapA: f32,\n        pqTonemapB: f32,\n        hlgOOTFGammaMinusOne: f32,\n        nitsToSdrRelativeFactor: f32,\n        sdrRelativeToNitsFactor: f32\n      };\n      @group(0) @binding(1) var<uniform> hdrMetadata: HdrMetadata;\n      @group(0) @binding(2) var yTexture: texture_2d<u32>;\n      ${this.uTexture?"@group(0) @binding(3) var uTexture: texture_2d<u32>;":""}\n      ${this.vTexture?"@group(0) @binding(4) var vTexture: texture_2d<u32>;":""}\n      ${this.aTexture?"@group(0) @binding(5) var aTexture: texture_2d<u32>;":""}\n      ${1&e.flags?"\n        fn swap(x: u32) -> u32 {\n          var low = x & 0xff;\n          var high = (x >> 8) & 0xff;\n          return (low << 8) | high;\n        }\n      ":""}\n      @fragment\n      fn main(@location(0) coord: vec4<f32>) -> @location(0) vec4<f32> {\n        let offset = hdrMetadata.offset;\n        let multiplier = hdrMetadata.multiplier;\n        let pq_tonemap_a = hdrMetadata.pqTonemapA;\n        let pq_tonemap_b = hdrMetadata.pqTonemapB;\n        let hlg_ootf_gamma_minus_one = hdrMetadata.hlgOOTFGammaMinusOne;\n        let nits_to_sdr_relative_factor = hdrMetadata.nitsToSdrRelativeFactor;\n        let sdr_relative_to_nits_factor = hdrMetadata.sdrRelativeToNitsFactor;\n        let y = ${u(c)?`f32(${1&e.flags?`swap(${c})`:c} >> ${n[0]}) / f32(${o[0]})`:c};\n        let u = ${u(l)?`f32(${1&e.flags?`swap(${l})`:l} >> ${n[1]}) / f32(${o[1]})`:l};\n        let v = ${u(d)?`f32(${1&e.flags?`swap(${d})`:d} >> ${n[2]}) / f32(${o[2]})`:d};\n        let a = ${u(h)?`f32(${1&e.flags?`swap(${h})`:h} >> ${n[e.comp.length-1]}) / f32(${o[e.comp.length-1]})`:h};\n        var color = vec4(y, u, v, a);\n        if (color.a > 0) {\n          color.r /= color.a;\n          color.g /= color.a;\n          color.b /= color.a;\n        }\n        color.r -= offset;\n        color.g -= offset;\n        color.b -= offset;\n        color.r *= multiplier;\n        color.g *= multiplier;\n        color.b *= multiplier;\n        ${i.reduce(((e,t)=>e+t),"")}\n        color.r *= color.a;\n        color.g *= color.a;\n        color.b *= color.a;\n        return color;\n      }\n    `}async init(){await super.init(),this.hdrMetadataBuffer=this.device.createBuffer({size:32,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})}generateBindGroup(){if(!this.yTexture)return;const e=[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}},{binding:2,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"uint"}}];this.uTexture&&e.push({binding:3,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"uint"}}),this.vTexture&&e.push({binding:4,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"uint"}}),this.aTexture&&e.push({binding:5,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"uint"}}),this.bindGroupLayout=this.device.createBindGroupLayout({entries:e});const t=[{binding:0,resource:{buffer:this.rotateMatrixBuffer,size:16*Float32Array.BYTES_PER_ELEMENT}},{binding:1,resource:{buffer:this.hdrMetadataBuffer,size:this.hdrMetadataBuffer.size}},{binding:2,resource:this.yTexture.createView()}];this.uTexture&&t.push({binding:3,resource:this.uTexture.createView()}),this.vTexture&&t.push({binding:4,resource:this.vTexture.createView()}),this.aTexture&&t.push({binding:5,resource:this.aTexture.createView()}),this.bindGroup=this.device.createBindGroup({layout:this.bindGroupLayout,entries:t})}checkFrame(e){if(o.f[15](e+32)!==this.linesize||o.f[15](e+72)!==this.videoHeight||o.f[15](e+68)!==this.videoWidth||o.f[15](e+80)!==this.format){const t=(0,d.I)(o.f[15](e+80));if(this.yTexture&&(this.yTexture.destroy(),this.yTexture=null),this.uTexture&&(this.uTexture.destroy(),this.uTexture=null),this.vTexture&&(this.vTexture.destroy(),this.vTexture=null),this.aTexture&&(this.aTexture.destroy(),this.aTexture=null),16&t.flags){let i=0;if(this.yTexture=this.device.createTexture({size:[o.f[15](e+32+4*i++)>>>1,o.f[15](e+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_DST,format:"r16uint"}),t.comp.length>2){const r=t.comp[1].plane===t.comp[2].plane;this.uTexture=this.device.createTexture({size:[o.f[15](e+32+4*i++)>>>(r?2:1),o.f[15](e+72)>>>t.log2ChromaH],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_DST,format:r?"rg16uint":"r16uint"}),r||(this.vTexture=this.device.createTexture({size:[o.f[15](e+32+4*i++)>>>1,o.f[15](e+72)>>>t.log2ChromaH],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_DST,format:"r16uint"}))}128&t.flags&&(this.aTexture=this.device.createTexture({size:[o.f[15](e+32+4*i++)>>>1,o.f[15](e+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_DST,format:"r16uint"})),this.textureWidth=o.f[15](e+32)>>>1}else{const i=t.comp[0].depth+7>>>3;let r=t.comp[0].step/i;const s=["","r16uint","rg16uint","","rgba16uint"];this.yTexture=this.device.createTexture({size:[o.f[15](e+32)/r>>>1,o.f[15](e+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_DST,format:s[r]}),this.textureWidth=o.f[15](e+32)/r>>>1}this.linesize=o.f[15](e+32),this.srcColorSpace=new u.A(o.f[15](e+220),o.f[15](e+212),o.f[15](e+216),o.f[15](e+208)),this.videoWidth=o.f[15](e+68),this.videoHeight=o.f[15](e+72),this.format=o.f[15](e+80);const i={type:1,bitDepth:t.comp[0].depth,toneMapPQAndHlgToDst:!0,metadata:this.hdrMetadata,dstSdrMaxLuminanceNits:f.kH,dstMaxLuminanceRelative:1},r=(0,m.aH)(e,14);if(r){const e=o.f[20](r+4);o.f[8](e)>0&&(i.maxContentLightLevel=o.f[8](e))}this.generateFragmentSource(t,i),this.layout(),this.generatePipeline(),this.generateRenderBundleEncoder();const a=(0,h.s3)(this.hdrMetadata[s.o9],28).slice();this.device.queue.writeBuffer(this.hdrMetadataBuffer,0,a.buffer,a.byteOffset,a.byteLength)}}render(e){if(this.lost)return;let t=(0,d.I)(o.f[15](e+80));if(!t)return;this.checkFrame(e);const i=this.device.createCommandEncoder();let r=0;this.device.queue.writeTexture({texture:this.yTexture},(0,v.Lv)(),{offset:o.f[20](e+4*r),bytesPerRow:o.f[15](e+32+4*r++),rowsPerImage:this.yTexture.height},{width:this.yTexture.width,height:this.yTexture.height,depthOrArrayLayers:1}),16&t.flags&&(this.uTexture&&this.device.queue.writeTexture({texture:this.uTexture},(0,v.Lv)(),{offset:o.f[20](e+4*r),bytesPerRow:o.f[15](e+32+4*r++),rowsPerImage:this.uTexture.height},{width:this.uTexture.width,height:this.uTexture.height,depthOrArrayLayers:1}),this.vTexture&&this.device.queue.writeTexture({texture:this.vTexture},(0,v.Lv)(),{offset:o.f[20](e+4*r),bytesPerRow:o.f[15](e+32+4*r++),rowsPerImage:this.vTexture.height},{width:this.vTexture.width,height:this.vTexture.height,depthOrArrayLayers:1}),this.aTexture&&this.device.queue.writeTexture({texture:this.aTexture},(0,v.Lv)(),{offset:o.f[20](e+4*r),bytesPerRow:o.f[15](e+32+4*r++),rowsPerImage:this.aTexture.height},{width:this.aTexture.width,height:this.aTexture.height,depthOrArrayLayers:1}));const s=i.beginRenderPass({colorAttachments:[{view:this.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]});s.executeBundles([this.renderBundle]),s.end(),this.device.queue.submit([i.finish()])}destroy(){this.hdrMetadata&&((0,c.A)(this.hdrMetadata),this.hdrMetadata=null),this.hdrMetadataBuffer&&(this.hdrMetadataBuffer.destroy(),this.hdrMetadataBuffer=null),super.destroy()}static isSupport(e){if((0,g.A)(e)){const t=(0,d.I)(o.f[15](e+80));if(t){const e=t.comp[0].depth+7>>>3;if(2!==e)return!1;let i=t.comp[0].step/e;return!!(16&t.flags||3!==i)}}return!1}}},38222:(e,t,i)=>{"use strict";i.d(t,{A:()=>h});var r=i(134),s=i(63939),a=i(54024),n=i(97317),o=i(6110),c=i(25669),l=i(72703),d=i(11473);class h extends a.A{constructor(e,t){super(e,t),(0,r.A)(this,"linesize",void 0)}async init(){await super.init()}generateFragmentSource(e){const t=(0,c.A)(this.srcColorSpace,this.dstColorSpace,{bitDepth:8,type:1,outputRGB:!0}),i=["y","u","v","a"],r=["r","g","b","a"];let s=`textureSample(${i[e.comp[0].plane]}Texture, s, in_texcoord.xy).${r[e.comp[0].offset]}`,a=e.comp[1]?`textureSample(${i[e.comp[1].plane]}Texture, s, in_texcoord.xy).${r[e.comp[1].offset]}`:32&e.flags?"0.0":"0.5",n=e.comp[2]?`textureSample(${i[e.comp[2].plane]}Texture, s, in_texcoord.xy).${r[e.comp[2].offset]}`:32&e.flags?"0.0":"0.5",o="1.0";128&e.flags&&(o=`textureSample(${i[e.comp[e.comp.length-1].plane]}Texture, s, in_texcoord.xy).${r[e.comp[e.comp.length-1].offset]}`,2===e.comp.length&&(a=32&e.flags?"0.0":"0.5")),this.fragmentSource=`\n      @group(0) @binding(1) var s: sampler;\n      @group(0) @binding(2) var yTexture: texture_2d<f32>;\n      ${this.uTexture?"@group(0) @binding(3) var uTexture: texture_2d<f32>;":""}\n      ${this.vTexture?"@group(0) @binding(4) var vTexture: texture_2d<f32>;":""}\n      ${this.aTexture?"@group(0) @binding(5) var aTexture: texture_2d<f32>;":""}\n      \n      @fragment\n      fn main(@location(0) in_texcoord: vec4<f32>) -> @location(0) vec4<f32> {\n        let y = ${s};\n        let u = ${a};\n        let v = ${n};\n        let alpha = ${o};\n        var color = vec4(y, u, v, alpha);\n        ${t.reduce(((e,t)=>e+t),"")}\n        return color;\n      }\n    `}checkFrame(e){if(s.f[15](e+32)!==this.linesize||s.f[15](e+72)!==this.videoHeight||s.f[15](e+68)!==this.videoWidth){const t=(0,n.I)(s.f[15](e+80));if(this.yTexture&&(this.yTexture.destroy(),this.yTexture=null),this.uTexture&&(this.uTexture.destroy(),this.uTexture=null),this.vTexture&&(this.vTexture.destroy(),this.vTexture=null),this.aTexture&&(this.aTexture.destroy(),this.aTexture=null),16&t.flags){let i=0;if(this.yTexture=this.device.createTexture({size:[s.f[15](e+32+4*i++),s.f[15](e+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:"r8unorm"}),t.comp.length>2){const r=t.comp[1].plane===t.comp[2].plane;this.uTexture=this.device.createTexture({size:[s.f[15](e+32+4*i++)>>>(r?1:0),s.f[15](e+72)>>>t.log2ChromaH],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:r?"rg8unorm":"r8unorm"}),r||(this.vTexture=this.device.createTexture({size:[s.f[15](e+32+4*i++),s.f[15](e+72)>>>t.log2ChromaH],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:"r8unorm"}))}128&t.flags&&(this.aTexture=this.device.createTexture({size:[s.f[15](e+32+4*i++),s.f[15](e+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:"r8unorm"})),this.textureWidth=s.f[15](e+32)}else{const i=t.comp[0].depth+7>>>3;let r=t.comp[0].step/i;const a=["","r8unorm","rg8unorm","","rgba8unorm"];this.yTexture=this.device.createTexture({size:[s.f[15](e+32)/r,s.f[15](e+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:a[r]}),this.textureWidth=s.f[15](e+32)/r}this.linesize=s.f[15](e+32),this.srcColorSpace=new o.A(s.f[15](e+220),s.f[15](e+212),s.f[15](e+216),s.f[15](e+208)),this.generateFragmentSource(t),this.videoWidth=s.f[15](e+68),this.videoHeight=s.f[15](e+72),this.format=s.f[15](e+80),this.layout(),this.generatePipeline(),this.generateRenderBundleEncoder()}}render(e){if(this.lost)return;let t=(0,n.I)(s.f[15](e+80));if(!t)return;this.checkFrame(e);let i=0;this.device.queue.writeTexture({texture:this.yTexture},(0,d.Lv)(),{offset:s.f[20](e+4*i),bytesPerRow:s.f[15](e+32+4*i++),rowsPerImage:this.yTexture.height},{width:this.yTexture.width,height:this.yTexture.height,depthOrArrayLayers:1}),16&t.flags&&(this.device.queue.writeTexture({texture:this.uTexture},(0,d.Lv)(),{offset:s.f[20](e+4*i),bytesPerRow:s.f[15](e+32+4*i++),rowsPerImage:this.uTexture.height},{width:this.uTexture.width,height:this.uTexture.height,depthOrArrayLayers:1}),this.vTexture&&this.device.queue.writeTexture({texture:this.vTexture},(0,d.Lv)(),{offset:s.f[20](e+4*i),bytesPerRow:s.f[15](e+32+4*i++),rowsPerImage:this.vTexture.height},{width:this.vTexture.width,height:this.vTexture.height,depthOrArrayLayers:1}),this.aTexture&&this.device.queue.writeTexture({texture:this.aTexture},(0,d.Lv)(),{offset:s.f[20](e+4*i),bytesPerRow:s.f[15](e+32+4*i),rowsPerImage:this.aTexture.height},{width:this.aTexture.width,height:this.aTexture.height,depthOrArrayLayers:1}));const r=this.device.createCommandEncoder(),a=r.beginRenderPass({colorAttachments:[{view:this.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]});a.executeBundles([this.renderBundle]),a.end(),this.device.queue.submit([r.finish()])}static isSupport(e){if((0,l.A)(e)){const t=(0,n.I)(s.f[15](e+80));if(t){const e=t.comp[0].depth+7>>>3;if(1!==e)return!1;let i=t.comp[0].step/e;return!!(16&t.flags||3!==i)}}return!1}}},54024:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(134),s=i(54895),a=i(15045);class n extends a.A{constructor(e,t){super(e,t),(0,r.A)(this,"yTexture",void 0),(0,r.A)(this,"uTexture",void 0),(0,r.A)(this,"vTexture",void 0),(0,r.A)(this,"aTexture",void 0),this.vertexSource=s.A}generateBindGroup(){if(!this.yTexture)return;const e=[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}},{binding:2,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}];this.uTexture&&e.push({binding:3,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}),this.vTexture&&e.push({binding:4,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}),this.aTexture&&e.push({binding:5,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}),this.bindGroupLayout=this.device.createBindGroupLayout({entries:e});const t=[{binding:0,resource:{buffer:this.rotateMatrixBuffer,size:16*Float32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.sampler},{binding:2,resource:this.yTexture.createView()}];this.uTexture&&t.push({binding:3,resource:this.uTexture.createView()}),this.vTexture&&t.push({binding:4,resource:this.vTexture.createView()}),this.aTexture&&t.push({binding:5,resource:this.aTexture.createView()}),this.bindGroup=this.device.createBindGroup({layout:this.bindGroupLayout,entries:t})}destroy(){this.yTexture&&this.yTexture.destroy(),this.uTexture&&this.uTexture.destroy(),this.vTexture&&this.vTexture.destroy(),this.aTexture&&this.aTexture.destroy(),super.destroy()}}},54750:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(54895),s=i(23195),a=i(15045);const n=["bt2020","bt2100","st2048","p3-dcl","hlg"];class o extends a.A{constructor(e,t){super(e,t),this.vertexSource=r.A,this.fragmentSource=s.A}checkFrame(e){e.codedWidth===this.textureWidth&&e.codedHeight===this.videoHeight&&e.codedWidth===this.videoWidth||(this.videoWidth=e.codedWidth,this.videoHeight=e.codedHeight,this.textureWidth=e.codedWidth,this.layout(),this.generatePipeline())}generateBindGroup(){this.bindGroupLayout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,externalTexture:{}},{binding:2,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}}]})}render(e){if(this.lost)return;this.checkFrame(e);const t=this.device.createBindGroup({layout:this.renderPipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.rotateMatrixBuffer,size:16*Float32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.device.importExternalTexture({source:e})},{binding:2,resource:this.sampler}]}),i=this.device.createCommandEncoder(),r={colorAttachments:[{view:this.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]},s=i.beginRenderPass(r);s.setPipeline(this.renderPipeline),s.setBindGroup(0,t),s.setVertexBuffer(0,this.vbo),s.draw(4,4,0,0),s.end(),this.device.queue.submit([i.finish()])}static isSupport(e){return e instanceof VideoFrame&&!n.some((t=>t===e.colorSpace.primaries))}}},15045:(e,t,i)=>{"use strict";i.d(t,{A:()=>l});var r=i(134),s=i(4624),a=i(43356),n=i(72739),o=i(38469);const c="src/avrender/image/WebGPURender.ts";class l extends a.A{constructor(e,t){super(e,t),(0,r.A)(this,"adapter",void 0),(0,r.A)(this,"device",void 0),(0,r.A)(this,"context",void 0),(0,r.A)(this,"vsModule",void 0),(0,r.A)(this,"fsModule",void 0),(0,r.A)(this,"rotateMatrixBuffer",void 0),(0,r.A)(this,"renderPipeline",void 0),(0,r.A)(this,"rotateMatrix",void 0),(0,r.A)(this,"vbo",void 0),(0,r.A)(this,"sampler",void 0),(0,r.A)(this,"vertex",void 0),(0,r.A)(this,"fragmentSource",void 0),(0,r.A)(this,"vertexSource",void 0),(0,r.A)(this,"renderBundleEncoder",void 0),(0,r.A)(this,"renderBundle",void 0),(0,r.A)(this,"bindGroupLayout",void 0),(0,r.A)(this,"bindGroup",void 0),(0,r.A)(this,"pipelineLayout",void 0)}async init(e){var t;this.adapter=await navigator.gpu.requestAdapter({powerPreference:null!==(t=this.options.powerPreference)&&void 0!==t?t:"high-performance"}),this.adapter||s.h2("not support webgpu render",c,86);const i=[];n.__(e,(e=>{this.adapter.features.has(e)&&i.push(e)})),this.device=await this.adapter.requestDevice({requiredFeatures:i.length?i:void 0}),this.device.lost.then((()=>{var e;this.destroyed||(this.lost=!0,s.z3("gpu device lost",c,105),null!==(e=this.options)&&void 0!==e&&e.onRenderContextLost&&this.options.onRenderContextLost())})),this.context=this.canvas.getContext("webgpu"),this.context||s.h2("can not support webgpu, got GPUCanvasContext failed",c,114),this.context.configure({device:this.device,format:navigator.gpu.getPreferredCanvasFormat(),alphaMode:"premultiplied"}),this.sampler=this.device.createSampler({magFilter:"linear",minFilter:"linear"}),this.vbo=this.device.createBuffer({size:28*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST}),this.rotateMatrixBuffer=this.device.createBuffer({size:16*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.setRotateMatrix(this.getRotateMatrix(0))}generatePipeline(){this.generateBindGroup(),this.pipelineLayout=this.device.createPipelineLayout({bindGroupLayouts:[this.bindGroupLayout]}),this.vsModule=this.device.createShaderModule({code:this.vertexSource}),this.fsModule=this.device.createShaderModule({code:this.fragmentSource}),this.renderPipeline=this.device.createRenderPipeline({layout:this.pipelineLayout,vertex:{module:this.vsModule,entryPoint:"main",buffers:[{arrayStride:28,attributes:[{shaderLocation:0,offset:0,format:"float32x3"},{shaderLocation:1,offset:12,format:"float32x4"}]}]},fragment:{module:this.fsModule,entryPoint:"main",targets:[{format:navigator.gpu.getPreferredCanvasFormat()}]},primitive:{topology:"triangle-strip"}})}generateRenderBundleEncoder(){this.renderPipeline&&(this.renderBundleEncoder=this.device.createRenderBundleEncoder({colorFormats:[navigator.gpu.getPreferredCanvasFormat()]}),this.renderBundleEncoder.setPipeline(this.renderPipeline),this.renderBundleEncoder.setBindGroup(0,this.bindGroup),this.renderBundleEncoder.setVertexBuffer(0,this.vbo),this.renderBundleEncoder.draw(4,4,0,0),this.renderBundle=this.renderBundleEncoder.finish())}setRotateMatrix(e){this.rotateMatrix=e;const t=new Float32Array(this.rotateMatrix);this.device.queue.writeBuffer(this.rotateMatrixBuffer,0,t.buffer,t.byteOffset,t.byteLength)}setVertices(){const e=new Float32Array(this.vertex);this.device.queue.writeBuffer(this.vbo,0,e.buffer,e.byteOffset,e.byteLength)}clear(){this.context.getCurrentTexture().destroy()}layout(){let e=this.videoWidth,t=this.videoHeight,i=this.canvasWidth,r=this.canvasHeight,s=this.textureWidth;this.options.sar&&1!==this.options.sar&&(e=Math.floor(this.videoWidth*this.options.sar),s=Math.floor(this.textureWidth*this.options.sar)),90!==this.rotate&&270!==this.rotate||(i=this.canvasHeight,r=this.canvasWidth);const a=e/i,n=t/r;let c;c=a>1?!(a<n):a>n,1===this.renderMode&&(c=!c);let l=0;if(s!==e&&(l=(s-e)/s),c){const s=(r-t*i/e)/r;this.vertex=[-1,1-s,0,0,0,0,0,-1,-1+s,0,0,1,0,0,1,1-s,0,1-l,0,0,0,1,-1+s,0,1-l,1,0,0]}else{const s=(i-e*r/t)/i;this.vertex=[-1+s,1,0,0,0,0,0,-1+s,-1,0,0,1,0,0,1-s,1,0,1-l,0,0,0,1-s,-1,0,1-l,1,0,0]}(0,o.A)(this.vertex,this.flipHorizontal,this.flipVertical),this.setVertices()}viewport(e,t){super.viewport(e,t)}setRotate(e,t=!0){(e%=360)!==this.rotate&&(this.rotate=e,this.setRotateMatrix(this.getRotateMatrix(e)),this.layout(),t&&this.clear())}destroy(){this.sampler=null,this.vbo&&this.vbo.destroy(),this.rotateMatrixBuffer&&this.rotateMatrixBuffer.destroy(),this.bindGroupLayout=null,this.bindGroup=null,this.pipelineLayout=null,this.renderBundle=null,this.renderBundleEncoder=null,this.fsModule=null,this.vsModule=null,this.renderPipeline=null,this.rotateMatrix=null,this.vertex=null,this.context=null,this.options=null,this.destroyed=!0,this.device&&(this.device.destroy(),this.device=null),this.adapter&&(this.adapter=null),super.destroy()}}},63849:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(134),s=i(72703),a=i(43356),n=i(86932),o=i(89188);class c extends a.A{constructor(e){super({width:0,height:0},{devicePixelRatio:1,renderMode:0}),(0,r.A)(this,"writableStream",void 0),(0,r.A)(this,"writer",void 0),this.writableStream=e}async init(){this.writer=this.writableStream.getWriter()}clear(){}render(e){e=e instanceof VideoFrame?new VideoFrame(e,{timestamp:1e3*(0,n.A)(),rotation:(this.rotate+(this.flipVertical?180:0))%360,flip:(this.flipHorizontal||this.flipVertical)&&!(this.flipHorizontal&&this.flipVertical)}):(0,o.pt)(e,BigInt(1e3*(0,n.A)()),{rotation:(this.rotate+(this.flipVertical?180:0))%360,flip:(this.flipHorizontal||this.flipVertical)&&!(this.flipHorizontal&&this.flipVertical)}),this.writer.write(e)}layout(){}setRotate(e,t=!0){(e%=360)!==this.rotate&&(this.rotate=e,t&&this.clear())}static isSupport(e){return e instanceof VideoFrame||(0,s.A)(e)}}},6110:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(134),s=i(12535),a=i(1064),n=i(86141),o=i(91131);class c{constructor(e,t,i,s){(0,r.A)(this,"matrixId",void 0),(0,r.A)(this,"primaryId",void 0),(0,r.A)(this,"transferId",void 0),(0,r.A)(this,"rangeId",void 0),this.matrixId=e,this.primaryId=t,this.transferId=i,this.rangeId=s}getMatrixId(){return this.matrixId}getPrimaryId(){return this.primaryId}getTransferId(){return this.transferId}getRangeId(){return this.rangeId}isWide(){return 9===this.primaryId||11===this.primaryId||12===this.primaryId}isHDR(){return 18===this.transferId||16===this.transferId}isToneMappedByDefault(){return 18===this.transferId||16===this.transferId}isAffectedBySDRWhiteLevel(){return 18===this.transferId||16===this.transferId}fullRangeEncodedValues(){return 12===this.transferId||11===this.transferId}getTransformMatrix(e){const t=(1<<e-1)/((1<<e)-1);let i=0,r=0;switch(this.matrixId){case 0:return new s.A;case 1:case 2:i=.2126,r=.0722;break;case 4:i=.3,r=.11;break;case 5:case 6:i=.299,r=.114;break;case 7:i=.212,r=.087;break;case 8:return s.A.RowMajor([.25,.5,.25,0,-.25,.5,-.25,t,.5,0,-.5,t,0,0,0,1]);case 10:return i=.2627,r=.0593,s.A.RowMajor([1,0,0,0,i,1-i-r,r,0,0,0,1,0,0,0,0,1]);case 9:i=.2627,r=.0593;break;case 11:return s.A.RowMajor([0,1,0,0,0,-.5,.493283,.5,.5,-.495951,0,.5,0,0,0,1])}let a=1-i-r,n=.5/(1-r),o=.5/(1-i);return s.A.RowMajor([i,a,r,0,n*-i,n*-a,n*(1-r),.5,o*(1-i),o*-a,o*-r,.5,0,0,0,1])}getRangeAdjustMatrix(e){if(2===this.rangeId)return new s.A;const t=e-8,i=(1<<e)-1,r=i/(219<<t);switch(this.matrixId){case 0:case 8:return(new s.A).setScale(new a.P([r,r,r])).postTranslate(new a.P([-16/219,-16/219,-16/219]));case 1:case 4:case 5:case 6:case 7:case 9:case 10:case 11:case 2:{const e=224<<t,n=i/e,o=(e-i)/(2*e);return(new s.A).setScale(new a.P([r,n,n])).postTranslate(new a.P([-16/219,o,o]))}}return new s.A}getTransferFunction_(){switch(this.transferId){case 8:return n.Hi;case 4:return n.$_;case 5:return n.J7;case 7:return n.q;case 1:case 6:case 14:case 15:return n.aP;case 17:return n.Cr;case 18:case 12:case 9:case 10:case 16:case 2:return null}}getTransferFunction(e){return this.transferId,this.getTransferFunction_()}getInverseTransferFunction(e){const t=this.getTransferFunction(e);if(t){const e={a:0,b:0,c:0,d:0,e:0,f:0,g:0};if(t.a>0&&t.g>0){const i=Math.pow(t.a,t.g);e.a=1/i,e.b=-t.e/i,e.g=1/t.g}return e.d=t.c*t.d+t.f,e.e=-t.b/t.a,0!=t.c&&(e.c=1/t.c,e.f=-t.f/t.c),e}}hasExtendedSkTransferFn(){return 0===this.matrixId}isValid(){return 2!==this.matrixId&&2!==this.primaryId&&2!==this.transferId&&0!==this.rangeId}getColorSpacePrimaries(){const e=o.WO;switch(this.primaryId){case 1:return o.P5;case 4:return o.Wc;case 5:return o.cA;case 7:return o.vi;case 8:return o.cp;case 9:return o.Je;case 10:return o.lf;case 11:return o.Rk;case 12:return o.tR}return e}getPrimaryMatrix(){const e=this.getColorSpacePrimaries(),t=o._O(e);return s.A.RowMajor([t.rc(0,0),t.rc(0,1),t.rc(0,2),0,t.rc(1,0),t.rc(1,1),t.rc(1,2),0,t.rc(2,0),t.rc(2,1),t.rc(2,2),0,0,0,0,1])}}},91131:(e,t,i)=>{"use strict";i.d(t,{Je:()=>u,P5:()=>o,Rk:()=>p,WO:()=>g,Wc:()=>c,_O:()=>v,cA:()=>l,cp:()=>h,lf:()=>f,tR:()=>m,vi:()=>d});var r=i(45726),s=i(1064),a=i(66551),n=i(60153);const o=[.64,.33,.3,.6,.15,.06,.3127,.329],c=[.67,.33,.21,.71,.14,.08,.31,.316],l=[.64,.33,.29,.6,.15,.06,.3127,.329],d=[.63,.34,.31,.595,.155,.07,.3127,.329],h=[.681,.319,.243,.692,.145,.049,.31,.316],u=[.708,.292,.17,.797,.131,.046,.3127,.329],f=[1,0,0,1,0,0,.3333333333333333,.3333333333333333],p=[.68,.32,.265,.69,.15,.06,.314,.351],m=[.68,.32,.265,.69,.15,.06,.3127,.329],g=[0,0,0,0,0,0,0,0];function v(e){const t=r.A.RowMajor([e[0],e[2],e[4],e[1],e[3],e[5],1-e[0]-e[1],1-e[2]-e[3],1-e[4]-e[5]]),i=t.copy().invert(),o=new s.P([e[6]/e[7],1,(1-e[6]-e[7])/e[7]]),c=(0,n.Y3)(i,o);let l=new r.A([c.x,0,0,0,c.y,0,0,0,c.z]);l=(0,a.B)(t,l);const d=function(e,t){const i=new s.P([e/t,1,(1-e-t)/t]),o=new s.P([.96422,1,.82521]),c=r.A.RowMajor([.8951,.2664,-.1614,-.7502,1.7135,.0367,.0389,-.0685,1.0296]),l=r.A.RowMajor([.9869929,-.1470543,.1599627,.4323053,.5183603,.0492912,-.0085287,.0400428,.9684867]),d=(0,n.Y3)(c,i),h=(0,n.Y3)(c,o);let u=new r.A([h.x/d.x,0,0,0,h.y/d.y,0,0,0,h.z/d.z]);return u=(0,a.B)(u,c),u=(0,a.B)(l,u),u}(e[6],e[7]);return(0,a.B)(d,l)}},86141:(e,t,i)=>{"use strict";i.d(t,{$_:()=>r,Cr:()=>c,Hi:()=>n,J7:()=>s,aP:()=>o,q:()=>a});const r={g:2.2,a:1,b:0,c:0,d:0,e:0,f:0},s={g:2.8,a:1,b:0,c:0,d:0,e:0,f:0},a={g:2.222222222222,a:.899626676224,b:.100373323776,c:.25,d:.091286342118,e:0,f:0},n={g:1,a:1,b:0,c:0,d:0,e:0,f:0},o={g:2.4,a:.9478672985781991,b:.05213270142180095,c:.07739938080495357,d:.04045,e:0,f:0},c={g:2.6,a:1.034080527699,b:0,c:0,d:0,e:0,f:0}},89401:(e,t,i)=>{"use strict";i.d(t,{A:()=>o,U:()=>n});const r=.2627,s=.678,a=.0593;function n(e){e.metadata.hlgOOTFGammaMinusOne=.2}function o(e){return 0===e.type?`\n      {\n        vec4 luma_vec = vec4(${r}, ${s}, ${a}, 0.0);\n        float L = dot(color, luma_vec);\n        if (L > 0.0) {\n          color.r *= pow(L, hlg_ootf_gamma_minus_one);\n          color.g *= pow(L, hlg_ootf_gamma_minus_one);\n          color.b *= pow(L, hlg_ootf_gamma_minus_one);\n        }\n      }\n    `:1===e.type?`\n      {\n        let luma_vec: vec4<f32> = vec4(${r}, ${s}, ${a}, 0.0);\n        let L: f32 = dot(color, luma_vec);\n        if (L > 0.0) {\n          color.r *= pow(L, hlg_ootf_gamma_minus_one);\n          color.g *= pow(L, hlg_ootf_gamma_minus_one);\n          color.b *= pow(L, hlg_ootf_gamma_minus_one);\n        }\n      }\n    `:""}},7511:(e,t,i)=>{"use strict";function r(e,t){let i="",r="";if(0===t.type?(i="mat4",r="vec4"):1===t.type&&(i="mat4x4",r="vec4"),!i||!r)return"";let s=`\n      color = ${i}(\n        ${e.rc(0,0)}, ${e.rc(1,0)}, ${e.rc(2,0)}, 0,\n        ${e.rc(0,1)}, ${e.rc(1,1)}, ${e.rc(2,1)}, 0,\n        ${e.rc(0,2)}, ${e.rc(1,2)}, ${e.rc(2,2)}, 0,\n        0, 0, 0, 1\n      ) * color;\n    `;return 0===e.rc(0,3)&&0===e.rc(1,3)&&0===e.rc(2,3)||(s+=`\n        color += ${r}(${e.rc(0,3)}, ${e.rc(1,3)}, ${e.rc(2,3)}, 0);\n      `),s}i.d(t,{A:()=>r})},79955:(e,t,i)=>{"use strict";function r(e,t){t.metadata.sdrRelativeToNitsFactor=t.dstSdrMaxLuminanceNits/e}function s(e){return"\n    color.r *= sdr_relative_to_nits_factor;\n    color.g *= sdr_relative_to_nits_factor;\n    color.b *= sdr_relative_to_nits_factor;\n "}i.d(t,{A:()=>s,j:()=>r})},64748:(e,t,i)=>{"use strict";i.d(t,{A:()=>a,n:()=>s});var r=i(57517);function s(e,t,i){let s=i.dstSdrMaxLuminanceNits;t&&(s=r.kH,i.sdrWhiteLevel&&(s=i.sdrWhiteLevel)),i.metadata.nitsToSdrRelativeFactor=e/s}function a(e){return"\n    color.r *= nits_to_sdr_relative_factor;\n    color.g *= nits_to_sdr_relative_factor;\n    color.b *= nits_to_sdr_relative_factor;\n  "}},70194:(e,t,i)=>{"use strict";i.d(t,{A:()=>a,J:()=>s});var r=i(57517);function s(e,t){const i=function(e,t){let i=r.hD;18!==e.getTransferId()&&t.maxContentLightLevel>0&&(i=t.maxContentLightLevel);let s=r.kH;return t.sdrWhiteLevel&&(s=t.sdrWhiteLevel),i/s}(e,t);i>t.dstMaxLuminanceRelative?(t.metadata.pqTonemapA=t.dstMaxLuminanceRelative/(i*i),t.metadata.pqTonemapB=1/t.dstMaxLuminanceRelative):(t.metadata.pqTonemapA=0,t.metadata.pqTonemapB=0)}function a(e){return`\n    {\n      ${1===e.type?"let maximum: f32":"float maximum"} = max(color.r, max(color.g, color.b));\n      if (maximum > 0.0) {\n        color.r *= (1.0 + pq_tonemap_a * maximum) / (1.0 + pq_tonemap_b * maximum);\n        color.g *= (1.0 + pq_tonemap_a * maximum) / (1.0 + pq_tonemap_b * maximum);\n        color.b *= (1.0 + pq_tonemap_a * maximum) / (1.0 + pq_tonemap_b * maximum);\n      }\n    }\n `}},15380:(e,t,i)=>{"use strict";function r(e){return e===e>>>0?`${e}.0`:e.toString()}i.d(t,{A:()=>r})},25669:(e,t,i)=>{"use strict";i.d(t,{A:()=>v});var r=i(6110),s=i(57517),a=i(7511),n=i(5361),o=i(63921),c=i(55168),l=i(16307),d=i(89401),h=i(64748),u=i(70194),f=i(79955),p=i(84272),m=i(51025),g=i(40326);function v(e,t,i){const v=[],y=8===e.getMatrixId(),A=(0,a.A)(e.getRangeAdjustMatrix(i.bitDepth),i);if(y||v.push(A),v.push((0,a.A)(e.getTransformMatrix(i.bitDepth).invert(),i)),y&&v.push(A),t.isValid()){if(e.isHDR()){switch(e.getTransferId()){case 18:v.push((0,n.A)(i));break;case 16:v.push((0,o.A)(i));break;default:const t=e.getTransferFunction();t?v.push((0,c.A)(t,e.hasExtendedSkTransferFn(),i)):v.push((0,l.A)(e.getTransferId(),i))}10===e.getMatrixId()&&v.push((0,a.A)(e.getTransformMatrix(i.bitDepth).invert(),i)),v.push((0,a.A)(e.getPrimaryMatrix(),i));const y=new r.A(0,9,8,2);switch(e.getTransferId()){case 18:v.push((0,a.A)(y.getPrimaryMatrix().invert(),i)),(0,d.U)(i),v.push((0,d.A)(i)),(0,h.n)(s.hD,!0,i),v.push((0,h.A)(i)),i.toneMapPQAndHlgToDst&&((0,u.J)(e,i),v.push((0,u.A)(i))),v.push((0,a.A)(y.getPrimaryMatrix(),i));break;case 16:(0,h.n)(s.th,!0,i),v.push((0,h.A)(i)),i.toneMapPQAndHlgToDst&&(v.push((0,a.A)(y.getPrimaryMatrix().invert(),i)),(0,u.J)(e,i),v.push((0,u.A)(i)),v.push((0,a.A)(y.getPrimaryMatrix(),i)))}switch(v.push((0,a.A)(t.getPrimaryMatrix().invert(),i)),10===t.getMatrixId()&&v.push((0,a.A)(t.getTransformMatrix(i.bitDepth),i)),t.getTransferId()){case 18:(0,f.j)(s.kH,i),v.push((0,f.A)(i)),v.push((0,p.A)(i));break;case 16:(0,f.j)(s.th,i),v.push((0,f.A)(i)),v.push((0,m.A)(i));default:const r=t.getInverseTransferFunction();r?v.push((0,c.A)(r,e.hasExtendedSkTransferFn(),i)):v.push((0,g.A)(e.getTransferId(),i))}}if(!i.outputRGB){const e=8===t.getMatrixId(),r=(0,a.A)(t.getRangeAdjustMatrix(i.bitDepth).invert(),i);e&&v.push(r),v.push((0,a.A)(t.getTransformMatrix(i.bitDepth),i)),e||v.push(r)}}return v}},57517:(e,t,i)=>{"use strict";i.d(t,{hD:()=>s,kH:()=>r,th:()=>a});const r=203,s=1e3,a=1e4},71323:(e,t,i)=>{"use strict";function r(e,t,i){return t?`\n      {\n        ${1===i.type?"var v: f32":"float v"} = abs(color.r);\n        ${e()}\n        color.r = sign(color.r) * v;\n      }\n      {\n        ${1===i.type?"var v: f32":"float v"} = abs(color.g);\n        ${e()}\n        color.g = sign(color.g) * v;\n      }\n      {\n        ${1===i.type?"var v: f32":"float v"} = abs(color.b);\n        ${e()}\n        color.b = sign(color.b) * v;\n      }\n    `:`\n      {\n        ${1===i.type?"var v: f32":"float v"} = color.r;\n        ${e()}\n        color.r = v;\n      }\n      {\n        ${1===i.type?"var v: f32":"float v"} = color.g;\n        ${e()}\n        color.g = v;\n      }\n      {\n        ${1===i.type?"var v: f32":"float v"} = color.b;\n        ${e()}\n        color.b = v;\n      }\n    `}i.d(t,{A:()=>r})},40326:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(71323);function s(e,t){return(0,r.A)((function(){switch(e){case 9:return"\n          if (v < 0.0) {\n            v = 0.0;\n          }\n          else {\n            v =  1.0 + log(v) / log(10.0) / 2.0;\n          }\n        ";case 10:return"\n          if (v < sqrt(10.0) / 1000.0)\n            v = 0.0;\n          }\n          else {\n            v = 1.0 + log(v) / log(10.0) / 2.5;\n          }\n        ";case 11:return`\n          ${1===t.type?"let a: f32":"float a"} = 1.099296826809442;\n          ${1===t.type?"let b: f32":"float b"}= 0.018053968510807;\n          if (v < -b) {\n            v = -a * pow(-v, 0.45) + (a - 1.0);\n          }\n          else if (v <= b) {\n            v = 4.5 * v;\n          }\n          else {\n            v = a * pow(v, 0.45) - (a - 1.0);\n          }\n        `;case 12:return`\n          ${1===t.type?"let a: f32":"float a"} = 1.099;\n          ${1===t.type?"let b: f32":"float b"} = 0.018;\n          ${1===t.type?"let l: f32":"float l"} = 0.0045;\n\n          if (v < -l) {\n            v = -(a * pow(-4.0 * v, 0.45) + (a - 1.0)) / 4.0;\n          }\n          else if (v <= b) {\n            v = 4.5 * v;\n          }\n          else {\n            v = a * pow(v, 0.45) - (a - 1.0);\n          }\n        `;default:return""}}),!1,t)}},5361:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(71323);function s(e){return(0,r.A)((function(){return`\n      v = max(0.0, v);\n      ${1===e.type?"let a: f32":"float a"} = 0.17883277;\n      ${1===e.type?"let b: f32":"float b"} = 0.28466892;\n      ${1===e.type?"let c: f32":"float c"} = 0.55991073;\n      if (v <= 0.5) {\n        v = v * v * 4.0;\n      }\n      else {\n        v = exp((v - c) / a) + b;\n      }\n      v = v / 12.0;\n    `}),!1,e)}},84272:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(71323);function s(e){return(0,r.A)((function(){return`\n      v = max(0.0, v);\n      ${1===e.type?"let a: f32":"float a"} = 0.17883277;\n      ${1===e.type?"let b: f32":"float b"} = 0.28466892;\n      ${1===e.type?"let c: f32":"float c"} = 0.55991073;\n      if (v <= 1.0) {\n        v = 0.5 * sqrt(v);\n      }\n      else {\n        v = a * log(v - b) + c;\n      }\n    `}),!1,e)}},63921:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(71323);function s(e){return(0,r.A)((function(){return`\n      v = max(0.0, v);\n      ${1===e.type?"let m1: f32":"float m1"} = (2610.0 / 4096.0) / 4.0;\n      ${1===e.type?"let m2: f32":"float m2"} = (2523.0 / 4096.0) * 128.0;\n      ${1===e.type?"let c1: f32":"float c1"} = 3424.0 / 4096.0;\n      ${1===e.type?"let c2: f32":"float c2"} = (2413.0 / 4096.0) * 32.0;\n      ${1===e.type?"let c3: f32":"float c3"} = (2392.0 / 4096.0) * 32.0;\n      \n      ${0===e.type?"\n        #ifdef GL_FRAGMENT_PRECISION_HIGH\n        highp float v2 = v;\n        #else\n        float v2 = v;\n        #endif\n      ":"var v2: f32 = v;"}\n  \n      v2 = pow(max(pow(v2, 1.0 / m2) - c1, 0.0) / (c2 - c3 * pow(v2, 1.0 / m2)), 1.0 / m1);\n      v = v2;\n    `}),!1,e)}},51025:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(71323);function s(e){return(0,r.A)((function(){return`\n      v = max(0.0, v);\n      ${1===e.type?"let m1: f32":"float m1"} = (2610.0 / 4096.0) / 4.0;\n      ${1===e.type?"let m2: f32":"float m2"} = (2523.0 / 4096.0) * 128.0;\n      ${1===e.type?"let c1: f32":"float c1"} = 3424.0 / 4096.0;\n      ${1===e.type?"let c2: f32":"float c2"} = (2413.0 / 4096.0) * 32.0;\n      ${1===e.type?"let c3: f32":"float c3"} = (2392.0 / 4096.0) * 32.0;\n      v =  pow((c1 + c2 * pow(v, m1)) / (1.0 + c3 * pow(v, m1)), m2);\n    `}),!1,e)}},16307:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(71323);function s(e,t){return(0,r.A)((function(){switch(e){case 9:return"\n          if (v < 0.0) {\n            v = 0.0;\n          }\n          else {\n            v = pow(10.0, (v - 1.0) * 2.0);\n          }\n        ";case 10:return"\n          if (v < 0.0) {\n            v = 0.0;\n          }\n          else {\n            v = pow(10.0, (v - 1.0) * 2.5);\n          }\n        ";case 11:return`\n          ${1===t.type?"let a: f32":"float a"} = 1.099296826809442;\n          ${1===t.type?"let from_linear_neg_a: f32":"float from_linear_neg_a"} = -1.047844;\n          ${1===t.type?"let from_linear_b: f32":"float from_linear_b"} = 0.081243;\n          if (v < from_linear_neg_a) {\n            v = -pow((a - 1.0 - v) / a, 1.0 / 0.45);\n          }\n          else if (v <= from_linear_b) {\n            v = v / 4.5;\n          }\n          else {\n            v = pow((v + a - 1.0) / a, 1.0 / 0.45);\n          }\n        `;case 12:return`\n          ${1===t.type?"let a: f32":"float a"} = 1.099;\n          ${1===t.type?"let from_linear_neg_l: f32":"float from_linear_neg_l"} = -0.020250;\n          ${1===t.type?"let from_linear_b: f32":"float from_linear_b"} = 0.081000;\n          if (v < from_linear_neg_l) {\n            v = -pow((1.0 - a - v * 4.0) / a, 1.0 / 0.45) / 4.0;\n          }\n          else if (v <= from_linear_b) {\n            v = v / 4.5;\n          }\n          else {\n            v = pow((v + a - 1.0) / a, 1.0 / 0.45);\n          }\n        `;default:return""}}),!1,t)}},55168:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(71323),s=i(15380);function a(e,t,i){return(0,r.A)((function(){let t=.0009765625,i="v";Math.abs(e.c-1)>t&&(i=`${(0,s.A)(e.c)} * ${i}`),Math.abs(e.f)>t&&(i=`${i} + ${(0,s.A)(e.f)}`);let r="v";return Math.abs(e.a=1)>t&&(r=`${(0,s.A)(e.a)} * ${r}`),Math.abs(e.b)>t&&(r=`${r} + ${(0,s.A)(e.b)}`),Math.abs(e.g-1)>t&&(r=`pow(${r}, ${(0,s.A)(e.g)})`),Math.abs(e.e)>t&&(r=`${r} + ${(0,s.A)(e.e)}`),`\n      if (v < ${(0,s.A)(e.d)}) {\n        v = ${i};\n      }\n      else {\n        v = ${r};\n      }\n    `}),!1,i)}},38469:(e,t,i)=>{"use strict";function r(e,t,i){if(t){let t=e[3],i=e[4];e[3]=e[17],e[4]=e[18],e[17]=t,e[18]=i,t=e[10],i=e[11],e[10]=e[24],e[11]=e[25],e[24]=t,e[25]=i}if(i){let t=e[3],i=e[4];e[3]=e[10],e[4]=e[11],e[10]=t,e[11]=i,t=e[17],i=e[18],e[17]=e[24],e[18]=e[25],e[24]=t,e[25]=i}}i.d(t,{A:()=>r})},20088:(e,t,i)=>{"use strict";i.d(t,{A:()=>d});var r,s,a=i(134),n=i(80662),o=i.n(n),c=i(61499),l=i(12085);class d{constructor(){(0,a.A)(this,"offset",void 0),(0,a.A)(this,"multiplier",void 0),(0,a.A)(this,"pqTonemapA",void 0),(0,a.A)(this,"pqTonemapB",void 0),(0,a.A)(this,"hlgOOTFGammaMinusOne",void 0),(0,a.A)(this,"nitsToSdrRelativeFactor",void 0),(0,a.A)(this,"sdrRelativeToNitsFactor",void 0)}}r=d.prototype,(s=new(o())).set("offset",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("multiplier",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("pqTonemapA",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),s.set("pqTonemapB",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),s.set("hlgOOTFGammaMinusOne",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),s.set("nitsToSdrRelativeFactor",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:20,8:0}),s.set("sdrRelativeToNitsFactor",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),(0,l.A)(r,c.Og,!0),(0,l.A)(r,c.dc,4),(0,l.A)(r,c.g7,28),(0,l.A)(r,c.JY,s)},36719:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(134),s=i(9188);class a extends s.A{constructor(e,t,i=!0){super(e,t),(0,r.A)(this,"enableColor",void 0),(0,r.A)(this,"aPoint",void 0),(0,r.A)(this,"aColor",void 0),this.enableColor=i}link(e){super.link(e),this.aPoint=this.gl.getAttribLocation(this.program,"point"),this.aColor=this.gl.getAttribLocation(this.program,"color"),this.enableColor?(this.gl.enableVertexAttribArray(this.aPoint),this.gl.enableVertexAttribArray(this.aColor)):this.gl.enableVertexAttribArray(this.aPoint)}bind(){super.bind(),this.enableColor?(this.gl.vertexAttribPointer(this.aPoint,3,this.gl.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,0),this.gl.vertexAttribPointer(this.aColor,4,this.gl.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,3*Float32Array.BYTES_PER_ELEMENT)):this.gl.vertexAttribPointer(this.aPoint,3,this.gl.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,0)}}},9188:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(134);i(4624);class s{constructor(e,t){(0,r.A)(this,"gl",void 0),(0,r.A)(this,"_program",void 0),(0,r.A)(this,"vertexShader",void 0),(0,r.A)(this,"fragmentShader",void 0),this.vertexShader=e,this.fragmentShader=t}link(e){this.gl=e,this.vertexShader&&this.vertexShader.compile(this.gl),this.fragmentShader&&this.fragmentShader.compile(this.gl),this._program=this.gl.createProgram(),this.gl.attachShader(this._program,this.vertexShader.shader),this.gl.attachShader(this._program,this.fragmentShader.shader),this.gl.linkProgram(this._program)}stop(){this.vertexShader.stop(this.gl),this.fragmentShader.stop(this.gl),this.gl.deleteProgram(this._program),this.vertexShader=null,this.fragmentShader=null,this._program=null}bind(){this.gl.useProgram(this._program)}get program(){return this._program}}},24399:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(134),s=i(36719),a=i(37022),n=i(36200),o=i(84209);class c extends s.A{constructor(e,t){super(new a.A(t||o.A),new n.A(e)),(0,r.A)(this,"rotateMatrixLocation",void 0),(0,r.A)(this,"ySamplerLocation",void 0),(0,r.A)(this,"uSamplerLocation",void 0),(0,r.A)(this,"vSamplerLocation",void 0),(0,r.A)(this,"aSamplerLocation",void 0)}link(e){super.link(e),this.rotateMatrixLocation=this.gl.getUniformLocation(this.program,"rotateMatrix"),this.ySamplerLocation=this.gl.getUniformLocation(this.program,"y_Sampler"),this.uSamplerLocation=this.gl.getUniformLocation(this.program,"u_Sampler"),this.vSamplerLocation=this.gl.getUniformLocation(this.program,"v_Sampler"),this.aSamplerLocation=this.gl.getUniformLocation(this.program,"a_Sampler")}setRotateMatrix(e){this.gl.uniformMatrix4fv(this.rotateMatrixLocation,!1,new Float32Array(e))}bindYTexture(e=0){this.gl.uniform1i(this.ySamplerLocation,e)}bindUTexture(e=0){this.gl.uniform1i(this.uSamplerLocation,e)}bindVTexture(e=0){this.gl.uniform1i(this.vSamplerLocation,e)}bindATexture(e=0){this.gl.uniform1i(this.aSamplerLocation,e)}}},25408:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(134),s=i(24399);class a extends s.A{constructor(e,t){super(e,t),(0,r.A)(this,"offsetLocation",void 0),(0,r.A)(this,"multiplierLocation",void 0),(0,r.A)(this,"pqTonemapALocation",void 0),(0,r.A)(this,"pqTonemapBLocation",void 0),(0,r.A)(this,"hlgOOTFGammaMinusOneLocation",void 0),(0,r.A)(this,"hlgDstMaxLuminanceRelativeLocation",void 0),(0,r.A)(this,"nitsToSdrRelativeFactorLocation",void 0),(0,r.A)(this,"sdrRelativeToNitsFactorLocation",void 0)}link(e){super.link(e),this.offsetLocation=this.gl.getUniformLocation(this.program,"offset"),this.multiplierLocation=this.gl.getUniformLocation(this.program,"multiplier"),this.pqTonemapALocation=this.gl.getUniformLocation(this.program,"pq_tonemap_a"),this.pqTonemapBLocation=this.gl.getUniformLocation(this.program,"pq_tonemap_b"),this.hlgOOTFGammaMinusOneLocation=this.gl.getUniformLocation(this.program,"hlg_ootf_gamma_minus_one"),this.nitsToSdrRelativeFactorLocation=this.gl.getUniformLocation(this.program,"nits_to_sdr_relative_factor"),this.sdrRelativeToNitsFactorLocation=this.gl.getUniformLocation(this.program,"sdr_relative_to_nits_factor")}setMetaData(e){this.gl.uniform1f(this.offsetLocation,e.offset),this.gl.uniform1f(this.multiplierLocation,e.multiplier),this.gl.uniform1f(this.pqTonemapALocation,e.pqTonemapA),this.gl.uniform1f(this.pqTonemapBLocation,e.pqTonemapB),this.gl.uniform1f(this.hlgOOTFGammaMinusOneLocation,e.hlgOOTFGammaMinusOne),this.gl.uniform1f(this.nitsToSdrRelativeFactorLocation,e.nitsToSdrRelativeFactor),this.gl.uniform1f(this.sdrRelativeToNitsFactorLocation,e.sdrRelativeToNitsFactor)}}},18915:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(24399);class s extends r.A{constructor(e,t){super(e,t)}}},36200:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(27976);class s extends r.A{constructor(e){super(1,e)}}},27976:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(134);i(4624);class s{constructor(e,t){(0,r.A)(this,"type",void 0),(0,r.A)(this,"_shader",void 0),(0,r.A)(this,"_source",void 0),(0,r.A)(this,"compiled",void 0),this.type=e,this._shader=null,this._source=t,this.compiled=!1}compile(e){this.compiled||(this._shader=e.createShader(0===this.type?e.VERTEX_SHADER:e.FRAGMENT_SHADER),e.shaderSource(this._shader,this._source),e.compileShader(this._shader),this.compiled=!0)}stop(e){e.deleteShader(this._shader),this._shader=null}get shader(){return this._shader}}},37022:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(27976);class s extends r.A{constructor(e){super(0,e)}}},22684:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(134),s=i(67672);class a{constructor(e,t,i){(0,r.A)(this,"gl",void 0),(0,r.A)(this,"width",void 0),(0,r.A)(this,"height",void 0),(0,r.A)(this,"texture",void 0),this.gl=e,this.width=t,this.height=i,this.texture=this.gl.createTexture()}getTexture(){return this.texture}bind(e){s.ai(e)&&this.gl.activeTexture(this.gl.TEXTURE0+e),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture)}setSize(e,t){this.width=e,this.height=t}setUnpackAlignment(){this.width%8==0?this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,8):this.width%4==0?this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,4):this.width%2==0?this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,2):this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1)}destroy(){this.texture&&(this.gl.deleteTexture(this.texture),this.texture=null)}}},18105:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(134),s=i(22684),a=i(4624);class n extends s.A{constructor(e,t,i){super(e,t,i),(0,r.A)(this,"filter",void 0),(0,r.A)(this,"format",void 0),(0,r.A)(this,"internalformat",void 0),(0,r.A)(this,"dataType",void 0),(0,r.A)(this,"firstUploaded",void 0),(0,r.A)(this,"pbo",void 0),this.format=this.gl.LUMINANCE,this.filter=this.gl.LINEAR,this.internalformat=this.gl.LUMINANCE,this.dataType=this.gl.UNSIGNED_BYTE}init(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.firstUploaded=!1}setFormat(e){this.format=e}setInternalformat(e){this.internalformat=e}setDataType(e){this.dataType=e}setFilter(e){this.filter=e}fill(e){if(this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.setUnpackAlignment(),this.firstUploaded)if(this.pbo){const t=this.gl;t.bindBuffer(t.PIXEL_UNPACK_BUFFER,this.pbo),t.bufferSubData(t.PIXEL_UNPACK_BUFFER,0,e),t.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,this.width,this.height,this.format,this.dataType,0)}else this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,this.width,this.height,this.format,this.dataType,e);else{if("function"==typeof WebGL2RenderingContext&&this.gl instanceof WebGL2RenderingContext)try{this.pbo=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.PIXEL_UNPACK_BUFFER,this.pbo),this.gl.bufferData(this.gl.PIXEL_UNPACK_BUFFER,e,this.gl.STREAM_DRAW),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.internalformat,this.width,this.height,0,this.format,this.dataType,0)}catch(t){this.pbo=null,a.R8("not support pbo","src/avrender/image/webgl/texture/VideoTexture.ts",109),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.internalformat,this.width,this.height,0,this.format,this.dataType,e)}else this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.internalformat,this.width,this.height,0,this.format,this.dataType,e);this.firstUploaded=!0}}destroy(){this.pbo&&this.gl.deleteBuffer(this.pbo),super.destroy()}}},48641:(e,t,i)=>{"use strict";i.d(t,{A:()=>g});var r=i(134),s=i(63939),a=i(50932),n=(i(10278),i(37837)),o=i(11473),c=i(84149),l=i(4624),d=i(26429),h=i(44690),u=i(67672),f=i(14686),p=i(86932);const m=h.A.windows||h.A.mac||h.A.linux?20:30;class g{constructor(e,t,i={}){(0,r.A)(this,"context",void 0),(0,r.A)(this,"observer",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"pullIPC",void 0),(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"channels",void 0),(0,r.A)(this,"ended",void 0),(0,r.A)(this,"float32",void 0),(0,r.A)(this,"buffered",void 0),(0,r.A)(this,"pause",void 0),(0,r.A)(this,"startTime",void 0),(0,r.A)(this,"dest",void 0),(0,r.A)(this,"queue",void 0),(0,r.A)(this,"firstRendered",void 0),(0,r.A)(this,"lastStutterTimestamp",void 0),this.context=e,this.observer=t,this.options=i}async request(e,t,i){switch(e){case"init":break;case"start":{const{port:e,channels:i}=t;this.channels=i,this.pullIPC=new c.Ay(e),this.buffer=this.allocBuffer(),this.float32=new Float32Array((0,o.eq)().buffer),this.queue=[],this.startTime=0,this.ended=!1,this.pause=!1,this.firstRendered=!1,this.lastStutterTimestamp=(0,p.A)(),await this.pullInterval(),this.buffering(),await this.pullInterval(),this.buffered=!0,this.process();break}case"restart":if(!this.ended)return;this.buffer=this.allocBuffer(),this.queue=[],this.startTime=0,this.ended=!1,this.pause=!1,this.firstRendered=!1,await this.pullIPC.request("pull",{buffer:this.buffer}),this.buffering(),await this.pullIPC.request("pull",{buffer:this.buffer}),this.buffered=!0,this.lastStutterTimestamp=(0,p.A)(),this.process();break;case"stop":this.freeBuffer(this.buffer),this.buffer=null,this.ended=!0,this.pullIPC.destroy();break;case"clear":this.queue.forEach((e=>{e.disconnect()})),this.queue.length=0;break;case"pause":this.pause=!0;break;case"unpause":this.pause=!1,this.queue.length||this.process()}}allocBuffer(){const e=(0,n.Gy)(48);a.M[20](e,(0,n.Gy)(4*this.channels));const t=(0,n.Gy)(512*m*this.channels);for(let i=0;i<this.channels;i++)a.M[20](s.f[20](e)+4*i,t+128*m*4*i);return a.M[15](e+12,128*m),e}freeBuffer(e){e&&((0,n.aI)(s.f[20](e)),(0,n.aI)(e),(0,n.Eb)(e))}async pullInterval(){let e=0;if(this.options.isMainWorker){const t=await this.pullIPC.request("pullBuffer",{nbSamples:128*m});u.sv(t)?(e=0,(0,f.lW)(s.f[20](s.f[20](this.buffer)),t.byteLength,new Uint8Array(t))):e=t}else e=await this.pullIPC.request("pull",{buffer:this.buffer});return e}async pull(){this.buffered=!1,await this.pullInterval()<0?this.ended=!0:(this.buffered=!0,this.queue.length||this.process())}buffering(){this.float32.length||(this.float32=new Float32Array((0,o.eq)().buffer));const e=this.context.createBuffer(this.channels,128*m,this.context.sampleRate);for(let t=0;t<this.channels;t++)if(s.f[20](s.f[20](this.buffer)+4*t)){let i=s.f[20](s.f[20](this.buffer)+4*t)>>>2;e.copyToChannel&&!d.USE_THREADS?e.copyToChannel(this.float32.subarray(i,i+128*m),t,0):e.getChannelData(t).set(this.float32.subarray(i,i+128*m),0)}const t=this.context.createBufferSource();t.buffer=e,t.onended=()=>{if(this.queue.shift(),this.ended&&!this.queue.length)return this.freeBuffer(this.buffer),l.pq("audio source ended","src/avrender/pcm/AudioSourceBufferNode.ts",257),void this.observer.onEnded();this.process(),this.queue.length||(0,p.A)()-this.lastStutterTimestamp>1e3&&(this.observer.onStutter(),this.lastStutterTimestamp=(0,p.A)()),this.firstRendered||(this.firstRendered=!0,this.observer.onFirstRendered())},0===this.startTime&&(this.startTime=this.context.currentTime),t.start(this.startTime),this.dest&&t.connect(this.dest),this.startTime+=t.buffer.duration,this.queue.push(t)}connect(e){this.dest=e}disconnect(){for(let e=0;e<this.queue.length;e++)this.queue[e].disconnect();this.dest=null,this.queue.length=0}process(){this.buffer&&!this.pause&&this.buffered&&(this.buffering(),this.pull())}}},88397:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(6534);class s extends r.A{constructor(e,t,i={}){super(e,t,"audio-source-processor",i)}}},6534:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(134),s=i(84149),a=i(67672);class n{constructor(e,t,i,a={}){(0,r.A)(this,"audioWorkletNode",void 0),(0,r.A)(this,"ipcPort",void 0),(0,r.A)(this,"observer",void 0),this.observer=t,this.audioWorkletNode=new AudioWorkletNode(e,i,a),this.ipcPort=new s.Ay(this.audioWorkletNode.port),this.ipcPort.on(s.Wo,(e=>{switch(e.method){case"ended":this.observer.onEnded();break;case"firstRendered":this.observer.onFirstRendered();break;case"stutter":this.observer.onStutter()}}))}async request(e,t,i){return this.ipcPort.request(e,t,i)}connect(e){this.audioWorkletNode.connect(e)}getNode(){return this.audioWorkletNode}disconnect(){this.audioWorkletNode.disconnect()}getParameters(e){const t=this.audioWorkletNode.parameters;if(a.Pc(t.get))return t.get(e);t.forEach(((t,i)=>{if(i===e)return t}))}}},41324:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(61837);async function s(e,t){const i=(0,r.A)(t,{varName:"processor"}),s=new Blob([i],{type:"text/javascript"}),a=URL.createObjectURL(s);await e.audioWorklet.addModule(a)}},60120:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r,s=i(134),a=i(95335),n=i(4624);!function(e){e[e.ADD=0]="ADD",e[e.REMOVE=1]="REMOVE",e[e.UPDATE_TIMESTAMP_OFFSET=2]="UPDATE_TIMESTAMP_OFFSET",e[e.CALLBACK=3]="CALLBACK",e[e.CHANGE_MIME_TYPE=4]="CHANGE_MIME_TYPE"}(r||(r={}));const o={mediaBufferMax:10};class c{constructor(e={}){(0,s.A)(this,"sourceBuffer",void 0),(0,s.A)(this,"operatorQueue",void 0),(0,s.A)(this,"updating",void 0),(0,s.A)(this,"lastRemoveTime",void 0),(0,s.A)(this,"paddingCallback",void 0),(0,s.A)(this,"options",void 0),(0,s.A)(this,"ending",void 0),(0,s.A)(this,"onQuotaExceededError",void 0),(0,s.A)(this,"onEnded",void 0),this.options=a.X$({},o,e),this.operatorQueue=[],this.updating=!1,this.lastRemoveTime=0,this.ending=!1}setSourceBuffer(e){this.sourceBuffer&&(this.sourceBuffer.onupdateend=null,this.sourceBuffer.onerror=null),this.sourceBuffer=e,this.sourceBuffer.onupdateend=()=>{this.paddingCallback&&(this.paddingCallback(),this.paddingCallback=null),this.operatorQueue&&this.operatorQueue.length?this.enqueue():(this.updating=!1,this.ending&&this.onEnded&&this.onEnded())},this.sourceBuffer.onerror=e=>{n.z3(`track update buffer error: ${e}`,"src/avrender/track/Track.ts",110)}}changeMimeType(e,t){this.sourceBuffer&&(this.operatorQueue.push({operator:r.CHANGE_MIME_TYPE,type:e,mode:t}),this.updating||this.enqueue())}enqueue(){if(this.operatorQueue.length){const e=this.operatorQueue.shift();if(e.operator===r.ADD)try{this.sourceBuffer.appendBuffer(e.buffer),this.updating=!0,e.callback&&(this.paddingCallback=e.callback)}catch(t){if(!(t instanceof DOMException&&"QuotaExceededError"===t.name))throw t;this.operatorQueue.unshift(e),this.onQuotaExceededError&&this.onQuotaExceededError(),this.updating=!1}else e.operator===r.REMOVE?(this.sourceBuffer.remove(e.start,e.end),this.updating=!0,e.callback&&(this.paddingCallback=e.callback)):e.operator===r.UPDATE_TIMESTAMP_OFFSET?(this.sourceBuffer.timestampOffset=e.timestampOffset,e.callback&&e.callback(),this.operatorQueue.length?this.enqueue():this.updating=!1):e.operator===r.CALLBACK?(e.callback&&e.callback(),this.operatorQueue.length?this.enqueue():this.updating=!1):e.operator===r.CHANGE_MIME_TYPE&&(this.sourceBuffer.changeType(e.type),this.sourceBuffer.mode=e.mode,this.sourceBuffer.timestampOffset=0)}}addBuffer(e,t){e?(this.operatorQueue.push({operator:r.ADD,buffer:e,callback:t}),this.updating||this.enqueue()):t&&t()}insertEnqueueCallback(e){this.operatorQueue.push({operator:r.CALLBACK,callback:e}),this.updating||this.enqueue()}updateTimestampOffset(e,t){this.operatorQueue.push({operator:r.UPDATE_TIMESTAMP_OFFSET,timestampOffset:e,callback:t}),this.updating||this.enqueue()}removeBuffer(e,t){this.ending||(e=Math.floor(e))-this.lastRemoveTime<this.options.mediaBufferMax<<1||(this.operatorQueue.push({operator:r.REMOVE,start:this.lastRemoveTime,end:e-this.options.mediaBufferMax,callback:t}),this.updating||this.enqueue(),this.lastRemoveTime=e-this.options.mediaBufferMax)}removeAllBuffer(e){this.sourceBuffer.buffered.length?(this.operatorQueue.push({operator:r.REMOVE,start:this.sourceBuffer.buffered.start(0),end:this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1),callback:e}),this.updating||this.enqueue()):e&&e()}end(){this.ending=!0,this.updating||this.operatorQueue.length||this.onEnded&&this.onEnded()}stop(){if(this.sourceBuffer){try{this.sourceBuffer.abort(),this.updating=!1}catch(e){}try{this.sourceBuffer.buffered.length&&(this.updating?this.operatorQueue.push({operator:r.REMOVE,start:this.sourceBuffer.buffered.start(0),end:this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1)}):(this.sourceBuffer.remove(this.sourceBuffer.buffered.start(0),this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1)),this.updating=!0)),this.paddingCallback&&(this.paddingCallback(),this.paddingCallback=null)}catch(e){}}}reset(){this.stop(),this.operatorQueue.length=0,this.ending=!1}isPaused(){return!this.updating&&this.operatorQueue.length}getQueueLength(){return this.operatorQueue.length}getBufferedTime(){return this.sourceBuffer&&this.sourceBuffer.buffered.length?this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1)-this.sourceBuffer.buffered.start(0):0}getBufferedStart(){return this.sourceBuffer&&this.sourceBuffer.buffered.length?this.sourceBuffer.buffered.start(0):0}getBufferedEnd(){return this.sourceBuffer&&this.sourceBuffer.buffered.length?this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1):0}getBufferedDuration(e){if(this.sourceBuffer&&this.sourceBuffer.buffered.length){let t=0;try{for(let i=0;i<this.sourceBuffer.buffered.length;i++){const r=Math.max(e,this.sourceBuffer.buffered.start(i));t+=Math.max(e,this.sourceBuffer.buffered.end(i))-r}}catch(e){}return t}return 0}getSourceBuffer(){return this.sourceBuffer}setMediaBufferMax(e){this.options.mediaBufferMax=e}getMediaBufferMax(){return this.options.mediaBufferMax}destroy(){this.stop(),this.operatorQueue=null,this.sourceBuffer&&(this.sourceBuffer.onupdateend=this.sourceBuffer.onerror=null,this.sourceBuffer=null)}}},85224:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(63939),s=i(79756),a=i(86834);function n(e){let t="";return t=86017!==r.f[15](e+4)||a.A.firefox?`audio/mp4; codecs="${(0,s.A)(e)}"`:"audio/mpeg",t}},10333:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(63939),s=i(28875);function a(e){return 139===r.f[15](e+4)?`video/webm; codecs="${(0,s.A)(e)}"`:`video/mp4; codecs="${(0,s.A)(e)}"`}},68960:(e,t,i)=>{"use strict";i.d(t,{A:()=>h});var r=i(134),s=i(80662),a=i.n(s),n=i(77162),o=i(74503),c=i(9599),l=i(94300),d=i(77231);class h{constructor(){(0,r.A)(this,"index",d.N_),(0,r.A)(this,"id",d.N_),(0,r.A)(this,"privData",null),(0,r.A)(this,"privateData2",null),(0,r.A)(this,"codecpar",(0,o.A)(new n.A,n.A)),(0,r.A)(this,"sideData",{}),(0,r.A)(this,"nbFrames",BigInt(0)),(0,r.A)(this,"metadata",{}),(0,r.A)(this,"duration",d.Dh),(0,r.A)(this,"startTime",d.Dh),(0,r.A)(this,"firstDTS",d.Dh),(0,r.A)(this,"disposition",0),(0,r.A)(this,"timeBase",(0,o.A)(c.P)),(0,r.A)(this,"sampleIndexes",[]),(0,r.A)(this,"sampleIndexesPosMap",new(a()))}destroy(){this.codecpar&&(this.codecpar.destroy(),(0,l.A)(this.codecpar),this.codecpar=null),this.timeBase&&((0,l.A)(this.timeBase),this.timeBase=null),this.sampleIndexes.length=0,this.sampleIndexesPosMap.clear()}}},95832:(e,t,i)=>{"use strict";i.d(t,{Bq:()=>h,Ij:()=>d,XC:()=>l,f7:()=>u,uF:()=>a});var r=i(77231),s=i(37246);const a={1:"Main",2:"LC",3:"SSR",4:"LTP",5:"HE",6:"SCALABLE",29:"HEv2",23:"LD",39:"ELD"},n={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},o=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,r.N_,r.N_,r.N_],c=[r.N_,1,2,3,4,5,6,7];function l(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t){const{profile:i,sampleRate:s,channels:a}=function(e){let t=r.N_,i=r.N_,s=r.N_;return e.length>=2&&(t=e[0]>>3&31,i=o[(7&e[0])<<1|e[1]>>7],s=c[e[1]>>3&15]),{profile:t,sampleRate:i,channels:s}}(t);e.codecpar.profile=i,e.codecpar.sampleRate=s,e.codecpar.chLayout.nbChannels=a,e.codecpar.frameSize=5===i?2048:1024,e.codecpar.format=8}}function d(e){const t=n[e.sampleRate],i=e.chLayout.nbChannels,s=e.profile===r.N_?2:e.profile,a=new Uint8Array(2);return a[0]=(31&s)<<3|(14&t)>>1,a[1]=(1&t)<<7|(15&i)<<3,a}function h(e){if(e.length<7)return-1;const t=e[0]<<4|e[1]>>4;if(4095!==t)return-1;const i=1&e[1],r=(192&e[2])>>>6,s=(60&e[2])>>>2,a=(1&e[2])<<2|(192&e[3])>>>6,n=(3&e[3])<<11|e[4]<<3|(224&e[5])>>>5,l=3&e[6];let d=1===i?7:9,h=n-d;return{syncWord:t,profile:r+1,sampleRate:o[s],channels:c[a],aacFrameLength:n,numberOfRawDataBlocksInFrame:l,headerLength:d,framePayloadLength:h}}function u(e,t){function i(){const e=t.readU(2);let i=0;for(let r=0;r<=e;r++)i<<=8,i|=t.readU(8);return i}t||(t=new s.A).appendBuffer(e);const r=t.getPointer(),a={syncWord:0,profile:0,sampleRate:0,channels:0,useSameStreamMux:!1,headerLength:0,framePayloadLength:0,muxLengthBytes:0},n=t.readU(11);if(695!==n)return-1;a.syncWord=n,a.muxLengthBytes=t.readU(13);const l=1===t.readU1();if(a.useSameStreamMux=l,!l){const e=1===t.readU1();if(e&&1===t.readU1())return-1;if(e&&i(),1!==t.readU1())return-1;if(0!==t.readU(6))return-1;if(0!==t.readU(4))return-1;if(0!==t.readU(3))return-1;let r=e?i():0;const s=t.readU(5);r-=5;const n=t.readU(4);r-=4;const l=t.readU(4);if(r-=4,t.readU(3),r-=3,r>0&&t.readU(r),0!==t.readU(3))return-1;if(t.readU(8),1===t.readU1())if(e)i();else{let e=0;for(;;){e<<=8;const i=1===t.readU1();if(e+=t.readU(8),!i)break}}1===t.readU1()&&t.readU(8),a.profile=s+1,a.sampleRate=o[n],a.channels=c[l]}let d=0;for(;;){const e=t.readU(8);if(d+=e,255!==e)break}return a.framePayloadLength=d,a.headerLength=t.getPointer()-r+(8===t.getBitLeft()?0:1),a}},87518:(e,t,i)=>{"use strict";i.d(t,{R:()=>f,j:()=>s});var r=i(37246);const s=[3,4,3,7,259,263,1539,1543],a=[[64,69,96],[64,70,96],[80,87,120],[80,88,120],[96,104,144],[96,105,144],[112,121,168],[112,122,168],[128,139,192],[128,140,192],[160,174,240],[160,175,240],[192,208,288],[192,209,288],[224,243,336],[224,244,336],[256,278,384],[256,279,384],[320,348,480],[320,349,480],[384,417,576],[384,418,576],[448,487,672],[448,488,672],[512,557,768],[512,558,768],[640,696,960],[640,697,960],[768,835,1152],[768,836,1152],[896,975,1344],[896,976,1344],[1024,1114,1536],[1024,1115,1536],[1152,1253,1728],[1152,1254,1728],[1280,1393,1920],[1280,1394,1920]],n=[4,5,6,5],o=[4,6,7,6],c=[48e3,44100,32e3,0],l=[32,40,48,56,64,80,96,112,128,160,192,224,256,320,384,448,512,576,640],d=[2,1,2,3,3,4,4,5],h=[1,2,3,6],u=7;function f(e){const t=new r.A(e.length);t.appendBuffer(e);const i={syncWord:0,crc1:0,srCode:0,bitstreamId:0,bitstreamMode:0,channelMode:0,lfeOn:0,frameType:0,substreamId:0,centerMixLevel:0,surroundMixLevel:0,channelMap:0,numBlocks:0,dolbySurroundMode:0,srShift:0,sampleRate:0,bitrate:0,channels:0,frameSize:0,channelLayout:BigInt(0),ac3BitrateCode:0};if(i.syncWord=t.readU(16),2935!==i.syncWord)return-1;if(i.bitstreamId=31&t.peekU(29),i.bitstreamId>16)return-2;if(i.numBlocks=6,i.ac3BitrateCode=-1,i.centerMixLevel=5,i.surroundMixLevel=6,i.dolbySurroundMode=0,i.bitstreamId<=10){if(i.crc1=t.readU(16),i.srCode=t.readU(2),3===i.srCode)return-3;const e=t.readU(6);if(e>37)return-4;i.ac3BitrateCode=e>>1,t.readU(5),i.bitstreamMode=t.readU(3),i.channelMode=t.readU(3),2==i.channelMode?i.dolbySurroundMode=t.readU(2):(1&i.channelMode&&1!=i.channelMode&&(i.centerMixLevel=n[t.readU(2)]),4&i.channelMode&&(i.surroundMixLevel=o[t.readU(2)])),i.lfeOn=t.readU(1),i.srShift=Math.max(i.bitstreamId,8)-8,i.sampleRate=c[i.srCode]>>i.srShift,i.bitrate=1e3*l[i.ac3BitrateCode]>>i.srShift,i.channels=d[i.channelMode]+i.lfeOn,i.frameSize=2*a[e][i.srCode],i.frameType=2,i.substreamId=0}else{if(i.crc1=0,i.frameType=t.readU(2),3==i.frameType)return-5;if(i.substreamId=t.readU(3),i.frameSize=t.readU(11)+1<<1,i.frameSize<u)return-6;if(i.srCode=t.readU(2),3==i.srCode){const e=t.readU(2);if(3==e)return-7;i.sampleRate=c[e]/2,i.srShift=1}else i.numBlocks=h[t.readU(2)],i.sampleRate=c[i.srCode],i.srShift=0;i.channelMode=t.readU(3),i.lfeOn=t.readU(1),i.bitrate=8*i.frameSize*i.sampleRate/(256*i.numBlocks),i.channels=d[i.channelMode]+i.lfeOn}return i.channelLayout=BigInt(s[i.channelMode]),i.lfeOn&&(i.channelLayout|=BigInt(8)),i}},21477:(e,t,i)=>{"use strict";i.d(t,{Ui:()=>n,XC:()=>a,zk:()=>s});var r=i(37246);i(83314),i(97317);const s={0:"Main",1:"High",2:"Professional"};function a(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=4){const i=n(t);e.codecpar.profile=i.profile,e.codecpar.level=i.level}}function n(e){const t=new r.A(e.length);t.appendBuffer(e),t.readU1(),t.readU(7);const i=t.readU(3),s=t.readU(5),a=t.readU1();let n=t.readU1()?10:8;return t.readU1()&&(n=12),{profile:i,level:s,tier:a,bitDepth:n,monochrome:t.readU1(),chromaSubsamplingX:t.readU1(),chromaSubsamplingY:t.readU1(),chromaSamplePosition:t.readU(2)}}},14769:(e,t,i)=>{"use strict";i.d(t,{DK:()=>o,XC:()=>l,Xr:()=>c,jA:()=>a,ob:()=>s,oe:()=>n});var r=i(31865);const s=34,a=8,n=[0,8,12,0,16,20,24,32],o=[0,88200,176400,192e3,8e3,16e3,22050,24e3,32e3,44100,48e3,96e3,0,0,0,0],c=[0,192,576,1152,2304,4608,0,0,256,512,1024,2048,4096,8192,16384,32768];function l(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length===s){const{bitsPerRawSample:i,sampleRate:s,channels:a}=function(e){const t=new r.A(e);t.skip(10);const i=t.readUint24();return{sampleRate:i>>4,channels:1+((15&i)>>>1),bitsPerRawSample:1+((1&i)<<4|(240&t.readUint8())>>>4)}}(t);e.codecpar.bitsPerRawSample=i,e.codecpar.sampleRate=s,e.codecpar.chLayout.nbChannels=a}}},62815:(e,t,i)=>{"use strict";i.d(t,{KD:()=>I,S1:()=>b,XC:()=>T,kM:()=>k,oT:()=>x,sL:()=>w,tZ:()=>y,wf:()=>S});var r=i(63939),s=i(72739),a=i(729),n=i(31865),o=i(37246),c=i(4624),l=i(14686),d=i(60264),h=i(37837),u=i(23991),f=i(39381),p=i(82774);const m="src/avutil/codecs/h264.ts",g=16,v=3,y={66:"Constrained Baseline",77:"Main",100:"High",110:"High10",122:"High422",244:"High444"};function A(e,t,i=[]){e.length>32&&(c.R8(`h264 metadata's sps max length is 32, but get ${e.length}`,m,216),e=e.slice(0,32)),e.length>256&&(c.R8(`h264 metadata's pps max length is 256, but get ${e.length}`,m,220),e=e.slice(0,256));let r=7;r=e.reduce(((e,t)=>e+2+t.length),r),r=t.reduce(((e,t)=>e+2+t.length),r);const n=e[0],o=S(n);66!==o.profile&&77!==o.profile&&88!==o.profile&&(r+=4,i.length&&(r=i.reduce(((e,t)=>e+2+t.length),r)));const l=new Uint8Array(r),d=new a.A(l);return d.writeUint8(1),d.writeUint8(n[1]),d.writeUint8(n[2]),d.writeUint8(n[3]),d.writeUint8(252|v),d.writeUint8(224|31&e.length),s.__(e,(e=>{d.writeUint16(e.length),d.writeBuffer(e)})),d.writeUint8(t.length),s.__(t,(e=>{d.writeUint16(e.length),d.writeBuffer(e)})),66!==o.profile&&77!==o.profile&&88!==o.profile&&(d.writeUint8(252|o.chromaFormatIdc),d.writeUint8(248|o.bitDepthLumaMinus8),d.writeUint8(248|o.bitDepthChromaMinus8),i.length&&s.__(i,(e=>{d.writeUint16(e.length),d.writeBuffer(e)}))),l}function b(e){let t=d.py(e);if(t.length>1){const e=[],i=[],r=[];if(t.forEach((t=>{const s=31&t[0];7===s?e.push(t):8===s?i.push(t):13===s&&r.push(t)})),e.length&&i.length)return A(e,i,r)}}function w(e){let t=d.py(e);if(t.length>1){const e=[],i=[],r=[];if(t.forEach((t=>{const s=31&t[0];7===s?e.push(t):8===s?i.push(t):13===s&&r.push(t)})),e.length&&i.length){const t=[e[0],i[0]];return r.length&&t.push(r[0]),d.nW(t,0)}}}function x(e,t=!1){let i,r=d.py(e),s=!1;if(r.length){const e=[],a=[],n=[];r.forEach((t=>{const i=31&t[0];7===i?e.push(t):8===i?a.push(t):13===i?n.push(t):5===i&&(s=!0)})),e.length&&a.length?(i=A(e,a,n),r=r.filter((e=>{const i=31&e[0];return t?9!==i:9!==i&&8!==i&&7!==i&&13!==i}))):r=r.filter((e=>9!=(31&e[0])))}const a=r.reduce(((e,t)=>e+v+1+t.length),0),n=(0,h.sY)(a),o=(0,l.s3)(n,a);return d.S9(r,v,o),{bufferPointer:n,length:a,key:s,extradata:i}}function k(e,t){let i=d.py(e).concat(d.py(t));if(i.length){const e=[],t=[],r=[],s=[],a=[];return i.forEach((i=>{const n=31&i[0];7===n?e.push(i):8===n?t.push(i):13===n?r.push(i):6===n?s.push(i):9!==n&&a.push(i)})),function(e,t,i,r,s){const a=[d.Le(r,0),d.Le(e,0),d.Le(t,0),d.Le(i,0),d.Le(s,2)];let n=a.reduce(((e,t)=>e+t),0);const o=(0,h.sY)(n+6);let c=o;return p.w8((c+=1,c-1),0),p.w8((c+=1,c-1),0),p.w8((c+=1,c-1),0),p.w8((c+=1,c-1),1),p.w8((c+=1,c-1),9),p.w8((c+=1,c-1),240),r.length&&(d.nW(r,0,(0,l.s3)(c,a[0])),c+=a[0]),e.length&&(d.nW(e,0,(0,l.s3)(c,a[1])),c+=a[1]),t.length&&(d.nW(t,0,(0,l.s3)(c,a[2])),c+=a[2]),i.length&&(d.nW(i,0,(0,l.s3)(c,a[3])),c+=a[3]),s.length&&d.nW(s,2,(0,l.s3)(c,a[4])),{bufferPointer:o,length:n+6}}(e,t,r,s,a)}}function T(e,t){let i;if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&d.Bs(t))s.__(d.py(t),(e=>{if(7==(31&e[0]))return i=e,!1}));else if(t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=3&t[4];const{spss:r}=function(e){const t=new n.A(e);t.skip(5);const i=[],r=[],s=[],a=31&t.readUint8();for(let e=0;e<a;e++){const e=t.readUint16();i.push(t.readBuffer(e))}const o=t.readUint8();for(let e=0;e<o;e++){const e=t.readUint16();r.push(t.readBuffer(e))}if(t.remainingSize()>4){t.skip(3);const e=t.readUint8();if(e>0)for(let i=0;i<e;i++){const e=t.readUint16();s.push(t.readBuffer(e))}}return{spss:i,ppss:r,spsExts:s}}(t);r.length&&(i=r[0])}if(i){const{profile:t,level:r,width:s,height:a,videoDelay:n,chromaFormatIdc:o,bitDepthLumaMinus8:c}=S(i);switch(e.codecpar.profile=t,e.codecpar.level=r,e.codecpar.width=s,e.codecpar.height=a,e.codecpar.videoDelay=n,c){case 0:e.codecpar.format=3===o?5:2===o?4:0;break;case 1:e.codecpar.format=3===o?66:2===o?70:60;break;case 2:e.codecpar.format=3===o?68:2===o?64:62}}}function I(e,t=4){if(64&r.f[15](e+36))return d.py((0,l.s3)(r.f[20](e+24),r.f[15](e+28))).some((e=>5==(31&e[0])));{const i=r.f[15](e+28);let s=0;for(;s<i-t;){if(5==(31&f.r8(r.f[20](e+24)+(s+t))))return!0;s+=4===t?f.Sg(r.f[20](e+24)+s):3===t?f.ht(r.f[20](e+24)+s):2===t?f.yd(r.f[20](e+24)+s):f.r8(r.f[20](e+24)+s),s+=t}return!1}}function S(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);const i=d.BN(e.subarray(t)),r=new o.A(i.length);r.appendBuffer(i),r.readU1(),r.readU(2),r.readU(5);const s=r.readU(8);r.readU1(),r.readU1(),r.readU1(),r.readU1(),r.readU1(),r.readU1(),r.readU(2);const a=r.readU(8);u.xb(r);let n=1,c=0,l=0;if(100==s||110==s||122==s||244==s||44==s||83==s||86==s||118==s||128==s||138==s||139==s||134==s||135==s){function T(e){let t,i=8,s=8;for(let a=0;a<e;a++)0!==s&&(t=u.$x(r),s=(i+t+256)%256),i=0===s?i:s}if(n=u.xb(r),3===n&&r.readU1(),c=u.xb(r),l=u.xb(r),r.readU1(),r.readU1()){const I=new Array(8);for(let S=0;S<(3!=n?8:12);S++)I[S]=r.readU1(),I[S]&&T(S<6?16:64)}}const h=u.xb(r),f=u.xb(r);let p=0,m=0;if(0===f)p=u.xb(r);else if(1===f){m=r.readU1(),u.$x(r),u.$x(r);const P=u.xb(r);for(let _=0;_<P;_++)u.$x(r)}u.xb(r),r.readU1();const v=u.xb(r),y=u.xb(r),A=r.readU1();let b=16*(v+1),w=(2-A)*(y+1)*16;A||r.readU1(),r.readU1();const x=r.readU1();if(x){let M=1,C=2-x;1===n?(M=2,C=2*(2-x)):2===x&&(M=2,C=2-x),b-=M*(u.xb(r)+u.xb(r)),w-=C*(u.xb(r)+u.xb(r))}let k=0;if(r.readU1()){let B=r.readU1();function E(){const e=u.xb(r)+1;r.readU(4),r.readU(4);for(let t=0;t<e;t++)u.xb(r),u.xb(r),r.readU1();r.readU(5),r.readU(5),r.readU(5),r.readU(5)}B&&r.readU(8)>=17&&(r.readU(16),r.readU(16)),B=r.readU1(),B&&r.readU1(),B=r.readU1(),B&&(r.readU(3),r.readU1(),B=r.readU1(),B&&(r.readU(8),r.readU(8),r.readU(8))),B=r.readU1(),B&&(u.xb(r),u.xb(r)),B=r.readU1(),B&&(r.readU(32),r.readU(32),r.readU1());let D=r.readU1();D&&E();let R=r.readU1();R&&E(),(D||R)&&r.readU1(),r.readU1(),B=r.readU1(),B&&(r.readU1(),u.xb(r),u.xb(r),u.xb(r),u.xb(r),k=Math.min(u.xb(r),g))}return{profile:s,level:a,width:b,height:w,chromaFormatIdc:n,bitDepthLumaMinus8:c,bitDepthChromaMinus8:l,frameMbsOnlyFlag:A,picOrderCntType:f,log2MaxPicOrderCntLsbMinus4:p,deltaPicOrderAlwaysZeroFlag:m,log2MaxFrameNumMinus4:h,videoDelay:k}}},67659:(e,t,i)=>{"use strict";i.d(t,{KD:()=>k,S1:()=>y,XC:()=>x,ZU:()=>I,dT:()=>m,kM:()=>w,oT:()=>b,sL:()=>A,wf:()=>T});var r=i(63939),s=i(72739),a=i(729),n=i(31865),o=i(37246),c=i(14686),l=i(60264),d=i(37837),h=i(23991),u=i(39381),f=i(82774);const p=16,m={1:"Main",2:"Main10",3:"MainStillPicture",4:"Main444"},g=3;function v(e,t,i){const r=t[0];let n=23;e.length&&(n+=3,n=e.reduce(((e,t)=>e+2+t.length),n)),t.length&&(n+=3,n=t.reduce(((e,t)=>e+2+t.length),n)),i.length&&(n+=3,n=i.reduce(((e,t)=>e+2+t.length),n));const o=new Uint8Array(n),c=new a.A(o,!0),l=T(r);c.writeUint8(1),c.writeUint8(r[1]),c.writeUint8(r[2]),c.writeUint8(r[3]),c.writeUint8(r[4]),c.writeUint8(r[5]),c.writeUint8(r[6]),c.writeUint8(r[7]),c.writeUint8(r[8]),c.writeUint8(r[9]),c.writeUint8(r[10]),c.writeUint8(r[11]),c.writeUint8(l.level),c.writeUint8(1020),c.writeUint8(0),c.writeUint8(16320),c.writeUint8(16320|l.chroma_format_idc),c.writeUint8(8160|l.bit_depth_luma_minus8),c.writeUint8(8160|l.bit_depth_chroma_minus8),c.writeUint16(0),c.writeUint8(8|(1&r[0])<<2|g);let d=0;return e.length&&d++,t.length&&d++,i.length&&d++,c.writeUint8(d),e.length&&(c.writeUint8(160),c.writeUint16(e.length),s.__(e,(e=>{c.writeUint16(e.length),c.writeBuffer(e)}))),t.length&&(c.writeUint8(161),c.writeUint16(t.length),s.__(t,(e=>{c.writeUint16(e.length),c.writeBuffer(e)}))),i.length&&(c.writeUint8(162),c.writeUint16(i.length),s.__(i,(e=>{c.writeUint16(e.length),c.writeBuffer(e)}))),o}function y(e){let t=l.py(e);if(t.length>=2){const e=[],i=[],r=[];if(t.forEach((t=>{const s=t[0]>>>1&63;32===s?e.push(t):33===s?i.push(t):34===s&&r.push(t)})),i.length&&r.length)return v(e,i,r)}}function A(e){let t=l.py(e);if(t.length>=2){const e=[],i=[],r=[];if(t.forEach((t=>{const s=t[0]>>>1&63;32===s?e.push(t):33===s?i.push(t):34===s&&r.push(t)})),i.length&&r.length){const t=[i[0],r[0]];return e.length&&t.unshift(e[0]),l.nW(t,0)}}}function b(e,t=!1){let i,r=!1,s=l.py(e);if(s.length){const e=[],a=[],n=[];s.forEach((t=>{const i=t[0]>>>1&63;32===i?e.push(t):33===i?a.push(t):34===i&&n.push(t),19!==i&&20!==i&&21!==i||(r=!0)})),a.length&&n.length?(i=v(e,a,n),s=s.filter((e=>{const i=e[0]>>>1&63;return(t||32!==i&&33!==i&&34!==i)&&35!==i}))):s=s.filter((e=>35!=(e[0]>>>1&63)))}const a=s.reduce(((e,t)=>e+g+1+t.length),0),n=(0,d.sY)(a),o=(0,c.s3)(n,a);return l.S9(s,g,o),{bufferPointer:n,length:a,extradata:i,key:r}}function w(e,t){let i=l.py(e).concat(l.py(t));if(i.length){let e=[],t=[],r=[],s=[];return i.forEach((i=>{const a=i[0]>>>1&63;32===a?e.push(i):33===a?t.push(i):34===a?r.push(i):35!==a&&s.push(i)})),function(e,t,i,r){const s=[l.Le(e,0),l.Le(t,0),l.Le(i,0),l.Le(r,2)];let a=s.reduce(((e,t)=>e+t),0);const n=(0,d.sY)(a+7);let o=n;return f.w8((o+=1,o-1),0),f.w8((o+=1,o-1),0),f.w8((o+=1,o-1),0),f.w8((o+=1,o-1),1),f.w8((o+=1,o-1),70),f.w8((o+=1,o-1),1),f.w8((o+=1,o-1),80),e.length&&(l.nW(e,0,(0,c.s3)(o,s[0])),o+=s[0]),t.length&&(l.nW(t,0,(0,c.s3)(o,s[1])),o+=s[1]),i.length&&(l.nW(i,0,(0,c.s3)(o,s[2])),o+=s[2]),r.length&&l.nW(r,2,(0,c.s3)(o,s[3])),{bufferPointer:n,length:a+7}}(e,t,r,s)}}function x(e,t){let i;if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&l.Bs(t))s.__(l.py(t),(e=>{if(33==(e[0]>>>1&63))return i=e,!1}));else if(t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=3&t[21];const{spss:r}=function(e){const t=new n.A(e,!0);t.skip(22);let i=[],r=[],s=[];const a=t.readUint8();for(let e=0;e<a;e++){const e=63&t.readUint8(),a=t.readUint16(),n=[];for(let e=0;e<a;e++){const e=t.readUint16();n.push(t.readBuffer(e))}32===e?i=n:33===e?r=n:34===e&&(s=n)}return{vpss:i,spss:r,ppss:s}}(t);r.length&&(i=r[0])}if(i){const{profile:t,level:r,width:s,height:a,video_delay:n,chroma_format_idc:o,bit_depth_luma_minus8:c}=T(i);switch(e.codecpar.profile=t,e.codecpar.level=r,e.codecpar.width=s,e.codecpar.height=a,e.codecpar.videoDelay=n,c){case 0:e.codecpar.format=3===o?5:2===o?4:0;break;case 2:e.codecpar.format=3===o?68:2===o?64:62}}}function k(e,t=4){if(64&r.f[15](e+36))return l.py((0,c.s3)(r.f[20](e+24),r.f[15](e+28))).some((e=>{const t=e[0]>>>1&63;return 20===t||19===t}));{const i=r.f[15](e+28);let s=0;for(;s<i-t;){const i=u.r8(r.f[20](e+24)+(s+t))>>>1&63;if(20===i||19===i)return!0;s+=4===t?u.Sg(r.f[20](e+24)+s):3===t?u.ht(r.f[20](e+24)+s):2===t?u.yd(r.f[20](e+24)+s):u.r8(r.f[20](e+24)+s),s+=t}return!1}}function T(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);let i=0,r=0,s=0,a=0,n=0,c=0,d=1,u=0,f=0,m=0,g=0;const v=l.BN(e.subarray(t)),y=new o.A(v.length);y.appendBuffer(v),y.readU1(),y.readU(6),y.readU(6),y.readU(3),y.readU(4);const A=y.readU(3);y.readU1();let b=0;if(A<=6){u=y.readU(2),f=y.readU1(),i=y.readU(5),m=y.readU(32),g=y.readU(48),r=y.readU(8);const e=new Array(6),t=new Array(6);for(let i=0;i<A;i++)e[i]=y.readU1(),t[i]=y.readU1();if(A>0)for(let e=A;e<8;e++)y.readU(2);for(let i=0;i<A;i++)e[i]&&(y.readU(2),y.readU(1),y.readU(5),y.readU(32),y.readU(1),y.readU(1),y.readU(1),y.readU(1),y.readU(44)),t[i]&&y.readU(8);h.xb(y),d=h.xb(y),3===d&&(b=y.readU(1)),s=h.xb(y),a=h.xb(y);let o=0,l=0,p=0,v=0;y.readU1()&&(o=h.xb(y),l=h.xb(y),p=h.xb(y),v=h.xb(y)),n=h.xb(y),c=h.xb(y);let w=2,x=2;0===d?w=x=0:2===d?(w=2,x=1):3===d&&(w=x=1),s-=w*(1<<n+1)*(o+l),a-=x*(1<<n+1)*(p+v)}const w=h.xb(y)+4;let x=0;for(let e=y.readU1()?0:A;e<A+1;e++)h.xb(y),x=Math.max(x,Math.min(h.xb(y),p)),h.xb(y);const k=h.xb(y)+3,T=h.xb(y),I=h.xb(y)+2,S=h.xb(y),P=k+T,_=k-1,M=s+(1<<P)-1>>P,C=a+(1<<P)-1>>P;return{profile:i,level:r,width:s,height:a,chroma_format_idc:d,bit_depth_luma_minus8:n,bit_depth_chroma_minus8:c,general_profile_space:u,general_tier_flag:f,general_profile_compatibility_flags:m,constraint_flags:g,separate_colour_plane_flag:b,log2_min_cb_size:k,log2_diff_max_min_coding_block_size:T,log2_min_tb_size:I,log2_diff_max_min_transform_block_size:S,log2_max_trafo_size:S+I,log2_ctb_size:P,log2_min_pu_size:_,ctb_width:M,ctb_height:C,ctb_size:M*C,min_cb_width:s>>k,min_cb_height:a>>k,min_tb_width:s>>I,min_tb_height:a>>I,min_pu_width:s>>_,min_pu_height:a>>_,log2_max_poc_lsb:w,video_delay:x}}function I(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);const i=l.BN(e.subarray(t)),r=new o.A(i.length);return r.appendBuffer(i),{pps_pic_parameter_set_id:h.xb(r),pps_seq_parameter_set_id:h.xb(r),dependent_slice_segment_flag:r.readU1(),output_flag_present_flag:r.readU1(),num_extra_slice_header_bits:r.readU(3)}}},64093:(e,t,i)=>{"use strict";i.d(t,{Au:()=>y,He:()=>A,XC:()=>b,Y2:()=>m,hG:()=>g,oz:()=>v});var r=i(77231);const s=[44100,48e3,32e3,0],a=[22050,24e3,16e3,0],n=[11025,12e3,8e3,0],o=[0,1152,1152,384],c=[0,576,1152,384],l=[0,576,1152,384],d=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],h=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],u=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],f=[0,32,48,56,64,80,96,112,128,144,160,176,192,224,256,-1],p=[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1];function m(e,t){switch(e){case 0:return n[t];case 2:return a[t];case 3:return s[t]}return r.N_}function g(e,t){switch(e){case 0:return l[t];case 2:return c[t];case 3:return o[t]}return r.N_}function v(e,t,i){switch(t){case 1:switch(e){case 0:case 2:return p[i];case 3:return u[i]}break;case 2:switch(e){case 0:case 2:return p[i];case 3:return h[i]}case 3:switch(e){case 0:case 2:return f[i];case 3:return d[i]}}return r.N_}function y(e){switch(e){case 1:return 34;case 2:return 33;case 3:return 32}return r.N_}const A={32:"Layer1",33:"Layer2",34:"Layer3"};function b(e,t){if(t&&t.length>=4){const i=t[1]>>>3&3,r=(6&t[1])>>1,s=(12&t[2])>>>2,a=3&~(t[3]>>>6)?2:1,n=y(r),o=m(i,s);e.codecpar.profile=n,e.codecpar.sampleRate=o,e.codecpar.chLayout.nbChannels=a}}},74762:(e,t,i)=>{"use strict";i.d(t,{q:()=>o});var r=i(79331),s=i(67672),a=i(72739),n=i(54825);function o(e){const t=(0,r.A)(e,{aloneValueName:"context"});if(!t.tt)return{queue:[],head:{}};const i=[];function o(e){let t="";return a.__(e,(e=>{s.Yj(e)?t+=e:e.context?t+=`<${e.tagName}>${e.context}</${e.tagName}>`:t+=`<${e.tagName}/>`})),t}function c(e,t,r){let c=(0,n.j)(t||e.begin),l=e.context||"",d=e.region||"Default",h="";s.YO(l)&&(l=o(l)),s.YO(e.span)?a.__(e.span,(e=>{e.context&&(c===-BigInt(1)&&e.begin&&(c=(0,n.j)(e.begin)),!d&&e.region&&(d=e.region),s.Yj(e.context)?(l+=e.context,e.br&&(l+="<br>")):(l+=o(e.context),e.br&&(l+="<br>"))),e.end&&(h=e.end)})):e.span&&(e.span.context&&(c===-BigInt(1)&&e.span.begin&&(c=(0,n.j)(e.span.begin)),!d&&e.span.region&&(d=e.span.region),s.Yj(e.span.context)?l+=e.span.context:l+=o(e.span.context)),e.span.end&&(h=e.span.end)),i.push({context:l,pts:c,region:d,duration:e.dur?(0,n.j)(e.dur):(0,n.j)(r||e.end||h)-c})}function l(e,t,i){s.YO(e)?a.__(e,(e=>{c(e,t,i)})):c(e,t,i)}return t.tt.body&&t.tt.body.div&&(s.YO(t.tt.body.div)?a.__(t.tt.body.div,(e=>{e.p&&l(e.p,e.begin,e.end)})):t.tt.body.div.p&&l(t.tt.body.div.p,t.tt.body.div.begin,t.tt.body.end)),{queue:i,head:t.tt.head||{}}}},97077:(e,t,i)=>{"use strict";i.d(t,{Ui:()=>a,XC:()=>s});var r=i(37246);function s(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){const i=a(t);e.codecpar.profile=i.profile,e.codecpar.level=i.level}}function a(e){const t=new r.A(e.length);return t.appendBuffer(e.subarray(4)),{profile:t.readU(8),level:t.readU(8),bitDepth:t.readU(4),chromaSubsampling:t.readU(3),fullRangeFlag:t.readU1(),colorPrimaries:t.readU(8),colorTrc:t.readU(8),colorSpace:t.readU(8)}}},82014:(e,t,i)=>{"use strict";i.d(t,{Ui:()=>n,XC:()=>a,wN:()=>s}),i(9599);var r=i(37246);i(77231),i(97317),i(44328),i(729);const s={0:"Profile0",1:"Profile1",2:"Profile2",3:"Profile3"};function a(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){const i=n(t);e.codecpar.profile=i.profile,e.codecpar.level=i.level}}function n(e){const t=new r.A(e.length);return t.appendBuffer(e),{profile:t.readU(8),level:t.readU(8),bitDepth:t.readU(4),chromaSubsampling:t.readU(3),fullRangeFlag:t.readU1(),colorPrimaries:t.readU(8),colorTrc:t.readU(8),colorSpace:t.readU(8)}}},59166:(e,t,i)=>{"use strict";i.d(t,{KD:()=>k,S1:()=>y,Ui:()=>I,XC:()=>x,kM:()=>w,oT:()=>b,sL:()=>A,wf:()=>T});var r=i(63939),s=i(72739),a=i(729),n=i(31865),o=i(37246),c=i(14686),l=i(60264),d=i(37837),h=i(23991),u=i(83314),f=i(39381),p=i(82774);const m=3;function g(e){const t=e.readU(9),i=e.readU(3),r=e.readU(2),s=e.readU(2),a=e.readU(3);e.readU(5),e.readU(2);const n=e.readU(6),o=e.readU(7),c=e.readU(1),l=e.readU(8),d=e.readU(1),h=e.readU(1),u=[],f=[];if(n){for(let t=0;t<n-1;t++)u[t]=e.readU(8);u[n-1]=e.readU(6)}else e.readU(6);if(i>1){let t=0;for(let r=i-2;r>=0;--r)t|=e.readU(1)<<r;for(let t=i;t<=8&&i>1;++t)e.readU(1);for(let r=i-2;r>=0;--r)t&1<<r&&(f[r]=e.readU(8))}const p=e.readU(8),m=[];if(p)for(let t=0;t<p;t++)m.push(e.readU(8));return{olsIdx:t,numSublayers:i,bitDepthMinus8:a,chromaFormatIdc:s,constantFrameRate:r,generalProfileIdc:o,generalTierFlag:c,generalLevelIdc:l,ptlFrameOnlyConstraintFlag:d,ptlMultilayerEnabledFlag:h,generalConstraintInfo:u,sublayerLevelIdc:f,generalSubProfileIdc:m,maxPictureWidth:e.readU(16),maxPictureHeight:e.readU(16),avgFramerate:e.readU(16)}}function v(e,t,i){const r=t[0];let n;if(r){const e=T(r);let t=e.generalConstraintInfo;t.length||(t=new Array(12).fill(0));const i=new u.A;if(i.writeU(9,0),i.writeU(3,e.spsMaxSublayersMinus1+1),i.writeU(2,1),i.writeU(2,e.chromaFormatIdc),i.writeU(3,e.bitDepthMinus8),i.writeU(5,31),i.writeU(2,0),i.writeU(6,t.length),i.writeU(7,e.profile),i.writeU1(e.tierFlag),i.writeU(8,e.level),i.writeU1(e.ptlFrameOnlyConstraintFlag),i.writeU1(e.ptlMultilayerEnabledFlag),t.length){for(let e=0;e<t.length-1;e++)i.writeU(8,t[e]);i.writeU(6,t[t.length-1])}else i.writeU(6,63);if(e.spsMaxSublayersMinus1+1>1){let t=0;for(let i=e.spsMaxSublayersMinus1-1;i>=0;i--)t=t<<1|e.ptlSublayerLevelPresentFlag[i];i.writeU(e.spsMaxSublayersMinus1,t);for(let t=e.spsMaxSublayersMinus1+1;t<=8&&e.spsMaxSublayersMinus1>0;++t)i.writeU1(0);for(let t=e.spsMaxSublayersMinus1-1;t>=0;t--)e.ptlSublayerLevelPresentFlag[t]&&i.writeU(8,e.sublayerLevelIdc[t])}i.writeU(8,e.generalSubProfileIdc.length);for(let t=0;t<e.generalSubProfileIdc.length;t++)i.writeU(8,e.sublayerLevelIdc[t]);i.writeU(16,e.width),i.writeU(16,e.height),i.writeU(16,0),i.padding(),n=i.getBuffer().subarray(0,i.getPointer())}let o=2+(n?n.length:0);e.length&&(o+=3,o=e.reduce(((e,t)=>e+2+t.length),o)),t.length&&(o+=3,o=t.reduce(((e,t)=>e+2+t.length),o)),i.length&&(o+=3,o=i.reduce(((e,t)=>e+2+t.length),o));const c=new Uint8Array(o),l=new a.A(c,!0);l.writeUint8(m<<1|(n?1:0)|248),n&&l.writeBuffer(n);let d=0;return e.length&&d++,t.length&&d++,i.length&&d++,l.writeUint8(d),e.length&&(l.writeUint8(142),l.writeUint16(e.length),s.__(e,(e=>{l.writeUint16(e.length),l.writeBuffer(e)}))),t.length&&(l.writeUint8(143),l.writeUint16(t.length),s.__(t,(e=>{l.writeUint16(e.length),l.writeBuffer(e)}))),i.length&&(l.writeUint8(144),l.writeUint16(i.length),s.__(i,(e=>{l.writeUint16(e.length),l.writeBuffer(e)}))),c}function y(e){let t=l.py(e);if(t.length>=2){const e=[],i=[],r=[];if(t.forEach((t=>{const s=t[1]>>>3&31;14===s?e.push(t):15===s?i.push(t):16===s&&r.push(t)})),i.length&&r.length)return v(e,i,r)}}function A(e){let t=l.py(e);if(t.length>=2){const e=[],i=[],r=[];if(t.forEach((t=>{const s=t[1]>>>3&31;14===s?e.push(t):15===s?i.push(t):16===s&&r.push(t)})),i.length&&r.length){const t=[i[0],r[0]];return e.length&&t.unshift(e[0]),l.nW(t,0)}}}function b(e,t=!1){let i,r=!1,s=l.py(e);if(s.length){const e=[],a=[],n=[];s.forEach((t=>{const i=t[1]>>>3&31;14===i?e.push(t):15===i?a.push(t):16===i&&n.push(t),8!==i&&7!==i&&9!==i&&10!==i||(r=!0)})),a.length&&n.length?(i=v(e,a,n),s=s.filter((e=>{const i=e[1]>>>3&31;return(t||14!==i&&15!==i&&16!==i)&&20!==i}))):s=s.filter((e=>20!=(e[1]>>>3&31)))}const a=s.reduce(((e,t)=>e+m+1+t.length),0),n=(0,d.sY)(a),o=(0,c.s3)(n,a);return l.S9(s,m,o),{bufferPointer:n,length:a,extradata:i,key:r}}function w(e,t){let i=l.py(e).concat(l.py(t));if(i.length){let e=[],t=[],r=[],s=[];return i.forEach((i=>{const a=i[1]>>>3&31;14===a?e.push(i):15===a?t.push(i):16===a?r.push(i):20!==a&&s.push(i)})),function(e,t,i,r,s){const a=[l.Le(e,0),l.Le(t,0),l.Le(i,0),l.Le(r,2)];let n=a.reduce(((e,t)=>e+t),0);const o=(0,d.sY)(n+7);let h=o;return p.w8((h+=1,h-1),0),p.w8((h+=1,h-1),0),p.w8((h+=1,h-1),0),p.w8((h+=1,h-1),1),p.w8((h+=1,h-1),0),p.w8((h+=1,h-1),161),p.w8((h+=1,h-1),(s?1:0)<<7|40),e.length&&(l.nW(e,0,(0,c.s3)(h,a[0])),h+=a[0]),t.length&&(l.nW(t,0,(0,c.s3)(h,a[1])),h+=a[1]),i.length&&(l.nW(i,0,(0,c.s3)(h,a[2])),h+=a[2]),r.length&&l.nW(r,2,(0,c.s3)(h,a[3])),{bufferPointer:o,length:n+7}}(e,t,r,s,!0)}}function x(e,t){let i;if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&l.Bs(t))s.__(l.py(t),(e=>{if(15==(e[1]>>>3&31))return i=e,!1}));else if(t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=t[0]>>>1&3;const{spss:r}=function(e){const t=new n.A(e,!0);if(1&t.readUint8()){const i=new o.A;i.appendBuffer(e.subarray(1)),g(i),t.skip(i.getPointer())}let i=[],r=[],s=[];const a=t.readUint8();for(let e=0;e<a;e++){const e=31&t.readUint8();let a=1;13!==e&&12!==e&&(a=t.readUint16());const n=[];for(let e=0;e<a;e++){const e=t.readUint16();n.push(t.readBuffer(e))}14===e?i=n:15===e?r=n:16===e&&(s=n)}return{vpss:i,spss:r,ppss:s}}(t);r.length&&(i=r[0])}i&&function(e,t){const{profile:i,level:r,width:s,height:a,videoDelay:n,chromaFormatIdc:o,bitDepthMinus8:c}=T(t);switch(e.codecpar.profile=i,e.codecpar.level=r,e.codecpar.width=s,e.codecpar.height=a,e.codecpar.videoDelay=n,c){case 0:e.codecpar.format=3===o?5:2===o?4:0;break;case 2:e.codecpar.format=3===o?68:2===o?64:62}}(e,i)}function k(e,t=4){if(64&r.f[15](e+36))return l.py((0,c.s3)(r.f[20](e+24),r.f[15](e+28))).some((e=>{const t=e[1]>>>3&31;return 8===t||7===t}));{const i=r.f[15](e+28);let s=0;for(;s<i-t;){const i=f.r8(r.f[20](e+24)+(s+t+1))>>>3&31;if(8===i||7===i)return!0;s+=4===t?f.Sg(r.f[20](e+24)+s):3===t?f.ht(r.f[20](e+24)+s):2===t?f.yd(r.f[20](e+24)+s):f.r8(r.f[20](e+24)+s),s+=t}return!1}}function T(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);let i=0,r=0,s=0,a=0,n=0,c=1,d=0,u=0,f=0;const p=[],m=[],g=[],v=[],y=l.BN(e.subarray(t)),A=new o.A(y.length);A.appendBuffer(y),A.readU1(),A.readU1(),A.readU(6),A.readU(5),A.readU(3),A.readU(8);const b=A.readU(3);c=A.readU(2);const w=A.readU(2);if(A.readU(1)){if(i=A.readU(7),d=A.readU(1),r=A.readU(8),u=A.readU(1),f=A.readU(1),A.readU(1)){for(let e=0;e<8;e++)p[e]=A.readU(8);p[8]=A.readU(7);const e=A.readU(8);A.readU(e)}A.skipPadding();for(let e=b-1;e>=0;e--)m[e]=A.readU(1);A.skipPadding();for(let e=b-1;e>=0;e--)m[e]&&(g[e]=A.readU(8));const e=A.readU(8);if(e)for(let t=0;t<e;t++)v[t]=A.readU(32)}A.readU1(),A.readU1()&&A.readU1();const x=s=h.xb(A),k=a=h.xb(A);if(A.readU1()&&(h.xb(A),h.xb(A),h.xb(A),h.xb(A)),A.readU1()){const e=h.xb(A),t=w+5,i=1<<t,r=x/(1<<t),s=k/(1<<t),a=Math.ceil(Math.log2(r)),n=Math.ceil(Math.log2(s));let o=0,c=0,l=0;e>0&&(l=A.readU1(),c=A.readU1());for(let t=0;e>0&&t<=e;t++)c&&0!=t||(t>0&&x>i&&A.readU(a),t>0&&k>i&&A.readU(n),t<e&&x>i&&A.readU(a),t<e&&k>i&&A.readU(n)),l||A.readU(2);if(o=h.xb(A)+1,A.readU(1)&&A.readU(1))for(let t=0;t<=e;t++)A.readU(o)}n=h.xb(A),A.readU(1),A.readU(1);const T=A.readU(4),I=A.readU(1);let S=0;I&&(S=h.xb(A));const P=[],_=A.readU(2);for(let e=0;e<8*_;e++)P[e]=A.readU(1);return{profile:i,level:r,width:s,height:a,videoDelay:b+1>2?2:b,chromaFormatIdc:c,bitDepthMinus8:n,generalProfileSpace:0,tierFlag:d,generalConstraintInfo:p,generalSubProfileIdc:v,ptlFrameOnlyConstraintFlag:u,ptlMultilayerEnabledFlag:f,spsMaxSublayersMinus1:b,ptlSublayerLevelPresentFlag:m,sublayerLevelIdc:g,sps_log2_max_pic_order_cnt_lsb_minus4:T,sps_poc_msb_cycle_flag:I,sps_poc_msb_cycle_len_minus1:S,sps_num_extra_ph_bytes:_,sps_extra_ph_bit_present_flag:P}}function I(e){l.Bs(e)&&(e=y(e));const t=new o.A;return t.appendBuffer(e),1&t.readU(8)?g(t):{}}},77231:(e,t,i)=>{"use strict";i.d(t,{Dh:()=>s,FQ:()=>u,H3:()=>c,KR:()=>d,N_:()=>a,SF:()=>n,WT:()=>l,f7:()=>g,go:()=>f,i0:()=>h,qs:()=>o,vh:()=>p,zg:()=>m});var r=i(9599);const s=-BigInt(1),a=-1,n=1e6,o=1e3,c=1e9,l=BigInt(2208988800)*BigInt(1e6),d=new r.P({den:n,num:1}),h=new r.P({den:o,num:1}),u=new r.P({den:c,num:1}),f=(new r.P({den:1,num:1}),2147483647),p=BigInt(0x8000000000000000),m=65535,g=4294967295;BigInt(0x10000000000000000)},9705:(e,t,i)=>{"use strict";i.d(t,{E$:()=>r,LR:()=>s,LT:()=>l,NU:()=>h,OY:()=>c,UY:()=>a,gR:()=>n,lh:()=>o,nr:()=>u,r8:()=>d});const r=-1,s=-2,a=-3,n=-4,o=-5,c=-6,l=-7,d=-8,h=-9,u=-10},49032:(e,t,i)=>{"use strict";async function r(e,t=-1){let i=await e.peekString(8);if(/^FLV/.test(i))return 0;if(/^DKIF/.test(i))return 5;if(/^ftyp/.test(i.slice(4,8)))return 1;if(/^OggS/.test(i))return 4;if(/^ID3/.test(i))return 14;if(/^fLaC/.test(i))return 17;if(/^RIFF/.test(i)){const t=(await e.peekString(12)).slice(8);if(/^WAVE/.test(t))return 16;if(/^AVI/.test(t))return 10}else{if(/^ADIF/.test(i))return 15;if(440786851===await e.peekUint32())return 8;if(/^WEBVTT/.test(i))return 18;if(/^LIMA/.test(i))return await e.skip(4),await e.readUint16();{const t=await e.peekBuffer(2);switch(t[0]){case 86:if(!(224&~t[1]))return 15;break;case 255:if(240==(246&t[1]))return 15;if([242,244,246,250,252].includes(254&t[1]))return 14}}}return t}i.d(t,{A:()=>r})},364:(e,t,i)=>{"use strict";i.d(t,{A:()=>d});var r=i(62751),s=i(92647),a=i(95335),n=i(50011),o=i(8507),c=i(72739);const l=["php","asp","aspx","jsp","do","pl"];async function d(e,t="",i={}){let d,h="",u={url:e};if(/^rtsp/.test(e)||/^rtmp/.test(e)){/^rtsp/.test(e)?h="rtsp":/^rtmp/.test(e)&&(h="rtmp"),d=2;const t=o.qg(e).protocol.split("+")[1]||"wss";"wss"===t||"ws"===t?d=2:"webtransport"===t&&(d=3),u.url=u.url.replace(/^\S+:\/\//,t+"://"),"rtmp"===h&&(u.subProtocol=d,d=6)}else{var f;const u=o.qg(e).protocol;h=t||o.qg(e).file.split(".").pop(),h&&!c.zy(l,h)||!/^https?/.test(u)||(h=await async function(e,t={}){const i={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};let r;t.headers&&a.__(t.headers,((e,t)=>{i.headers[t]=e})),t.credentials&&(i.credentials=t.credentials),t.referrerPolicy&&(i.referrerPolicy=t.referrerPolicy),"function"==typeof AbortController&&(r=new AbortController,i.signal=r.signal);const o=await fetch(e,i);if(o.ok&&o.status>=200&&o.status<=299){const e=o.body.getReader(),t=[];let i=0;for(;;){let r=await e.read();if(r.done)break;if(i+=r.value.length,t.push(r.value),i>=100)break}if(r&&r.abort(),t.length){const e=t.length>1?(0,s.A)(Uint8Array,t):t[0];if(e.length){const t=n.decode(e.subarray(0,100));if(/<\?xml/.test(t)){if(t.indexOf("<MPD")>-1)return"mpd"}else if(/#EXTM3U/.test(t))return"m3u8"}}}return""}(e,i));let p=0;"wss"===u||"ws"===u?p=2:"webtransport"===u&&(p=3),d=null!==(f=r.$$[h])&&void 0!==f?f:p}return{type:d,ext:h,info:u}}},36204:(e,t,i)=>{"use strict";i.d(t,{t:()=>l});var r=i(63939),s=i(50932),a=i(56024),n=i(66788),o=i(14686),c=i(77231);function l(e,t=0){0===t&&(t=(0,a.FP)()),s.M[15](t+152,e.sampleRate),s.M[15](t+76,e.numberOfFrames),s.M[15](t+292,e.numberOfChannels),s.M[15](t+80,function(e){switch(e){case"u8":return 0;case"s16":return 1;case"s32":return 2;case"f32":return 3;case"u8-planar":return 5;case"s16-planar":return 6;case"s32-planar":return 7;case"f32-planar":return 8;default:throw new Error("not support")}}(e.format)),s.M[17](t+104,e.timestamp<0?c.Dh:BigInt(Math.floor(e.timestamp))),s.M[17](t+312,BigInt(Math.floor(e.duration))),s.M[15](t+124,c.SF),s.M[15](t+120,1),(0,a.rh)(t);const i=(0,n.K0)(r.f[15](t+80))?r.f[15](t+292):1;for(let s=0;s<i;s++)e.copyTo((0,o.s3)(r.f[20](r.f[20](t+64)+4*s),r.f[15](t+32)),{planeIndex:s});return t}},89188:(e,t,i)=>{"use strict";i.d(t,{pt:()=>h});var r=i(63939),s=(i(9599),i(97317)),a=i(44328),n=i(77231),o=i(11473),c=i(95335);function l(e){switch(e){case 0:return"I420";case 33:return"I420A";case 4:return"I422";case 5:return"I444";case 28:return"BGRA";case 26:return"RGBA";case 23:return"NV12";default:return null}}function d(e){const t={fullRange:!1,matrix:null,primaries:null,transfer:null};switch(r.f[15](e+220)){case 1:default:t.matrix="bt709";break;case 6:t.matrix="smpte170m";break;case 5:t.matrix="bt470bg";break;case 0:t.matrix="rgb"}switch(r.f[15](e+212)){case 1:default:t.primaries="bt709";break;case 5:t.primaries="bt470bg";break;case 6:t.primaries="smpte170m"}switch(r.f[15](e+216)){case 1:default:t.transfer="bt709";break;case 13:t.transfer="iec61966-2-1";break;case 6:t.transfer="smpte170m"}return 2===r.f[15](e+208)&&(t.fullRange=!0),t}function h(e,t,i={}){let h=r.f[15](e+72);const u=(0,s.I)(r.f[15](e+80)),f=[];for(let t=0;t<u.comp.length;t++)f.push({offset:r.f[20](e+4*t),stride:r.f[15](e+32+4*t)});const p=c.X$({codedWidth:r.f[15](e+68),codedHeight:h,timestamp:Number(t||(0,a.Mr)(r.f[17](e+104),e+120,n.KR)),format:l(r.f[15](e+80)),duration:Number((0,a.Mr)(r.f[17](e+312),e+120,n.KR)),layout:f,colorSpace:d(e),visibleRect:{x:r.f[25](e+276),y:r.f[25](e+268),width:r.f[15](e+68)-(r.f[25](e+276)+r.f[25](e+280)),height:r.f[15](e+72)-(r.f[25](e+268)+r.f[25](e+272))}},i);return new VideoFrame((0,o.Lv)(),p)}},22898:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(63939),s=(i(9599),i(44328)),a=i(14686),n=i(77231);function o(e){const t=1&r.f[15](e+36);return new EncodedAudioChunk({type:t?"key":"delta",timestamp:r.f[17](e+8)===n.Dh?n.N_:Number((0,s.Mr)(r.f[17](e+8),e+72,n.KR)),data:(0,a.s3)(r.f[20](e+24),r.f[15](e+28))})}},28917:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(63939),s=(i(9599),i(44328)),a=i(14686),n=i(77231);function o(e){const t=1&r.f[15](e+36);return new EncodedVideoChunk({type:t?"key":"delta",timestamp:r.f[17](e+8)===n.Dh?n.N_:Number((0,s.Mr)(r.f[17](e+8),e+72,n.KR)),data:(0,a.s3)(r.f[20](e+24),r.f[15](e+28))})}},94561:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(26429),s=i(76045),a=i(67672);async function n(e,t=!1){let i;return a.Yj(e)||a.sv(e)?(i=await(0,s.A)({source:e}),r.USE_THREADS&&t&&(i.threadModule=await(0,s.A)({source:i.buffer},{child:!0})),delete i.buffer):i=e,i}},79756:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(63939),s=i(62751);function a(e){const t=r.f[15](e+4);let i=r.f[15](e+48),a=s.os[t];return 86018===t&&(a=`${a}.${i}`),a||"unknown"}},39365:(e,t,i)=>{"use strict";i.d(t,{C:()=>s});var r=i(86834);function s(e){return e?!r.A.chrome||r.A.checkVersion(r.A.majorVersion,"94",!0)?"prefer-hardware":"allow":!r.A.chrome||r.A.checkVersion(r.A.majorVersion,"94",!0)?"prefer-software":"deny"}},28875:(e,t,i)=>{"use strict";i.d(t,{A:()=>m});var r=i(63939),s=i(62751),a=i(21477),n=i(97077),o=i(82014),c=i(59166),l=i(67659),d=i(20525),h=i(77231),u=i(14686),f=i(90932),p=i(60264);function m(e,t){const i=r.f[15](e+4);let m=r.f[15](e+48),g=r.f[15](e+52);!t&&0!==r.f[20](e+12)&&r.f[15](e+16)&&(t=(0,u.s3)(r.f[20](e+12),r.f[15](e+16)));let v=s.os[i],y="";if(27===i)110===m&&(m=100),y=d.GP("%s.%02x00%02x",v,255&m,255&g);else if(173===i){let e=0,i=0,r=0,s=0;t&&(p.Bs(t)&&(t=l.S1(t)),t.length>13&&(e=t[1]>>>6&3,r=t[1]>>>5&1,i=t[2]|t[3]<<8|t[4]<<16|t[5]<<24,s=240&t[6]));const a={0:"",1:"A",2:"B",3:"C"};y=d.GP("%s.%s%d.%x.%s%d.%x",v,a[e],m,i,0===r?"L":"H",g,s)}else if(196===i){var A;let e=0;if((null===(A=t)||void 0===A?void 0:A.length)>13&&(e=1&t[5]),y=d.GP("%s.%d.%s%d",v,m,0===e?"L":"H",g),t){p.Bs(t)&&(t=c.S1(t));const e=c.Ui(t);if(e.generalConstraintInfo.length){let t=e.generalConstraintInfo.length-1;for(;t>0&&0===e.generalConstraintInfo[t];)t--;const i=e.generalConstraintInfo.slice(0,t+1);i.length&&(y+=`.C${f.l(new Uint8Array(i),!1)}`)}e.generalSubProfileIdc.length&&(y+=`.S${e.generalSubProfileIdc.map((e=>e.toString(16))).join("+")}`),y+=`.O${e.olsIdx}+${e.numSublayers}`}}else if(225===i)if(t){const e=a.Ui(t);y=d.GP("%s.%d.%02d%s.%02d.%d.%d%d%d",v,e.profile,e.level,e.tier?"H":"M",e.bitDepth,e.monochrome,e.chromaSubsamplingX,e.chromaSubsamplingY,e.chromaSamplePosition)}else y=d.GP("%s.%d.%02dM.08",v,m,g);else if(139===i)if(t){const e=n.Ui(t);y=d.GP("%s.%02d.%02d.%02d",v,e.profile,e.level,e.bitDepth)}else y=m!==h.N_&&g!==h.N_?d.GP("%s.%02d.%02d.08",v,m,g):v;else if(167===i)if(t){const e=o.Ui(t);y=d.GP("%s.%02d.%02d.%02d.%02d.%02d.%02d.%02d.%02d",v,e.profile,e.level,e.bitDepth,e.chromaSubsampling,e.colorPrimaries,e.colorTrc,e.colorSpace,e.fullRangeFlag)}else y=m!==h.N_&&g!==h.N_?d.GP("%s.%02d.%02d.08.00",v,m,g):d.GP("%s.%02d.%02d.08.00",v,0,40);else y=v||"unknown";return y}},67603:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(4919);let s=WebAssembly.validate((0,r.E_)("AGFzbQEAAAABBgFgAX8BfwISAQNlbnYGbWVtb3J5AgMBgIACAwIBAAcJAQVsb2FkOAAACgoBCAAgAP4SAAAL")),a=WebAssembly.validate((0,r.E_)("AGFzbQEAAAABBQFgAAF7AhIBA2VudgZtZW1vcnkCAwGAgAIDAgEACgoBCABBAP0ABAAL"));function n(e,t,i){let r=a?"-simd":s?"-atomic":"";switch(t){case"decoder":if(i>65536&&i<=65572)return`${e}/decode/pcm${r}.wasm`;if(i>=69632&&i<=69683)return`${e}/decode/adpcm${r}.wasm`;switch(i){case 2:return`${e}/decode/mpeg2video${r}.wasm`;case 27:return`${e}/decode/h264${r}.wasm`;case 30:return`${e}/decode/theora${r}.wasm`;case 86018:return`${e}/decode/aac${r}.wasm`;case 86019:return`${e}/decode/ac3${r}.wasm`;case 86056:return`${e}/decode/eac3${r}.wasm`;case 86020:return`${e}/decode/dca${r}.wasm`;case 86017:return`${e}/decode/mp3${r}.wasm`;case 173:return`${e}/decode/hevc${r}.wasm`;case 196:return`${e}/decode/vvc${r}.wasm`;case 12:return`${e}/decode/mpeg4${r}.wasm`;case 225:return`${e}/decode/av1${r}.wasm`;case 86051:return`${e}/decode/speex${r}.wasm`;case 86076:return`${e}/decode/opus${r}.wasm`;case 86028:return`${e}/decode/flac${r}.wasm`;case 86021:return`${e}/decode/vorbis${r}.wasm`;case 139:return`${e}/decode/vp8${r}.wasm`;case 167:return`${e}/decode/vp9${r}.wasm`;case 86022:return`${e}/decode/dvaudio${r}.wasm`;case 24:return`${e}/decode/dvvideo${r}.wasm`;case 3:return`${e}/decode/h261${r}.wasm`;case 4:case 20:case 19:return`${e}/decode/h263${r}.wasm`;case 14:case 15:case 16:case 5:case 6:case 68:case 69:return`${e}/decode/msmpeg4${r}.wasm`;case 86036:case 86057:case 86073:return`${e}/decode/ra${r}.wasm`;case 86023:case 86024:case 86052:case 86054:case 86053:return`${e}/decode/wma${r}.wasm`;case 17:case 18:case 71:return`${e}/decode/wmv${r}.wasm`;case 7:return`${e}/decode/mjpeg${r}.wasm`;default:return null}case"encoder":if(i>65536&&i<=65572)return`${e}/encode/pcm${r}.wasm`;switch(i){case 27:return`${e}/encode/x264${r}.wasm`;case 30:return`${e}/encode/theora${r}.wasm`;case 86018:return`${e}/encode/aac${r}.wasm`;case 86019:return`${e}/encode/ac3${r}.wasm`;case 86056:return`${e}/encode/eac3${r}.wasm`;case 86020:return`${e}/encode/dca${r}.wasm`;case 86017:return`${e}/encode/mp3lame${r}.wasm`;case 173:return`${e}/encode/x265${r}.wasm`;case 12:return`${e}/encode/mpeg4${r}.wasm`;case 225:return`${e}/encode/av1${r}.wasm`;case 86051:return`${e}/encode/speex${r}.wasm`;case 86076:return`${e}/encode/opus${r}.wasm`;case 86028:return`${e}/encode/flac${r}.wasm`;case 86021:return`${e}/encode/vorbis${r}.wasm`;case 139:return`${e}/encode/vp8${r}.wasm`;case 167:return`${e}/encode/vp9${r}.wasm`;default:return null}case"resampler":return`${e}/resample/resample${r}.wasm`;case"scaler":return`${e}/scale/scale${r}.wasm`;case"stretchpitcher":return`${e}/stretchpitch/stretchpitch${r}.wasm`}}},93147:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(63939),s=i(97317);function a(e){if(0!==r.f[15](e))return!1;const t=(0,s.I)(r.f[15](e+28));return t&&128&t.flags}},24310:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(63939),s=i(97317);function a(e){if(0!==r.f[15](e))return!1;const t=(0,s.I)(r.f[15](e+28));return!(!t||t.comp[0].depth<=8||18!==r.f[15](e+92)&&16!==r.f[15](e+92))}},16041:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(134),s=(i(55833),i(40046)),a=i(73783),n=i(37837),o=i(56024);class c{constructor(e,t){(0,r.A)(this,"list",void 0),(0,r.A)(this,"mutex",void 0),this.list=e,this.mutex=t}alloc(){let e=this.list.find((e=>-1===s.p_(e+320,-1,1,16,2)),20);return e||(e=(0,n.Gy)(328),(0,o._h)(e),s.M_(e+320,1,16,2),a.s2(this.mutex),this.list.push(e,20),a.Tl(this.mutex)),e}release(e){s.Hh(e+320,16,2)<=0||1===s.jb(e+320,1,16,2)&&((0,o.to)(e),s.M_(e+320,-1,16,2))}}},47442:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(134),s=(i(10278),i(40046)),a=i(73783),n=i(37837);class o{constructor(e,t){(0,r.A)(this,"list",void 0),(0,r.A)(this,"mutex",void 0),this.list=e,this.mutex=t}alloc(){let e=this.list.find((e=>-1===s.p_(e+48,-1,1,16,2)),20);return e||(e=(0,n.Gy)(56),s.M_(e+48,1,16,2),a.s2(this.mutex),this.list.push(e,20),a.Tl(this.mutex)),e}release(e){s.Hh(e+48,16,2)<=0||1===s.jb(e+48,1,16,2)&&s.M_(e+48,-1,16,2)}}},84290:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(134),s=i(40046),a=i(73783),n=i(37837),o=(i(47958),i(71517));class c{constructor(e,t){(0,r.A)(this,"list",void 0),(0,r.A)(this,"mutex",void 0),this.list=e,this.mutex=t}alloc(){let e=this.list.find((e=>-1===s.p_(e+80,-1,1,16,2)),20);return e||(e=(0,n.Gy)(88),(0,o.Pd)(e),s.M_(e+80,1,16,2),a.s2(this.mutex),this.list.push(e,20),a.Tl(this.mutex)),e}release(e){s.Hh(e+80,16,2)<=0||1===s.jb(e+80,1,16,2)&&((0,o.Up)(e),s.M_(e+80,-1,16,2))}}},97317:(e,t,i)=>{"use strict";i.d(t,{I:()=>a});var r=i(80662);const s=new(i.n(r)());function a(e){if(s.has(e))return s.get(e);const t=B[e];if(!t)return;const i={log2ChromaW:t[0],log2ChromaH:t[1],flags:t[2],comp:t[3].map((e=>({plane:e[0],step:e[1],offset:e[2],shift:e[3],depth:e[4]})))};return s.set(e,i),i}const n=[[0,1,0,0,8],[1,1,0,0,8],[2,1,0,0,8]],o=[...n,[3,1,0,0,8]],c=[[0,2,0,0,9],[1,2,0,0,9],[2,2,0,0,9]],l=[...c,[3,2,0,0,9]],d=[[0,2,0,0,10],[1,2,0,0,10],[2,2,0,0,10]],h=[...d,[3,2,0,0,10]],u=[[0,2,0,0,12],[1,2,0,0,12],[2,2,0,0,12]],f=[...u,[3,2,0,0,12]],p=[[0,2,0,0,14],[1,2,0,0,14],[2,2,0,0,14]],m=[[0,2,0,0,16],[1,2,0,0,16],[2,2,0,0,16]],g=[...m,[3,2,0,0,16]],v=[[0,1,0,0,8],[1,2,0,0,8],[1,2,1,0,8]],y=[[0,1,0,0,8],[1,2,1,0,8],[1,2,0,0,8]],A=[[0,8,2,0,16],[0,8,4,0,16],[0,8,6,0,16],[0,8,0,0,16]],b=[[0,2,0,6,10],[1,4,0,6,10],[1,4,2,6,10]],w=[[0,2,0,4,12],[1,4,0,4,12],[1,4,2,4,12]],x=[[0,2,0,0,16],[1,4,0,0,16],[1,4,2,0,16]],k=[[0,8,0,0,16],[0,8,2,0,16],[0,8,4,0,16],[0,8,6,0,16]],T=[[0,8,4,0,16],[0,8,2,0,16],[0,8,0,0,16],[0,8,6,0,16]],I=[[2,2,0,0,9],[0,2,0,0,9],[1,2,0,0,9]],S=[[2,2,0,0,10],[0,2,0,0,10],[1,2,0,0,10]],P=[[2,2,0,0,12],[0,2,0,0,12],[1,2,0,0,12]],_=[[2,2,0,0,14],[0,2,0,0,14],[1,2,0,0,14]],M=[[2,2,0,0,16],[0,2,0,0,16],[1,2,0,0,16]],C=[[2,2,0,0,16],[0,2,0,0,16],[1,2,0,0,16],[3,2,0,0,16]],B={6:[2,2,16,n],0:[1,1,16,n],12:[1,1,16,n],4:[1,0,16,n],13:[1,0,16,n],5:[0,0,16,n],14:[0,0,16,n],23:[1,1,16,v],24:[1,1,16,y],188:[0,0,16,v],189:[0,0,16,y],59:[1,1,17,c],60:[1,1,16,c],69:[1,0,17,c],70:[1,0,16,c],65:[0,0,17,c],66:[0,0,16,c],61:[1,1,17,d],62:[1,1,16,d],63:[1,0,17,d],64:[1,0,16,d],67:[0,0,17,d],68:[0,0,16,d],122:[1,1,17,u],123:[1,1,16,u],126:[1,0,17,u],127:[1,0,16,u],130:[0,0,17,u],131:[0,0,16,u],124:[1,1,17,p],125:[1,1,16,p],128:[1,0,17,p],129:[1,0,16,p],132:[0,0,17,p],133:[0,0,16,p],46:[1,1,17,m],45:[1,1,16,m],48:[1,0,17,m],47:[1,0,16,m],50:[0,0,17,m],49:[0,0,16,m],33:[1,1,144,o],78:[1,0,144,o],79:[0,0,144,o],80:[1,1,145,l],81:[1,1,144,l],82:[1,0,145,l],83:[1,0,144,l],84:[0,0,145,l],85:[0,0,144,l],86:[1,1,145,h],87:[1,1,144,h],88:[1,0,145,h],89:[1,0,144,h],90:[0,0,145,h],91:[0,0,144,h],184:[1,0,145,f],185:[1,0,144,f],186:[0,0,145,f],187:[0,0,144,f],92:[1,1,145,g],93:[1,1,144,g],94:[1,0,145,g],95:[1,0,144,g],96:[0,0,145,g],97:[0,0,144,g],156:[0,0,129,A],155:[0,0,128,A],159:[1,1,17,b],158:[1,1,16,b],210:[1,1,17,w],209:[1,1,16,w],170:[1,1,17,x],169:[1,1,16,x],8:[0,0,0,[[0,1,0,0,8]]],29:[0,0,1,[[0,2,0,0,16]]],30:[0,0,0,[[0,2,0,0,16]]],56:[0,0,128,[[0,2,0,0,8],[0,2,1,0,8]]],109:[0,0,129,[[0,4,0,0,16],[0,4,2,0,16]]],110:[0,0,128,[[0,4,0,0,16],[0,4,2,0,16]]],26:[0,0,160,[[0,4,0,0,8],[0,4,1,0,8],[0,4,2,0,8],[0,4,3,0,8]]],25:[0,0,160,[[0,4,1,0,8],[0,4,2,0,8],[0,4,3,0,8],[0,4,0,0,8]]],104:[0,0,161,k],105:[0,0,160,k],28:[0,0,160,[[0,4,2,0,8],[0,4,1,0,8],[0,4,0,0,8],[0,4,3,0,8]]],27:[0,0,160,[[0,4,3,0,8],[0,4,2,0,8],[0,4,1,0,8],[0,4,0,0,8]]],106:[0,0,161,T],107:[0,0,160,T],2:[0,0,32,[[0,3,0,0,8],[0,3,1,0,8],[0,3,2,0,8]]],3:[0,0,32,[[0,3,2,0,8],[0,3,1,0,8],[0,3,0,0,8]]],119:[0,0,32,[[0,4,0,0,8],[0,4,1,0,8],[0,4,2,0,8]]],121:[0,0,32,[[0,4,2,0,8],[0,4,1,0,8],[0,4,0,0,8]]],71:[0,0,48,[[2,1,0,0,8],[0,1,0,0,8],[1,1,0,0,8]]],111:[0,0,176,[[2,1,0,0,8],[0,1,0,0,8],[1,1,0,0,8],[3,1,0,0,8]]],72:[0,0,49,I],73:[0,0,48,I],74:[0,0,49,S],75:[0,0,48,S],134:[0,0,49,P],135:[0,0,48,P],136:[0,0,49,_],137:[0,0,48,_],76:[0,0,49,M],77:[0,0,48,M],112:[0,0,177,C],113:[0,0,176,C]}},58055:(e,t,i)=>{"use strict";i.d(t,{J:()=>r});const r={0:{bits:8,planar:!1},1:{bits:16,planar:!1},2:{bits:32,planar:!1},10:{bits:64,planar:!1},3:{bits:32,planar:!1},4:{bits:64,planar:!1},5:{bits:8,planar:!0},6:{bits:16,planar:!0},7:{bits:32,planar:!0},11:{bits:64,planar:!0},8:{bits:32,planar:!0},9:{bits:64,planar:!0}}},62751:(e,t,i)=>{"use strict";i.d(t,{$$:()=>a,Eh:()=>p,HR:()=>s,IY:()=>y,Ki:()=>v,Mb:()=>g,Sz:()=>d,Xp:()=>c,_R:()=>n,_m:()=>f,d8:()=>m,iW:()=>h,mX:()=>u,n1:()=>o,os:()=>r,qO:()=>l});const r={86017:"mp3",86018:"mp4a.40",86021:"vorbis",86028:"flac",86076:"opus",65542:"ulaw",65543:"alaw",86019:"ac-3",86056:"ec-3",86020:"dtsc",225:"av01",27:"avc1",173:"hev1",196:"vvc1",139:"vp8",167:"vp09",12:"mp4v"},s={flv:0,mp4:1,m4s:1,mov:1,ts:2,mts:2,m2ts:2,ivf:5,opus:4,oggs:4,ogg:4,m3u8:2,m3u:2,mpd:1,mp3:14,mkv:8,mka:8,webm:9,aac:15,flac:17,wav:16,srt:19,vtt:18,ssa:20,ass:20,xml:21,ttml:21,h264:11,264:11,avc:11,h265:12,265:12,hevc:12,h266:13,266:13,vvc:13,mpeg:3,mpg:3,rtsp:6,rtmp:7,avi:10},a={m3u8:4,m3u:4,mpd:5},n={copy:0,h264:27,h261:3,h263:4,h263i:20,h263p:19,mjpeg:7,wmv1:17,wmv2:18,wmv3:71,avc:27,hevc:173,h265:173,vvc:196,h266:196,av1:225,vp9:167,vp8:139,mpeg4:12,theora:30,mpeg2video:2,rv10:5,rv20:6,rv30:68,rv40:69},o={copy:0,aac:86018,ac3:86019,eac3:86056,dts:86020,mp3:86017,opus:86076,flac:86028,speex:86051,vorbis:86021,pcm_alaw:65543,pcm_mulaw:65542,wmav1:86023,wmav2:86024,cook:86036,sipr:86057,ralf:86073},c={webvtt:94226,subrip:94225,ass:94230,ttml:94232,mov_text:94213,hdmv_pgs:94214,hdmv_text:94231,dvd:94208,dvb:94209,eia_608:94218},l={yuv420p:0,yuv422p:4,yuv444p:5,yuva420p:33,yuva422p:78,yuva444p:79,yuvj420p:12,yuvj422p:13,yuvj444p:14,yuv420p10le:62,yuv422p10le:64,yuv444p10le:68,yuva420p10le:87,yuva422p10le:89,yuva444p10le:91,yuv420p10be:61,yuv422p10be:63,yuv444p10be:67,yuva420p10be:86,yuva422p10be:88,yuva444p10be:90},d={u8:0,"u8-planar":5,s16:1,"s16-planar":6,s32:2,"s32-planar":7,s64:10,"s64-planar":11,float:3,"float-planar":8,double:4,"double-planar":9},h={flv:0,mp4:1,mov:1,ts:2,mpegts:2,mpeg:3,ivf:5,ogg:4,opus:4,m3u8:2,m3u:2,mpd:1,mp3:14,mkv:8,matroska:8,mka:8,webm:9,aac:15,flac:17,wav:16,raw_h264:11,raw_h265:12,raw_vvc:13,rtsp:6,rtmp:7,avi:10},u={tv:1,pc:2},f={bt709:1,fcc:4,bt470bg:5,smpte170m:6,smpte240m:7,ycgco:8,gbr:0,bt2020nc:9},p={bt709:1,bt470m:4,bt470bg:5,smpte170m:6,smpte240m:7,smpte428:10,film:8,smpte431:11,smpte432:12,bt2020:9,"jedec-p22":22,ebu3213:22},m={bt709:1,gamma22:4,gamma28:5,smpte170m:6,smpte240m:7,srgb:13,xvycc:11,"bt2020-10":14,"bt2020-12":15,smpte2084:16,"arib-std-b67":18},g={Audio:1,Video:0,Subtitle:3,Attachment:4,Data:2},v={default:1,dub:2,original:4,comment:8,lyrics:16,karaoke:32,forced:64,"hearing impaired":128,"visual impaired":256,"clean effects":512,"attached pic":1024,"timed thumbnails":2048,captions:65536,descriptions:131072,metadata:262144,dependent:524288,"still image":1048576},y={mono:4,stereo:3,2.1:11,"3.0":7,"3.0(back)":259,"4.0":263,quad:51,"quad(side)":1539,3.1:15,"5.0":55,"5.0(side)":1543,4.1:271,5.1:63,"5.1(side)":1551,"6.0":1799,"6.0(front)":1731,"3.1.2":20495,hexagonal:311,6.1:1807,"6.1(back)":319,"6.1(front)":1739,"7.0":1591,"7.0(front)":1735,7.1:1599,"7.1(wide)":255,"7.1(wide-side)":1743,"5.1.2":20543,octagonal:1847,cube:184371,"5.1.4":184383,"7.1.2":22079,"7.1.4":185919,"7.2.3":34359825983,"9.1.4":186111,hexadecagonal:6442710839,downmix:1610612736,22.2:2164663779327}},36981:(e,t,i)=>{"use strict";i.d(t,{r:()=>h});var r,s,a=i(134),n=i(80662),o=i.n(n),c=i(61499),l=i(12085);class d{constructor(){(0,a.A)(this,"id",void 0),(0,a.A)(this,"name",void 0),(0,a.A)(this,"opaque",void 0)}}r=d.prototype,(s=new(o())).set("id",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("name",{0:4,1:0,2:0,3:1,4:16,5:0,6:0,7:4,8:0}),s.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:20,8:0}),(0,l.A)(r,c.Og,!0),(0,l.A)(r,c.dc,4),(0,l.A)(r,c.g7,24),(0,l.A)(r,c.JY,s);class h{constructor(){(0,a.A)(this,"order",void 0),(0,a.A)(this,"nbChannels",void 0),(0,a.A)(this,"u",void 0),(0,a.A)(this,"opaque",void 0)}}!function(e){var t=new(o());t.set("order",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("nbChannels",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),t.set("u",{0:function(e){var t=new(o());return t.set("mask",{0:10,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("map",{0:d,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),(0,l.A)(e,c.Og,!0),(0,l.A)(e,c.dc,8),(0,l.A)(e,c.g7,8),(0,l.A)(e,c.JY,t),e}({}),1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),t.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),(0,l.A)(e,c.Og,!0),(0,l.A)(e,c.dc,8),(0,l.A)(e,c.g7,24),(0,l.A)(e,c.JY,t)}(h.prototype)},50288:(e,t,i)=>{"use strict";i.d(t,{BU:()=>u});var r,s,a=i(134),n=i(80662),o=i.n(n),c=i(61499),l=i(12085),d=i(73783);i(37837);class h{constructor(){(0,a.A)(this,"data",0),(0,a.A)(this,"size",0),(0,a.A)(this,"refcount",0),(0,a.A)(this,"free",0),(0,a.A)(this,"opaque",0),(0,a.A)(this,"flags",0),(0,a.A)(this,"flagsInternal",0)}}r=h.prototype,(s=new(o())).set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("size",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("refcount",{0:9,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),s.set("free",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),s.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),s.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:20,8:0}),s.set("flagsInternal",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),(0,l.A)(r,c.Og,!0),(0,l.A)(r,c.dc,4),(0,l.A)(r,c.g7,28),(0,l.A)(r,c.JY,s);class u{constructor(){(0,a.A)(this,"buffer",0),(0,a.A)(this,"data",0),(0,a.A)(this,"size",0)}}!function(e){var t=new(o());t.set("buffer",{0:h,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),t.set("size",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),(0,l.A)(e,c.Og,!0),(0,l.A)(e,c.dc,4),(0,l.A)(e,c.g7,12),(0,l.A)(e,c.JY,t)}(u.prototype);class f{constructor(){(0,a.A)(this,"mutex",void 0),(0,a.A)(this,"pool",0),(0,a.A)(this,"refcount",0),(0,a.A)(this,"size",0),(0,a.A)(this,"opaque",0),(0,a.A)(this,"alloc",0),(0,a.A)(this,"alloc2",0),(0,a.A)(this,"poolFree",0)}}!function(e){var t=new(o());t.set("mutex",{0:d.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("pool",{get 0(){return p},1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),t.set("refcount",{0:9,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),t.set("size",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),t.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),t.set("alloc",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:20,8:0}),t.set("alloc2",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:24,8:0}),t.set("poolFree",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:28,8:0}),(0,l.A)(e,c.Og,!0),(0,l.A)(e,c.dc,4),(0,l.A)(e,c.g7,32),(0,l.A)(e,c.JY,t)}(f.prototype);class p{constructor(){(0,a.A)(this,"data",0),(0,a.A)(this,"opaque",0),(0,a.A)(this,"free",0),(0,a.A)(this,"pool",0),(0,a.A)(this,"next",0),(0,a.A)(this,"buffer",void 0)}}!function(e){var t=new(o());t.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),t.set("free",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:8,8:0}),t.set("pool",{0:f,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),t.set("next",{0:p,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),t.set("buffer",{0:h,1:0,2:0,3:0,4:0,5:0,6:0,7:20,8:0}),(0,l.A)(e,c.Og,!0),(0,l.A)(e,c.dc,4),(0,l.A)(e,c.g7,48),(0,l.A)(e,c.JY,t)}(p.prototype)},77162:(e,t,i)=>{"use strict";i.d(t,{A:()=>m});var r,s,a=i(134),n=i(80662),o=i.n(n),c=i(61499),l=i(12085),d=i(47958),h=i(9599),u=i(36981),f=i(77231),p=i(71766);class m{constructor(){(0,a.A)(this,"codecType",-1),(0,a.A)(this,"codecId",0),(0,a.A)(this,"codecTag",0),(0,a.A)(this,"extradata",0),(0,a.A)(this,"extradataSize",0),(0,a.A)(this,"codedSideData",0),(0,a.A)(this,"nbCodedSideData",0),(0,a.A)(this,"format",f.N_),(0,a.A)(this,"bitrate",BigInt(0)),(0,a.A)(this,"bitsPerCodedSample",0),(0,a.A)(this,"bitsPerRawSample",0),(0,a.A)(this,"profile",f.N_),(0,a.A)(this,"level",f.N_),(0,a.A)(this,"width",0),(0,a.A)(this,"height",0),(0,a.A)(this,"sampleAspectRatio",new h.P({den:1,num:1})),(0,a.A)(this,"framerate",new h.P({den:1,num:0})),(0,a.A)(this,"fieldOrder",0),(0,a.A)(this,"colorRange",0),(0,a.A)(this,"colorPrimaries",2),(0,a.A)(this,"colorTrc",2),(0,a.A)(this,"colorSpace",2),(0,a.A)(this,"chromaLocation",0),(0,a.A)(this,"videoDelay",0),(0,a.A)(this,"chLayout",void 0),(0,a.A)(this,"sampleRate",f.N_),(0,a.A)(this,"blockAlign",0),(0,a.A)(this,"frameSize",0),(0,a.A)(this,"initialPadding",0),(0,a.A)(this,"trailingPadding",0),(0,a.A)(this,"seekPreroll",0),(0,a.A)(this,"flags",0)}destroy(){(0,p.dn)(this[c.o9]),this[c.o9]=0}}r=m.prototype,(s=new(o())).set("codecType",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("codecId",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("codecTag",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),s.set("extradata",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),s.set("extradataSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),s.set("codedSideData",{0:d.lg,1:1,2:1,3:0,4:0,5:0,6:0,7:20,8:0}),s.set("nbCodedSideData",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),s.set("format",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:28,8:0}),s.set("bitrate",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),s.set("bitsPerCodedSample",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:40,8:0}),s.set("bitsPerRawSample",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:44,8:0}),s.set("profile",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:48,8:0}),s.set("level",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:52,8:0}),s.set("width",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:56,8:0}),s.set("height",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:60,8:0}),s.set("sampleAspectRatio",{0:h.P,1:0,2:0,3:0,4:0,5:0,6:0,7:64,8:0}),s.set("framerate",{0:h.P,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),s.set("fieldOrder",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),s.set("colorRange",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),s.set("colorPrimaries",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:88,8:0}),s.set("colorTrc",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:92,8:0}),s.set("colorSpace",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:96,8:0}),s.set("chromaLocation",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:100,8:0}),s.set("videoDelay",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:104,8:0}),s.set("chLayout",{0:u.r,1:0,2:0,3:0,4:0,5:0,6:0,7:112,8:0}),s.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:136,8:0}),s.set("blockAlign",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:140,8:0}),s.set("frameSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:144,8:0}),s.set("initialPadding",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:148,8:0}),s.set("trailingPadding",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:152,8:0}),s.set("seekPreroll",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:156,8:0}),s.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:160,8:0}),(0,l.A)(r,c.Og,!0),(0,l.A)(r,c.dc,8),(0,l.A)(r,c.g7,168),(0,l.A)(r,c.JY,s)},56490:(e,t,i)=>{"use strict";i.d(t,{A:()=>h});var r,s,a=i(134),n=i(80662),o=i.n(n),c=i(61499),l=i(12085);class d{constructor(){(0,a.A)(this,"key",0),(0,a.A)(this,"value",0)}}r=d.prototype,(s=new(o())).set("key",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("value",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),(0,l.A)(r,c.Og,!0),(0,l.A)(r,c.dc,4),(0,l.A)(r,c.g7,8),(0,l.A)(r,c.JY,s);class h{constructor(){(0,a.A)(this,"count",0),(0,a.A)(this,"elems",0)}}!function(e){var t=new(o());t.set("count",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("elems",{0:d,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),(0,l.A)(e,c.Og,!0),(0,l.A)(e,c.dc,4),(0,l.A)(e,c.g7,8),(0,l.A)(e,c.JY,t)}(h.prototype)},55833:(e,t,i)=>{"use strict";i.d(t,{pu:()=>m});var r=i(134),s=i(80662),a=i.n(s),n=i(61499),o=i(12085),c=i(56490),l=i(50288),d=i(9599),h=i(94300),u=i(36981),f=i(77231),p=i(56024);const m=8;class g{constructor(){(0,r.A)(this,"type",0),(0,r.A)(this,"data",0),(0,r.A)(this,"size",0),(0,r.A)(this,"metadata",0),(0,r.A)(this,"buf",0)}}var v,y;v=g.prototype,(y=new(a())).set("type",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),y.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),y.set("size",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),y.set("metadata",{0:c.A,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),y.set("buf",{0:l.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),(0,o.A)(v,n.Og,!0),(0,o.A)(v,n.dc,4),(0,o.A)(v,n.g7,20),(0,o.A)(v,n.JY,y),function(e){var t=new(a());t.set("displayPrimaries",{0:d.P,1:0,2:0,3:1,4:6,5:0,6:0,7:0,8:0}),t.set("whitePoint",{0:d.P,1:0,2:0,3:1,4:2,5:0,6:0,7:48,8:0}),t.set("minLuminance",{0:d.P,1:0,2:0,3:0,4:0,5:0,6:0,7:64,8:0}),t.set("maxLuminance",{0:d.P,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),t.set("hasPrimaries",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),t.set("hasLuminance",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),(0,o.A)(e,n.Og,!0),(0,o.A)(e,n.dc,4),(0,o.A)(e,n.g7,88),(0,o.A)(e,n.JY,t)}(class{constructor(){(0,r.A)(this,"displayPrimaries",void 0),(0,r.A)(this,"whitePoint",void 0),(0,r.A)(this,"minLuminance",void 0),(0,r.A)(this,"maxLuminance",void 0),(0,r.A)(this,"hasPrimaries",void 0),(0,r.A)(this,"hasLuminance",void 0)}}.prototype),function(e){var t=new(a());t.set("maxCLL",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("maxFALL",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,o.A)(e,n.Og,!0),(0,o.A)(e,n.dc,4),(0,o.A)(e,n.g7,8),(0,o.A)(e,n.JY,t)}(class{constructor(){(0,r.A)(this,"maxCLL",void 0),(0,r.A)(this,"maxFALL",void 0)}}.prototype);class A{constructor(){(0,r.A)(this,"data",new Array(m).fill(0,0,m)),(0,r.A)(this,"linesize",new Array(m).fill(0,0,m)),(0,r.A)(this,"extendedData",0),(0,r.A)(this,"width",f.N_),(0,r.A)(this,"height",f.N_),(0,r.A)(this,"nbSamples",f.N_),(0,r.A)(this,"format",f.N_),(0,r.A)(this,"keyFrame",0),(0,r.A)(this,"pictType",0),(0,r.A)(this,"sampleAspectRatio",new d.P({den:1,num:0})),(0,r.A)(this,"pts",f.Dh),(0,r.A)(this,"pktDts",f.Dh),(0,r.A)(this,"timeBase",void 0),(0,r.A)(this,"quality",f.N_),(0,r.A)(this,"opaque",0),(0,r.A)(this,"repeatPict",f.N_),(0,r.A)(this,"interlacedFrame",f.N_),(0,r.A)(this,"topFieldFirst",f.N_),(0,r.A)(this,"paletteHasChanged",f.N_),(0,r.A)(this,"sampleRate",f.N_),(0,r.A)(this,"buf",new Array(m).fill(0,0,m)),(0,r.A)(this,"extendedBuf",0),(0,r.A)(this,"nbExtendedBuf",0),(0,r.A)(this,"sideData",0),(0,r.A)(this,"nbSideData",0),(0,r.A)(this,"flags",0),(0,r.A)(this,"colorRange",0),(0,r.A)(this,"colorPrimaries",2),(0,r.A)(this,"colorTrc",2),(0,r.A)(this,"colorSpace",2),(0,r.A)(this,"chromaLocation",0),(0,r.A)(this,"bestEffortTimestamp",f.Dh),(0,r.A)(this,"pktPos",f.Dh),(0,r.A)(this,"metadata",0),(0,r.A)(this,"decodeErrorFlags",0),(0,r.A)(this,"pktSize",f.N_),(0,r.A)(this,"hwFramesCtx",0),(0,r.A)(this,"opaqueRef",0),(0,r.A)(this,"cropTop",0),(0,r.A)(this,"cropBottom",0),(0,r.A)(this,"cropLeft",0),(0,r.A)(this,"cropRight",0),(0,r.A)(this,"privateRef",0),(0,r.A)(this,"chLayout",void 0),(0,r.A)(this,"duration",BigInt(0))}close(){(0,p.to)(this[n.o9]),(0,h.A)(this)}}!function(e){var t=new(a());t.set("data",{0:2,1:1,2:1,3:1,4:8,5:0,6:0,7:0,8:0}),t.set("linesize",{0:15,1:0,2:0,3:1,4:8,5:0,6:0,7:32,8:0}),t.set("extendedData",{0:2,1:1,2:2,3:0,4:0,5:0,6:0,7:64,8:0}),t.set("width",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:68,8:0}),t.set("height",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),t.set("nbSamples",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:76,8:0}),t.set("format",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),t.set("keyFrame",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),t.set("pictType",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:88,8:0}),t.set("sampleAspectRatio",{0:d.P,1:0,2:0,3:0,4:0,5:0,6:0,7:92,8:0}),t.set("pts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:104,8:0}),t.set("pktDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:112,8:0}),t.set("timeBase",{0:d.P,1:0,2:0,3:0,4:0,5:0,6:0,7:120,8:0}),t.set("quality",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:128,8:0}),t.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:132,8:0}),t.set("repeatPict",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:136,8:0}),t.set("interlacedFrame",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:140,8:0}),t.set("topFieldFirst",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:144,8:0}),t.set("paletteHasChanged",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:148,8:0}),t.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:152,8:0}),t.set("buf",{0:l.BU,1:1,2:1,3:1,4:8,5:0,6:0,7:156,8:0}),t.set("extendedBuf",{0:l.BU,1:1,2:2,3:0,4:0,5:0,6:0,7:188,8:0}),t.set("nbExtendedBuf",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:192,8:0}),t.set("sideData",{0:g,1:1,2:2,3:0,4:0,5:0,6:0,7:196,8:0}),t.set("nbSideData",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:200,8:0}),t.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:204,8:0}),t.set("colorRange",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:208,8:0}),t.set("colorPrimaries",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:212,8:0}),t.set("colorTrc",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:216,8:0}),t.set("colorSpace",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:220,8:0}),t.set("chromaLocation",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:224,8:0}),t.set("bestEffortTimestamp",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:232,8:0}),t.set("pktPos",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:240,8:0}),t.set("metadata",{0:c.A,1:1,2:1,3:0,4:0,5:0,6:0,7:248,8:0}),t.set("decodeErrorFlags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:252,8:0}),t.set("pktSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:256,8:0}),t.set("hwFramesCtx",{0:l.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:260,8:0}),t.set("opaqueRef",{0:l.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:264,8:0}),t.set("cropTop",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:268,8:0}),t.set("cropBottom",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:272,8:0}),t.set("cropLeft",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:276,8:0}),t.set("cropRight",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:280,8:0}),t.set("privateRef",{0:l.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:284,8:0}),t.set("chLayout",{0:u.r,1:0,2:0,3:0,4:0,5:0,6:0,7:288,8:0}),t.set("duration",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:312,8:0}),(0,o.A)(e,n.Og,!0),(0,o.A)(e,n.dc,8),(0,o.A)(e,n.g7,320),(0,o.A)(e,n.JY,t)}(A.prototype),function(e){var t=new(a());t.set("refCount",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:320,8:0}),(0,o.A)(e,n.Og,!0),(0,o.A)(e,n.dc,8),(0,o.A)(e,n.g7,328),(0,o.A)(e,n.JY,t)}(class extends A{constructor(...e){super(...e),(0,r.A)(this,"refCount",void 0)}}.prototype)},47958:(e,t,i)=>{"use strict";i.d(t,{lg:()=>f});var r,s,a=i(134),n=i(80662),o=i.n(n),c=i(61499),l=i(12085),d=i(50288),h=i(9599),u=i(77231);class f{constructor(){(0,a.A)(this,"data",0),(0,a.A)(this,"size",0),(0,a.A)(this,"type",-1)}}r=f.prototype,(s=new(o())).set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("size",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("type",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),(0,l.A)(r,c.Og,!0),(0,l.A)(r,c.dc,4),(0,l.A)(r,c.g7,12),(0,l.A)(r,c.JY,s),function(e){var t=new(o());t.set("wallclock",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),(0,l.A)(e,c.Og,!0),(0,l.A)(e,c.dc,8),(0,l.A)(e,c.g7,16),(0,l.A)(e,c.JY,t)}(class{constructor(){(0,a.A)(this,"wallclock",void 0),(0,a.A)(this,"flags",void 0)}}.prototype);class p{constructor(){(0,a.A)(this,"buf",0),(0,a.A)(this,"pts",u.Dh),(0,a.A)(this,"dts",u.Dh),(0,a.A)(this,"data",0),(0,a.A)(this,"size",0),(0,a.A)(this,"streamIndex",u.N_),(0,a.A)(this,"flags",0),(0,a.A)(this,"sideData",0),(0,a.A)(this,"sideDataElems",0),(0,a.A)(this,"duration",u.Dh),(0,a.A)(this,"pos",u.Dh),(0,a.A)(this,"opaque",0),(0,a.A)(this,"opaqueRef",0),(0,a.A)(this,"timeBase",new h.P({den:u.SF,num:1}))}}!function(e){var t=new(o());t.set("buf",{0:d.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("pts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),t.set("dts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),t.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:24,8:0}),t.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:28,8:0}),t.set("streamIndex",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),t.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:36,8:0}),t.set("sideData",{0:f,1:1,2:1,3:0,4:0,5:0,6:0,7:40,8:0}),t.set("sideDataElems",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:44,8:0}),t.set("duration",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:48,8:0}),t.set("pos",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:56,8:0}),t.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:64,8:0}),t.set("opaqueRef",{0:d.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:68,8:0}),t.set("timeBase",{0:h.P,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),(0,l.A)(e,c.Og,!0),(0,l.A)(e,c.dc,8),(0,l.A)(e,c.g7,80),(0,l.A)(e,c.JY,t)}(p.prototype),function(e){var t=new(o());t.set("refCount",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),(0,l.A)(e,c.Og,!0),(0,l.A)(e,c.dc,8),(0,l.A)(e,c.g7,88),(0,l.A)(e,c.JY,t)}(class extends p{constructor(...e){super(...e),(0,a.A)(this,"refCount",void 0)}}.prototype)},10278:(e,t,i)=>{"use strict";i.d(t,{A:()=>d});var r,s,a=i(134),n=i(80662),o=i.n(n),c=i(61499),l=i(12085);class d{constructor(){(0,a.A)(this,"data",void 0),(0,a.A)(this,"linesize",void 0),(0,a.A)(this,"nbSamples",void 0),(0,a.A)(this,"maxnbSamples",void 0),(0,a.A)(this,"channels",void 0),(0,a.A)(this,"sampleRate",void 0),(0,a.A)(this,"format",void 0),(0,a.A)(this,"timestamp",void 0),(0,a.A)(this,"duration",void 0)}}r=d.prototype,(s=new(o())).set("data",{0:2,1:1,2:2,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("linesize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("nbSamples",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),s.set("maxnbSamples",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),s.set("channels",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),s.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:20,8:0}),s.set("format",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),s.set("timestamp",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),s.set("duration",{0:19,1:0,2:0,3:0,4:0,5:0,6:0,7:40,8:0}),(0,l.A)(r,c.Og,!0),(0,l.A)(r,c.dc,8),(0,l.A)(r,c.g7,48),(0,l.A)(r,c.JY,s),function(e){var t=new(o());t.set("refCount",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:48,8:0}),(0,l.A)(e,c.Og,!0),(0,l.A)(e,c.dc,8),(0,l.A)(e,c.g7,56),(0,l.A)(e,c.JY,t)}(class extends d{constructor(...e){super(...e),(0,a.A)(this,"refCount",void 0)}}.prototype)},9599:(e,t,i)=>{"use strict";i.d(t,{P:()=>d});var r,s,a=i(134),n=i(80662),o=i.n(n),c=i(61499),l=i(12085);class d{constructor(e){(0,a.A)(this,"num",1),(0,a.A)(this,"den",1),e&&(this.den=e.den,this.num=e.num)}}r=d.prototype,(s=new(o())).set("num",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("den",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,l.A)(r,c.Og,!0),(0,l.A)(r,c.dc,4),(0,l.A)(r,c.g7,8),(0,l.A)(r,c.JY,s)},37815:(e,t,i)=>{"use strict";i.d(t,{A6:()=>v,D$:()=>u,Q7:()=>m,VG:()=>f,aw:()=>h,us:()=>g});var r=i(14686),s=i(63939),a=i(50932),n=i(37837),o=i(40046),c=(i(50288),i(73783)),l=i(52699);const d=1;function h(e,t,i=0,r=0,s=0){const c=(0,n.Gy)(28);if(!c)return 0;const l=function(e,t,i,r=0,s=0,c=0){a.M[20](e,t),a.M[25](e+4,i),a.M[20](e+12,r),a.M[20](e+16,s),o.M_(e+8,1,9,2),a.M[15](e+20,c);const l=(0,n.Gy)(12);return l?(a.M[20](l,e),a.M[20](l+4,t),a.M[25](l+8,i),l):0}(c,e,t,i,r,s);return l||((0,n.Eb)(c),0)}function u(e){return h((0,n.sY)(e),e)}function f(e){const t=(0,n.Gy)(12);return(0,r.Mr)(t,e,12),o.WQ(s.f[20](e)+8,1,9,2),t}function p(e,t){const i=s.f[20](s.f[20](e));if(t?((0,r.Mr)(s.f[20](e),s.f[20](t),12),(0,n.aI)(t)):(0,n.aI)(e),1===o.jb(i+8,1,9,2)){const e=!(2&s.f[15](i+24));s.f[20](i+16)?y(s.f[20](i+16),s.f[20](i)):(0,n.Eb)(s.f[20](i)),e&&(0,n.Eb)(i)}}function m(e){e&&s.f[20](e)&&p(e,0)}function g(e,t){const i=s.f[20](e);if(!t)return m(e),0;if(i&&s.f[20](i+4)===s.f[20](t+4))return a.M[20](i+4,s.f[20](t+4)),a.M[25](i+8,s.f[25](t+8)),0;const r=f(t);return m(e),a.M[20](e,r),0}function v(e,t){if(!s.f[20](e)){const i=h((0,n.cz)(0,t),t);return a.M[20](e,i),a.M[15](s.f[20](i)+24,s.f[15](s.f[20](i)+24)|d),0}const i=s.f[20](e),c=s.f[20](i);if(s.f[25](i+8)===t)return 0;if(!(s.f[15](c+24)&d&&function(e){return 1&s.f[15](s.f[20](e)+20)?0:1===o.Hh(s.f[20](e)+8,9,2)?1:0}(i)&&s.f[20](i+4)===s.f[20](c))){let i=l.z(4);a.M[20](i,0);const n=v(i,t);return n<0?(l.t(4),n):((0,r.Mr)(s.f[20](s.f[20](i)+4),s.f[20](c),Math.min(t,s.f[25](c+4))),p(e,i),l.t(4),0)}const u=(0,n.cz)(s.f[20](c),t);return a.M[20](i+4,u),a.M[20](c,u),a.M[25](i+8,t),a.M[25](c+4,t),0}function y(e,t){const i=e,r=s.f[20](i+12);c.s2(r),a.M[20](i+16,s.f[20](r+4)),a.M[20](r+4,i),c.Tl(r),1===o.jb(r+8,1,9,2)&&function(e){!function(e){for(;s.f[20](e+4);){const t=s.f[20](e+4);a.M[20](e+4,s.f[20](t+16)),s.f[20](t+4)?y(s.f[20](t+4),s.f[20](t)):(0,n.Eb)(s.f[20](t)),(0,n.Eb)(t)}}(e),c.zr(e),(0,n.Eb)(e)}(r)}},73749:(e,t,i)=>{"use strict";i.d(t,{AO:()=>h,IH:()=>d,a5:()=>f});var r=i(63939),s=i(50932),a=(i(56490),i(11473)),n=i(14686),o=i(37837),c=i(67672),l=i(62100);function d(e){h(r.f[20](e)),(0,o.aI)(e)}function h(e){if(e){for(;s.M[15](e,r.f[15](e)-1),r.f[15](e)+1;)(0,o.aI)(r.f[20](e+4)+8*r.f[15](e)),(0,o.aI)(r.f[20](e+4)+8*r.f[15](e)+4);(0,o.aI)(e+4)}}function u(e,t){let i=0;return e?(t&&(i=1+(t-r.f[20](e+4)>>3)),i>=r.f[15](e)?0:r.f[20](e+4)+8*i):0}function f(e,t,i,o=0){if(!e)throw new Error("m is nullptr");let d=0;if(64&o&&(d=function(e,t,i=0,s=0){if(!e)return 0;let a=i;if(!t)return 0;for(;a=u(e,a);){let e=(0,n.lH)(r.f[20](a));if(1&s&&(e.toLocaleLowerCase(),t.toLocaleLowerCase()),e===t||2&s&&0===e.indexOf(t))return a}}(e,t,0,o)),d){if(16&o)return 0;32&o&&(i=`${(0,n.lH)(r.f[20](d+4))},${i}`),a.s_.free(r.f[20](d+4)),s.M[20](d+4,a.s_.malloc(i.length+1)),(0,n.qW)(r.f[20](d+4),i,i.length)}else{c.Yj(i)||(i=(0,l.A)(i));let o=a.s_.realloc(r.f[20](e+4),8*(r.f[15](e)+1));s.M[20](e+4,o),s.M[20](r.f[20](e+4)+8*r.f[15](e),a.s_.malloc(t.length+1)),s.M[20](r.f[20](e+4)+8*r.f[15](e)+4,a.s_.malloc(i.length+1)),(0,n.qW)(r.f[20](r.f[20](e+4)+8*r.f[15](e)),t,t.length),(0,n.qW)(r.f[20](r.f[20](e+4)+8*r.f[15](e)+4),i,i.length),s.M[15](e,r.f[15](e)+1)}return 0}},56024:(e,t,i)=>{"use strict";i.d(t,{FP:()=>m,_h:()=>A,aH:()=>y,rh:()=>b,to:()=>w,xj:()=>g});var r,s=i(63939),a=i(50932),n=(i(36981),i(9599),i(55833)),o=i(37837),c=i(14686),l=i(77231),d=i(37815),h=i(73749),u=i(99991),f=i(66788),p=i(9705);function m(){const e=(0,o.Gy)(320);return A(e),e}function g(e){w(e),(0,o.Eb)(e)}function v(e){const t=s.f[20](e);(0,d.Q7)(t+16),(0,h.IH)(t+12),(0,o.aI)(e)}function y(e,t){for(let i=0;i<s.f[15](e+200);i++)if(s.f[15](s.f[20](s.f[20](e+196)+4*i))===t)return s.f[20](s.f[20](e+196)+4*i);return 0}function A(e){s.f[20](e+64)!==e&&(0,o.aI)(e+64),(0,u.bl)(e+288),(0,c.sO)(e,0,320),a.M[17](e+104,l.Dh),a.M[17](e+112,l.Dh),a.M[17](e+232,l.Dh),a.M[17](e+240,l.Dh),a.M[15](e+256,-1),a.M[15](e+84,1),a.M[15](e+92,0),a.M[15](e+96,1),a.M[15](e+80,-1),a.M[20](e+64,e),a.M[15](e+212,2),a.M[15](e+216,2),a.M[15](e+220,2),a.M[15](e+208,0),a.M[15](e+224,0),a.M[15](e+204,0)}function b(e,t){const i=(0,f.K0)(s.f[15](e+80)),r=s.f[15](e+292),c=i?r:1;let l=0;if(!s.f[15](e+32)){if(l=(0,f.f8)(s.f[15](e+80),r,s.f[15](e+76),t),l<0)return l;a.M[15](e+32,l)}if(c>n.pu){if(a.M[20](e+64,(0,o.sY)(4*c)),a.M[20](e+188,(0,o.sY)(4*c)),!s.f[20](e+188)||!s.f[20](e+64))return(0,o.aI)(e+64),(0,o.aI)(e+188),p.gR;a.M[15](e+192,c-n.pu)}else a.M[20](e+64,e);for(let t=0;t<Math.min(c,n.pu);t++){if(a.M[20](e+156+4*t,(0,d.D$)(s.f[15](e+32))),!s.f[20](e+156+4*t))return w(e),p.gR;a.M[20](s.f[20](e+64)+4*t,s.f[20](s.f[20](e+156+4*t)+4)),a.M[20](e+4*t,s.f[20](s.f[20](e+156+4*t)+4))}for(let t=0;t<c-n.pu;t++){if(a.M[20](s.f[20](e+188)+4*t,(0,d.D$)(s.f[15](e+32))),!s.f[20](s.f[20](e+188)+4*t))return w(e),p.gR;a.M[20](s.f[20](e+64)+4*(t+n.pu),s.f[20](s.f[20](s.f[20](e+188)+4*t)+4))}}function w(e){if(e){!function(e){!function(e,t){const i=s.f[15](t),r=s.f[20](e);for(let e=0;e<i;e++)v(r+4*e);a.M[15](t,0),(0,o.aI)(e)}(e+196,e+200)}(e);for(let t=0;t<8;t++)(0,d.Q7)(e+156+4*t);for(let t=0;t<s.f[15](e+192);t++)(0,d.Q7)(s.f[20](e+188)+4*t);(0,o.aI)(e+188),(0,h.IH)(e+248),(0,d.Q7)(e+260),(0,d.Q7)(e+264),(0,d.Q7)(e+284),A(e)}}i(97317),i(38156),function(e){e[e.UNIQUE=1]="UNIQUE"}(r||(r={}))},71517:(e,t,i)=>{"use strict";i.d(t,{$W:()=>m,E4:()=>g,Is:()=>y,NX:()=>_,NZ:()=>w,Ow:()=>v,Pd:()=>x,Qe:()=>b,Un:()=>h,Up:()=>S,Zx:()=>P,_5:()=>A,fQ:()=>p,iI:()=>d,rN:()=>I,rU:()=>u,sn:()=>f,zu:()=>k});var r=i(14686),s=i(63939),a=i(50932),n=(i(47958),i(37837)),o=i(77231),c=i(37815);const l=64;function d(e,t){return t?(0,r.JW)(s.f[20](e+24),s.f[15](e+28)):(0,r.s3)(s.f[20](e+24),s.f[15](e+28))}function h(e,t,i){const r=s.f[15](t),a=s.f[20](e);for(let e=0;e<r;e++)if(s.f[15](a+12*e+8)===i)return a+12*e;return 0}function u(e,t){return h(e+40,e+44,t)}function f(e,t,i){const r=s.f[15](t),a=s.f[20](e);for(let e=0;e<r;e++)if(s.f[15](a+12*e+8)===i)return!0;return!1}function p(e,t){return f(e+40,e+44,t)}function m(e,t,i,o,c){const l=s.f[15](t),d=s.f[20](e);for(let e=0;e<l;e++)if(s.f[15](d+12*e+8)===i)return(0,n.Eb)(s.f[20](d+12*e)),a.M[20](d+12*e,o),void a.M[25](d+12*e+4,c);const h=12*(l+1),u=(0,n.Gy)(h);if(l)for(let e=0;e<l;e++)(0,r.Mr)(u+12*e,d+12*e,12);const f=u+12*l;return a.M[20](f,o),a.M[15](f+8,i),a.M[25](f+4,c),d&&(0,n.Eb)(d),a.M[20](e,u),a.M[15](t,l+1),f}function g(e,t,i,s){const a=(0,n.sY)(s+l);return(0,r.sO)(a+s,0,l),m(e,t,i,a,s)}function v(e,t,i,r){m(e+40,e+44,t,i,r)}function y(e,t){let i=-1;for(let r=0;r<s.f[15](e+44);r++)if(s.f[15](s.f[20](e+40)+12*r+8)===t){i=r;break}if(i>-1)if(1===s.f[15](e+44))(0,n.Eb)(s.f[20](s.f[20](e+40))),(0,n.Eb)(s.f[20](e+40)),a.M[20](e+40,0),a.M[15](e+44,0);else{const t=12*(s.f[15](e+44)-1),o=(0,n.Gy)(t);for(let t=0;t<s.f[15](e+44);t++)t!==i?(0,r.Mr)(o+12*t,s.f[20](e+40)+12*t,12):(0,n.Eb)(s.f[20](s.f[20](e+40)+12*t));(0,n.Eb)(s.f[20](e+40)),a.M[20](e+40,o),a.M[15](e+44,s.f[15](e+44)-1)}}function A(){const e=(0,n.Gy)(80);return x(e),e}function b(e){S(e),(0,n.Eb)(e)}function w(e,t){const i=s.f[20](e),r=s.f[15](t);if(i){for(let e=0;e<r;e++)(0,n.Eb)(s.f[20](i+12*e));(0,n.aI)(e),a.M[15](t,0)}}function x(e){a.M[20](e+24,0),a.M[15](e+28,0),a.M[20](e+40,0),a.M[15](e+44,0),a.M[15](e+32,o.N_),a.M[17](e+56,o.Dh),a.M[17](e+48,o.Dh),a.M[15](e+36,0),a.M[17](e+16,o.Dh),a.M[17](e+8,o.Dh),a.M[15](e+76,o.SF),a.M[15](e+72,1),a.M[20](e,0)}function k(e,t){return a.M[15](e+32,s.f[15](t+32)),a.M[17](e+56,s.f[17](t+56)),a.M[17](e+48,s.f[17](t+48)),a.M[15](e+36,s.f[15](t+36)),a.M[17](e+16,s.f[17](t+16)),a.M[17](e+8,s.f[17](t+8)),a.M[20](e+64,s.f[20](t+64)),a.M[15](e+76,s.f[15](t+76)),a.M[15](e+72,s.f[15](t+72)),a.M[20](e+68,0),(0,c.us)(e+68,s.f[20](t+68)),function(e,t){if(w(e+40,e+44),s.f[15](t+44)){let i=12;a.M[20](e+40,(0,n.Gy)(i*s.f[15](t+44)));for(let i=0;i<s.f[15](t+44);i++)a.M[25](s.f[20](e+40)+12*i+4,s.f[25](s.f[20](t+40)+12*i+4)),a.M[15](s.f[20](e+40)+12*i+8,s.f[15](s.f[20](t+40)+12*i+8)),a.M[20](s.f[20](e+40)+12*i,(0,n.sY)(s.f[25](s.f[20](t+40)+12*i+4))),(0,r.Mr)(s.f[20](s.f[20](e+40)+12*i),s.f[20](s.f[20](t+40)+12*i),s.f[25](s.f[20](t+40)+12*i+4));a.M[15](e+44,s.f[15](t+44))}}(e,t),0}function T(e,t){return(0,c.A6)(e,t+l),(0,r.sO)(s.f[20](s.f[20](e)+4)+t,0,l),0}function I(e,t){return s.f[20](e)&&(0,c.Q7)(e),a.M[20](e,0),k(e,t),!s.f[20](t)&&s.f[15](t+28)?(T(e,s.f[15](t+28)),s.f[15](t+28)&&(0,r.Mr)(s.f[20](s.f[20](e)+4),s.f[20](t+24),s.f[15](t+28)),a.M[20](e+24,s.f[20](s.f[20](e)+4))):s.f[20](t)&&(a.M[20](e,(0,c.VG)(s.f[20](t))),a.M[20](e+24,s.f[20](t+24))),a.M[15](e+28,s.f[15](t+28)),0}function S(e){w(e+40,e+44),(0,c.Q7)(e+68),s.f[20](e)?(0,c.Q7)(e):s.f[20](e+24)&&(0,n.Eb)(s.f[20](e+24)),x(e)}function P(e,t){s.f[20](e)&&(0,c.Q7)(e),a.M[20](e,0),!s.f[20](t)&&s.f[15](t+28)?(T(e,s.f[15](t+28)),s.f[15](t+28)&&(0,r.Mr)(s.f[20](s.f[20](e)+4),s.f[20](t+24),s.f[15](t+28)),a.M[20](e+24,s.f[20](s.f[20](e)+4))):s.f[20](t)&&(a.M[20](e,(0,c.VG)(s.f[20](t))),a.M[20](e+24,s.f[20](t+24))),a.M[15](e+28,s.f[15](t+28))}function _(e,t,i){s.f[20](e)?(0,c.Q7)(e):s.f[20](e+24)&&(0,n.Eb)(s.f[20](e+24)),a.M[20](e,(0,c.aw)(t,i+l)),a.M[20](e+24,t),a.M[15](e+28,i)}},99991:(e,t,i)=>{"use strict";i.d(t,{ML:()=>d,bl:()=>l,xY:()=>h});var r=i(63939),s=i(50932),a=i(85103),n=i(37837),o=i(14686),c=i(9705);function l(e){2==r.f[15](e)&&(0,n.aI)(e+8),(0,o.sO)(e,0,24)}function d(e,t){return t?(s.M[15](e,1),s.M[15](e+4,(0,a.Xb)(t)),s.M[10](e+8,t),0):c.UY}function h(e,t){if(t<=0)throw new Error("invalid channels");const i=(0,n.Gy)(24*t);for(let e=0;e<t;e++)s.M[15](i+24*e,768);s.M[15](e,2),s.M[15](e+4,t),s.M[20](e+8,i)}},71766:(e,t,i)=>{"use strict";i.d(t,{Yi:()=>d,dn:()=>h});var r=i(14686),s=i(63939),a=i(50932),n=(i(36981),i(9599),i(37837)),o=i(99991),c=i(71517),l=i(77231);function d(e,t){a.M[15](e,s.f[15](t)),a.M[15](e+4,s.f[15](t+4)),a.M[8](e+8,s.f[8](t+8)),a.M[15](e+28,s.f[15](t+28)),a.M[17](e+32,s.f[17](t+32)),a.M[15](e+40,s.f[15](t+40)),a.M[15](e+44,s.f[15](t+44)),a.M[15](e+48,s.f[15](t+48)),a.M[15](e+52,s.f[15](t+52)),a.M[15](e+56,s.f[15](t+56)),a.M[15](e+60,s.f[15](t+60)),a.M[15](e+68,s.f[15](t+68)),a.M[15](e+64,s.f[15](t+64)),a.M[15](e+80,s.f[15](t+80)),a.M[15](e+84,s.f[15](t+84)),a.M[15](e+88,s.f[15](t+88)),a.M[15](e+92,s.f[15](t+92)),a.M[15](e+96,s.f[15](t+96)),a.M[15](e+100,s.f[15](t+100)),a.M[15](e+104,s.f[15](t+104)),(0,r.Mr)(e+112,t+112,24),a.M[15](e+136,s.f[15](t+136)),a.M[15](e+140,s.f[15](t+140)),a.M[15](e+144,s.f[15](t+144)),a.M[15](e+148,s.f[15](t+148)),a.M[15](e+152,s.f[15](t+152)),a.M[15](e+156,s.f[15](t+156)),a.M[15](e+160,s.f[15](t+160)),(0,r.Mr)(e+72,t+72,8),s.f[20](t+12)&&(s.f[20](e+12)&&(0,n.Eb)(s.f[20](e+12)),a.M[20](e+12,(0,n.sY)(s.f[15](t+16))),a.M[15](e+16,s.f[15](t+16)),(0,r.Mr)(s.f[20](e+12),s.f[20](t+12),s.f[15](t+16))),s.f[20](t+20)&&function(e,t,i,o){if(!i)return;const c=(0,n.Gy)(12*o);for(let e=0;e<o;e++)a.M[15](c+12*e+8,s.f[15](i+12*e+8)),a.M[25](c+12*e+4,s.f[25](i+12*e+4)),a.M[20](c+12*e,(0,n.sY)(s.f[25](i+12*e+4))),(0,r.Mr)(s.f[20](c+12*e),s.f[20](i+12*e),s.f[25](i+12*e+4));a.M[15](t,o),a.M[20](e,c)}(e+20,e+24,s.f[20](t+20),s.f[15](t+24))}function h(e){e&&(function(e){s.f[20](e+12)&&(0,n.aI)(e+12),(0,o.bl)(e+112),(0,c.NZ)(e+20,e+24),(0,r.sO)(e,0,168),a.M[15](e,-1),a.M[15](e+4,0),a.M[15](e+28,-1),a.M[15](e+112,0),a.M[15](e+80,0),a.M[15](e+84,0),a.M[15](e+88,2),a.M[15](e+92,2),a.M[15](e+96,2),a.M[15](e+100,0),a.M[15](e+64,0),a.M[15](e+68,1),a.M[15](e+72,0),a.M[15](e+72,1),a.M[15](e+48,l.N_),a.M[15](e+52,l.N_),a.M[15](e+160,0)}(e),(0,n.Eb)(e))}i(47958)},85103:(e,t,i)=>{"use strict";function r(e){return e=(e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135,(e+=e>>8)+(e>>16)&63}function s(e){return r(Number(BigInt.asUintN(32,e)))+r(Number(BigInt.asUintN(32,e>>BigInt(32))))}function a(e){const t=e/BigInt(1e3),i=e-t*BigInt(1e3);return Number(t)+Number(i)/1e3}i.d(t,{Xb:()=>s,yw:()=>a})},50315:(e,t,i)=>{"use strict";i.d(t,{ZK:()=>o,bE:()=>c,p$:()=>a,zz:()=>n});var r=i(31865),s=i(729);function a(e){const t=new r.A(e,!0),i=t.readUint32(),s=t.readUint32(),a=t.readUint32(),n=t.readUint32(),o=t.readUint32(),c=t.readUint32(),l={scheme:i,cryptByteBlock:s,skipByteBlock:a,keyId:t.readBuffer(n),iv:t.readBuffer(o),subsamples:[]};if(c)for(let e=0;e<c;e++)l.subsamples.push({bytesOfClearData:t.readUint32(),bytesOfProtectedData:t.readUint32()});return l}function n(e){const t=new Uint8Array(24+e.keyId.length+e.iv.length+8*e.subsamples.length),i=new s.A(t,!0);return i.writeUint32(e.scheme),i.writeUint32(e.cryptByteBlock),i.writeUint32(e.skipByteBlock),i.writeUint32(e.keyId.length),i.writeUint32(e.iv.length),i.writeUint32(e.subsamples.length),i.writeBuffer(e.keyId),i.writeBuffer(e.iv),e.subsamples.forEach((e=>{i.writeUint32(e.bytesOfClearData),i.writeUint32(e.bytesOfProtectedData)})),t}function o(e){const t=new r.A(e,!0),i=t.readUint32(),s=[];for(let e=0;e<i;e++){const e=t.readUint32(),i=t.readUint32(),r=t.readUint32(),a=t.readUint32(),n={systemId:t.readBuffer(e),keyIds:[],data:null};if(i)for(let e=0;e<i;e++)n.keyIds.push(t.readBuffer(r));n.data=t.readBuffer(a),s.push(n)}return s}function c(e){let t=4;e.forEach((e=>{t+=16+e.systemId.length+e.keyIds.length*(e.keyIds.length?e.keyIds[0].length:0)+e.data.length}));const i=new Uint8Array(t),r=new s.A(i,!0);return r.writeUint32(e.length),e.forEach((e=>{r.writeUint32(e.systemId.length),r.writeUint32(e.keyIds.length),r.writeUint32(e.keyIds.length?e.keyIds[0].length:0),r.writeUint32(e.data.length),r.writeBuffer(e.systemId),e.keyIds.forEach((e=>{r.writeBuffer(e)})),r.writeBuffer(e.data)})),i}},23991:(e,t,i)=>{"use strict";function r(e){let t=0,i=0;for(;i<32&&0===e.readU1();)i++;return t=e.readU(i),t+=(1<<i)-1,t}function s(e){let t=r(e);return t=1&t?(t+1)/2:-t/2,t}i.d(t,{$x:()=>s,xb:()=>r})},39381:(e,t,i)=>{"use strict";i.d(t,{E3:()=>a,Sg:()=>l,Y0:()=>c,ht:()=>o,r8:()=>s,yd:()=>n});var r=i(63939);function s(e){return r.f[2](e)}function a(e){return s(e+1)<<8|s(e)}function n(e){return s(e)<<8|s(e+1)}function o(e){return s(e)<<16|s(e+1)<<8|s(e+2)}function c(e){return a(e+2)<<16|a(e)}function l(e){return n(e)<<16|n(e+2)}},82774:(e,t,i)=>{"use strict";i.d(t,{Cv:()=>o,w8:()=>s});var r=i(50932);function s(e,t){r.M[2](e,255&t)}function a(e,t){s(e,t>>>8),s(e+1,t)}function n(e,t){a(e,t>>>16),a(e+2,65535&t)}function o(e,t){n(e,Number(BigInt.asUintN(32,t>>BigInt(32)))),n(e+4,Number(BigInt.asUintN(32,t)))}},37837:(e,t,i)=>{"use strict";i.d(t,{Eb:()=>h,Gy:()=>d,aI:()=>u,cz:()=>f,sY:()=>l});var r=i(11473),s=i(63939),a=i(50932),n=i(14686),o=i(4624);const c="src/avutil/util/mem.ts";function l(e){const t=r.s_.malloc(e);return t||o.h2("can not alloc buffer",c,32),t}function d(e){const t=r.s_.malloc(e);return t||o.h2("can not alloc buffer",c,40),(0,n.sO)(t,0,e),t}function h(e){r.s_.free(e)}function u(e){r.s_.free(s.f[20](e)),a.M[20](e,0)}function f(e,t){return r.s_.realloc(e,t)}},60264:(e,t,i)=>{"use strict";i.d(t,{BN:()=>h,Bs:()=>a,Ky:()=>n,Le:()=>c,S9:()=>d,nW:()=>l,py:()=>o}),i(31865);var r=i(729),s=i(72739);function a(e){return e.length>4&&0===e[0]&&0===e[1]&&(1===e[2]||0===e[2]&&1===e[3])}function n(e,t){let i=0;for(let r=t;r<e.length;r++)switch(e[r]){case 0:i++;break;case 1:if(i>=2)return{offset:r-Math.min(i,3),startCode:Math.min(i+1,4)};i=0;break;default:i=0}return{offset:-1,startCode:0}}function o(e){const t=[];let i=n(e,0),r={offset:-1,startCode:0};for(;r=n(e,i.offset+i.startCode),r.offset>-1;)t.push(e.subarray(i.offset+i.startCode,r.offset,!0)),i=r;return t.push(e.subarray(i.offset+i.startCode,void 0,!0)),t}function c(e,t){return e.reduce(((e,i,r)=>0===t?e+4+i.length:1===t?e+3+i.length:e+(r?3:4)+i.length),0)}function l(e,t,i){if(!i){let r=e.reduce(((e,i,r)=>0===t?e+4+i.length:1===t?e+3+i.length:e+(r?3:4)+i.length),0);i=new Uint8Array(r)}const a=new r.A(i);return s.__(e,((e,i)=>{a.writeUint8(0),a.writeUint8(0),(0===t||2===t&&!i)&&a.writeUint8(0),a.writeUint8(1),a.writeBuffer(e)})),i}function d(e,t,i){if(!i){const r=e.reduce(((e,i)=>e+t+1+i.length),0);i=new Uint8Array(r)}const a=new r.A(i);return s.__(e,(e=>{3===t?a.writeUint32(e.length):2===t?a.writeUint24(e.length):1===t?a.writeUint16(e.length):a.writeUint8(e.length),a.writeBuffer(e)})),i}function h(e,t=0,i){i||(i=e.length);const r=new Uint8Array(e.length);let s=0,a=0;for(let n=0;n<e.length;n++){if(n>=t&&n<i)if(0===e[n])s++;else if(3===e[n]&&2===s&&n+1<e.length&&e[n+1]<=3){if(n++,n===e.length)break;s=0===e[n]?1:0}else s=0;r[a++]=e[n]}return r.slice(0,a)}},38156:(e,t,i)=>{"use strict";i(97317),i(77231),i(37837)},44328:(e,t,i)=>{"use strict";i.d(t,{FP:()=>c,Mr:()=>o,iU:()=>h,j2:()=>d,k:()=>n,lb:()=>l});var r=i(63939),s=i(77231),a=i(31658);function n(e,t,i){return e*BigInt(t.num)*BigInt(i.den)/(BigInt(t.den)*BigInt(i.num))}function o(e,t,i){return e*BigInt(r.f[15](t))*BigInt(i.den)/(BigInt(r.f[15](t+4))*BigInt(i.num))}function c(e,t,i){return e*BigInt(t.num)*BigInt(r.f[15](i+4))/(BigInt(t.den)*BigInt(r.f[15](i)))}function l(e){return e.num/e.den}function d(e,t){if(isNaN(19))return{den:0,num:0};if(Math.abs(e)>s.go+3)return{den:0,num:e<0?-1:1};const i=e>1?{den:Math.floor(t/e+.5),num:t}:{den:t,num:Math.floor(e*t+.5)};return h(i),i}function h(e){const t=(0,a.A)(e.num,e.den);t<=1||(e.den/=t,e.num/=t)}},66788:(e,t,i)=>{"use strict";i.d(t,{K0:()=>n,f8:()=>o});var r=i(77231),s=i(95073),a=(i(37837),i(58055));function n(e){return!(e<0||e>=12)&&a.J[e].planar}function o(e,t,i,o){const c=function(e){return e<0||e>=12?0:a.J[e].bits>>3}(e),l=n(e);return!c||i<=0||t<=0?-1:(o||(o=1,i=(0,s.A)(i,32)),t>r.go/o||t*i>(r.go-o*t)/c?-1:l?(0,s.A)(i*c,o):(0,s.A)(i*c*t,o))}},71762:(e,t,i)=>{"use strict";i.d(t,{T8:()=>h,Wu:()=>d,r0:()=>l,wm:()=>c});var r=i(63939),s=i(50932),a=i(14686),n=i(71517),o=i(37837);function c(e){const t={pts:r.f[17](e+8),dts:r.f[17](e+16),data:(0,n.iI)(e).slice(),streamIndex:r.f[15](e+32),flags:r.f[15](e+36),sideData:[],duration:r.f[17](e+48),pos:r.f[17](e+56),timeBase:{den:r.f[15](e+76),num:r.f[15](e+72)}};for(let i=0;i<r.f[15](e+44);i++){const s={type:r.f[15](r.f[20](e+40)+12*i+8),data:(0,a.s3)(r.f[20](r.f[20](e+40)+12*i),r.f[25](r.f[20](e+40)+12*i+4)).slice()};t.sideData.push(s)}return t}function l(e,t=0){t||(t=(0,n._5)()),s.M[17](t+8,e.pts),s.M[17](t+16,e.dts);const i=(0,o.sY)(e.data.length);if((0,a.lW)(i,e.data.length,e.data),(0,n.NX)(t,i,e.data.length),s.M[15](t+32,e.streamIndex),s.M[15](t+36,e.flags),s.M[17](t+48,e.duration),s.M[17](t+56,e.pos),s.M[15](t+76,e.timeBase.den),s.M[15](t+72,e.timeBase.num),e.sideData.length)for(let i=0;i<e.sideData.length;i++){const r=(0,o.sY)(e.sideData[i].data.length);(0,a.lW)(r,e.sideData[i].data.length,e.sideData[i].data),(0,n.Ow)(t,e.sideData[i].type,r,e.sideData[i].data.length)}else(0,n.NZ)(t+40,t+44);return t}function d(e){const t={codecType:r.f[15](e),codecId:r.f[15](e+4),codecTag:r.f[8](e+8),extradata:null,codedSideData:[],format:r.f[15](e+28),bitrate:r.f[17](e+32),bitsPerCodedSample:r.f[15](e+40),bitsPerRawSample:r.f[15](e+44),profile:r.f[15](e+48),level:r.f[15](e+52),width:r.f[15](e+56),height:r.f[15](e+60),sampleAspectRatio:{den:r.f[15](e+68),num:r.f[15](e+64)},framerate:{den:r.f[15](e+76),num:r.f[15](e+72)},fieldOrder:r.f[15](e+80),colorRange:r.f[15](e+84),colorPrimaries:r.f[15](e+88),colorTrc:r.f[15](e+92),colorSpace:r.f[15](e+96),chromaLocation:r.f[15](e+100),videoDelay:r.f[15](e+104),chLayout:{order:r.f[15](e+112),nbChannels:r.f[15](e+116),u:r.f[10](e+120)},sampleRate:r.f[15](e+136),blockAlign:r.f[15](e+140),frameSize:r.f[15](e+144),initialPadding:r.f[15](e+148),trailingPadding:r.f[15](e+152),seekPreroll:r.f[15](e+156),flags:r.f[15](e+160)};r.f[15](e+16)&&(t.extradata=(0,a.s3)(r.f[20](e+12),r.f[15](e+16)).slice());for(let i=0;i<r.f[15](e+24);i++){const s={type:r.f[15](r.f[20](e+20)+12*i+8),data:(0,a.s3)(r.f[20](r.f[20](e+20)+12*i),r.f[25](r.f[20](e+20)+12*i+4)).slice()};t.codedSideData.push(s)}return t}function h(e,t=0){if(t||(t=(0,o.sY)(168),(0,a.sO)(t,0,168)),s.M[15](t,e.codecType),s.M[15](t+4,e.codecId),s.M[8](t+8,e.codecTag),e.extradata&&(r.f[20](t+12)&&(0,o.Eb)(r.f[20](t+12)),s.M[20](t+12,(0,o.sY)(e.extradata.length)),(0,a.lW)(r.f[20](t+12),e.extradata.length,e.extradata),s.M[15](t+16,e.extradata.length)),e.codedSideData.length)for(let i=0;i<e.codedSideData.length;i++){const r=(0,o.sY)(e.codedSideData[i].data.length);(0,a.lW)(r,e.codedSideData[i].data.length,e.codedSideData[i].data),(0,n.$W)(t+20,t+24,e.codedSideData[i].type,r,e.codedSideData[i].data.length)}else(0,n.NZ)(t+20,t+24);return s.M[15](t+28,e.format),s.M[17](t+32,e.bitrate),s.M[15](t+40,e.bitsPerCodedSample),s.M[15](t+44,e.bitsPerRawSample),s.M[15](t+48,e.profile),s.M[15](t+52,e.level),s.M[15](t+56,e.width),s.M[15](t+60,e.height),s.M[15](t+68,e.sampleAspectRatio.den),s.M[15](t+64,e.sampleAspectRatio.num),s.M[15](t+76,e.framerate.den),s.M[15](t+72,e.framerate.num),s.M[15](t+80,e.fieldOrder),s.M[15](t+84,e.colorRange),s.M[15](t+88,e.colorPrimaries),s.M[15](t+92,e.colorTrc),s.M[15](t+96,e.colorSpace),s.M[15](t+100,e.chromaLocation),s.M[15](t+104,e.videoDelay),s.M[15](t+112,e.chLayout.order),s.M[15](t+116,e.chLayout.nbChannels),s.M[10](t+120,e.chLayout.u),s.M[15](t+136,e.sampleRate),s.M[15](t+140,e.blockAlign),s.M[15](t+144,e.frameSize),s.M[15](t+148,e.initialPadding),s.M[15](t+152,e.trailingPadding),s.M[15](t+156,e.seekPreroll),s.M[15](t+160,e.flags),t}i(77162)},95007:(e,t,i)=>{"use strict";i.d(t,{A:()=>f});var r=i(134),s=i(95335),a=i(72739),n=i(73783),o=i(7417),c=i(4624);const l="src/cheap/allocator/AllocatorJS.ts",d=v(16),h=32,u=68;class f{constructor(e,t=!0){var i,a,n,o;(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"byteOffset",void 0),(0,r.A)(this,"heapOffset",void 0),(0,r.A)(this,"heapLength",void 0),(0,r.A)(this,"int32Array",void 0),(0,r.A)(this,"updates",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"shared",void 0),(0,r.A)(this,"handles",void 0),this.options=s.X$({growSize:1048576,maxHeapSize:2097152e3},e),this.handles=[],this.buffer=e.buffer,this.shared=!1,this.options.memory||this.buffer instanceof ArrayBuffer||this.buffer instanceof SharedArrayBuffer?(this.byteOffset=null!==(i=e.byteOffset)&&void 0!==i?i:0,this.heapOffset=A(this.byteOffset+g(h),null!==(a=e.byteLength)&&void 0!==a?a:this.buffer.byteLength),this.heapLength=b((null!==(n=e.byteLength)&&void 0!==n?n:this.buffer.byteLength)-this.heapOffset),this.int32Array=new Int32Array(this.buffer,this.heapOffset,v(this.heapLength)),this.updates=new Int32Array(this.buffer,this.byteOffset,h),"function"==typeof SharedArrayBuffer&&this.buffer instanceof SharedArrayBuffer&&(this.shared=!0)):c.h2("Expected buffer to be an instance of Buffer or ArrayBuffer",l,109),t&&(this.updates.fill(1),function(e){return 65===e[0]&&65===e[66]}(o=this.int32Array)||function(e){const t=e.length-69;k(e,65,1),e[1]=1,e[3]=68;for(let t=1;t<h;t++)e[3+t]=1;k(e,t,68),e[68]=1,e[70]=1}(o),function(e){let t=u;for(;t<e.length-1;){const i=x(e,t);i<2||i>=e.length-u?c.h2(`Got invalid sized chunk at ${g(t)} (${g(i)} bytes).`,l,565):S(e,t)?p(e,t,i):m(e,t,i),t+=i+2}}(this.int32Array))}addUpdateHandle(e){a.zy(this.handles,e)||this.handles.push(e)}removeUpdateHandle(e){a.TF(this.handles,e)}malloc_(e){(e=y(e,7))<16&&(e=16);const t=v(e),i=this.findFreeBlock(this.int32Array,t);if(i<=1)return 0;const r=x(this.int32Array,i);return r-(t+2)>=d?function(e,t,i,r,s){const a=t+i+2,n=r-(a-t);I(e,t,r,s),e[t-1]=-i,e[t+i]=-i,e[a-1]=-n,e[a+n]=-n,M(e,a,n,s)}(this.int32Array,i,t,r,this.updates):I(this.int32Array,i,r,this.updates),g(i)+this.heapOffset}malloc(e){this.shared&&((0,n.s2)(o.II,!0),this.checkBuffer());const t=this.malloc_(e);return this.shared&&(0,n.Tl)(o.II),t}calloc_(e,t){let i=e*t;i=i<16?16:y(i,7);const r=this.malloc_(i);if(0===r)return 0;const s=v(r-this.heapOffset);return this.int32Array.subarray(s,s+v(i)).fill(0),r}calloc(e,t){this.shared&&((0,n.s2)(o.II,!0),this.checkBuffer());const i=this.calloc_(e,t);return this.shared&&(0,n.Tl)(o.II),i}realloc_(e,t){if(0===e)return this.malloc_(t);const i=e;if(0===t)return this.free_(i),0;let r=v(e-=this.heapOffset),s=r,a=0;P(this.int32Array,r)&&(s=this.int32Array[r-1],a=r-s);const n=x(this.int32Array,s)-a;if(n>=v(y(t,7)))return i;{const e=this.malloc_(t);return 0===e?(this.free_(i),0):(this.int32Array.set(this.int32Array.subarray(r,r+n),v(e-this.heapOffset)),this.free_(i),e)}}realloc(e,t){return this.shared&&((0,n.s2)(o.II,!0),this.checkBuffer()),e=this.realloc_(e,t),this.shared&&(0,n.Tl)(o.II),e}alignedAlloc_(e,t){if(e<=8)return this.malloc_(t);const i=this.malloc_(t+e-1+4);if(0===i)return 0;const r=i+e-1+4&~(e-1);return this.int32Array[v(r-this.heapOffset)-1]=v(i-this.heapOffset),r}alignedAlloc(e,t){this.shared&&((0,n.s2)(o.II,!0),this.checkBuffer());const i=this.alignedAlloc_(e,t);return this.shared&&(0,n.Tl)(o.II),i}free_(e){if(0===e)return;let t=v(e-=this.heapOffset);if(P(this.int32Array,t)&&(t=this.int32Array[t-1]),S(this.int32Array,t))return;const i=x(this.int32Array,t),r=_(this.int32Array,t),s=function(e,t){const i=x(e,t);if(t+i+2>=e.length-2)return 0;const r=t+i+2;return e[r-1]<2?0:r}(this.int32Array,t);0!==r?0!==s?function(e,t,i,r,s,a){const n=x(e,t),o=x(e,s),c=s-t+o;I(e,t,n,a),I(e,s,o,a),e[t-1]=-c,e[s+o]=-c,M(e,t,c,a)}(this.int32Array,r,0,0,s,this.updates):C(this.int32Array,r,t,i,this.updates):0!==s?function(e,t,i,r,s){const a=x(e,t);I(e,t,a,s);const n=r+a+2;e[i-1]=-n,e[t+a]=-n,M(e,i,n,s)}(this.int32Array,s,t,i,this.updates):M(this.int32Array,t,i,this.updates)}free(e){this.shared&&((0,n.s2)(o.II,!0),this.checkBuffer()),this.free_(e),this.shared&&(0,n.Tl)(o.II)}sizeof(e){if(0===e)return 0;let t=v(e-=this.heapOffset);return P(this.int32Array,t)&&(t=this.int32Array[t-1]),g(x(this.int32Array,t))}inspect(){return this.checkBuffer(),function(e,t){const i=[],r=w(e,1,t);let s=u,a=0;for(;s<e.length-1;){const r=x(e,s);(r<2||r>=e.length)&&c.h2(`Got invalid sized chunk at ${g(s)} (${g(r)})`,l,621),S(e,s)?i.push(w(e,s,t)):(a+=g(r),i.push({type:"used",block:s,offset:g(s)+t,size:g(r)})),s+=r+2}return{header:r,blocks:i,total:g(e.length),used:a}}(this.int32Array,this.heapOffset)}findFreeBlock(e,t){let i=function(e,t){let i=1;for(let r=e[1];r>0;r--){let s=e[i+2+(r-1)];for(;1!==s&&e[s-1]<t;)i=s,s=e[i+2+(r-1)]}return i=e[i+2],i}(e,t);if(1===i){if(this.options.growAllowed&&this.heapLength<this.options.maxHeapSize){const e=this.int32Array.length+1;let i,o,c=0,l=0,d=0;if(this.options.onResize){var r,s,n;const e=this.options.onResize(this.int32Array,this.int32Array.byteLength+y(Math.max(this.options.growSize,g(t)),7));c=null!==(r=e.byteOffset)&&void 0!==r?r:0,d=A(c+g(h),null!==(s=e.byteLength)&&void 0!==s?s:e.buffer.byteLength),l=b((null!==(n=e.byteLength)&&void 0!==n?n:e.buffer.byteLength)-d),i=new Int32Array(e.buffer,d,v(l)),o=new Int32Array(e.buffer,c,h)}else{const e=new ArrayBuffer(this.int32Array.length+v(this.options.growSize));d=A(c+g(h),e.byteLength),l=b(e.byteLength-d),i=new Int32Array(e,d,v(l)),i.set(this.int32Array,0),o=new Int32Array(e,c,h)}this.byteOffset=c,this.heapOffset=d,this.buffer=i.buffer,this.heapLength=l,this.int32Array=i,this.updates=o;const u=i.length-(e-1)-2;k(i,u,e);const f=_(i,e);return 0!==f?C(i,f,e,u,this.updates):M(i,e,u,this.updates),this.handles.length&&a.__(this.handles,(e=>{e(this.buffer)})),this.findFreeBlock(this.int32Array,t)}return i}return i}getBuffer(){return this.buffer}isAlloc(e){this.shared&&((0,n.s2)(o.II,!0),this.checkBuffer());const t=v(e-this.heapOffset);let i=this.int32Array[3];for(;i&&1!==i;){if(t>=i&&t<i+this.int32Array[i-1])return this.shared&&(0,n.Tl)(o.II),!1;i=this.int32Array[i+2]}return this.shared&&(0,n.Tl)(o.II),!0}checkBuffer(){this.options.memory&&this.options.memory.buffer!==this.buffer&&(this.buffer=this.options.memory.buffer,this.heapLength=b(this.buffer.byteLength-this.heapOffset),this.int32Array=new Int32Array(this.buffer,this.heapOffset,v(this.heapLength)))}}function p(e,t,i){e[t-1]!==e[t+i]&&c.h2(`Block length header does not match footer (${g(e[t-1])} vs ${g(e[t+i])}).`,l,581);const r=e[t+0];(r<1||r>h)&&c.h2(`Block ${g(t)} height must be between 1 and 32, got ${r}.`,l,586);for(let i=0;i<r;i++){const r=e[t+2+i];r>=u&&!S(e,r)&&c.h2(`Block ${g(t)} has a pointer to a non-free block (${g(r)}).`,l,592)}return!0}function m(e,t,i){if(e[t-1]===e[t+i])return!0;c.h2(`Block length header does not match footer (${g(e[t-1])} vs ${g(e[t+i])}).`,l,601)}function g(e){return e<<2>>>0}function v(e){return e>>>2}function y(e,t){return(e+t&~t)>>>0}function A(e,t){const i=t-e;return e+(y(i,7)===i?0:i-y(i,7)+8)}function b(e){return e-4}function w(e,t,i){const r=e[t+0],s=[];for(let i=0;i<r;i++)s.push(e[t+2+i]);return{type:"free",block:t,offset:g(t)+i,height:r,pointers:s,size:g(e[t-1])}}function x(e,t){const i=e[t-1],r=i>>31;return i+r^r}function k(e,t,i){e[i-1]=t,e[i+t]=t}function T(e,t,i){let r=1;for(let s=e[1];s>0;s--){let a=r+2+(s-1);for(;e[a]>=u&&e[e[a]-1]<t;)r=e[a],a=r+2+(s-1);i[s-1]=r}}function I(e,t,i,r){T(e,i,r);let s=e[r[0]+2];for(;s!==t&&1!==s&&e[s-1]<=i;){for(let i=e[s+0]-1;i>=0;i--)e[s+2+i]===t&&(r[i]=s);s=e[s+2]}let a=e[1];for(let i=0;i<a&&e[r[i]+2+i]===t;i++)e[r[i]+2+i]=e[t+2+i];for(;a>0&&1===e[a-1+3];)a--,e[1]=a;e[t-1]=-i,e[t+i]=-i}function S(e,t){return!(t<65)&&!(e[t-1]<0)}function P(e,t){return!(t<65)&&!(e[t-1]<0)}function _(e,t){if(t<=u)return 0;const i=e[t-2];return i<2?0:t-(2+i)}function M(e,t,i,r){T(e,i,r);const s=function(e,t,i,r){const s=e[1];let a=function(){let e=1;for(;Math.random()<.5&&e<h;)e+=1;return e}();if(i-1<a+1&&(a=i-2),a>s){const i=s+1;return e[1]=i,e[i-1+3]=1,r[i]=1,e[t+0]=i,i}return e[t+0]=a,a}(e,t,i,r);for(let i=1;i<=s;i++){const s=r[i-1]+2+(i-1);e[t+2+(i-1)]=e[s],e[s]=t,r[i-1]=1}return e[t-1]=i,e[t+i]=i,i}function C(e,t,i,r,s){const a=i-t+r;return I(e,t,i-t-2,s),e[t-1]=-a,e[i+r]=-a,M(e,t,a,s),r}},94321:(e,t,i)=>{"use strict";i.d(t,{z:()=>s});var r=i(134);class s{constructor(){(0,r.A)(this,"table",void 0),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"nodes",void 0),this.table=new WebAssembly.Table({initial:16,element:"anyfunc",address:"i32",index:"i32"}),this.pointer=6,this.nodes=[{pointer:this.pointer,length:10,free:!0}]}getPointer(){return this.pointer}alloc(e){let t=this.findFree(e);if(t<0){const i=this.nodes[this.nodes.length-1],r=e-(i.free?i.length:0);this.table.grow(r),i.free?i.length=i.length+r:this.nodes.push({pointer:i.pointer+i.length,length:r,free:!0}),t=this.findFree(e)}const i=this.nodes[t];return i.length>e&&(this.nodes.splice(t+1,0,{pointer:i.pointer+e,length:i.length-e,free:!0}),i.length=e),i.free=!1,i.pointer}free(e){let t=this.findNode(e);const i=this.nodes[t];if(i&&!i.free){const e=this.nodes[t-1],r=this.nodes[t+1];e&&e.free?r&&r.free?(e.length+=i.length+r.length,this.nodes.splice(t,2)):(e.length+=i.length,this.nodes.splice(t,1)):r&&r.free?(i.length+=r.length,this.nodes.splice(t+1,1),i.free=!0):i.free=!0}if(1===this.nodes.length&&this.nodes[0].free){const e=new WebAssembly.Table({initial:16,element:"anyfunc",address:"i32",index:"i32"});this.pointer=6,this.nodes=[{pointer:this.pointer,length:10,free:!0}];for(let t=1;t<this.pointer;t++)e.set(t,this.table.get(t));this.table=e}}get(e){return this.table.get(e)}set(e,t){if(e<0||e>=this.pointer)throw new RangeError("index out of bound");this.table.set(e,t)}inspect(){return this.nodes}findFree(e){let t=-1;for(let i=0;i<this.nodes.length;i++)if(this.nodes[i].length>=e&&this.nodes[i].free){t=i;break}return t}findNode(e){let t=-1;for(let i=0;i<this.nodes.length;i++)if(this.nodes[i].pointer===e){t=i;break}return t}}},15541:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r="AGFzbQEAAAABLwlgAn9/AGACf34AYAJ/fQBgAn98AGABfwF/YAF/AX5gAX8BfWABfwF8YAN/f38AAhIBA2VudgZtZW1vcnkCAwGAgAQDERAAAAABAgMEBAQEBAUGBwgIB5YBEAZ3cml0ZTgAAAd3cml0ZTE2AAEHd3JpdGUzMgACB3dyaXRlNjQAAwh3cml0ZWYzMgAECHdyaXRlZjY0AAUFcmVhZDgABgZyZWFkVTgABwZyZWFkMTYACAdyZWFkVTE2AAkGcmVhZDMyAAoGcmVhZDY0AAsHcmVhZGYzMgAMB3JlYWRmNjQADQRmaWxsAA4EY29weQAPCpYBEAkAIAAgAToAAAsJACAAIAE7AQALCQAgACABNgIACwkAIAAgATcDAAsJACAAIAE4AgALCQAgACABOQMACwcAIAAsAAALBwAgAC0AAAsHACAALgEACwcAIAAvAQALBwAgACgCAAsHACAAKQMACwcAIAAqAgALBwAgACsDAAsLACAAIAEgAvwLAAsMACAAIAEgAvwKAAAL"},98564:(e,t,i)=>{"use strict";i.d(t,{Ts:()=>h});var r=i(4919),s=i(4624),a=i(63939),n=i(50932),o=i(88096),c=i(15541);const l="src/cheap/asm/memory.ts";let d;function h(e,t,i){try{const s=o.bx((0,r.E_)(c.A),{shared:"function"==typeof SharedArrayBuffer&&e.buffer instanceof SharedArrayBuffer,initial:t,maximum:i});d=new WebAssembly.Instance(new WebAssembly.Module(s),{env:{memory:e}}),(0,a.$)({4:d.exports.readU8,5:d.exports.readU8,2:d.exports.readU8,3:d.exports.readU8,6:d.exports.readU16,7:d.exports.readU16,8:e=>d.exports.read32(e)>>>0,9:e=>d.exports.read32(e)>>>0,10:e=>BigInt.asUintN(64,d.exports.read64(e)),22:e=>BigInt.asUintN(64,d.exports.read64(e)),11:d.exports.read8,12:d.exports.read8,13:d.exports.read16,14:d.exports.read16,15:d.exports.read32,16:d.exports.read32,17:d.exports.read64,21:d.exports.read64,18:d.exports.readf32,19:d.exports.readf64,20:e=>d.exports.read32(e)>>>0,25:e=>d.exports.read32(e)>>>0}),(0,n.$)({4:d.exports.write8,5:d.exports.write8,2:d.exports.write8,3:d.exports.write8,6:d.exports.write16,7:d.exports.write16,8:d.exports.write32,9:d.exports.write32,10:d.exports.write64,22:d.exports.write64,11:d.exports.write8,12:d.exports.write8,13:d.exports.write16,14:d.exports.write16,15:d.exports.write32,16:d.exports.write32,17:d.exports.write64,21:d.exports.write64,18:d.exports.writef32,19:d.exports.writef64,20:d.exports.write32,25:d.exports.write32,copy:d.exports.copy,fill:d.exports.fill})}catch(e){s.R8("memory asm not support, cannot use asm memory function",l,119)}}},26429:(e,t,i)=>{"use strict";i.r(t),i.d(t,{HEAP_INITIAL:()=>p,HEAP_MAXIMUM:()=>m,HEAP_OFFSET:()=>f,STACK_ALIGNMENT:()=>h,STACK_SIZE:()=>u,USE_THREADS:()=>d});var r,s,a=i(95797),n=i(10576),o=i(86834),c=i(44690);const l=n.TK,d=!!a.A.thread&&!l.CHEAP_DISABLE_THREAD;let h=16,u=1048576;const f=1024,p=null!==(r=l.CHEAP_HEAP_INITIAL)&&void 0!==r?r:265,m=null!==(s=l.CHEAP_HEAP_MAXIMUM)&&void 0!==s?s:d&&c.A.ios&&!o.A.checkVersion(c.A.version,"17",!0)?8192:65536},73281:(e,t,i)=>{"use strict";i.d(t,{A:()=>E});var r=i(59135),s=i(63939),a=i(50932);let n,o;const c=(0,r.A)();function l(e,t){o().setUint8(e,t)}function d(e){return o().getUint8(e)}function h(e,t){o().setUint16(e,t,c)}function u(e){return o().getUint16(e,c)}function f(e,t){o().setUint32(e,t,c)}function p(e){return o().getUint32(e,c)}function m(e,t){o().setBigUint64(e,t,c)}function g(e){return o().getBigUint64(e,c)}function v(e,t){o().setInt8(e,t)}function y(e){return o().getInt8(e)}function A(e,t){o().setInt16(e,t,c)}function b(e){return o().getInt16(e,c)}function w(e,t){o().setInt32(e,t,c)}function x(e){return o().getInt32(e,c)}function k(e,t){o().setBigInt64(e,t,c)}function T(e){return o().getBigInt64(e,c)}function I(e,t){o().setFloat32(e,t,c)}function S(e){return o().getFloat32(e,c)}function P(e,t){o().setFloat64(e,t,c)}function _(e){return o().getFloat64(e,c)}function M(e){return o().getUint32(e,c)}function C(e,t){return o().setUint32(e,t,c)}function B(e,t){o().setUint32(e,t,c)}function E(e,t){n=e,o=t,(0,s.$)({4:d,5:d,2:d,3:d,6:u,7:u,8:p,9:p,10:g,11:y,12:y,13:b,14:b,15:x,16:x,17:T,18:S,19:_,20:M,23:e=>!!y(e),24:e=>!!y(e),25:e=>function(e){return o().getUint32(e,c)}(e)}),(0,a.$)({4:l,5:l,2:l,3:l,6:h,7:h,8:f,9:f,10:m,11:v,12:v,13:A,14:A,15:w,16:w,17:k,18:I,19:P,20:C,23:(e,t)=>{v(e,t?1:0)},24:(e,t)=>{v(e,t?1:0)},25:B})}},63939:(e,t,i)=>{"use strict";i.d(t,{$:()=>a,f:()=>s});var r=i(95335);const s={4:function(e){throw new Error("unimplemented")},5:function(e){throw new Error("unimplemented")},2:function(e){throw new Error("unimplemented")},3:function(e){throw new Error("unimplemented")},6:function(e){throw new Error("unimplemented")},7:function(e){throw new Error("unimplemented")},8:function(e){throw new Error("unimplemented")},9:function(e){throw new Error("unimplemented")},10:function(e){throw new Error("unimplemented")},11:function(e){throw new Error("unimplemented")},12:function(e){throw new Error("unimplemented")},13:function(e){throw new Error("unimplemented")},14:function(e){throw new Error("unimplemented")},15:function(e){throw new Error("unimplemented")},16:function(e){throw new Error("unimplemented")},17:function(e){throw new Error("unimplemented")},18:function(e){throw new Error("unimplemented")},19:function(e){throw new Error("unimplemented")},20:function(e){throw new Error("unimplemented")},0:function(e){throw new Error("invalid operate")},1:function(e){throw new Error("invalid operate")},22:function(e){throw new Error("invalid operate")},21:function(e){throw new Error("invalid operate")},23:function(e){throw new Error("invalid operate")},24:function(e){throw new Error("invalid operate")},25:function(e){throw new Error("unimplemented")}};function a(e){r.X$(s,e)}},50932:(e,t,i)=>{"use strict";i.d(t,{$:()=>a,M:()=>s});var r=i(95335);const s={4:function(e,t){throw new Error("unimplemented")},5:function(e,t){throw new Error("unimplemented")},2:function(e,t){throw new Error("unimplemented")},3:function(e,t){throw new Error("unimplemented")},6:function(e,t){throw new Error("unimplemented")},7:function(e,t){throw new Error("unimplemented")},8:function(e,t){throw new Error("unimplemented")},9:function(e,t){throw new Error("unimplemented")},10:function(e,t){throw new Error("unimplemented")},11:function(e,t){throw new Error("unimplemented")},12:function(e,t){throw new Error("unimplemented")},13:function(e,t){throw new Error("unimplemented")},14:function(e,t){throw new Error("unimplemented")},15:function(e,t){throw new Error("unimplemented")},16:function(e,t){throw new Error("unimplemented")},17:function(e,t){throw new Error("unimplemented")},18:function(e,t){throw new Error("unimplemented")},19:function(e,t){throw new Error("unimplemented")},20:function(e,t){throw new Error("unimplemented")},0:function(e,t){throw new Error("invalid operate")},1:function(e,t){throw new Error("invalid operate")},22:function(e,t){throw new Error("invalid operate")},21:function(e,t){throw new Error("invalid operate")},23:function(e,t){throw new Error("invalid operate")},24:function(e,t){throw new Error("invalid operate")},25:function(e,t){throw new Error("unimplemented")},copy:function(e,t,i){throw new Error("invalid operate")},fill:function(e,t,i){throw new Error("invalid operate")}};function a(e){r.X$(s,e)}},25323:(e,t,i)=>{"use strict";i.d(t,{X:()=>D,l:()=>E});var r=i(66681),s=i.n(r),a=i(11919),n=i.n(a),o=i(75019),c=i.n(o),l=i(99921),d=i(63939),h=i(50932),u=i(61499),f=i(6704),p=i(67672),m=i(95335),g=i(62100),v=i(72739);function y(e,t,i,r){s()(e,t,{get:i,set:r,configurable:!0,enumerable:!0})}function A(e){return function(){return d.f[20](e())}}function b(e,t,i,r){return function(){return e[`__$__${t}`]||(e[`__$__${t}`]=E(i(),r))}}function w(e,t){return function(){return d.f[t](e())}}function x(e,t,i,r){const s=8*f.i[t]-r-i,a=Math.pow(2,i)-1;return function(){return d.f[t](e())>>>s&a}}function k(e){return function(t){h.M[20](e(),t)}}function T(e,t,i,r){const s=`__$__${t}`;return function(t){const a=e[s]||(e[s]=E(i(),r));m.__(t,((e,t)=>{a[t]=e})),e[s]=a}}function I(e,t){return function(i){h.M[t](e(),i)}}function S(e,t,i,r){let s=0,a=8*f.i[t];for(let e=0;e<i;e++)s|=1<<a-1-(e+r);const n=Math.pow(2,i)-1,o=a-r-i;return function(i){const r=e(),a=d.f[t](r);h.M[t](r,a&~s|(i&n)<<o)}}function P(e,t,i){const r={};let s=(0,l.A)(i);for(let a=0;a<t;a++){const t=(0,g.A)(a);y(r,t,b(r,t,(()=>e()+s*a),i),T(r,t,(()=>e()+s*a),i))}return r}function _(e,t,i){const r={};let s=(0,l.A)(i);for(let a=0;a<t;a++)y(r,(0,g.A)(a),w((()=>e()+s*a),i),I((()=>e()+s*a),i));return r}function M(e,t,i,r,s){return function(){let a=t[`__$__${i}`];return a||(a=p.Pc(s)||p.Ik(s)?P(e,r,s):_(e,r,s),t[`__$__${i}`]=a),a[u.o9]=e(),a}}function C(e,t,i,r,s){const a=`__$__${t}`;return function(t){let n=e[a]||P(i,r,s);n[u.o9]=i(),v.__(t,((e,t)=>{n[t]=e})),e[a]=n}}function B(e,t,i,r,s){const a=`__$__${t}`;return function(t){let n=e[a]||_(i,r,s);n[u.o9]=i(),v.__(t,((e,t)=>{n[t]=e})),e[a]=n}}function E(e,t){let i=p.Pc(t)?t.prototype:t;const r={};for(r[u.o9]=e,n()(r,i);;){let e=i[u.JY];if(e&&e.forEach(((e,t)=>{e[3]?e[1]?y(r,t,M((()=>r[u.o9]+e[7]),r,t,e[4],e[0]),B(r,t,(()=>r[u.o9]+e[7]),e[4],20)):p.Pc(e[0])||p.Ik(e[0])?y(r,t,M((()=>r[u.o9]+e[7]),r,t,e[4],e[0]),C(r,t,(()=>r[u.o9]+e[7]),e[4],e[0])):y(r,t,M((()=>r[u.o9]+e[7]),r,t,e[4],e[0]),B(r,t,(()=>r[u.o9]+e[7]),e[4],e[0])):e[1]?y(r,t,A((()=>r[u.o9]+e[7])),k((()=>r[u.o9]+e[7]))):p.Pc(e[0])||p.Ik(e[0])?y(r,t,b(r,t,(()=>r[u.o9]+e[7]),e[0]),T(r,t,(()=>r[u.o9]+e[7]),e[0])):e[5]?y(r,t,x((()=>r[u.o9]+e[7]),e[0],e[6],e[8]),S((()=>r[u.o9]+e[7]),e[0],e[6],e[8])):y(r,t,w((()=>r[u.o9]+e[7]),e[0]),I((()=>r[u.o9]+e[7]),e[0]))})),i=c()(i),!i)break}return r}function D(e){let t=c()(e);for(;;){let i=t[u.JY];if(i&&i.forEach(((t,i)=>{delete e[i]})),t=c()(t),!t)break}}},12085:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(66681),s=i.n(r);function a(e,t,i){s()(e,t,{value:i,writable:!1,enumerable:!1,configurable:!1})}},11473:(e,t,i)=>{"use strict";i.d(t,{GE:()=>x,Lv:()=>O,Tg:()=>H,XI:()=>I,ce:()=>P,eq:()=>g,pv:()=>G,s_:()=>S,wE:()=>k});var r=i(39638),s=i(95007),a=i(94321),n=i(10576),o=i(26429),c=i(7417),l=i(33856),d=i(98564),h=i(82854),u=i(73281),f=i(54568),p=i(86834),m=i(44690);let g,v,y,A=-1,b=!0,w="",x=null,k=null,T=0,I=null,S=null,P=null,_=null,M=null,C=null,B=null,E=null,D=null,R=null,U=null,L=null,$={5:E,3:E,7:D,9:R,22:U,12:_,14:M,16:C,21:B};function F(){return!(!P||P.buffer===E.buffer)}function O(){return P.buffer}function N(){return F()&&j(P.buffer),E}function z(){return F()&&j(P.buffer),L}function V(e){return F()&&j(P.buffer),$[e]}function W(){o.USE_THREADS?(g=N,v=z,y=V):(g=()=>E,v=()=>L,y=e=>$[e])}function j(e){_=new Int8Array(e),M=new Int16Array(e),C=new Int32Array(e),B=new BigInt64Array(e),E=new Uint8Array(e),D=new Uint16Array(e),R=new Uint32Array(e),U=new BigUint64Array(e),L=new DataView(e),$={5:E,3:E,7:D,9:R,22:U,12:_,14:M,16:C,21:B}}function G(){return Atomics.add(R,c.hb>>>2,1)}async function H(e){var t;W(),(0,u.A)((()=>S),v),(0,l.A)(y),P=e.memory,e.disableAsm||("function"==typeof BigInt&&BigInt!==Number&&(p.A.chrome&&p.A.checkVersion(p.A.majorVersion,"85",!0)||p.A.firefox&&p.A.checkVersion(p.A.majorVersion,"78",!0)||p.A.safari&&p.A.checkVersion(p.A.majorVersion,"15",!0)||m.A.ios&&p.A.checkVersion(m.A.version,"15",!0)||p.A.newEdge)&&d.Ts(P,o.HEAP_INITIAL,o.HEAP_MAXIMUM),(p.A.chrome&&p.A.checkVersion(p.A.majorVersion,"85",!0)||p.A.firefox&&p.A.checkVersion(p.A.majorVersion,"78",!0)||p.A.safari&&p.A.checkVersion(p.A.majorVersion,"15",!0)||m.A.ios&&p.A.checkVersion(m.A.version,"15",!0)||p.A.newEdge)&&h.Ts(P,o.HEAP_INITIAL,o.HEAP_MAXIMUM));var i;i=new s.A({buffer:P.buffer,memory:P,byteOffset:o.HEAP_OFFSET,maxHeapSize:64*o.HEAP_MAXIMUM*1024,growAllowed:!0,onResize:(e,t)=>(P.grow(t-e.byteLength>>>16),{buffer:P.buffer,byteOffset:o.HEAP_OFFSET})},!1),S&&S.removeUpdateHandle(j),S=i,n.TK.CHeap&&(n.TK.CHeap.Allocator=S),S.addUpdateHandle(j),j(S.getBuffer()),e.stackPointer&&(T=e.stackSize,k=e.stackPointer,x=new WebAssembly.Global({value:"i32",mutable:!0},k+T),I=new a.z),A="number"==typeof e.id?e.id:Atomics.add(R,c.hb>>>2,1),w=null!==(t=e.name)&&void 0!==t?t:"anonymous",n.TK.CHeap={initThread:H,Allocator:S,Table:I,ThreadId:A,ThreadName:w,Memory:P,Config:o,StackSize:T,StackTop:k,StackPointer:x,isMainThread:!1},b=!1}!(0,r.A)()&&!(0,f.A)()||(0,r.A)()&&!o.USE_THREADS?function(){var e,t,i,r,f,g,_,M;if(W(),(0,u.A)((()=>S),v),(0,l.A)(y),P=null!==(e=n.TK.CHeap)&&void 0!==e&&e.Memory?n.TK.CHeap.Memory:new WebAssembly.Memory({initial:o.HEAP_INITIAL,maximum:o.HEAP_MAXIMUM,shared:o.USE_THREADS,address:"i32",index:"i32"}),"function"==typeof BigInt&&BigInt!==Number&&(p.A.chrome&&p.A.checkVersion(p.A.majorVersion,"85",!0)||p.A.firefox&&p.A.checkVersion(p.A.majorVersion,"78",!0)||p.A.safari&&p.A.checkVersion(p.A.majorVersion,"15",!0)||m.A.ios&&p.A.checkVersion(m.A.version,"15",!0)||p.A.newEdge)&&o.USE_THREADS&&d.Ts(P,o.HEAP_INITIAL,o.HEAP_MAXIMUM),o.USE_THREADS&&(p.A.chrome&&p.A.checkVersion(p.A.majorVersion,"85",!0)||p.A.firefox&&p.A.checkVersion(p.A.majorVersion,"78",!0)||p.A.safari&&p.A.checkVersion(p.A.majorVersion,"15",!0)||m.A.ios&&p.A.checkVersion(m.A.version,"15",!0)||p.A.newEdge)&&h.Ts(P,o.HEAP_INITIAL,o.HEAP_MAXIMUM),S=null!==(t=n.TK.CHeap)&&void 0!==t&&t.Allocator?n.TK.CHeap.Allocator:new s.A({buffer:P.buffer,memory:P,byteOffset:o.HEAP_OFFSET,maxHeapSize:64*o.HEAP_MAXIMUM*1024,growAllowed:!0,onResize:(e,t)=>(P.grow(t-e.byteLength>>>16),{buffer:P.buffer,byteOffset:o.HEAP_OFFSET})}),S.addUpdateHandle(j),j(S.getBuffer()),T=null!==(i=n.TK.CHeap)&&void 0!==i&&i.StackSize?n.TK.CHeap.StackSize:o.STACK_SIZE,k=null!==(r=n.TK.CHeap)&&void 0!==r&&r.StackTop?n.TK.CHeap.StackTop:S.malloc(T),x=null!==(f=n.TK.CHeap)&&void 0!==f&&f.StackPointer?n.TK.CHeap.StackPointer:new WebAssembly.Global({value:"i32",mutable:!0},k+T),I=null!==(g=n.TK.CHeap)&&void 0!==g&&g.Table?n.TK.CHeap.Table:new a.z,A=null!==(_=n.TK.CHeap)&&void 0!==_&&_.ThreadId?n.TK.CHeap.ThreadId:0,w=null!==(M=n.TK.CHeap)&&void 0!==M&&M.ThreadName?n.TK.CHeap.ThreadName:"main",!n.TK.CHeap)if(o.USE_THREADS)Atomics.store(R,c.hb>>>2,A+1),Atomics.store(C,c.II>>>2,0);else{R[c.hb>>>2]=A+1;let e=c.II>>>2;C[e]=0}n.TK.CHeap||(n.TK.CHeap={Allocator:S,Table:I,ThreadId:A,ThreadName:w,Memory:P,Config:o,StackSize:T,StackTop:k,StackPointer:x,isMainThread:!0,threadCounter:c.hb,heapMutex:c.II}),b=!0}():(n.TK.CHeap={initThread:H,isMainThread:!1,Config:o},b=!1)},80098:(e,t,i)=>{"use strict";i.d(t,{I_:()=>w,SQ:()=>x});var r=i(75019),s=i.n(r),a=i(11919),n=i.n(a),o=i(42096),c=i.n(o),l=i(99921),d=i(63939),h=i(50932),u=i(61499),f=i(6704),p=i(67672),m=i(95335),g=i(72739),v=i(2148);const y=s()({});function A(e,t){for(;;){let i=e[u.JY];if(i){const e=i.get(t);if(e)return e}if(!(e=s()(e))||e===y)return null}}function b(e,t,i,r){const s={};s[u.o9]=e;let a=(0,l.A)(r?20:i);return new Proxy(s,{get(e,t,s){if(t===u.o9)return e[u.o9];const n=(0,v.A)(t);return r?d.f[20](e[u.o9]+n*a):p.Pc(i)?e[t]:d.f[i](e[u.o9]+n*a)},set(e,t,s,n){if(t===u.o9)return e[u.o9]=s,!0;const o=(0,v.A)(t);if(r)h.M[20](e[u.o9]+o*a,s),e[t]=s;else if(p.Pc(i)){const r=e[t]||(e[t]=w(e[u.o9]+o*a,i));m.__(s,((e,t)=>{r[t]=e})),e[t]=r}else h.M[i](e[u.o9]+o*a,s),e[t]=s;return!0}})}function w(e,t){const i=p.Pc(t)?t.prototype:t,r={};r[u.o9]=e,n()(r,i);const{proxy:s,revoke:a}=Proxy.revocable(r,{get(e,t,r){if(p.Yj(t)){const r=A(i,t.replace(/^\$+/,""));if(r){const i=e[u.o9]+r[7];if(r[3]){let s=e[t];return s||(s=b(i,r[4],r[0],r[1]),e[t]=s),s[u.o9]=i,s}if(r[1])return d.f[20](i);if(p.Pc(r[0])||p.Ik(r[0]))return e[t]||(e[t]=w(i,r[0]));{let e=d.f[r[0]](i);return r[5]&&(e=e>>>8*f.i[r[0]]-r[8]-r[6]&Math.pow(2,r[6])-1),e}}return e[t]}return e[t]},set(e,t,r,s){if(p.Yj(t)){const s=A(i,t.replace(/^\$+/,""));if(s){const i=e[u.o9]+s[7];if(s[3]){const a=e[t]||b(i,s[4],s[0],s[1]);g.__(r,((e,t)=>{a[t]=e})),e[t]=a}else if(s[1])h.M[20](i,r),e[t]=r;else if(p.Pc(s[0])||p.Ik(s[0])){const a=e[t]||(e[t]=w(i,s[0]));m.__(r,((e,t)=>{a[t]=e})),e[t]=a}else{if(s[5]){let e=0,t=8*f.i[s[0]];for(let i=0;i<s[6];i++)e|=1<<t-1-(i+s[8]);const a=d.f[s[0]](i);h.M[s[0]](i,a&~e|(r&Math.pow(2,s[6])-1)<<t-s[8]-s[6])}else h.M[s[0]](i,r);e[t]=r}}else e[t]=r}else e[t]=r;return!0},getOwnPropertyDescriptor:(e,t)=>({enumerable:!0,configurable:!0}),ownKeys:e=>c()(e[u.JY].keys())});return r[u.kE]=a,s}function x(e){const t=e[u.kE];t&&t()}},52699:(e,t,i)=>{"use strict";i.d(t,{t:()=>a,z:()=>s});var r=i(11473);function s(e){return r.GE.value=r.GE.value-e,r.GE.value}function a(e){r.GE.value=r.GE.value+e}},7417:(e,t,i)=>{"use strict";i.d(t,{II:()=>l,hb:()=>c,z1:()=>o});var r,s,a=i(10576);let n=4;function o(e,t=1){let i=n;for(;i%t;)i+=1;return n=i+e,i}const c=null!==(r=a.TK.CHeap)&&void 0!==r&&r.threadCounter?a.TK.CHeap.threadCounter:o(4,4),l=null!==(s=a.TK.CHeap)&&void 0!==s&&s.heapMutex?a.TK.CHeap.heapMutex:o(4,4)},79630:(e,t,i)=>{"use strict";i.d(t,{A:()=>d});var r=i(134),s=i(63939),a=i(50932),n=i(11473),o=i(61403),c=i(26429);class l{constructor(e,t){(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"len",void 0),(0,r.A)(this,"view",void 0),this.pointer=e,this.len=t}get byteLength(){return this.len}get buffer(){return n.Lv}get byteOffset(){return this.pointer}getView(){return this.view&&this.view.buffer===n.ce.buffer||(this.view=new DataView((0,n.Lv)(),this.pointer,this.len)),this.view}getFloat32(e,t){return this.getView().getFloat32(e,t)}getFloat64(e,t){return this.getView().getFloat64(e,t)}getInt8(e){return this.getView().getInt8(e)}getInt16(e,t){return this.getView().getInt16(e,t)}getInt32(e,t){return this.getView().getInt32(e,t)}getUint8(e){return this.getView().getUint8(e)}getUint16(e,t){return this.getView().getUint16(e,t)}getUint32(e,t){return this.getView().getUint32(e,t)}setFloat32(e,t,i){this.getView().setFloat32(e,t,i)}setFloat64(e,t,i){this.getView().setFloat64(e,t,i)}setInt8(e,t){this.getView().setInt8(e,t)}setInt16(e,t,i){this.getView().setInt16(e,t,i)}setInt32(e,t,i){this.getView().setInt32(e,t,i)}setUint8(e,t){this.getView().setUint8(e,t)}setUint16(e,t,i){this.getView().setUint16(e,t,i)}setUint32(e,t,i){this.getView().setUint32(e,t,i)}getBigInt64(e,t){return this.getView().getBigInt64(e,t)}getBigUint64(e,t){return this.getView().getBigUint64(e,t)}setBigInt64(e,t,i){this.getView().setBigInt64(e,t,i)}setBigUint64(e,t,i){this.getView().setBigUint64(e,t,i)}}class d extends o.A{constructor(e,t){return super(),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"len",void 0),this.pointer=e,this.len=t,this.proxy}getIndexValue(e){return s.f[2](this.pointer+e)}setIndexValue(e,t){a.M[2](this.pointer+e,t)}set(e,t=0){new Uint8Array((0,n.Lv)(),this.pointer,this.len).set(e,t)}subarray(e=0,t,i){return i&&!c.USE_THREADS?new d(this.pointer+e,(t||this.len)-e):new Uint8Array((0,n.Lv)(),this.pointer+e,(null!=t?t:this.len)-e)}slice(e=0,t){return new Uint8Array((0,n.Lv)(),this.pointer+e,(null!=t?t:this.len)-e).slice()}get length(){return this.len}get byteLength(){return this.len}get buffer(){return(0,n.Lv)()}get byteOffset(){return this.pointer}get view(){return new l(this.pointer,this.len)}}},12264:(e,t,i)=>{"use strict";i.d(t,{A:()=>y});var r,s,a=i(134),n=i(80662),o=i.n(n),c=i(61499),l=i(12085),d=i(11473),h=i(63939),u=i(50932),f=i(99921),p=i(14686),m=i(67672),g=i(29170);class v{constructor(){(0,a.A)(this,"prev",void 0),(0,a.A)(this,"next",void 0),(0,a.A)(this,"data",void 0)}}r=v.prototype,(s=new(o())).set("prev",{0:v,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("next",{0:v,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("data",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:8,8:0}),(0,l.A)(r,c.Og,!0),(0,l.A)(r,c.dc,4),(0,l.A)(r,c.g7,12),(0,l.A)(r,c.JY,s);class y{constructor(){(0,a.A)(this,"length",0),(0,a.A)(this,"head",0),(0,a.A)(this,"tail",0)}createNode(e,t,i=!1){const r=d.s_.malloc(12);if(u.M[20](r+4,0),u.M[20](r,0),m.ai(t))if(20===t)u.M[20](r+8,e);else{const i=d.s_.malloc((0,f.A)(t));u.M[t](i,e),u.M[20](r+8,i)}else if(i)u.M[20](r+8,e);else{const i=d.s_.malloc((0,f.A)(t));(0,p.Mr)(i,e[c.o9],(0,f.A)(t)),u.M[20](r+8,i)}return r}getItem(e,t){let i;return i=m.ai(t)?20===t?e:h.f[t](e):(0,g.A)(e,t),i}push(e,t,i=!1){const r=this.createNode(e,t,i);this.tail?(u.M[20](this.tail+4,r),u.M[20](r,this.tail),this.tail=r):(this.head=r,this.tail=r),this.length++}pop(e){const t=this.tail;let i=this.getItem(h.f[20](t+8),e);return this.length>1?(u.M[20](h.f[20](t)+4,0),this.tail=h.f[20](t)):(this.head=0,this.tail=0),this.length--,d.s_.free(h.f[20](t+8)),d.s_.free(t),i}shift(e){const t=this.head;let i=this.getItem(h.f[20](t+8),e);return this.length>1?(u.M[20](h.f[20](t+4),0),this.head=h.f[20](t+4)):(this.head=0,this.tail=0),this.length--,d.s_.free(h.f[20](t+8)),d.s_.free(t),i}unshift(e,t,i=!1){const r=this.createNode(e,t,i);this.head?(u.M[20](this.head,r),u.M[20](r+4,this.head),this.head=r):(this.head=r,this.tail=r),this.length++}forEach(e,t){if(!this.length)return;let i=this.head,r=0;for(;0!==i&&!1!==e(this.getItem(h.f[20](i+8),t),r);)i=h.f[20](i+4),r++}find(e,t){if(!this.length)return 0;let i=this.head,r=0;for(;0!==i;){const s=this.getItem(h.f[20](i+8),t);if(!0===e(s,r))return s;i=h.f[20](i+4),r++}return 0}indexOf(e,t){if(!this.length)return 0;let i=this.head,r=0;for(;0!==i;){if(r===e)return this.getItem(h.f[20](i+8),t);i=h.f[20](i+4),r++}return 0}clear(e,t){if(this.length){let i=this.head;for(;0!==i;){e&&e(this.getItem(h.f[20](i+8),t)),d.s_.free(h.f[20](i+8));const r=h.f[20](i+4);d.s_.free(i),i=r}}this.head=0,this.tail=0,this.length=0}}!function(e){var t=new(o());t.set("length",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("head",{0:v,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),t.set("tail",{0:v,1:1,2:1,3:0,4:0,5:0,6:0,7:8,8:0}),(0,l.A)(e,c.Og,!0),(0,l.A)(e,c.dc,4),(0,l.A)(e,c.g7,12),(0,l.A)(e,c.JY,t)}(y.prototype)},72703:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(67672);function s(e){return r.ai(e)&&e>=0}},74503:(e,t,i)=>{"use strict";i.d(t,{A:()=>l});var r=i(99921),s=i(11473),a=i(14686),n=i(95335),o=i(34677),c=i(29170);function l(e,t){(0,o.A)(t)||(t=e,e=null);const i=(0,r.A)(t),l=s.s_.malloc(i);if(!l)throw new TypeError("cannot alloc memory for struct");(0,a.sO)(l,0,i);const d=(0,c.A)(l,t),h=new t;return e&&n.X$(h,e),n.__(h,((e,t)=>{(0,o.A)(e)&&(d[t]=e)})),d}},14686:(e,t,i)=>{"use strict";i.d(t,{JW:()=>u,Mr:()=>l,bg:()=>p,lH:()=>m,lW:()=>d,qW:()=>g,s3:()=>f,sO:()=>h});var r=i(11473),s=i(50011),a=i(50932),n=i(79630),o=i(26429),c=i(63939);function l(e,t,i){(0,r.eq)().set((0,r.eq)().subarray(t,t+i),e)}function d(e,t,i){(0,r.eq)().set(i.subarray(0,t),e)}function h(e,t,i){(0,r.eq)().subarray(e,e+i).fill(t)}function u(e,t){return o.USE_THREADS?f(e,t):new n.A(e,t)}function f(e,t){return new Uint8Array((0,r.Lv)(),e,t)}function p(e,t){return new Uint16Array((0,r.Lv)(),e,t)}function m(e,t){let i=0;for(;c.f[4]((e+=1)-1)&&(i++,!(t&&i>=t)););const r=Math.min(i,null!=t?t:i);return s.decode(f(e,r))}function g(e,t,i,r=!0){const n=s.encode(t);let o=n.length,c=r?1:0;i&&o-c>i&&(o=i-c),d(e,o,n),r&&a.M[11](e+o,0)}},99921:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(61499),s=i(67672),a=i(6704);function n(e){return s.ai(e)?a.i[e]||0:s.Pc(e)&&e.prototype[r.Og]?e.prototype[r.g7]:0}},29170:(e,t,i)=>{"use strict";i.d(t,{A:()=>l});var r=i(61499),s=i(80098),a=i(25323),n=i(95797),o=i(67672),c=i(10534);function l(e,t){return arguments[2]&&o.Yj(arguments[2])&&(t=t.prototype,c.__(arguments[2],(e=>{const i=t[r.JY];t=i.get(e)[0]}))),n.A.proxy?(0,s.I_)(e,t):(0,a.l)(e,t)}},94300:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(11473),s=i(61499),a=i(80098),n=i(25323),o=i(95797);function c(e){const t=e[s.o9];t&&(r.s_.free(t),e[s.o9]=0,o.A.proxy?(0,a.SQ)(e):(0,n.X)(e))}},61499:(e,t,i)=>{"use strict";i.d(t,{JY:()=>l,Og:()=>a,dc:()=>o,g7:()=>n,kE:()=>d,o9:()=>c});var r=i(75062),s=i.n(r);const a=s()("Struct"),n=s()("StructLength"),o=s()("StructMaxBaseTypeByteLength"),c=s()("StructAddress"),l=(s()("StructKeysQueue"),s()("StructKeysMeta")),d=(s()("StructKeysInstance"),s()("StructProxyRevoke"))},10047:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r="AGFzbQEAAAABLAdgAX8Bf2ABfwF+YAJ/fwF/YAJ/fgF+YAN/f38Bf2ADf35+AX5gA39/fgF/AhIBA2VudgZtZW1vcnkCAwGAgAQDKCcAAAABAgICAwICAgMCAgIDAgICAwICAgMCAgIDAgICAwQEBAUCAgYHhgMnBWxvYWQ4AAAGbG9hZDE2AAEGbG9hZDMyAAIGbG9hZDY0AAMGc3RvcmU4AAQHc3RvcmUxNgAFB3N0b3JlMzIABgdzdG9yZTY0AAcEYWRkOAAIBWFkZDE2AAkFYWRkMzIACgVhZGQ2NAALBHN1YjgADAVzdWIxNgANBXN1YjMyAA4Fc3ViNjQADwRhbmQ4ABAFYW5kMTYAEQVhbmQzMgASBWFuZDY0ABMDb3I4ABQEb3IxNgAVBG9yMzIAFgRvcjY0ABcEeG9yOAAYBXhvcjE2ABkFeG9yMzIAGgV4b3I2NAAbCWV4Y2hhbmdlOAAcCmV4Y2hhbmdlMTYAHQpleGNoYW5nZTMyAB4KZXhjaGFuZ2U2NAAfEWNvbXBhcmVfZXhjaGFuZ2U4ACASY29tcGFyZV9leGNoYW5nZTE2ACESY29tcGFyZV9leGNoYW5nZTMyACISY29tcGFyZV9leGNoYW5nZTY0ACMGbm90aWZ5ACQEd2FpdAAlC3dhaXRUaW1lb3V0ACYKugMnCAAgAP4SAAALCAAgAP4TAQALCAAgAP4QAgALCAAgAP4RAwALDAAgACAB/hkAACABCwwAIAAgAf4aAQAgAQsMACAAIAH+FwIAIAELDAAgACAB/hgDACABCwoAIAAgAf4gAAALCgAgACAB/iEBAAsKACAAIAH+HgIACwoAIAAgAf4fAwALCgAgACAB/icAAAsKACAAIAH+KAEACwoAIAAgAf4lAgALCgAgACAB/iYDAAsKACAAIAH+LgAACwoAIAAgAf4vAQALCgAgACAB/iwCAAsKACAAIAH+LQMACwoAIAAgAf41AAALCgAgACAB/jYBAAsKACAAIAH+MwIACwoAIAAgAf40AwALCgAgACAB/jwAAAsKACAAIAH+PQEACwoAIAAgAf46AgALCgAgACAB/jsDAAsKACAAIAH+QwAACwoAIAAgAf5EAQALCgAgACAB/kECAAsKACAAIAH+QgMACwwAIAAgASAC/koAAAsMACAAIAEgAv5LAQALDAAgACABIAL+SAIACwwAIAAgASAC/kkDAAsKACAAIAH+AAIACwwAIAAgAUJ//gECAAsMACAAIAEgAv4BAgAL"},82854:(e,t,i)=>{"use strict";i.d(t,{KJ:()=>l,Ko:()=>d,Ts:()=>h});var r=i(4919),s=i(4624),a=i(88096),n=i(10047),o=i(40046);const c="src/cheap/thread/asm/atomics.ts";let l;function d(){return!!l}function h(e,t,i){try{if(!("function"==typeof SharedArrayBuffer&&e.buffer instanceof SharedArrayBuffer))return;{const s=a.bx((0,r.E_)(n.A),{shared:!0,initial:t,maximum:i});l=new WebAssembly.Instance(new WebAssembly.Module(s),{env:{memory:e}})}(0,o.$Z)({add:function(e,t,i){switch(i){case 5:case 3:return 255&l.exports.add8(e,t);case 12:return l.exports.add8(e,t);case 14:return l.exports.add16(e,t);case 7:return 65535&l.exports.add16(e,t);case 16:return l.exports.add32(e,t);case 9:return 4294967295&l.exports.add32(e,t);case 21:return l.exports.add64(e,t);case 22:return BigInt.asUintN(64,l.exports.add64(e,t))}},sub:function(e,t,i){switch(i){case 5:case 3:return 255&l.exports.sub8(e,t);case 12:return l.exports.sub8(e,t);case 14:return l.exports.sub16(e,t);case 7:return 65535&l.exports.sub16(e,t);case 16:return l.exports.sub32(e,t);case 9:return 4294967295&l.exports.sub32(e,t);case 21:return l.exports.sub64(e,t);case 22:return BigInt.asUintN(64,l.exports.sub64(e,t))}},and:function(e,t,i){switch(i){case 5:case 3:return 255&l.exports.and8(e,t);case 12:return l.exports.and8(e,t);case 14:return l.exports.and16(e,t);case 7:return 65535&l.exports.and16(e,t);case 16:return l.exports.and32(e,t);case 9:return 4294967295&l.exports.and32(e,t);case 21:return l.exports.and64(e,t);case 22:return BigInt.asUintN(64,l.exports.and64(e,t))}},or:function(e,t,i){switch(i){case 5:case 3:return 255&l.exports.or8(e,t);case 12:return l.exports.or8(e,t);case 14:return l.exports.or16(e,t);case 7:return 65535&l.exports.or16(e,t);case 16:case 9:return l.exports.or32(e,t);case 21:return l.exports.or64(e,t);case 22:return BigInt.asUintN(64,l.exports.or64(e,t))}},xor:function(e,t,i){switch(i){case 5:case 3:return 255&l.exports.xor8(e,t);case 12:return l.exports.xor8(e,t);case 14:return l.exports.xor16(e,t);case 7:return 65535&l.exports.xor16(e,t);case 16:case 9:return l.exports.xor32(e,t);case 21:return l.exports.xor64(e,t);case 22:return BigInt.asUintN(64,l.exports.xor64(e,t))}},store:function(e,t,i){switch(i){case 5:case 12:case 3:return l.exports.store8(e,t);case 14:case 7:return l.exports.store16(e,t);case 16:case 9:return l.exports.store32(e,t);case 21:case 22:return l.exports.store64(e,t)}},load:function(e,t){switch(t){case 5:case 3:return 255&l.exports.load8(e);case 12:return l.exports.load8(e);case 14:case 7:return l.exports.load16(e);case 16:return l.exports.load32(e);case 9:return 4294967295&l.exports.load32(e);case 21:return l.exports.load64(e);case 22:return BigInt.asUintN(64,l.exports.load64(e))}},compareExchange:function(e,t,i,r){switch(r){case 5:case 3:return 255&l.exports.compare_exchange8(e,t,i);case 12:return l.exports.compare_exchange8(e,t,i);case 14:return l.exports.compare_exchange16(e,t,i);case 7:return 65535&l.exports.compare_exchange16(e,t,i);case 16:return l.exports.compare_exchange32(e,t,i);case 9:return 4294967295&l.exports.compare_exchange32(e,t,i);case 21:return l.exports.compare_exchange64(e,t,i);case 22:return BigInt.asUintN(64,l.exports.compare_exchange64(e,t,i))}},exchange:function(e,t,i){switch(i){case 5:case 3:return 255&l.exports.exchange8(e,t);case 12:return l.exports.exchange8(e,t);case 14:return l.exports.exchange16(e,t);case 7:return 65535&l.exports.exchange16(e,t);case 16:return l.exports.exchange32(e,t);case 9:return 4294967295&l.exports.exchange32(e,t);case 21:return l.exports.exchange64(e,t);case 22:return BigInt.asUintN(64,l.exports.exchange64(e,t))}},notify:function(e,t){return l.exports.notify(e,t)},wait:function(e,t){return l.exports.wait(e,t)},waitTimeout:function(e,t,i){return l.exports.waitTimeout(e,t,BigInt(0|i)*BigInt(1e6))}})}catch(e){s.R8("atomics asm not support, cannot use asm atomics function",c,291)}}},40046:(e,t,i)=>{"use strict";let r,s,a,n,o,c,l,d,h,u,f,p,m,g;function v(e){e.add&&(r=e.add),e.sub&&(s=e.sub),e.and&&(a=e.and),e.or&&(n=e.or),e.xor&&(o=e.xor),e.store&&(c=e.store),e.load&&(l=e.load),e.compareExchange&&(d=e.compareExchange),e.exchange&&(h=e.exchange),e.notify&&(u=e.notify),e.wait&&(f=e.wait),e.waitTimeout&&(p=e.waitTimeout),e.waitAsync&&(m=e.waitAsync),e.waitTimeoutAsync&&(g=e.waitTimeoutAsync)}i.d(t,{$Z:()=>v,Hh:()=>l,I8:()=>o,M_:()=>c,Uo:()=>a,WQ:()=>r,cv:()=>h,j4:()=>p,jb:()=>s,me:()=>u,or:()=>n,p_:()=>d,uk:()=>f})},33856:(e,t,i)=>{"use strict";i.d(t,{A:()=>_});var r=i(54001),s=i.n(r),a=i(86932),n=i(7972),o=i(40046),c=i(26429),l=i(86834),d=i(95797);let h;const u=c.USE_THREADS||!l.A.chrome&&d.A.atomics||l.A.checkVersion(l.A.majorVersion,"94",!0);function f(e,t,i,r){if(u)return Atomics.add(h(i),e>>>r,t);{const s=h(i),a=e>>>r,n=s[a];return s[a]+=t,n}}function p(e,t,i,r){if(u)return Atomics.sub(h(i),e>>>r,t);{const s=h(i),a=e>>>r,n=s[a];return s[a]-=t,n}}function m(e,t,i,r){if(u)return Atomics.and(h(i),e>>>r,t);{const s=h(i),a=e>>>r,n=s[a];return s[a]&=t,n}}function g(e,t,i,r){if(u)return Atomics.or(h(i),e>>>r,t);{const s=h(i),a=e>>>r,n=s[a];return s[a]|=t,n}}function v(e,t,i,r){if(u)return Atomics.xor(h(i),e>>>r,t);{const s=h(i),a=e>>>r,n=s[a];return s[a]^=t,n}}function y(e,t,i,r){if(u)return Atomics.store(h(i),e>>>r,t);{const s=h(i),a=e>>>r,n=s[a];return s[a]=t,n}}function A(e,t,i){return u?Atomics.load(h(t),e>>>i):h(t)[e>>>i]}function b(e,t,i,r,s){if(u)return Atomics.compareExchange(h(r),e>>>s,t,i);{const a=h(r),n=e>>>s,o=a[n];return o===t&&(a[n]=i),o}}function w(e,t,i,r){if(u)return Atomics.exchange(h(i),e>>>r,t);{const s=h(i),a=e>>>r,n=s[a];return s[a]=t,n}}function x(e,t){return u?Atomics.notify(h(16),e>>>2,t):void 0}const k={ok:0,"not-equal":1,"timed-out":2};function T(e,t){return k[Atomics.wait(h(16),e>>>2,t)]}function I(e,t,i){return k[Atomics.wait(h(16),e>>>2,t,i)]}async function S(e,t){if(Atomics.waitAsync){const i=Atomics.waitAsync(h(16),e>>>2,t);return i.async?k[await i.value]:k[i.value]}if(A(e)!==t)return 1;for(;A(e)===t;)await new(s())((e=>{(0,n.A)((()=>{e()}))}));return 0}async function P(e,t,i){if(Atomics.waitAsync){const r=Atomics.waitAsync(h(16),e>>>2,t,i);return r.async?k[await r.value]:k[r.value]}if(A(e)!==t)return 1;{const r=(0,a.A)();for(;A(e)===t&&(0,a.A)()-r<i;)await new(s())((e=>{(0,n.A)((()=>{e()}))}));return A(e)!==t?0:2}}function _(e){h=e,(0,o.$Z)({add:f,sub:p,and:m,or:g,xor:v,store:y,load:A,compareExchange:b,exchange:w,notify:x,wait:T,waitTimeout:I,waitAsync:S,waitTimeoutAsync:P})}},42518:(e,t,i)=>{"use strict";i.d(t,{Ts:()=>u,XR:()=>v,mq:()=>m,uk:()=>g,vP:()=>p,zr:()=>f});var r,s,a=i(134),n=i(80662),o=i.n(n),c=i(61499),l=i(12085),d=i(73783),h=i(40046);function u(e,t){return h.M_(e,0,16,2),0}function f(e){return h.M_(e,0,16,2),0}function p(e){return h.WQ(e,1,16,2),h.me(e,1),0}function m(e){return h.WQ(e,1,16,2),h.me(e,1073741824),0}function g(e,t){let i=h.Hh(e,16,2);return d.Tl(t),h.uk(e,i),d.s2(t),0}function v(e,t,i){let r=h.Hh(e,16,2);d.Tl(t);let s=h.j4(e,r,i);return d.s2(t),2===s?110:0}r=class{constructor(){(0,a.A)(this,"atomic",void 0)}}.prototype,(s=new(o())).set("atomic",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),(0,l.A)(r,c.Og,!0),(0,l.A)(r,c.dc,4),(0,l.A)(r,c.g7,4),(0,l.A)(r,c.JY,s)},81574:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var r=i(84149),s=(i(55013),i(10576)),a=i(67672);let n=s.TK;function o(e){let t,i;n.onmessage=o=>{const c=o.data,l=c.type,d=c.data;switch(l){case"init":if(s.TK.CHeap&&s.TK.CHeap.initThread&&s.TK.CHeap.Config.USE_THREADS)return void s.TK.CHeap.initThread(d).then((()=>{n.postMessage({type:"ready"})}));n.postMessage({type:"ready"});break;case"run":n.postMessage({type:"running"}),i=e(d.params),h=d.port,t=new r.Ay(h),t.on(r.S3,(async e=>{const r=e.method,s=e.params;if(a.Pc(i[r]))try{i[r].transfer||(i[r].transfer=[]);const a=await i[r](...s.params);t.reply(e,a,null,i[r].transfer),i[r].transfer.length=0}catch(i){t.reply(e,-2097152,{message:i.message})}}));break;case"stop":t&&t.destroy(),s.TK.__freeSmartPtr__&&s.TK.__freeSmartPtr__(),n.postMessage({type:"stopped"})}var h}}},26848:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var r=i(10576);let s=r.TK;function a(e){let t;s.onmessage=i=>{const a=i.data,n=a.type,o=a.data;switch(n){case"init":if(r.TK.CHeap&&r.TK.CHeap.initThread&&r.TK.CHeap.Config.USE_THREADS)return void r.TK.CHeap.initThread(o).then((()=>{s.postMessage({type:"ready"})}));s.postMessage({type:"ready"});break;case"run":t=e(o.params);break;case"stop":t&&t.then?t.then((e=>{r.TK.__freeSmartPtr__&&r.TK.__freeSmartPtr__(),s.postMessage({type:"stopped",data:e})})):(r.TK.__freeSmartPtr__&&r.TK.__freeSmartPtr__(),s.postMessage({type:"stopped",data:t}))}}}},67524:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var r=i(84149),s=(i(55013),i(10576)),a=i(67672);let n=s.TK;function o(e){let t;n.onmessage=i=>{const o=i.data,c=o.type,l=o.data;switch(c){case"init":if(s.TK.CHeap&&s.TK.CHeap.initThread&&s.TK.CHeap.Config.USE_THREADS)return void s.TK.CHeap.initThread(l).then((()=>{n.postMessage({type:"ready"})}));n.postMessage({type:"ready"});break;case"run":n.postMessage({type:"running"}),d=l.port,t=new r.Ay(d),t.on(r.S3,(async i=>{const r=i.method,s=i.params;if(a.Pc(e[r]))try{e[r].transfer||(e[r].transfer=[]);const a=await e[r](...s.params);t.reply(i,a,null,e[r].transfer),e[r].transfer.length=0}catch(e){t.reply(i,-2097152,{message:e.message})}}));break;case"stop":t&&t.destroy(),s.TK.__freeSmartPtr__&&s.TK.__freeSmartPtr__(),n.postMessage({type:"stopped"})}var d}}},73783:(e,t,i)=>{"use strict";i.d(t,{Tl:()=>g,Ts:()=>f,bh:()=>m,eu:()=>u,s2:()=>p,zr:()=>v});var r,s,a=i(134),n=i(80662),o=i.n(n),c=i(61499),l=i(12085),d=i(40046),h=i(39638);class u{constructor(){(0,a.A)(this,"atomic",void 0)}}function f(e){return d.M_(e,0,16,2),0}function p(e,t=!1){let i;if(0!==(i=d.p_(e,0,1,16,2)))do{2!=i&&0===d.p_(e,1,2,16,2)||!t&&(0,h.A)()&&d.uk(e,2)}while(0!==(i=d.p_(e,0,2,16,2)));return 0}function m(e){return 0===d.p_(e,0,1,16,2)?0:16}function g(e){return 1!==d.jb(e,1,16,2)&&(d.M_(e,0,16,2),d.me(e,1)),0}function v(e){return d.M_(e,0,16,2),0}r=u.prototype,(s=new(o())).set("atomic",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),(0,l.A)(r,c.Og,!0),(0,l.A)(r,c.dc,4),(0,l.A)(r,c.g7,4),(0,l.A)(r,c.JY,s)},79490:(e,t,i)=>{"use strict";i.d(t,{Ts:()=>p,XR:()=>A,Zr:()=>y,bE:()=>g,uk:()=>v,zr:()=>m});var r,s,a=i(134),n=i(80662),o=i.n(n),c=i(61499),l=i(12085),d=i(73783),h=i(63939),u=i(50932),f=i(40046);function p(e,t){return f.M_(e,0|t,16,2),d.Ts(e+4),0}function m(e){return d.zr(e+4),0}function g(e){return f.WQ(e,1,16,2),f.me(e,1),0}function v(e){for(;f.uk(e,0),f.jb(e,1,16,2)<=0;)f.WQ(e,1,16,2);return 0}function y(e){return d.s2(e+4),h.f[16](e)>0?(u.M[16](e,h.f[16](e)-1),d.Tl(e+4),0):(d.Tl(e+4),11)}function A(e,t){return 2!==f.j4(e,0,t)&&f.jb(e,1,16,2)<=0?(f.WQ(e,1,16,2),110):0}r=class{constructor(){(0,a.A)(this,"atomic",void 0),(0,a.A)(this,"mutex",void 0)}}.prototype,(s=new(o())).set("atomic",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("mutex",{0:d.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,l.A)(r,c.Og,!0),(0,l.A)(r,c.dc,4),(0,l.A)(r,c.g7,8),(0,l.A)(r,c.JY,s)},88506:(e,t,i)=>{"use strict";i.d(t,{nE:()=>T,nx:()=>I,pt:()=>k});var r=i(75062),s=i.n(r),a=i(80662),n=i.n(a),o=i(54001),c=i.n(o),l=i(11473),d=i(84149),h=(i(55013),i(61837)),u=i(26429),f=i(67672),p=i(10576),m=i(62100),g=i(95073);let v=p.TK.Worker,y=p.TK.MessageChannel;i(81574),i(26848),i(67524);const A=(0,h.A)(81574,{varName:"init"}),b=((0,h.A)(26848,{varName:"init"}),(0,h.A)(67524,{varName:"init"}),s()("revoke")),w=new(n());function x(e,t){return`${e}_${t}`}function k(e,t,i){t=t||{},f.Pc(t)&&(i=t,t={});let r,s=[];function a(...t){const r=new e(...t);return new(c())((t=>{const s={$worker:null,$ipc:null,$channel:null,$moduleId:(0,m.A)(i),$stackPointer:0,$instance:r,$type:"class"},{proxy:a,revoke:n}=Proxy.revocable(s,{get(t,i,a){if(t[i])return s[i];if(i in e.prototype&&"function"==typeof e.prototype[i]){const e=function(...e){return r[i](...e)};e.transfer=function(...e){return{invoke:function(...e){return r[i](...e)}}},t[i]=e}return t[i]}});s[b]=n,t(a)}))}return r=(...r)=>{let a;if(f.Pc(i))a=i();else{let t;const r=x(i,"class");if(w.has(r))t=w.get(r).url,w.get(r).refCount++;else{const s=(0,h.A)(i,{varName:`__module_${e.name}__`,exportName:`__${e.name}__`,pointName:e.name,exportIsClass:!0}),a=`\n            self.CHEAP_DISABLE_THREAD = ${p.TK.CHEAP_DISABLE_THREAD}\n            self.CHEAP_HEAP_INITIAL = ${p.TK.CHEAP_HEAP_INITIAL}\n            self.CHEAP_HEAP_MAXIMUM = ${p.TK.CHEAP_HEAP_MAXIMUM}\n            ${p.TK.CHEAP_POLYFILL_URL?`self.CHEAP_POLYFILL_URL = '${p.TK.CHEAP_POLYFILL_URL}'`:""}\n            ${p.TK.CHEAP_POLYFILL_URL?`importScripts('${p.TK.CHEAP_POLYFILL_URL}');`:""}\n            ${s}\n            function run(params) {\n              params.unshift(null)\n              return new (Function.prototype.bind.apply(__module_${e.name}__.__${e.name}__, params))()\n            }\n            ${A}\n            init.default(run);\n          `;{const e=new Blob([a],{type:"text/javascript"});t=URL.createObjectURL(e)}w.set(r,{url:t,refCount:1})}a=new v(t)}const n=new y;return new(c())(((o,c)=>{var h;const f=u.USE_THREADS?l.s_.alignedAlloc(u.STACK_ALIGNMENT,t.stackSize?(0,g.A)(t.stackSize,u.STACK_ALIGNMENT):u.STACK_SIZE):0;a.onmessage=t=>{const c=t.data,l=c.type;switch(c.data,l){case"ready":a.postMessage({type:"run",data:{port:n.port2,params:r}},[n.port2,...s]);break;case"running":!function(){const t=new d.Ay(n.port1),r={$worker:a,$ipc:t,$channel:n,$moduleId:(0,m.A)(i),$stackPointer:f,$type:"class"},{proxy:s,revoke:c}=Proxy.revocable(r,{get(i,s,a){if(i[s])return r[s];if(s in e.prototype&&"function"==typeof e.prototype[s]){const e=async function(...e){return t.request(s,{params:e})};e.transfer=function(...e){return{invoke:async function(...i){return t.request(s,{params:i},e)}}},i[s]=e}return i[s]}});r[b]=c,o(s)}()}},a.postMessage({type:"init",data:{memory:u.USE_THREADS?l.ce:null,name:t.name||e.name,stackPointer:f,stackSize:null!==(h=t.stackSize)&&void 0!==h?h:u.STACK_SIZE}})}))},{run:!u.USE_THREADS&&!t.dispatchToWorker||t.disableWorker?a:r,transfer:function(...e){return s=e,{run:!u.USE_THREADS&&!t.dispatchToWorker||t.disableWorker?a:r}}}}function T(e){if(e.$worker&&(e.$worker.terminate(),e.$worker=null),e.$moduleId){if(f.Yj(e.$moduleId)){const t=x(e.$moduleId,e.$type);w.has(t)&&(w.get(t).refCount--,0===w.get(t).refCount&&(URL.revokeObjectURL(w.get(t).url),w.delete(t)))}e.$moduleId=null}if(e.$ipc&&(e.$ipc.destroy(),e.$ipc=null),e.$stackPointer&&(l.s_.free(e.$stackPointer),e.$stackPointer=0),e.$channel=null,e.$instance=null,e[b]){const t=e[b];e[b]=null,t()}}async function I(e){return e.$worker?new(c())((t=>{e.$worker.onmessage=function(i){const r=i.data,s=r.type,a=r.data;"stopped"===s&&(T(e),t(a))},e.$worker.postMessage({type:"stop"})})):e.$retval?e.$retval:void 0}},6704:(e,t,i)=>{"use strict";i.d(t,{_:()=>s,i:()=>r});const r={2:1,3:1,4:1,5:1,6:2,7:2,8:4,9:4,10:8,11:1,12:1,13:2,14:2,15:4,16:4,17:8,18:4,19:8,20:4,0:4,1:4,22:8,21:8,23:1,24:1,25:4},s={2:0,3:0,4:0,5:0,6:1,7:1,8:2,9:2,10:4,11:0,12:0,13:1,14:1,15:2,16:2,17:4,18:2,19:4,20:2,1:2,0:2,22:4,21:4,23:0,24:0,25:2}},19094:(e,t,i)=>{"use strict";i.d(t,{A:()=>p});var r=i(134),s=i(54001),a=i.n(s),n=i(11473),o=i(63939),c=i(50932),l=i(26429),d=i(14686),h=i(42518),u=i(73783),f=i(40046);class p{constructor(e,t){(0,r.A)(this,"count",void 0),(0,r.A)(this,"url",void 0),(0,r.A)(this,"childThreads",void 0),this.count=e,this.url=t,this.childThreads=[]}async createTheadPoolEntry(e){return new(a())(((t,i)=>{const r=new Worker(this.url),s=n.s_.alignedAlloc(l.STACK_ALIGNMENT,l.STACK_SIZE),a=n.s_.malloc(8);(0,d.sO)(a,0,8),c.M[15](a+4,0),c.M[15](a,2|o.f[15](a));const f=(0,n.pv)();r.onmessage=e=>{if("ready"===e.data.type){const e=s;(0,d.sO)(e,0,20),u.Ts(e+16),h.Ts(e+12),r.postMessage({type:"wait"}),t({id:f,thread:{thread:0,worker:r,stackPointer:s,threadDescriptor:a},threadWait:e})}},r.postMessage({type:"ready",data:{cheap:{memory:n.ce,stackPointer:s,stackSize:l.STACK_SIZE,id:f},runner:{resource:{tableSize:e.tableSize,module:e.module,initFuncs:e.initFuncs},options:{memoryBase:e.memoryBase,tableBase:e.tableBase,threadDescriptor:a,childImports:e.childImports},imports:e.childImports}}})}))}async ready(e){this.childThreads=await a().all(new Array(this.count).fill(0).map((()=>this.createTheadPoolEntry(e))))}hasFree(){for(let e=0;e<this.childThreads.length;e++)if(0===o.f[15](this.childThreads[e].thread.threadDescriptor+4))return!0;return!1}isPoolThread(e){for(let t=0;t<this.childThreads.length;t++)if(this.childThreads[t].thread.thread===e)return!0;return!1}createThread(e,t,i,r){for(let t=0;t<this.childThreads.length;t++)if(0===o.f[15](this.childThreads[t].thread.threadDescriptor+4))return c.M[15](this.childThreads[t].thread.threadDescriptor+4,1),this.childThreads[t].thread.thread=e,c.M[15](e+8,2|o.f[15](e+8)),u.s2(this.childThreads[t].threadWait+16),c.M[20](this.childThreads[t].threadWait,e),c.M[20](this.childThreads[t].threadWait+4,i),c.M[20](this.childThreads[t].threadWait+8,r),u.Tl(this.childThreads[t].threadWait+16),void h.vP(this.childThreads[t].threadWait+12)}joinThread(e,t){let i;for(let t=0;t<this.childThreads.length;t++)if(this.childThreads[t].thread.thread===e){i=this.childThreads[t];break}return i?(1&o.f[15](e+8)||(f.uk(e+12,1),0!==t&&c.M[20](t,o.f[20](e+4)),c.M[15](i.thread.threadDescriptor+4,0)),0):-1}detachThread(e){let t;for(let i=0;i<this.childThreads.length;i++)if(this.childThreads[i].thread.thread===e){t=this.childThreads[i];break}return t?(c.M[15](t.thread.threadDescriptor,1|o.f[15](t.thread.threadDescriptor)),c.M[15](e+8,1|o.f[15](e+8)),0):-1}destroy(){for(let e=0;e<this.childThreads.length;e++)n.s_.free(this.childThreads[e].thread.stackPointer),n.s_.free(this.childThreads[e].thread.threadDescriptor),this.childThreads[e].thread.worker.terminate();this.childThreads=[]}}},16030:(e,t,i)=>{"use strict";i.d(t,{A:()=>U});var r=i(134),s=i(80662),a=i.n(s),n=i(54001),o=i.n(n),c=i(63939),l=i(50932),d=i(11473),h=i(95335),u=i(72739),f=i(4624),p=i(67672),m=i(14686),g=i(14621),v=i(1708),y=i(20357),A=i(77775),b=i(26429),w=i(40046),x=i(82854),k=i(80905),T=i(24565),I=i(19094),S=i(42518),P=i(73783),_=i(95797),M=(i(81999),i(10576)),C=i(61837);const B="src/cheap/webassembly/WebAssemblyRunner.ts";let E=M.TK.Worker;function D(){}let R=!1;class U{static getTable(){return d.XI}static mutexLock(e){P.s2(e)}static mutexUnlock(e){P.Tl(e)}static condWait(e,t){S.uk(e,t)}static readPointer(e){return c.f[20](e)}static writePointer(e,t){l.M[20](e,t)}constructor(e,t={}){var i,s;(0,r.A)(this,"resource",void 0),(0,r.A)(this,"instance",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"builtinMalloc",void 0),(0,r.A)(this,"memoryBase",void 0),(0,r.A)(this,"tableBase",void 0),(0,r.A)(this,"childImports",void 0),(0,r.A)(this,"childUrl",void 0),(0,r.A)(this,"childBlob",void 0),(0,r.A)(this,"childThreads",void 0),(0,r.A)(this,"imports",void 0),(0,r.A)(this,"childReadyPromises",void 0),(0,r.A)(this,"threadPool",void 0),(0,r.A)(this,"initCalling",void 0),(0,r.A)(this,"promisingMap",void 0),this.resource=e,this.builtinMalloc=[],this.initCalling=!1,this.childThreads=new(a()),this.childReadyPromises=[],this.promisingMap=new(a()),p.Yj(t.childImports)?this.childImports=t.childImports:p.Ik(t.childImports)&&t.childImports instanceof Blob&&(this.childImports=URL.createObjectURL(t.childImports)),this.memoryBase=e.dataSize?d.s_.alignedAlloc(null!==(i=e.dataAlign)&&void 0!==i?i:8,e.dataSize):0,this.memoryBase&&e.bssSize&&(0,m.sO)(this.memoryBase+(e.dataSize-e.bssSize),0,e.bssSize),t.thread&&t.tableBase&&d.XI.getPointer()!==t.tableBase&&d.XI.alloc(t.tableBase-d.XI.getPointer()),this.tableBase=e.tableSize?d.XI.alloc(e.tableSize):0,this.options=t,this.imports={env:{memory:d.ce,__stack_pointer:d.GE,__indirect_function_table:d.XI.table,clock_time_get:g.WU,clock_res_get:g.Lq,random_get:g.Pp,abort:g.h2,proc_exit:function(e){f.z3(`wasm module exit, code: ${e}`,B,158)},__syscall_renameat:D,__syscall_unlinkat:D,environ_get:g.B,environ_sizes_get:g.CK,fd_close:D,fd_fdstat_get:g.LS,fd_read:D,fd_seek:D,fd_write:g.nK,emscripten_builtin_malloc:e=>{const t=d.s_.malloc(e);return this.builtinMalloc.push(t),t},emscripten_builtin_free:e=>{d.s_.free(e)},emscripten_builtin_memalign:(e,t,i)=>{const r=d.s_.alignedAlloc(t,i);return 0!==r?(l.M[20](e,r),this.builtinMalloc.push(r),0):-1},emscripten_memcpy_big:function(e,t,i){(0,m.Mr)(e,t,i)},__libc_malloc:function(e){return d.s_.malloc(e)},__libc_free:e=>{d.s_.free(e)},malloc:e=>{if(!0===this.initCalling){const t=d.s_.malloc(e);return this.builtinMalloc.push(t),t}return d.s_.malloc(e)},calloc:function(e,t){return d.s_.calloc(e,t)},realloc:function(e,t){return d.s_.realloc(e,t)},aligned_alloc:(e,t)=>d.s_.alignedAlloc(e,t),free:function(e){d.s_.free(e)},posix_memalign:function(e,t,i){const r=d.s_.alignedAlloc(t,i);return 0!==r?(l.M[20](e,r),0):-1},memalign:function(e,t){return d.s_.alignedAlloc(e,t)}},"GOT.func":{malloc:new WebAssembly.Global({mutable:!0,value:"i32"},2),calloc:new WebAssembly.Global({mutable:!0,value:"i32"},3),realloc:new WebAssembly.Global({mutable:!0,value:"i32"},4),aligned_alloc:new WebAssembly.Global({mutable:!0,value:"i32"},5),free:new WebAssembly.Global({mutable:!0,value:"i32"},1)}};{const e=(e,t,i,r)=>{if(this.threadPool&&this.threadPool.hasFree())return this.threadPool.createThread(e,t,i,r),0;this.childUrl||this.createChildUrl();const s=new E(this.childUrl);l.M[15](e,(0,d.pv)()),l.M[16](e+12,1),l.M[15](e+8,0),l.M[20](e+4,0);const a=d.s_.alignedAlloc(b.STACK_ALIGNMENT,b.STACK_SIZE),n=d.s_.malloc(8);let h;(0,m.sO)(n,0,8),this.childThreads.set(c.f[15](e),{thread:e,worker:s,stackPointer:a,threadDescriptor:n});const u=new(o())((e=>{h=e}));_.A.jspi||this.childReadyPromises.push(u);return s.onmessage=e=>{const t=e.data,i=t.type;t.data,"run"===i&&h(0)},s.postMessage({type:"run",data:{cheap:{memory:d.ce,stackPointer:a,stackSize:b.STACK_SIZE,id:c.f[15](e)},runner:{resource:{tableSize:this.resource.tableSize,module:this.resource.threadModule.module,initFuncs:this.resource.threadModule.initFuncs},options:{memoryBase:this.options.memoryBase||this.memoryBase,tableBase:this.tableBase,thread:e,threadDescriptor:n,childImports:this.childImports},func:i,args:r,imports:this.childImports,thread:e}}}),_.A.jspi?u:0};h.X$(this.imports.env,{wasm_pthread_create:_.A.jspi?new WebAssembly.Suspending(e):e,wasm_pthread_join2:(e,t)=>{if(this.threadPool&&this.threadPool.isPoolThread(e))return this.threadPool.joinThread(e,t),0;if(1&c.f[15](e+8))return this.childThreads.delete(c.f[15](e)),0;w.uk(e+12,1),0!==t&&l.M[20](t,c.f[20](e+4));const i=this.childThreads.get(c.f[15](e));return d.s_.free(i.stackPointer),d.s_.free(i.threadDescriptor),i.worker.terminate(),this.childThreads.delete(c.f[15](e)),(0,m.sO)(e,0,16),0},wasm_pthread_detach2:e=>{if(this.threadPool&&this.threadPool.isPoolThread(e))return this.threadPool.detachThread(e),0;const t=this.childThreads.get(c.f[15](e));l.M[15](t.threadDescriptor,1|c.f[15](t.threadDescriptor)),l.M[15](e+8,1|c.f[15](e+8))}}),h.X$(this.imports.env,v),h.X$(this.imports.env,y),h.X$(this.imports.env,A)}if(this.memoryBase?h.X$(this.imports.env,{__memory_base:this.memoryBase}):t.memoryBase&&h.X$(this.imports.env,{__memory_base:t.memoryBase}),this.tableBase&&h.X$(this.imports.env,{__table_base:this.tableBase}),null!==(s=t.imports)&&void 0!==s&&s.env&&(h.X$(this.imports.env,t.imports.env),t.envKey&&t.importMap)){const e={};h.__(this.imports.env,((i,r)=>{t.importMap[r]&&(e[t.importMap[r]]=i)})),this.imports[t.envKey]=e}this.imports.wasi_snapshot_preview1=this.imports.env}createChildUrl(){{let e="";{i(81999);const t=(0,C.A)(16030,{varName:"__WebAssemblyRunner__",exportName:"__WebAssemblyRunner__",pointName:U.name,exportIsClass:!0}),r=(0,C.A)(81999,{varName:"runThread"});let s="",a="";this.childImports&&(s=`importScripts('${this.childImports}');`),M.TK.CHEAP_POLYFILL_URL&&(a=`importScripts('${M.TK.CHEAP_POLYFILL_URL}');`),e=`\n          ${t}\n          ${r}\n          self.imports = {env:{}};\n          ${a}\n          ${s}\n          runThread.default();\n        `}this.childBlob=new Blob([e],{type:"text/javascript"}),this.childUrl=URL.createObjectURL(this.childBlob)}}overrideAtomic(){v.override({atomic_add_i8:x.KJ.exports.add8,atomic_sub_i8:x.KJ.exports.sub8,atomic_and_i8:x.KJ.exports.and8,atomic_or_i8:x.KJ.exports.or8,atomic_xor_i8:x.KJ.exports.xor8,atomic_store_i8:x.KJ.exports.store8,atomic_load_i8:x.KJ.exports.load8,atomic_compare_exchange_i8:x.KJ.exports.compare_exchange8,atomic_exchange_i8:x.KJ.exports.exchange8,atomic_add_i16:x.KJ.exports.add16,atomic_sub_i16:x.KJ.exports.sub16,atomic_and_i16:x.KJ.exports.and16,atomic_or_i16:x.KJ.exports.or16,atomic_xor_i16:x.KJ.exports.xor16,atomic_store_i16:x.KJ.exports.store16,atomic_load_i16:x.KJ.exports.load16,atomic_compare_exchange_i16:x.KJ.exports.compare_exchange16,atomic_exchange_i16:x.KJ.exports.exchange16,atomic_add_i32:x.KJ.exports.add32,atomic_sub_i32:x.KJ.exports.sub32,atomic_and_i32:x.KJ.exports.and32,atomic_or_i32:x.KJ.exports.or32,atomic_xor_i32:x.KJ.exports.xor32,atomic_store_i32:x.KJ.exports.store32,atomic_load_i32:x.KJ.exports.load32,atomic_compare_exchange_i32:x.KJ.exports.compare_exchange32,atomic_exchange_i32:x.KJ.exports.exchange32,atomic_add_i64:x.KJ.exports.add64,atomic_sub_i64:x.KJ.exports.sub64,atomic_and_i64:x.KJ.exports.and64,atomic_or_i64:x.KJ.exports.or64,atomic_xor_i64:x.KJ.exports.xor64,atomic_store_i64:x.KJ.exports.store64,atomic_load_i64:x.KJ.exports.load64,atomic_compare_exchange_i64:x.KJ.exports.compare_exchange64,atomic_exchange_i64:x.KJ.exports.exchange64,atomics_notify:x.KJ.exports.notify,atomics_wait:x.KJ.exports.wait}),h.X$(this.imports.env,v)}async run(e,t){if(p.Ik(e)&&h.X$(this.options.imports,e),T.Ko()&&this.resource.threadModule&&(T.LK||T.Ts(d.ce,b.HEAP_INITIAL,b.HEAP_MAXIMUM,y.override),h.X$(this.imports.env,y)),!k.LK&&k.Ko()&&k.Ts(d.ce,b.HEAP_INITIAL,b.HEAP_MAXIMUM),!R&&x.Ko()&&(R=!0,this.overrideAtomic()),this.instance=await WebAssembly.instantiate(this.resource.module,this.imports),this.initRunTime(),this.resource.threadModule&&this.resource.enableThreadPool&&t>0&&!_.A.jspi){this.childUrl||this.createChildUrl();let e=t;this.resource.enableThreadCountRate&&(e*=this.resource.enableThreadCountRate),this.threadPool=new I.A(e,this.childUrl),await this.threadPool.ready({tableSize:this.resource.tableSize,module:this.resource.threadModule.module,initFuncs:this.resource.threadModule.initFuncs,memoryBase:this.options.memoryBase||this.memoryBase,tableBase:this.tableBase,childImports:this.childImports})}}runAsChild(e){p.Ik(e)&&h.X$(this.options.imports,e),T.Ko()&&(T.LK||T.Ts(d.ce,b.HEAP_INITIAL,b.HEAP_MAXIMUM,y.override),h.X$(this.imports.env,y)),!R&&x.Ko()&&(R=!0,this.overrideAtomic()),this.instance=new WebAssembly.Instance(this.resource.module,this.imports),this.initRunTime()}async childThreadsReady(){if(!this.childReadyPromises.length)return;const e=this.childReadyPromises;this.childReadyPromises=[],await o().all(e)}initRunTime(){this.builtinMalloc=[],this.initCalling=!0,p.YO(this.resource.initFuncs)&&u.__(this.resource.initFuncs,(e=>{let t;if(this.asm[e]&&(t=this.asm[e]),t)return t()})),this.initCalling=!1}invoke(e,...t){if(!this.asm)return-1;let i;if(this.asm[e]?i=this.asm[e]:this.options.exportMap&&this.options.exportMap[e]&&this.asm[this.options.exportMap[e]]&&(i=this.asm[this.options.exportMap[e]]),i)return i.apply(null,t);f.z3(`the wasm module has not function ${e} to call`,B,676)}async invokeAsync(e,...t){if(!this.asm)return-1;if(!_.A.jspi)return this.invoke(e,...t);let i;if(this.promisingMap.has(e)?i=this.promisingMap.get(e):(this.asm[e]?i=this.asm[e]:this.options.exportMap&&this.options.exportMap[e]&&this.asm[this.options.exportMap[e]]&&(i=this.asm[this.options.exportMap[e]]),i=WebAssembly.promising(i),this.promisingMap.set(e,i)),i)return i.apply(null,t);f.z3(`the wasm module has not function ${e} to call`,B,717)}get asm(){return this.instance&&this.instance.exports}getInstance(){return this.instance}getChildThreadCount(){return this.childThreads.size}destroy(){var e;null!==(e=this.builtinMalloc)&&void 0!==e&&e.length&&(u.__(this.builtinMalloc,(e=>{d.s_.free(e)})),this.builtinMalloc.length=0),this.memoryBase&&(d.s_.free(this.memoryBase),this.memoryBase=null),this.tableBase&&(d.XI.free(this.tableBase),this.tableBase=0),this.childImports&&(URL.revokeObjectURL(this.childImports),this.childImports=null),this.childUrl&&(URL.revokeObjectURL(this.childUrl),this.childUrl=null),this.childBlob=null,this.childReadyPromises.length=0,this.childThreads.size&&this.childThreads.forEach(((e,t)=>{1&c.f[15](e.threadDescriptor)||(f.R8("has child thread running, maybe resource leakage",B,772),e.worker.terminate(),l.M[16](e.thread+12,0),e.stackPointer&&d.s_.free(e.stackPointer),d.s_.free(e.threadDescriptor),this.childThreads.delete(t))})),this.builtinMalloc=null,this.instance=null,this.options.thread&&(this.options.threadDescriptor&&l.M[15](this.options.threadDescriptor+4,0),this.options.threadDescriptor&&(1&c.f[15](this.options.threadDescriptor)||4&c.f[15](this.options.thread+8))?2&c.f[15](this.options.threadDescriptor)||(d.wE&&d.s_.free(d.wE),d.s_.free(this.options.threadDescriptor),(0,m.sO)(this.options.thread,0,16),self.close()):(l.M[16](this.options.thread+12,0),w.me(this.options.thread+12,1))),this.threadPool&&this.threadPool.destroy(),this.threadPool=null,this.promisingMap&&(this.promisingMap.clear(),this.promisingMap=null)}}},76045:(e,t,i)=>{"use strict";i.d(t,{A:()=>g});var r=i(54001),s=i.n(r),a=i(67672),n=i(24175),o=i(34531),c=i(88096),l=i(92647),d=i(95335),h=i(26429),u=i(86834),f=i(44690),p=i(729),m=i(4304);async function g(e,t={}){let i,r,g,v,y,A,b;if(t=d.X$({enableThread:h.USE_THREADS,initFuncs:t.child?[]:["__wasm_apply_data_relocs","_initialize"]},t),a.ai(e.dataSize)&&a.ai(e.tableSize))if(r=e.dataSize,v=e.dataSize,g=e.dataAlign,y=e.dataAlign,A=e.bssSize,a.Yj(e.source)){const t={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(a.Pc(WebAssembly.compileStreaming))i=await WebAssembly.compileStreaming(fetch(e.source,t));else{const r=await fetch(e.source,t);b=await r.arrayBuffer(),i=await WebAssembly.compile(b)}}else i=await WebAssembly.compile(e.source),b=a.sv(e.source)?e.source:e.source.buffer;else{const d={ioReader:new n.A(1048576),ioWriter:new o.A(1048576),bufferEnded:!1,compileStopped:!1,error:"",abortController:null,pullResolve:null,bufferResolve:null,buffers:[],data:{},options:t},m=new Response(new ReadableStream({async start(t){if(a.Yj(e.source)){var i;"function"==typeof AbortController&&(d.abortController=new AbortController);const r={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade",signal:null===(i=d.abortController)||void 0===i?void 0:i.signal},s=await fetch(e.source,r);let a;s.ok&&s.status>=200&&s.status<=299?a=s.body.getReader():t.error(`Http code invalid, ${s.status} ${s.statusText}`);const n=[];d.ioReader.onFlush=async e=>{let t=0;for(;n.length&&t<e.length;){const i=n.shift();i.length>e.length-t?(e.set(i.subarray(0,e.length-t),t),n.unshift(i.subarray(e.length-t)),t=e.length):(e.set(i,t),t+=i.length)}if(t>=e.length)return e.length;const{value:i,done:r}=await a.read();return r?t>0?t:-1048576:(d.buffers.push(i),i.length>e.length-t?(e.set(i.subarray(0,e.length-t),t),n.push(i.subarray(e.length-t)),e.length):(e.set(i,t),t+=i.length,t))}}else{let t=0,i=e.source.byteLength;const r=a.sv(e.source)?new Uint8Array(e.source):e.source;d.ioReader.onFlush=async e=>{if(t>=i)return-1048576;const s=Math.min(e.length,i-t);return e.set(r.subarray(t,t+s),0),t+=s,s}}d.ioWriter.onFlush=async e=>{if(d.pullResolve)return d.pullResolve(e.slice()),d.pullResolve=null,0;const t=await new(s())((e=>{d.bufferResolve=e}));return t.enqueue(e.slice()),d.bufferEnded&&t.close(),0},async function(e){try{for(await e.ioWriter.writeUint32(await e.ioReader.readUint32()),await e.ioWriter.writeUint32(await e.ioReader.readUint32());;){if(e.compileStopped){e.abortController&&e.abortController.abort();break}const t=await e.ioReader.readUint8();if(e.options.child&&11===t){await e.ioWriter.writeUint8(t),await(0,c.$z)(e.ioWriter,7),await(0,c.$z)(e.ioWriter,1),await(0,c.$z)(e.ioWriter,0),await e.ioWriter.writeUint8(65),await e.ioWriter.writeUint8(0),await e.ioWriter.writeUint8(11),await(0,c.$z)(e.ioWriter,1),await e.ioWriter.writeUint8(0);const i=await(0,c.GW)(e.ioReader);await e.ioReader.skip(i);continue}await e.ioWriter.writeUint8(t);const i=await(0,c.GW)(e.ioReader),r=e.ioReader.getPos();if(0===t){await(0,c.$z)(e.ioWriter,i);const t=e.ioReader.getPos(),r=await(0,c.GW)(e.ioReader),s=await e.ioReader.readString(r);if(await(0,c.$z)(e.ioWriter,r),await e.ioWriter.writeString(s),"dylink.0"===s){const r=e.ioReader.getPos()+(BigInt(Math.floor(i))-(e.ioReader.getPos()-t));for(;e.ioReader.getPos()<r;){const t=await e.ioReader.readUint8();await e.ioWriter.writeUint8(t);const i=await(0,c.GW)(e.ioReader);await(0,c.$z)(e.ioWriter,i),1===t?(e.data.dataSize=await(0,c.GW)(e.ioReader),e.data.dataAlign=await(0,c.GW)(e.ioReader),e.data.tableSize=await(0,c.GW)(e.ioReader),e.data.tableAlign=await(0,c.GW)(e.ioReader),await(0,c.$z)(e.ioWriter,e.data.dataSize),await(0,c.$z)(e.ioWriter,e.data.dataAlign),await(0,c.$z)(e.ioWriter,e.data.tableSize),await(0,c.$z)(e.ioWriter,e.data.tableAlign)):await e.ioWriter.writeBuffer(await e.ioReader.readBuffer(i))}}}else if(11===t){await(0,c.$z)(e.ioWriter,i);const t=await(0,c.GW)(e.ioReader);if(await(0,c.$z)(e.ioWriter,t),t){for(await(0,c.$z)(e.ioWriter,await(0,c.GW)(e.ioReader));;){const t=await e.ioReader.readUint8();if(await e.ioWriter.writeUint8(t),11===t)break}const t=await(0,c.GW)(e.ioReader);e.data.dataSize?e.data.bssSize=e.data.dataSize-t:e.data.dataSize=t,await(0,c.$z)(e.ioWriter,t)}}else if(2===t){const t=new p.A(new Uint8Array(i+100));let s=await(0,c.GW)(e.ioReader);(0,c.tt)(t,s);let a=0;for(;s--;){const i=await(0,c.GW)(e.ioReader);(0,c.tt)(t,i),t.writeBuffer(await e.ioReader.readBuffer(i));const r=await(0,c.GW)(e.ioReader);(0,c.tt)(t,r),t.writeBuffer(await e.ioReader.readBuffer(r));const s=await e.ioReader.readUint8();switch(t.writeUint8(s),s){case 0:(0,c.tt)(t,await(0,c.GW)(e.ioReader));break;case 3:(0,c.p2)(t,await(0,c.WP)(e.ioReader)),(0,c.tt)(t,await(0,c.GW)(e.ioReader));break;case 2:{let i=await(0,c.GW)(e.ioReader);e.options.enableThread?i|=2:i&=-3,(0,c.tt)(t,i);const r=await(0,c.GW)(e.ioReader);if((0,c.tt)(t,h.HEAP_INITIAL||r),1&i){let i=await(0,c.GW)(e.ioReader);f.A.ios&&!u.A.checkVersion(f.A.version,"17",!0)&&e.options.enableThread||(i=h.HEAP_MAXIMUM),(0,c.tt)(t,i)}a++;break}case 1:{(0,c.p2)(t,await(0,c.WP)(e.ioReader));const i=await(0,c.GW)(e.ioReader);(0,c.tt)(t,i);const r=await(0,c.GW)(e.ioReader);(0,c.tt)(t,r),e.data.tableSize=r,1&i&&(0,c.tt)(t,await(0,c.GW)(e.ioReader)),a++;break}}if(2===a)break}const n=t.getWroteBuffer(),o=i-Number(e.ioReader.getPos()-r);await(0,c.$z)(e.ioWriter,n.length+o),await e.ioWriter.writeBuffer(n)}else await(0,c.$z)(e.ioWriter,i);i-Number(e.ioReader.getPos()-r)&&await e.ioReader.pipe(e.ioWriter,i-Number(e.ioReader.getPos()-r))}}catch(t){-1048576===e.ioReader.error?e.bufferEnded=!0:e.error=t,e.ioReader.remainingLength()&&await e.ioWriter.writeBuffer(await e.ioReader.readBuffer(e.ioReader.remainingLength())),await e.ioWriter.flush()}}(d)},async pull(e){if(d.error)e.close();else{if(d.bufferResolve)return d.bufferResolve(e),void(d.bufferResolve=null);e.enqueue(await new(s())(((e,t)=>{d.pullResolve=e}))),d.bufferEnded?e.close():d.error&&e.error(d.error)}},cancel(e){d.compileStopped=!0}}),{headers:{"Content-Type":"application/wasm"}});i=a.Pc(WebAssembly.compileStreaming)?await WebAssembly.compileStreaming(m):await WebAssembly.compile(await m.arrayBuffer()),b=a.Yj(e.source)?(0,l.A)(Uint8Array,d.buffers).buffer:a.sv(e.source)?e.source:e.source.buffer,r=d.data.tableSize,v=d.data.dataSize,g=d.data.tableAlign,y=d.data.dataAlign,A=d.data.bssSize}return t.child?{module:i,initFuncs:t.initFuncs||[],tableSize:0,tableAlign:g||0,dataSize:1,dataAlign:y?Math.max((0,m.A)(y),8):8,bssSize:0,buffer:b}:{module:i,tableSize:r,tableAlign:g||0,dataSize:v,dataAlign:y?Math.max((0,m.A)(y),8):8,bssSize:A||0,initFuncs:t.initFuncs||[],buffer:b}}},81999:(e,t,i)=>{"use strict";function r(){let e;e=__WebAssemblyRunner__?__WebAssemblyRunner__.__WebAssemblyRunner__:__CHeap_WebAssemblyRunner__.default;let t,i,r=self,s=0;r.onmessage=a=>{const n=a.data,o=n.type,c=n.data;switch(o){case"run":r.postMessage({type:"run"}),self.CHeap&&self.CHeap.initThread&&self.CHeap.initThread(c.cheap).then((()=>{self.__SELF_THREAD__=c.runner.thread,c.runner.options.imports=self.imports,t=new e(c.runner.resource,c.runner.options),t.runAsChild(),e.getTable().get(c.runner.func)(c.runner.args),t.destroy()}));break;case"ready":i=c.runner,s=c.cheap.stackPointer,self.CHeap&&self.CHeap.initThread&&self.CHeap.initThread(c.cheap).then((()=>{r.postMessage({type:"ready"})}));break;case"wait":{async function l(){for(;;){for(e.mutexLock(s+16);0===e.readPointer(s);)e.condWait(s+12,s+16);self.__SELF_THREAD__=e.readPointer(s),i.options.thread=e.readPointer(s),i.thread=e.readPointer(s),i.func=e.readPointer(s+4),i.args=e.readPointer(s+8),t=new e(i.resource,i.options),t.runAsChild(),e.getTable().get(i.func)(i.args),t.destroy(),e.writePointer(s,0),e.mutexUnlock(s+16)}}i.options.imports=self.imports,l();break}}}}i.r(t),i.d(t,{default:()=>r})},91808:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r="AGFzbQEAAAABEANgAX8Bf2ABfwBgAn9/AX8CWQYDZW52Bm1lbW9yeQIDAYCABANlbnYGbWFsbG9jAAADZW52BGZyZWUAAQNlbnYGY2FsbG9jAAIDZW52B3JlYWxsb2MAAgNlbnYNYWxpZ25lZF9hbGxvYwACAwYFAAECAgIHMwUGbWFsbG9jAAUEZnJlZQAGBmNhbGxvYwAHB3JlYWxsb2MACAxhbGlnbmVkQWxsb2MACQoqBQYAIAAQAAsGACAAEAELCAAgACABEAILCAAgACABEAMLCAAgACABEAML"},80905:(e,t,i)=>{"use strict";i.d(t,{Ko:()=>h,LK:()=>l,Ts:()=>u});var r=i(11473),s=i(4919),a=i(4624),n=i(91808),o=i(88096);const c="src/cheap/webassembly/runtime/asm/libc.ts";let l,d=!0;function h(){return d}function u(e,t,i){try{const a=o.bx((0,s.E_)(n.A),{shared:"function"==typeof SharedArrayBuffer&&e.buffer instanceof SharedArrayBuffer,initial:t,maximum:i});l=new WebAssembly.Instance(new WebAssembly.Module(a),{env:{memory:e,malloc:function(e){return r.s_.malloc(e)},calloc:function(e,t){return r.s_.calloc(e,t)},realloc:function(e,t){return r.s_.realloc(e,t)},aligned_alloc:(e,t)=>r.s_.alignedAlloc(e,t),free:function(e){r.s_.free(e)}}}),r.XI.set(2,l.exports.malloc),r.XI.set(1,l.exports.free),r.XI.set(3,l.exports.calloc),r.XI.set(4,l.exports.realloc),r.XI.set(5,l.exports.alignedAlloc)}catch(e){d=!1,a.R8("libc asm not support, cannot use asm thread function",c,60)}}},60:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r="AGFzbQEAAAABEwNgAX8Bf2ACf38Bf2ADf39/AX8CEgEDZW52Bm1lbW9yeQIDAYCABAMIBwAAAAECAAAHQwcEbG9jawAAB3RyeWxvY2sAAQZ1bmxvY2sAAgR3YWl0AAMJdGltZWR3YWl0AAQGc2lnbmFsAAUJYnJvYWRjYXN0AAYKnAIHVgEBfyAAQQBBAf5IAgAhASABQQBHBEADQCABQQJGBH9BAQUgAEEBQQL+SAIAQQBHCwRAIABBAkJ//gECABoLIABBAEEC/kgCACEBIAFBAEcNAAsLQQALFwAgAEEAQQH+SAIAQQBGBH9BAAVBEAsLIwAgAEEB/iUCAEEBRwRAIABBAP4XAgAgAEEB/gACABoLQQALHQAgACAA/hACACABEAIaQn/+AQIAGiABEAAaQQALNwAgACAA/hACACABEAIaIAIpAwBCgJTr3AN+IAIoAgitfP4BAgAgARAAGkECRgR/QfAABUEACwsWACAAQQH+HgIAGiAAQQH+AAIAGkEACxoAIABBAf4eAgAaIABBgICAgAT+AAIAGkEACw=="},24565:(e,t,i)=>{"use strict";i.d(t,{Ko:()=>d,LK:()=>c,Ts:()=>h});var r=i(4919),s=i(4624),a=i(60),n=i(88096);const o="src/cheap/webassembly/runtime/asm/thread.ts";let c,l=!0;function d(){return l}function h(e,t,i,d){try{if(!("function"==typeof SharedArrayBuffer&&e.buffer instanceof SharedArrayBuffer))return void(l=!1);{const s=n.bx((0,r.E_)(a.A),{shared:!0,initial:t,maximum:i});c=new WebAssembly.Instance(new WebAssembly.Module(s),{env:{memory:e}})}d({wasm_pthread_mutex_lock:c.exports.lock,wasm_pthread_mutex_trylock:c.exports.trylock,wasm_pthread_mutex_unlock:c.exports.unlock,wasm_pthread_cond_wait:c.exports.wait,wasm_pthread_cond_timedwait:c.exports.timedwait,wasm_pthread_cond_signal:c.exports.signal,wasm_pthread_cond_broadcast:c.exports.broadcast})}catch(e){l=!1,s.R8("thread asm not support, cannot use asm thread function",o,69)}}},1708:(e,t,i)=>{"use strict";i.r(t),i.d(t,{atomic_add_i16:()=>p,atomic_add_i32:()=>k,atomic_add_i64:()=>E,atomic_add_i8:()=>a,atomic_and_i16:()=>g,atomic_and_i32:()=>I,atomic_and_i64:()=>R,atomic_and_i8:()=>o,atomic_compare_exchange_i16:()=>w,atomic_compare_exchange_i32:()=>C,atomic_compare_exchange_i64:()=>O,atomic_compare_exchange_i8:()=>u,atomic_exchange_i16:()=>x,atomic_exchange_i32:()=>B,atomic_exchange_i64:()=>N,atomic_exchange_i8:()=>f,atomic_load_i16:()=>b,atomic_load_i32:()=>M,atomic_load_i64:()=>F,atomic_load_i8:()=>h,atomic_or_i16:()=>v,atomic_or_i32:()=>S,atomic_or_i64:()=>U,atomic_or_i8:()=>c,atomic_store_i16:()=>A,atomic_store_i32:()=>_,atomic_store_i64:()=>$,atomic_store_i8:()=>d,atomic_sub_i16:()=>m,atomic_sub_i32:()=>T,atomic_sub_i64:()=>D,atomic_sub_i8:()=>n,atomic_xor_i16:()=>y,atomic_xor_i32:()=>P,atomic_xor_i64:()=>L,atomic_xor_i8:()=>l,atomics_notify:()=>z,atomics_wait:()=>V,atomics_wait_timeout:()=>W,override:()=>j});var r=i(40046),s=i(6704);let a=function(e,t){return r.WQ(e,t,12,s._[12])},n=function(e,t){return r.jb(e,t,12,s._[12])},o=function(e,t){return r.Uo(e,t,12,s._[12])},c=function(e,t){return r.or(e,t,12,s._[12])},l=function(e,t){return r.I8(e,t,12,s._[12])},d=function(e,t){return r.M_(e,t,12,s._[12])},h=function(e){return r.Hh(e,12,s._[12])},u=function(e,t,i){return r.p_(e,t,i,12,s._[12])},f=function(e,t){return r.cv(e,t,12,s._[12])},p=function(e,t){return r.WQ(e,t,14,s._[14])},m=function(e,t){return r.jb(e,t,14,s._[14])},g=function(e,t){return r.Uo(e,t,14,s._[14])},v=function(e,t){return r.or(e,t,14,s._[14])},y=function(e,t){return r.I8(e,t,14,s._[14])},A=function(e,t){return r.M_(e,t,14,s._[14])},b=function(e){return r.Hh(e,14,s._[14])},w=function(e,t,i){return r.p_(e,t,i,14,s._[14])},x=function(e,t){return r.cv(e,t,14,s._[14])},k=function(e,t){return r.WQ(e,t,16,s._[16])},T=function(e,t){return r.jb(e,t,16,s._[16])},I=function(e,t){return r.Uo(e,t,16,s._[16])},S=function(e,t){return r.or(e,t,16,s._[16])},P=function(e,t){return r.I8(e,t,16,s._[16])},_=function(e,t){return r.M_(e,t,16,s._[16])},M=function(e){return r.Hh(e,16,s._[16])},C=function(e,t,i){return r.p_(e,t,i,16,s._[16])},B=function(e,t){return r.cv(e,t,16,s._[16])},E=function(e,t){return r.WQ(e,t,21,s._[21])},D=function(e,t){return r.jb(e,t,21,s._[21])},R=function(e,t){return r.Uo(e,t,21,s._[21])},U=function(e,t){return r.or(e,t,21,s._[21])},L=function(e,t){return r.I8(e,t,21,s._[21])},$=function(e,t){return r.M_(e,t,21,s._[21])},F=function(e){return r.Hh(e,21,s._[21])},O=function(e,t,i){return r.p_(e,t,i,21,s._[21])},N=function(e,t){return r.cv(e,t,21,s._[21])},z=function(e,t){return r.me(e,t)},V=function(e,t){return r.uk(e,t)},W=function(e,t,i){return r.j4(e,t,Number(BigInt.asIntN(32,i)))};function j(e){e.atomic_add_i8&&(a=e.atomic_add_i8),e.atomic_sub_i8&&(n=e.atomic_sub_i8),e.atomic_and_i8&&(o=e.atomic_and_i8),e.atomic_or_i8&&(c=e.atomic_or_i8),e.atomic_xor_i8&&(l=e.atomic_xor_i8),e.atomic_store_i8&&(d=e.atomic_store_i8),e.atomic_load_i8&&(h=e.atomic_load_i8),e.atomic_compare_exchange_i8&&(u=e.atomic_compare_exchange_i8),e.atomic_exchange_i8&&(f=e.atomic_exchange_i8),e.atomic_add_i16&&(p=e.atomic_add_i16),e.atomic_sub_i16&&(m=e.atomic_sub_i16),e.atomic_and_i16&&(g=e.atomic_and_i16),e.atomic_or_i16&&(v=e.atomic_or_i16),e.atomic_xor_i16&&(y=e.atomic_xor_i16),e.atomic_store_i16&&(A=e.atomic_store_i16),e.atomic_load_i16&&(b=e.atomic_load_i16),e.atomic_compare_exchange_i16&&(w=e.atomic_compare_exchange_i16),e.atomic_exchange_i16&&(x=e.atomic_exchange_i16),e.atomic_add_i32&&(k=e.atomic_add_i32),e.atomic_sub_i32&&(T=e.atomic_sub_i32),e.atomic_and_i32&&(I=e.atomic_and_i32),e.atomic_or_i32&&(S=e.atomic_or_i32),e.atomic_xor_i32&&(P=e.atomic_xor_i32),e.atomic_store_i32&&(_=e.atomic_store_i32),e.atomic_load_i32&&(M=e.atomic_load_i32),e.atomic_compare_exchange_i32&&(C=e.atomic_compare_exchange_i32),e.atomic_exchange_i32&&(B=e.atomic_exchange_i32),e.atomic_add_i64&&(E=e.atomic_add_i64),e.atomic_sub_i64&&(D=e.atomic_sub_i64),e.atomic_and_i64&&(R=e.atomic_and_i64),e.atomic_or_i64&&(U=e.atomic_or_i64),e.atomic_xor_i64&&(L=e.atomic_xor_i64),e.atomic_store_i64&&($=e.atomic_store_i64),e.atomic_load_i64&&(F=e.atomic_load_i64),e.atomic_compare_exchange_i64&&(O=e.atomic_compare_exchange_i64),e.atomic_exchange_i64&&(N=e.atomic_exchange_i64),e.atomics_notify&&(z=e.atomics_notify),e.atomics_wait&&(V=e.atomics_wait),e.atomics_wait_timeout&&(W=e.atomics_wait_timeout)}},14621:(e,t,i)=>{"use strict";i.d(t,{B:()=>b,CK:()=>w,LS:()=>x,Lq:()=>_,Pp:()=>M,WU:()=>P,h2:()=>S,nK:()=>I});var r=i(134),s=i(80662),a=i.n(s),n=i(61499),o=i(50932),c=i(12085),l=i(63939),d=i(14686),h=i(50011);const u=[null,[],[]],f=0,p=28;function m(e,t){const i=u[e];0===t||10===t?(console.log.bind(console)(h.decode(i)),i.length=0):i.push(t)}const g={};let v,y="./this.program";function A(){if(!v){const e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:y||"./this.program"};for(let t in g)e[t]=g[t];const t=[];for(let i in e)t.push(i+"="+e[i]);v=t}return v}function b(e,t){let i=0;return A().forEach((function(r,s){const a=t+i;o.M[20](e+4*s,a),function(e,t){for(let i=0;i<e.length;++i)o.M[4](t,e.charCodeAt(i)),t+=1;o.M[4](t,0)}(r,a),i+=r.length+1})),0}function w(e,t){const i=A();o.M[25](e,i.length);let r=0;return i.forEach((function(e){r+=e.length+1})),o.M[25](t,r),0}function x(e,t){let i=0;return 0==e?i=2:1!=e&&2!=e||(i=64),o.M[11](t,2),o.M[13](t+2,1),o.M[15](t+8,i),o.M[15](t+12,0),o.M[17](t+16,BigInt(0)),f}var k,T;function I(e,t,i,r){let s=0;for(let r=0;r<i;r++){let i=l.f[20](t),r=l.f[25](t+4);for(let t=0;t<r;t++)m(e,l.f[4](i+t));s+=r,t+=8}return o.M[25](r,s),f}function S(e){throw e=`abort(${e+=""}). Build with -s ASSERTIONS=1 for more info.`,new WebAssembly.RuntimeError(e)}function P(e,t,i){if(0!==e)return p;const r=(new Date).getTime();return o.M[10](i,BigInt(r)*BigInt(1e6)),f}function _(e,t){return 0!==e?p:(o.M[10](t,BigInt(1e6)),f)}function M(e,t){const i=(0,d.s3)(e,t);return crypto.getRandomValues(i),f}k=class{constructor(){(0,r.A)(this,"buf",void 0),(0,r.A)(this,"len",void 0)}}.prototype,(T=new(a())).set("buf",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),T.set("len",{0:25,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,c.A)(k,n.Og,!0),(0,c.A)(k,n.dc,4),(0,c.A)(k,n.g7,8),(0,c.A)(k,n.JY,T)},20357:(e,t,i)=>{"use strict";i.r(t),i.d(t,{override:()=>C,wasm_cpu_core_count:()=>_,wasm_pthread_cond_broadcast:()=>x,wasm_pthread_cond_destroy:()=>y,wasm_pthread_cond_init:()=>v,wasm_pthread_cond_signal:()=>w,wasm_pthread_cond_timedwait:()=>b,wasm_pthread_cond_wait:()=>A,wasm_pthread_equal2:()=>S,wasm_pthread_exit:()=>I,wasm_pthread_mutex_destroy:()=>f,wasm_pthread_mutex_init:()=>u,wasm_pthread_mutex_lock:()=>p,wasm_pthread_mutex_trylock:()=>m,wasm_pthread_mutex_unlock:()=>g,wasm_pthread_once:()=>k,wasm_pthread_self2:()=>T,wasm_pthread_support:()=>P,wasm_threw_error:()=>M});var r=i(63939),s=i(50932),a=i(73783),n=i(42518),o=i(26429),c=i(11473),l=i(40046),d=i(10576),h=i(14686);let u,f,p,m,g,v,y,A,b,w,x,k;function T(){return d.TK.__SELF_THREAD__}function I(e){const t=d.TK.__SELF_THREAD__;s.M[20](t+4,e),s.M[15](t+8,4|r.f[15](t+8))}function S(e,t){return r.f[15](e)===r.f[15](t)?1:0}function P(){return o.USE_THREADS?1:0}function _(){return navigator.hardwareConcurrency}function M(e,t){throw new Error((0,h.lH)(t))}function C(e){e.wasm_pthread_mutex_lock&&(p=e.wasm_pthread_mutex_lock),e.wasm_pthread_mutex_trylock&&(m=e.wasm_pthread_mutex_trylock),e.wasm_pthread_mutex_unlock&&(g=e.wasm_pthread_mutex_unlock),e.wasm_pthread_cond_wait&&(A=e.wasm_pthread_cond_wait),e.wasm_pthread_cond_timedwait&&(b=e.wasm_pthread_cond_timedwait),e.wasm_pthread_cond_signal&&(w=e.wasm_pthread_cond_signal),e.wasm_pthread_cond_broadcast&&(x=e.wasm_pthread_cond_broadcast)}u=function(e,t){return a.Ts(e)},f=function(e){return a.zr(e)},p=function(e){return a.s2(e)},m=function(e){return a.bh(e)},g=function(e){return a.Tl(e)},v=function(e,t){return n.Ts(e,t)},y=function(e){return n.zr(e)},A=function(e,t){return n.uk(e,t)},b=function(e,t,i){let s=1e3*Number(r.f[17](i))+r.f[15](i+8)/1e6;return n.XR(e,t,s)},w=function(e){return n.vP(e)},x=function(e){return n.mq(e)},k=function(e,t){return 0===l.WQ(e,1,16,2)&&c.XI.get(t)(),0}},77775:(e,t,i)=>{"use strict";i.r(t),i.d(t,{Timespec:()=>u,wasm_sem_destroy:()=>p,wasm_sem_init:()=>f,wasm_sem_post:()=>y,wasm_sem_timedwait:()=>v,wasm_sem_trywait:()=>g,wasm_sem_wait:()=>m});var r,s,a=i(134),n=i(80662),o=i.n(n),c=i(61499),l=i(12085),d=i(63939),h=i(79490);class u{constructor(){(0,a.A)(this,"tvSec",void 0),(0,a.A)(this,"tvNSec",void 0)}}function f(e,t,i){return h.Ts(e,i)}function p(e){return h.zr(e)}function m(e){return h.uk(e)}function g(e){return h.Zr(e)}function v(e,t){let i=1e3*Number(d.f[17](t))+d.f[15](t+8)/1e6;return h.XR(e,i)}function y(e){return h.bE(e)}r=u.prototype,(s=new(o())).set("tvSec",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("tvNSec",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),(0,l.A)(r,c.Og,!0),(0,l.A)(r,c.dc,8),(0,l.A)(r,c.g7,16),(0,l.A)(r,c.JY,s)},6331:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(134),s=i(10576);class a{constructor(e,t){(0,r.A)(this,"type",void 0),(0,r.A)(this,"phase",void 0),(0,r.A)(this,"ns",void 0),(0,r.A)(this,"target",void 0),(0,r.A)(this,"originalEvent",void 0),(0,r.A)(this,"isPrevented",void 0),(0,r.A)(this,"isStopped",void 0),(0,r.A)(this,"listener",void 0),this.type=e,this.phase=a.PHASE_CURRENT,t&&(this.originalEvent=t)}preventDefault(){const e=this;if(!e.isPrevented){const{originalEvent:t}=e;t&&t.preventDefault(),e.isPrevented=s.rT}return e}stopPropagation(){const e=this;if(!e.isStopped){const{originalEvent:t}=e;t&&t.stopPropagation(),e.isStopped=s.rT}return e}prevent(){return this.preventDefault()}stop(){return this.stopPropagation()}}(0,r.A)(a,"PHASE_CURRENT",0),(0,r.A)(a,"PHASE_UPWARD",1),(0,r.A)(a,"PHASE_DOWNWARD",s.Cy)},96172:(e,t,i)=>{"use strict";i.d(t,{A:()=>h});var r=i(134),s=i(67672),a=i(72739),n=i(6331),o=i(95335),c=i(20525),l=(i(4624),i(56401)),d=i(10576);class h{constructor(e){(0,r.A)(this,"ns",void 0),(0,r.A)(this,"listeners",void 0),(0,r.A)(this,"nativeListeners",void 0),this.ns=e||d.W8,this.listeners={}}fire(e,t,i){let r=this,c=s.Yj(e)?r.parse(e):e,h=r.listeners[c.type],u=d.rT;if(h){h=o.C(h);const e=t&&t[0]instanceof n.A?t[0]:d.ZH;a.__(h,(function(s){if(!p(c.ns,s,d.rT)||!a.zy(h,s)||i&&!i(c,t,s))return;e&&(e.listener=s.fn);let n=(0,l.A)(s.fn,s.ctx,t);return e&&(e.listener=d.ZH),s.num=s.num?s.num+1:1,s.num===s.max&&r.off(c,s.fn),e&&(n===d.W8?e.prevent().stop():e.isStopped&&(n=d.W8)),n===d.W8?u=d.W8:void 0}))}return u}on(e,t){const i=this,r=i.listeners,n=s.Pc(t)?{fn:t}:t;if(s.Ik(n)&&s.Pc(n.fn)){const t=s.Yj(e)?i.parse(e):e;n.ns=t.ns,a.VC(r[t.type]||(r[t.type]=[]),n)}return this}one(e,t){return s.Pc(t)?t={fn:t,max:1}:t.max=1,this.on(e,t)}off(e,t){const i=this,r=i.listeners;if(e){const n=s.Yj(e)?i.parse(e):e,c=n.type,l=n.ns,h=f(t),u=function(e,t){a.__(e,(function(t,i){h(t)&&e.splice(i,1)}),d.rT),e.length||delete r[t]},m=function(e,t){a.__(e,(function(t,i){p(l,t)&&e.splice(i,1)}),d.rT),e.length||delete r[t]};c?r[c]&&u(r[c],c):l&&o.__(r,m)}else i.listeners={}}has(e,t){let i=this.listeners,r=s.Yj(e)?this.parse(e):e,n=r.type,c=r.ns,l=d.rT,h=f(t);var u;return n?i[n]&&(u=i[n],a.__(u,(function(e){if(h(e))return l=d.W8}))):c&&o.__(i,(function(e){return a.__(e,(function(e){if(p(c,e))return l=d.W8})),l})),!l}parse(e){const t={type:e,ns:d.u1};if(this.ns){const i=c.qh(e,d.ZG);i>=0&&(t.type=c.di(e,0,i),t.ns=c.di(e,i+1))}return t}}function u(){return d.rT}function f(e){return s.Pc(e)?function(t){return e===t.fn}:u}function p(e,t,i){const{ns:r}=t;return r&&e?r===e:i?d.rT:d.W8}},84504:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(2148);function s(e,t,i=!1){const s=t.split("."),a=e.split(".");for(let e=0;e<a.length;e++){if(i&&e==a.length-1&&(0,r.A)(a[e])>=(0,r.A)(s[e]))return a.length>=s.length;if((0,r.A)(a[e])>(0,r.A)(s[e]))return!0;if((0,r.A)(a[e])<(0,r.A)(s[e]))return!1;if(e===s.length-1&&e===a.length-1)return i;if(e===s.length-1)return!0;if(e===a.length-1)return!1}return!0}},92647:(e,t,i)=>{"use strict";function r(e,t){if(!t.length)return null;if(1===t.length)return t[0];let i,r=0;for(i of t)r+=i.length;let s=new e(r),a=0;for(i of t)s.set(i,a),a+=i.length;return s}i.d(t,{A:()=>r})},78995:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(56401),s=i(72739),a=i(10576);function n(e,t,i,n=!1){let o,c;return function(){let l=this;n&&(c=s.$r(arguments)),o||(n||(c=s.$r(arguments)),i&&(0,r.A)(e,l,c),o=setTimeout((function(){o=a.ZH,i||(0,r.A)(e,l,c)}),t))}}},56401:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(67672),s=i(10576);function a(e,t,i){if(r.Pc(e))return r.YO(i)?e.apply(t,i):t!==s.ZH?e.call(t,i):i!==s.ZH?e(i):e()}},8284:(e,t,i)=>{"use strict";function r(){let e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){let i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?i:3&i|8).toString(16)}))}i.d(t,{A:()=>r})},86932:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(45249),s=i.n(r);function a(){return s()()}},54568:(e,t,i)=>{"use strict";function r(){return"function"==typeof registerProcessor&&"number"==typeof sampleRate&&"number"==typeof currentFrame&&"number"==typeof currentTime}i.d(t,{A:()=>r})},34677:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(10576);function s(e){return e!==r.ZH}},59135:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(34677);let s;function a(){if((0,r.A)(s))return s;const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),s=256===new Int16Array(e)[0],s}},20491:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(67672),s=i(62100),a=i(20525);function n(e){return r.Pc(e)&&a.zy((0,s.A)(e),"[native code]")}},39638:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(34677),s=i(54568);function a(){return!("object"==typeof window&&(0,r.A)(window.document)||(0,s.A)())}},7972:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(64236),s=i.n(r),a=i(20491),n=i(10576);let o;typeof s()===n.s0&&(0,a.A)(s())&&(o=s()),o=typeof MessageChannel===n.s0&&(0,a.A)(MessageChannel)?function(e){const t=new MessageChannel;t.port1.onmessage=e,t.port2.postMessage(1)}:"function"==typeof setTimeout?setTimeout:function(e){setTimeout(e)};const c=o},36:(e,t,i)=>{"use strict";function r(e,t,i){return e<t?e=t:e>i&&(e=i),e}i.d(t,{A:()=>r})},61837:(e,t,i)=>{"use strict";i.d(t,{A:()=>f});var r=i(69736),s=i.n(r),a=i(73146),n=i.n(a);const o='\nfunction webpackBootstrapFunc (modules) {\n  var installedModules = {};\n  function __webpack_require__(moduleId) {\n    if(installedModules[moduleId])\n    return installedModules[moduleId].exports;\n    var module = installedModules[moduleId] = {\n      i: moduleId,\n      l: false,\n      exports: {}\n    };\n    if (!modules[moduleId]) {\n      console.error(\'can not found module:\', moduleId)\n    }\n    modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n    module.l = true;\n    return module.exports;\n  }\n  __webpack_require__.m = modules;\n  __webpack_require__.c = installedModules;\n  __webpack_require__.i = function(value) { return value; };\n  __webpack_require__.d = function(exports, definition, getter) {\n    if (typeof definition === \'string\') {\n      if(!__webpack_require__.o(exports, definition)) {\n        Object.defineProperty(exports, definition, {\n          enumerable: true,\n          get: getter\n        });\n      }\n    }\n    else {\n      for(var key in definition) {\n        if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n          Object.defineProperty(exports, key, {\n            enumerable: true,\n            get: definition[key]\n          });\n        }\n      }\n    }\n  };\n  __webpack_require__.r = function(exports) {\n    if(typeof Symbol !== \'undefined\' && Symbol.toStringTag) {\n    \tObject.defineProperty(exports, Symbol.toStringTag, { value: \'Module\' });\n    }\n    Object.defineProperty(exports, \'__esModule\', { value: true });\n  };\n  __webpack_require__.f = {};\n  __webpack_require__.e = function(chunkId) {\n    return Promise.all(Object.keys(__webpack_require__.f).reduce(function (promises, key) {\n      __webpack_require__.f[key](chunkId, promises);\n        return promises;\n    \t}, []));\n\t};\n  __webpack_require__.u = function(chunkId) {\n    return chunkId + "LIB_NAME";\n  };\n  __webpack_require__.n = function(module) {\n    var getter = module && module.__esModule ?\n      function getDefault() { return module[\'default\']; } :\n      function getModuleExports() { return module; };\n    __webpack_require__.d(getter, \'a\', getter);\n    return getter;\n  };\n  (function() {\n    var installedChunks = {\n      "main": 0\n    };\n    __webpack_require__.f.j = function(chunkId, promises) {\n      var installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n      if (installedChunkData !== 0) {\n        if(installedChunkData) {\n          promises.push(installedChunkData[2]);\n        } else {\n          if (true) {\n            var promise = new Promise(function(resolve, reject){installedChunkData = installedChunks[chunkId] = [resolve, reject]});\n            promises.push(installedChunkData[2] = promise);\n            var url = __webpack_require__.p + __webpack_require__.u(chunkId);\n            var error = new Error();\n            var loadingEnded = function(event) {\n              if(__webpack_require__.o(installedChunks, chunkId)) {\n                installedChunkData = installedChunks[chunkId];\n                if(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n                if(installedChunkData) {\n                  var errorType = event && (event.type === \'load\' ? \'missing\' : event.type);\n                  var realSrc = url;\n                  error.message = "Loading chunk " + chunkId + " failed.\\n(" + errorType + ": " + realSrc + ")";\n                  error.name = "ChunkLoadError";\n                  error.type = errorType;\n                  error.request = realSrc;\n                  installedChunkData[1](error);\n                }\n              }\n            };\n            __webpack_require__.l(url, loadingEnded);\n          }\n        }\n      }\n    };\n    var webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n    var [chunkIds, moreModules, runtime] = data;\n    var moduleId, chunkId, i = 0;\n    if (chunkIds.some(function(id){return installedChunks[id] !== 0})) {\n      for(moduleId in moreModules) {\n        if(__webpack_require__.o(moreModules, moduleId)) {\n          __webpack_require__.m[moduleId] = moreModules[moduleId];\n        }\n      }\n      if(runtime) runtime(__webpack_require__);\n    }\n    if (parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n      for (;i < chunkIds.length; i++) {\n        chunkId = chunkIds[i];\n        if (__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n          installedChunks[chunkId][0]();\n        }\n        installedChunks[chunkId] = 0;\n      }\n    }\n    var self = typeof globalThis !== undefined ? globalThis : self\n    var exportName = \'LIBRARY_EXPORT_NAME\'\n    var chunkLoadingGlobal = self["webpackChunk" + exportName] = self["webpackChunk" + exportName] || [];\n    chunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\n    chunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));\n  })();\n  (function() {\n    var inProgress = {};\n    __webpack_require__.l = function(url, done) {\n      if (inProgress[url]) { inProgress[url].push(done); return; }\n        inProgress[url] = [done];\n        var onComplete = function(event) {\n          clearTimeout(timeout);\n          var doneFns = inProgress[url];\n          delete inProgress[url];\n          doneFns && doneFns.forEach(function(fn){fn(event)});\n        }\n        var timeout = setTimeout(onComplete.bind(null, undefined, { type: "timeout" }), 120000);\n      if (typeof importScripts === \'function\') {\n        try {\n          importScripts(url);onComplete({type: "load"});\n        }\n        catch(e) {\n          onComplete({type: "missing"});\n        }\n      }\n      else {\n        import(url).then(function() {\n          onComplete({\n            type: "load"\n          });\n        }, function (error) {\n          onComplete({\n            type: "missing"\n          });\n        })\n      }\n    };\n  })();\n  __webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n  __webpack_require__.p = "ROOT_URL";\n  __webpack_require__.oe = function(err) { console.error(err); throw err; };\n  var f = __webpack_require__(__webpack_require__.s = ENTRY_MODULE);\n  return f;\n}\n',c="[\\.|\\-|\\+|\\w|/|@|!]+",l="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+c+").*?\\)";function d(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function h(e,t,r,a){const n={};n[r]=[];let o=t.toString();const h=o.match(/^(function)?\s?\w*\(\w+,\s*(\w+),\s*(\w+)\)/);if(!h)return n;const u=h[3];a.__webpack_exports_process__||(a.__webpack_require__=u,a.__webpack_exports__=h[2],a.__webpack_exports_process__=!0);let f,p=new RegExp("(\\\\n|\\W)"+d(u)+l,"g");for(;f=p.exec(o);)"dll-reference"!==f[3]&&n[r].push(f[3]);for(p=new RegExp("\\("+d(u)+'\\("(dll-reference\\s('+c+'))"\\)\\)'+l,"g");f=p.exec(o);)e[f[2]]||(n[r].push(f[1]),e[f[2]]=i(f[1]).m),n[f[2]]=n[f[2]]||[],n[f[2]].push(f[4]);const m=s()(n);for(let e=0;e<m.length;e++)for(let t=0;t<n[m[e]].length;t++)g=+n[m[e]][t],isNaN(g)||(n[m[e]][t]=+n[m[e]][t]);var g;return n}function u(e){return s()(e).reduce((function(t,i){return t||e[i].length>0}),!1)}function f(e,t){const r={main:i.m},a=function(e,t){const i={main:[t]},r={main:[],__webpack_exports__:"__webpack_exports__",__webpack_require__:"__webpack_require__",__webpack_exports_process__:!1},a={main:{}};for(;u(i);){const t=s()(i);for(let n=0;n<t.length;n++){let o=t[n],c=i[o].pop();if(a[o]=a[o]||{},a[o][c]||!e[o][c])continue;a[o][c]=!0,r[o]=r[o]||[],r[o].push(c);let l=h(e,e[o][c],o,r),d=s()(l);for(let e=0;e<d.length;e++)i[d[e]]=i[d[e]]||[],i[d[e]]=i[d[e]].concat(l[d[e]])}}return r}(r,e);let c=n()(e);return"var "+t.varName+"=("+o.replace("ENTRY_MODULE",c).replace("ROOT_URL",i.p||"").replace("LIBRARY_EXPORT_NAME","AVPlayer").replace("LIB_NAME",i.u&&i.u("")||"")+")({"+a.main.map((function(e){const i=n()(e);let s=i+": "+r.main[e].toString();if(i===c&&t.exportName&&t.pointName){const e=`;${a.__webpack_require__}.d(\n          ${a.__webpack_exports__},\n          "${t.exportName}",\n          function() {\n            if (${t.exportIsClass}) {\n              for (var key in ${a.__webpack_exports__}) {\n                if (key === '${t.exportName}') {\n                  continue;\n                }\n                var v = ${a.__webpack_exports__}[key];\n                if (typeof v === 'function' && v.name === '${t.pointName}') {\n                  return v;\n                }\n              }\n            }\n            return ${t.pointName};\n          }\n        );`;s=s.slice(0,s.length-1)+e+"}"}return s})).join(",")+"});"}},6498:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(67672),s=i(72739);function a(e,t){const i=[];return r.ai(e)&&(e+=""),e&&r.Yj(e)&&s.__(e.split(t),((e,t)=>{(e=e.trim())&&i.push(e)})),i}},2148:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(67672),s=i(10576);function a(e,t){return r.sH(e)?+e:t!==s.ZH?t:0}},62100:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(10576);function s(e,t){return e!=r.Cq&&e.toString?e.toString():t!==r.ZH?t:r.u1}},65196:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(134),s=i(54001),a=i.n(s),n=i(67672),o=i(72739);class c{constructor(){(0,r.A)(this,"queue",void 0),this.queue=[]}async execute(e){try{const t=await e.task();e.resolve(t)}catch(t){e.reject(t)}}async next(){if(this.queue.length){const e=this.queue[0];e.error?e.reject(e.error):await this.execute(e),this.queue.shift(),this.queue.length&&this.next()}}async push(e){if(!n.Pc(e))throw new TypeError("task must be a function");return new(a())(((t,i)=>{const r={task:e,resolve:t,reject:i};this.queue.push(r),1===this.queue.length&&this.next()}))}clear(e){o.__(this.queue,(t=>{t.error=e||new Error("command queue clear")}))}clearPadding(){this.queue.length=0}get length(){return this.queue.length}}},68391:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(134),s=i(67672),a=i(54058),n=i(86932);class o{constructor(e,t=0){(0,r.A)(this,"queue",void 0),(0,r.A)(this,"timer",void 0),(0,r.A)(this,"ended",void 0),(0,r.A)(this,"onEnd",void 0),(0,r.A)(this,"lastTime",void 0),(0,r.A)(this,"interval",void 0),this.queue=[],this.interval=e,this.timer=new a.A((()=>{this.queue.length?this.queue.shift()():this.ended?(this.onEnd&&this.onEnd(),this.timer.stop()):this.lastTime=(0,n.A)()}),t,e)}push(e){if(!s.Pc(e))throw new TypeError("task must be a function");this.ended=!1;const t=(0,n.A)();this.timer.isStarted()&&!this.queue.length&&t-this.lastTime>this.interval?(e(),this.lastTime=t):(this.queue.push(e),1!==this.queue.length||this.timer.isStarted()||this.timer.start())}end(){this.ended=!0}reset(){this.timer.stop(),this.queue.length=0}}},61403:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(134),s=i(67672);class a{constructor(){(0,r.A)(this,"proxy",void 0),this.proxy=new Proxy(this,{get:(e,t,i)=>s.sH(t)?e.getIndexValue(+t):e[t],set:(e,t,i,r)=>(s.sH(t)?e.setIndexValue(+t,i):e[t]=i,!0)})}}},37246:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(134),s=i(4624);class a{constructor(e=1048576){(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"bitsLeft",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"endPointer",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"error",void 0),(0,r.A)(this,"onFlush",void 0),this.pointer=0,this.bitsLeft=8,this.pos=BigInt(0),this.size=e,this.endPointer=0,this.error=0,this.buffer=new Uint8Array(this.size)}peekU1(){let e=0;(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush();let t=this.pointer,i=this.bitsLeft;return 0===i&&(t++,i=8),e=this.buffer[t]>>i-1&1,e}readU1(){let e=0;return(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush(),this.bitsLeft--,e=this.buffer[this.pointer]>>this.bitsLeft&1,0===this.bitsLeft&&(this.pointer++,this.bitsLeft=8,this.pos++),e}readU(e){let t=0;for(let i=0;i<e;i++)t|=this.readU1()<<e-i-1;return t}peekU(e){const t=this.pointer,i=this.bitsLeft,r=this.pos,s=this.readU(e);return this.pointer=t,this.bitsLeft=i,this.pos=r,s}remainingLength(){return this.endPointer-this.pointer}getBitLeft(){return this.bitsLeft}getPointer(){return this.pointer}setPointer(e){this.pointer=e}getPos(){return this.pos}skip(e){const t=(e-e%8)/8;this.pointer+=t,this.pos+=BigInt(t);const i=e%8;this.bitsLeft<=i?(this.pointer++,this.pos++,this.bitsLeft=8-(i-this.bitsLeft)):this.bitsLeft-=i}flush(){if(!this.onFlush)throw this.error=-1048574,Error("IOReader error, flush failed because of no flush callback");if(0===this.bitsLeft&&(this.pointer++,this.pos++),!(this.size-this.remainingLength()<=0))if(this.pointer<this.endPointer){this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0);const e=this.onFlush(this.buffer.subarray(this.endPointer-this.pointer,this.size));if(e<0)throw this.error=e,Error("IOReader error, flush failed");this.endPointer=this.endPointer-this.pointer+e,this.pointer=0}else{const e=this.onFlush(this.buffer);if(this.endPointer=e,this.pointer=0,this.bitsLeft=8,e<0)throw this.error=e,Error("IOReader error, flush failed")}}getBuffer(){return this.buffer}appendBuffer(e){if(this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else if(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer,this.pointer=0,this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else{const t=Math.min(this.size-this.endPointer,e.length);this.buffer.set(e.subarray(0,t),this.endPointer),this.endPointer+=t,s.R8("BSReader, call appendBuffer but the buffer's size is lagger then the remaining size","src/common/io/BitReader.ts",257)}}reset(){this.pointer=this.endPointer=0,this.bitsLeft=8,this.error=0,this.pos=BigInt(0)}skipPadding(){this.bitsLeft<8&&(this.bitsLeft=8,this.pointer++,this.pos++)}}},83314:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(134);class s{constructor(e=1048576){(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"bitPointer",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"error",void 0),(0,r.A)(this,"onFlush",void 0),this.pointer=0,this.bitPointer=0,this.size=e,this.error=0,this.pos=BigInt(0),this.buffer=new Uint8Array(this.size)}writeU1(e){(this.remainingLength()<1||1===this.remainingLength()&&this.bitPointer>=8)&&this.flush(),1&e?this.buffer[this.pointer]|=1<<7-this.bitPointer:this.buffer[this.pointer]&=~(1<<7-this.bitPointer),this.bitPointer++,8===this.bitPointer&&(this.pointer++,this.pos++,this.bitPointer=0)}writeU(e,t){for(let i=0;i<e;i++)this.writeU1(t>>e-i-1&1)}remainingLength(){return this.size-this.pointer}flush(){if(!this.onFlush)throw this.error=-1048574,Error("BSWriter error, flush failed because of no flush callback");if(this.pointer)if(this.bitPointer&&this.pointer>0){const e=this.onFlush(this.buffer.subarray(0,this.pointer).slice());if(0!==e)throw this.error=e,Error("BSWriter error, flush failed");this.buffer[0]=this.buffer[this.pointer]}else if(0===this.bitPointer){const e=this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==e)throw this.error=e,Error("BSWriter error, flush failed")}this.pointer=0}padding(){for(;0!==this.bitPointer;)this.writeU1(0)}reset(){this.pointer=0,this.bitPointer=0,this.error=0,this.pos=BigInt(0)}getBuffer(){return this.buffer}getPointer(){return this.pointer}getPos(){return this.pos}}},31865:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(134),s=i(92647),a=i(50011);class n{constructor(e,t=!0){(0,r.A)(this,"data",void 0),(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"byteStart",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"littleEndian",void 0),this.buffer=e,this.data=e instanceof Uint8Array?new DataView(e.buffer):e.view,this.byteStart=e instanceof Uint8Array?e.byteOffset:0,this.pos=0,this.size=e.byteLength,this.littleEndian=!t}readUint8(){return this.data.getUint8(this.pos+++this.byteStart)}peekUint8(){return this.data.getUint8(this.pos+this.byteStart)}readUint16(){const e=this.data.getUint16(this.pos+this.byteStart,this.littleEndian);return this.pos+=2,e}peekUint16(){return this.data.getUint16(this.pos+this.byteStart,this.littleEndian)}readUint24(){const e=this.readUint16(),t=this.readUint8();return this.littleEndian?t<<16|e:e<<8|t}peekUint24(){const e=this.readUint16(),t=this.readUint8();return this.pos-=3,this.littleEndian?t<<16|e:e<<8|t}readUint32(){const e=this.data.getUint32(this.pos+this.byteStart,this.littleEndian);return this.pos+=4,e}peekUint32(){return this.data.getUint32(this.pos+this.byteStart,this.littleEndian)}readUint64(){const e=BigInt(this.readUint32()),t=BigInt(this.readUint32());return this.littleEndian?t<<BigInt(32)|e:e<<BigInt(32)|t}peekUint64(){const e=BigInt(this.readUint32()),t=BigInt(this.readUint32());return this.pos-=8,this.littleEndian?t<<BigInt(32)|e:e<<BigInt(32)|t}readInt8(){return this.data.getInt8(this.pos+++this.byteStart)}peekInt8(){return this.data.getInt8(this.pos+this.byteStart)}readInt16(){const e=this.data.getInt16(this.pos+this.byteStart,this.littleEndian);return this.pos+=2,e}peekInt16(){return this.data.getInt16(this.pos+this.byteStart,this.littleEndian)}readInt24(){const e=this.readUint24();return 8388608&e?e-16777216:e}peekInt24(){const e=this.peekUint24();return 8388608&e?e-16777216:e}readInt32(){const e=this.data.getInt32(this.pos+this.byteStart,this.littleEndian);return this.pos+=4,e}peekInt32(){return this.data.getInt32(this.pos+this.byteStart,this.littleEndian)}readInt64(){const e=BigInt(this.readInt32()),t=BigInt(this.readInt32());return this.littleEndian?t<<BigInt(32)|e:e<<BigInt(32)|t}peekInt64(){const e=BigInt(this.readInt32()),t=BigInt(this.readInt32());return this.pos-=8,this.littleEndian?t<<BigInt(32)|e:e<<BigInt(32)|t}readFloat(){const e=this.data.getFloat32(this.pos+this.byteStart,this.littleEndian);return this.pos+=4,e}peekFloat(){return this.data.getFloat32(this.pos+this.byteStart,this.littleEndian)}readDouble(){const e=this.data.getFloat64(this.pos+this.byteStart,this.littleEndian);return this.pos+=8,e}peekDouble(){return this.data.getFloat64(this.pos+this.byteStart,this.littleEndian)}readHex(e=1){let t="";for(let i=0;i<e;i++){const e=this.readUint8().toString(16);t+=1===e.length?"0"+e:e}return t}peekHex(e=1){const t=this.pos,i=this.readHex(e);return this.pos=t,i}readString(e=1){let t="";if(e){let i=this.pos;for(let t=0;t<e&&0===this.buffer[this.pos+t];t++)i++;t=a.decode(this.buffer.subarray(i,i+e))}return this.pos+=e,t}peekString(e=1){const t=this.pos,i=this.readString(e);return this.pos=t,i}readLine(){let e="";for(let t=this.pos;t<this.size;t++)if(10===this.buffer[t]||13===this.buffer[t]){e+=this.readString(t-this.pos);break}for(let e=this.pos;e<this.size&&(10===this.buffer[e]||13===this.buffer[e]);e++)this.readUint8();return e}peekLine(){const e=this.pos,t=this.readLine();return this.pos=e,t}getPos(){return BigInt(this.pos)}seek(e){e>this.size&&(e=this.size),this.pos=Math.max(0,e)}skip(e){this.seek(this.pos+e)}back(e){this.seek(this.pos-e)}remainingSize(){return this.size-this.pos}readBuffer(e){e=Math.min(e,this.remainingSize());const t=this.buffer.slice(this.pos,this.pos+e);return this.pos+=e,t}appendBuffer(e){this.buffer=(0,s.A)(Uint8Array,[this.buffer.slice(),e.slice()]),this.data=new DataView(this.buffer.buffer),this.size+=e.byteLength,this.byteStart=0}resetBuffer(e,t=!0){this.buffer=e,this.data=e instanceof Uint8Array?new DataView(e.buffer):e.view,this.byteStart=e instanceof Uint8Array?e.byteOffset:0,this.pos=0,this.size=e.byteLength,this.littleEndian=!t}}},729:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(134),s=i(4624),a=i(50011);class n{constructor(e,t=!0){(0,r.A)(this,"data",void 0),(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"byteStart",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"littleEndian",void 0),this.buffer=e,this.data=e instanceof Uint8Array?new DataView(e.buffer):e.view,this.byteStart=e instanceof Uint8Array?e.byteOffset:0,this.pos=0,this.size=e.byteLength,this.littleEndian=!t}writeUint8(e){this.data.setUint8(this.pos+++this.byteStart,e)}writeUint16(e){this.data.setUint16(this.pos+this.byteStart,e,this.littleEndian),this.pos+=2}writeUint24(e){const t=3840&e,i=240&e,r=15&e;this.littleEndian?(this.writeUint8(r),this.writeUint8(i),this.writeUint8(t)):(this.writeUint8(t),this.writeUint8(i),this.writeUint8(r))}writeUint32(e){this.data.setUint32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}writeUint64(e){this.data.setBigUint64(this.pos+this.byteStart,e,this.littleEndian),this.pos+=8}writeInt8(e){this.data.setInt8(this.pos+++this.byteStart,e)}writeInt16(e){this.data.setInt16(this.pos+this.byteStart,e,this.littleEndian),this.pos+=2}writeInt24(e){this.writeUint24(e<0?e+16777216:e)}writeInt32(e){this.data.setInt32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}writeInt64(e){this.data.setBigInt64(this.pos+this.byteStart,e,this.littleEndian),this.pos+=8}writeFloat(e){this.data.setFloat32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}writeDouble(e){this.data.setFloat64(this.pos+this.byteStart,e,this.littleEndian),this.pos+=8}getPos(){return this.pos}seek(e){e>this.size&&(e=this.size),this.pos=Math.max(0,e)}skip(e){this.seek(this.pos+e)}back(e){this.seek(this.pos-e)}remainingSize(){return this.size-this.pos}writeBuffer(e){let t=e.length;this.remainingSize()<t&&(t=this.remainingSize(),s.R8(`the remaining buffer size is smaller then the wrote buffer, hope set ${e.length}, but set ${t}`,"src/common/io/BufferWriter.ts",202)),this.buffer.set(e,this.pos),this.pos+=e.length}writeString(e){const t=a.encode(e);return this.writeBuffer(t),t.length}getWroteBuffer(){return this.buffer.subarray(0,this.pos)}resetBuffer(e,t=!0){this.buffer=e,this.data=e instanceof Uint8Array?new DataView(e.buffer):e.view,this.byteStart=e instanceof Uint8Array?e.byteOffset:0,this.pos=0,this.size=e.byteLength,this.littleEndian=!t}}},24175:(e,t,i)=>{"use strict";i.d(t,{A:()=>d});var r=i(134),s=i(54001),a=i.n(s),n=i(4624),o=i(50011),c=i(13724);const l="src/common/io/IOReader.ts";class d{constructor(e=1048576,t=!0,i){if((0,r.A)(this,"data",void 0),(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"endPointer",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"littleEndian",void 0),(0,r.A)(this,"fileSize_",void 0),(0,r.A)(this,"error",void 0),(0,r.A)(this,"onFlush",void 0),(0,r.A)(this,"onSeek",void 0),(0,r.A)(this,"onSize",void 0),(0,r.A)(this,"flags",void 0),(0,r.A)(this,"flushResolve",void 0),this.pos=BigInt(0),this.pointer=0,this.error=0,this.endPointer=0,this.littleEndian=!t,this.flags=0,i&&i.view)this.size=i.length,this.buffer=i,this.data=i.view;else if(i&&!i.byteOffset)this.size=i.length,this.buffer=i,this.data=new DataView(this.buffer.buffer);else{if(i)throw new Error("not support subarray of ArrayBuffer");this.size=Math.max(e,102400),this.buffer=new Uint8Array(this.size),this.data=new DataView(this.buffer.buffer)}}async readUint8(){this.remainingLength()<1&&await this.flush(1);const e=this.data.getUint8(this.pointer);return this.pointer++,this.pos++,e}async peekUint8(){return this.remainingLength()<1&&await this.flush(1),this.data.getUint8(this.pointer)}async readUint16(){this.remainingLength()<2&&await this.flush(2);const e=this.data.getUint16(this.pointer,this.littleEndian);return this.pointer+=2,this.pos+=BigInt(2),e}async peekUint16(){return this.remainingLength()<2&&await this.flush(2),this.data.getUint16(this.pointer,this.littleEndian)}async readUint24(){this.remainingLength()<3&&await this.flush(3);const e=await this.readUint16(),t=await this.readUint8();return this.littleEndian?t<<16|e:e<<8|t}async peekUint24(){this.remainingLength()<3&&await this.flush(3);const e=this.pointer,t=this.pos,i=await this.readUint16(),r=await this.readUint8(),s=this.littleEndian?r<<16|i:i<<8|r;return this.pointer=e,this.pos=t,s}async readUint32(){this.remainingLength()<4&&await this.flush(4);const e=this.data.getUint32(this.pointer,this.littleEndian);return this.pointer+=4,this.pos+=BigInt(4),e}async peekUint32(){return this.remainingLength()<4&&await this.flush(4),this.data.getUint32(this.pointer,this.littleEndian)}async readUint64(){this.remainingLength()<8&&await this.flush(8);const e=this.data.getBigUint64(this.pointer,this.littleEndian);return this.pointer+=8,this.pos+=BigInt(8),e}async peekUint64(){return this.remainingLength()<8&&await this.flush(8),this.data.getBigUint64(this.pointer,this.littleEndian)}async readInt8(){this.remainingLength()<1&&await this.flush(1);const e=this.data.getInt8(this.pointer);return this.pointer++,this.pos++,e}async peekInt8(){return this.remainingLength()<1&&await this.flush(1),this.data.getInt8(this.pointer)}async readInt16(){this.remainingLength()<2&&await this.flush(2);const e=this.data.getInt16(this.pointer,this.littleEndian);return this.pointer+=2,this.pos+=BigInt(2),e}async peekInt16(){return this.remainingLength()<2&&await this.flush(2),this.data.getInt16(this.pointer,this.littleEndian)}async readInt24(){const e=await this.readUint24();return 8388608&e?e-16777216:e}async peekInt24(){const e=await this.peekUint24();return 8388608&e?e-16777216:e}async readInt32(){this.remainingLength()<4&&await this.flush(4);const e=this.data.getInt32(this.pointer,this.littleEndian);return this.pointer+=4,this.pos+=BigInt(4),e}async peekInt32(){return this.remainingLength()<4&&await this.flush(4),this.data.getInt32(this.pointer,this.littleEndian)}async readInt64(){this.remainingLength()<8&&await this.flush(8);const e=this.data.getBigInt64(this.pointer,this.littleEndian);return this.pointer+=8,this.pos+=BigInt(8),e}async peekInt64(){return this.remainingLength()<8&&await this.flush(8),this.data.getBigInt64(this.pointer,this.littleEndian)}async readFloat(){this.remainingLength()<4&&await this.flush(4);const e=this.data.getFloat32(this.pointer,this.littleEndian);return this.pointer+=4,this.pos+=BigInt(4),e}async peekFloat(){return this.remainingLength()<4&&await this.flush(4),this.data.getFloat32(this.pointer,this.littleEndian)}async readDouble(){this.remainingLength()<8&&await this.flush(8);const e=this.data.getFloat64(this.pointer,this.littleEndian);return this.pointer+=8,this.pos+=BigInt(8),e}async peekDouble(){return this.remainingLength()<8&&await this.flush(8),this.data.getFloat64(this.pointer,this.littleEndian)}async readHex(e=1){let t="";for(let i=0;i<e;i++){const e=(await this.readUint8()).toString(16);t+=1===e.length?"0"+e:e}return t}async peekHex(e=1){e>this.size&&(this.error=-1048574,n.h2("peekHex, length too large",l,416)),this.remainingLength()<e&&await this.flush(e);const t=this.pointer,i=this.pos;let r="";for(let t=0;t<e;t++){const e=(await this.readUint8()).toString(16);r+=1===e.length?"0"+e:e}return this.pointer=t,this.pos=i,r}async readBuffer(e,t){if(t||(t=new Uint8Array(e)),this.remainingLength()<e){let i=0;if(this.remainingLength()>0){const r=this.remainingLength();t.set(this.buffer.subarray(this.pointer,this.pointer+r),i),i+=r,this.pointer+=r,this.pos+=BigInt(r),e-=r}for(;e>0;){await this.flush();const r=Math.min(this.endPointer-this.pointer,e);t.set(this.buffer.subarray(this.pointer,this.pointer+r),i),i+=r,this.pointer+=r,this.pos+=BigInt(r),e-=r}}else t.set(this.buffer.subarray(this.pointer,this.pointer+e),0),this.pointer+=e,this.pos+=BigInt(e);return t}async peekBuffer(e,t){return e>this.size&&(this.error=-1048574,n.h2("peekBuffer, length too large",l,501)),this.remainingLength()<e&&await this.flush(e),t||(t=new Uint8Array(e)),t.set(this.buffer.subarray(this.pointer,this.pointer+e),0),t}async readToBuffer(e,t){if(this.remainingLength()<e){let i=0;if(this.remainingLength()>0){const r=this.remainingLength();t.set(this.buffer.subarray(this.pointer,this.pointer+r),i),i+=r,this.pointer+=r,this.pos+=BigInt(r),e-=r}for(;e>0;){try{await this.flush()}catch(e){if(-1048576===this.error&&i)return i;throw e}const r=Math.min(this.endPointer-this.pointer,e);t.set(this.buffer.subarray(this.pointer,this.pointer+r),i),i+=r,this.pointer+=r,this.pos+=BigInt(r),e-=r}return i}return t.set(this.buffer.subarray(this.pointer,this.pointer+e),0),this.pointer+=e,this.pos+=BigInt(e),e}async readString(e=1){const t=await this.readBuffer(e);return o.decode(t)}async peekString(e=1){const t=await this.peekBuffer(e);return o.decode(t)}async readLine(){let e="";for(;;){let t=!1;for(let i=this.pointer;i<this.endPointer;i++)if(10===this.buffer[i]||13===this.buffer[i]){i!==this.pointer&&(e+=await this.readString(i-this.pointer)),t=!0;break}if(t)break;e+=await this.readString(this.remainingLength()),await this.flush()}let t=await this.peekUint8();return 10!==t&&13!==t||(this.pointer++,13===t&&(t=await this.peekUint8(),10===t&&this.pointer++)),e}async peekLine(){if(this.remainingLength()<this.size)try{await this.flush()}catch(e){if(-1048576!==this.error)throw e}let e="",t=!1;for(let i=this.pointer;i<this.endPointer;i++)if(10===this.buffer[i]||13===this.buffer[i]){e+=await this.peekString(i-this.pointer),t=!0;break}return t||(this.error=-1048574,n.h2("peekLine, out of buffer",l,659)),e}getPointer(){return this.pointer}getPos(){return this.pos}async skip(e){const t=e;for(;this.remainingLength()<e;)e-=this.remainingLength(),this.pointer=this.endPointer,await this.flush();this.remainingLength()>=e&&(this.pointer+=e),this.pos+=BigInt(t)}remainingLength(){return this.endPointer-this.pointer}async flush_(e){return new(a())((async t=>{for(this.flushResolve=t;;){const i=await this.onFlush(e);if(-1048575!==i){this.flushResolve=null,t(i);break}await new c.A(0)}}))}async flush(e=0){if(this.onFlush||(this.error=-1048574,n.h2("IOReader error, flush failed because of no flush callback",l,738)),!(this.size-this.remainingLength()<=0)){if(e=Math.min(e,this.size),this.pointer<this.endPointer?(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer):this.endPointer=0,this.pointer=0,e)for(;this.remainingLength()<e;){const e=await this.flush_(this.buffer.subarray(this.endPointer));if(e<0)throw this.error=e,new Error(`IOReader error, flush ${-1048576===e?"ended":"failed"}, ret: ${e}`);this.endPointer+=e}else{const e=await this.flush_(this.buffer.subarray(this.endPointer));if(e<0)throw this.error=e,new Error(`IOReader error, flush ${-1048576===e?"ended":"failed"}, ret: ${e}`);this.endPointer+=e}this.error=0}}async seek(e,t=!1,i=!0){if(!t){const t=Number(e-this.pos);if(t<0&&Math.abs(t)<this.pointer)return this.pointer+=t,void(this.pos=e);if(t>0&&this.pointer+t<this.endPointer)return this.pointer+=t,void(this.pos=e);if(0===t)return}this.onSeek||(this.error=-1048574,n.h2("IOReader error, seek failed because of no seek callback",l,809)),this.pointer=this.endPointer=0,this.pos=e;const r=await this.onSeek(e);0!==r&&(this.error=r,n.h2("IOReader error, seek failed",l,818)),i&&await this.flush()}getBuffer(){return this.buffer}appendBuffer(e){if(this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else if(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer,this.pointer=0,this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else{const t=Math.min(this.size-this.endPointer,e.length);this.buffer.set(e.subarray(0,t),this.endPointer),this.endPointer+=t,n.R8("IOReader, call appendBuffer but the buffer's size is lagger then the remaining size",l,856)}}reset(){this.pointer=this.endPointer=0,this.pos=BigInt(0),this.error=0}setEndian(e){this.littleEndian=!e}isBigEndian(){return!this.littleEndian}async fileSize(){if(this.fileSize_)return this.fileSize_;if(!this.onSize)return n.R8("IOReader error, fileSize failed because of no onSize callback",l,898),BigInt(0);try{this.fileSize_=await this.onSize()}catch(e){n.R8(`IOReader error, call fileSize failed: ${e}`,l,905),this.fileSize_=BigInt(0)}return this.fileSize_}getBufferSize(){return this.size}async pipe(e,t){if(t)if(this.remainingLength()<t){if(this.remainingLength()>0){const i=this.remainingLength();await e.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+i)),this.pointer+=i,this.pos+=BigInt(i),t-=i}for(;t>0;){await this.flush();const i=Math.min(this.remainingLength(),t);await e.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+i)),this.pointer+=i,this.pos+=BigInt(i),t-=i}}else await e.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+t)),this.pointer+=t,this.pos+=BigInt(t);else{if(this.remainingLength()>0){const t=this.remainingLength();await e.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+t)),this.pointer+=t,this.pos+=BigInt(t)}for(;await this.flush_(this.buffer.subarray(0))>0;){const t=this.remainingLength();await e.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+t)),this.pointer+=t,this.pos+=BigInt(t)}}}abort(){this.error=-1048572,this.flushResolve&&(this.flushResolve(-1048572),this.flushResolve=null)}}},34531:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(134),s=i(50011);class a{constructor(e=1048576,t=!0,i){if((0,r.A)(this,"data",void 0),(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"littleEndian",void 0),(0,r.A)(this,"error",void 0),(0,r.A)(this,"onFlush",void 0),(0,r.A)(this,"onSeek",void 0),this.pointer=0,this.pos=BigInt(0),this.size=e,this.littleEndian=!t,this.error=0,i&&i.view)this.size=i.length,this.buffer=i,this.data=i.view;else if(i&&!i.byteOffset)this.size=i.length,this.buffer=i,this.data=new DataView(this.buffer.buffer);else{if(i)throw new Error("not support subarray of ArrayBuffer");this.buffer=new Uint8Array(this.size),this.data=new DataView(this.buffer.buffer)}}async writeUint8(e){this.remainingLength()<1&&await this.flush(),this.data.setUint8(this.pointer,e),this.pointer++,this.pos++}async writeUint16(e){this.remainingLength()<2&&await this.flush(),this.data.setUint16(this.pointer,e,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}async writeUint24(e){this.remainingLength()<3&&await this.flush();const t=(16711680&e)>>16,i=(65280&e)>>8,r=255&e;this.littleEndian?(await this.writeUint8(r),await this.writeUint8(i),await this.writeUint8(t)):(await this.writeUint8(t),await this.writeUint8(i),await this.writeUint8(r))}async writeUint32(e){this.remainingLength()<4&&await this.flush(),this.data.setUint32(this.pointer,e,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}async writeUint64(e){this.remainingLength()<8&&await this.flush(),this.data.setBigUint64(this.pointer,e,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}async writeInt8(e){this.remainingLength()<1&&await this.flush(),this.data.setInt8(this.pointer,e),this.pointer++,this.pos++}async writeInt16(e){this.remainingLength()<2&&await this.flush(),this.data.setInt16(this.pointer,e,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}async writeInt24(e){await this.writeUint24(e<0?e+16777216:e)}async writeInt32(e){this.remainingLength()<4&&await this.flush(),this.data.setInt32(this.pointer,e,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}async writeInt64(e){this.remainingLength()<8&&await this.flush(),this.data.setBigInt64(this.pointer,e,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}async writeFloat(e){this.remainingLength()<4&&await this.flush(),this.data.setFloat32(this.pointer,e,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}async writeDouble(e){this.remainingLength()<8&&await this.flush(),this.data.setFloat64(this.pointer,e,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}getPointer(){return this.pointer}getPos(){return this.pos}remainingLength(){return this.size-this.pointer}async writeBuffer(e){if(!e.length)return;let t=e.length;if(this.remainingLength()<t){let i=0;for(;t>0;){await this.flush();const r=Math.min(this.size,t);this.buffer.set(e.subarray(i,i+r),this.pointer),this.pointer+=r,this.pos+=BigInt(r),i+=r,t-=r}}else this.buffer.set(e,this.pointer),this.pointer+=t,this.pos+=BigInt(t)}async writeString(e){const t=s.encode(e);return await this.writeBuffer(t),t.length}async flush(){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const e=await this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==e)throw this.error=e,Error("IOWriter error, flush failed")}this.pointer=0}async flushToPos(e){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const t=await this.onFlush(this.buffer.subarray(0,this.pointer),e);if(0!==t)throw this.error=t,Error("IOWriter error, flush failed")}this.pointer=0}async seek(e){if(!this.onSeek)throw this.error=-1048574,Error("IOWriter error, seek failed because of no seek callback");await this.flush();const t=await this.onSeek(e);if(0!==t)throw this.error=t,Error("IOWriter error, seek failed");this.pos=e}seekInline(e){const t=this.pointer;this.pointer=Math.max(0,Math.min(this.size,e)),this.pos+=BigInt(this.pointer-t)}skip(e){const t=this.pointer;this.pointer=Math.min(this.size,this.pointer+e),this.pos+=BigInt(this.pointer-t)}back(e){const t=this.pointer;this.pointer=Math.max(0,this.pointer-e),this.pos+=BigInt(this.pointer-t)}getBuffer(){return this.buffer.subarray(0,this.pointer)}setEndian(e){this.littleEndian=!e}reset(){this.pointer=0,this.pos=BigInt(0),this.error=0}getBufferSize(){return this.size}}},35336:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(134),s=i(50011);class a{constructor(e=1048576,t=!0,i){if((0,r.A)(this,"data",void 0),(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"littleEndian",void 0),(0,r.A)(this,"error",void 0),(0,r.A)(this,"onFlush",void 0),(0,r.A)(this,"onSeek",void 0),this.pointer=0,this.pos=BigInt(0),this.size=e,this.littleEndian=!t,this.error=0,i&&i.view)this.size=i.length,this.buffer=i,this.data=i.view;else if(i&&!i.byteOffset)this.size=i.length,this.buffer=i,this.data=new DataView(this.buffer.buffer);else{if(i)throw new Error("not support subarray of ArrayBuffer");this.buffer=new Uint8Array(this.size),this.data=new DataView(this.buffer.buffer)}}writeUint8(e){this.remainingLength()<1&&this.flush(),this.data.setUint8(this.pointer,e),this.pointer++,this.pos++}writeUint16(e){this.remainingLength()<2&&this.flush(),this.data.setUint16(this.pointer,e,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}writeUint24(e){this.remainingLength()<3&&this.flush();const t=(16711680&e)>>16,i=(65280&e)>>8,r=255&e;this.littleEndian?(this.writeUint8(r),this.writeUint8(i),this.writeUint8(t)):(this.writeUint8(t),this.writeUint8(i),this.writeUint8(r))}writeUint32(e){this.remainingLength()<4&&this.flush(),this.data.setUint32(this.pointer,e,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}writeUint64(e){this.remainingLength()<8&&this.flush(),this.data.setBigUint64(this.pointer,e,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}writeInt8(e){this.remainingLength()<1&&this.flush(),this.data.setInt8(this.pointer,e),this.pointer++,this.pos++}writeInt16(e){this.remainingLength()<2&&this.flush(),this.data.setInt16(this.pointer,e,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}writeInt24(e){this.writeUint24(e<0?e+16777216:e)}writeInt32(e){this.remainingLength()<4&&this.flush(),this.data.setInt32(this.pointer,e,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}writeInt64(e){this.remainingLength()<8&&this.flush(),this.data.setBigInt64(this.pointer,e,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}writeFloat(e){this.remainingLength()<4&&this.flush(),this.data.setFloat32(this.pointer,e,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}writeDouble(e){this.remainingLength()<8&&this.flush(),this.data.setFloat64(this.pointer,e,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}getPointer(){return this.pointer}getPos(){return this.pos}remainingLength(){return this.size-this.pointer}writeBuffer(e){if(!e.length)return;let t=e.length;if(this.remainingLength()<t){let i=0;for(;t>0;){this.flush();const r=Math.min(this.size,t);this.buffer.set(e.subarray(i,i+r),this.pointer),this.pointer+=r,this.pos+=BigInt(r),i+=r,t-=r}}else this.buffer.set(e,this.pointer),this.pointer+=t,this.pos+=BigInt(t)}writeString(e){const t=s.encode(e);return this.writeBuffer(t),t.length}flush(){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const e=this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==e)throw this.error=e,Error("IOWriter error, flush failed")}this.pointer=0}flushToPos(e){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const t=this.onFlush(this.buffer.subarray(0,this.pointer),e);if(0!==t)throw this.error=t,Error("IOWriter error, flush failed")}this.pointer=0}seek(e){if(!this.onSeek)throw this.error=-1048574,Error("IOWriter error, seek failed because of no seek callback");this.flush();const t=this.onSeek(e);if(0!==t)throw this.error=t,Error("IOWriter error, seek failed");this.pos=e}seekInline(e){const t=this.pointer;this.pointer=Math.max(0,Math.min(this.size,e)),this.pos+=BigInt(this.pointer-t)}skip(e){const t=this.pointer;this.pointer=Math.min(this.size,this.pointer+e),this.pos+=BigInt(this.pointer-t)}back(e){const t=this.pointer;this.pointer=Math.max(0,this.pointer-e),this.pos+=BigInt(this.pointer-t)}getBuffer(){return this.buffer.subarray(0,this.pointer)}setEndian(e){this.littleEndian=!e}reset(){this.pointer=0,this.pos=BigInt(0),this.error=0}getBufferSize(){return this.size}}},22343:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(134),s=i(92647);class a{constructor(){(0,r.A)(this,"queue",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"startPos",void 0),(0,r.A)(this,"endPos",void 0),(0,r.A)(this,"index",void 0),(0,r.A)(this,"offset",void 0),this.queue=[],this.startPos=BigInt(0),this.endPos=BigInt(0),this.pos=BigInt(0)}write(e){if(this.pos===this.endPos)this.queue.push(e),this.endPos+=BigInt(e.length),this.pos+=BigInt(e.length);else if(e.length<this.queue[this.index].length-this.offset)this.queue[this.index].set(e,this.offset),this.offset+=e.length,this.pos+=BigInt(e.length),this.offset===this.queue[this.index].length&&(this.index++,this.offset=0),this.index===this.queue.length&&(this.index=-1,this.offset=-1,this.pos=this.endPos);else{let t=0;for(;t<e.length;){const i=Math.min(this.queue[this.index].length-this.offset,e.length-t);if(this.queue[this.index].set(e.subarray(t,t+i),this.offset),t+=i,this.offset+=i,this.pos+=BigInt(i),this.offset===this.queue[this.index].length){if(this.index+1===this.queue.length){if(t<e.length){const i=e.subarray(e.length-t);this.queue.push(i),this.endPos+=BigInt(i.length)}this.pos=this.endPos,this.index=-1,this.offset=-1;break}this.index++,this.offset=0}}}}seek(e){if(e<this.startPos||e>this.endPos)return!1;this.pos=e,this.index=-1,this.offset=-1;let t=this.startPos;for(let i=0;i<this.queue.length;i++){if(e<=t+BigInt(this.queue[i].length)){this.index=i,this.offset=Number(e-t);break}t+=BigInt(this.queue[i].length)}return this.index<0&&(this.pos=this.endPos),!0}flush(){this.startPos=this.endPos,this.pos=this.endPos,this.index=-1,this.offset=-1;const e=(0,s.A)(Uint8Array,this.queue);return this.queue.length=0,e}get size(){return this.queue.length}}},45726:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(134),s=i(72739),a=i(4624);const n="src/common/math/Matrix3.ts";class o{static RowMajor(e){return new o([e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]])}static ColMajor(e){return new o(e)}constructor(e){(0,r.A)(this,"element",void 0),e?(this.element=new Float32Array(9),this.set(e)):this.element=new Float32Array([1,0,0,0,1,0,0,0,1])}rc(e,t){return this.getValue(3*t+e)}setRC(e,t,i){this.setValue(3*t+e,i)}getValue(e){if(e>=0&&e<9)return this.element[e];a.z3("index out of Matrix4's rang [0 - 9]",n,47)}setValue(e,t){e>=0&&e<9?this.element[e]=t:a.z3("index out of Matrix4's rang [0 - 9]",n,56)}setIdentity(){return this.element=new Float32Array([1,0,0,0,1,0,0,0,1]),this}set(e){return s.__(e,((e,t)=>{this.element[t]=e})),this}invert(){const e=this.element,t=e[0],i=e[1],r=e[2],s=e[3],a=e[4],n=e[5],o=e[6],c=e[7],l=e[8],d=l*a-n*c,h=n*o-l*s,u=c*s-a*o,f=t*d+i*h+r*u;if(0===f)return this.set([0,0,0,0,0,0,0,0,0]);const p=1/f;return e[0]=d*p,e[1]=(r*c-l*i)*p,e[2]=(n*i-r*a)*p,e[3]=h*p,e[4]=(l*t-r*o)*p,e[5]=(r*s-n*t)*p,e[6]=u*p,e[7]=(i*o-c*t)*p,e[8]=(a*t-i*s)*p,this}toArray(){let e=[];for(let t=0;t<9;t++)e[t]=this.element[t];return e}copy(){return(new o).set(this.toArray())}}},12535:(e,t,i)=>{"use strict";i.d(t,{A:()=>l});var r=i(134),s=i(72739),a=i(4624),n=i(1064);const o="src/common/math/Matrix4.ts";let c;class l{static shared(){return c||(c=new l)}static RowMajor(e){return new l([e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]])}static ColMajor(e){return new l(e)}constructor(e){(0,r.A)(this,"element",void 0),e?(this.element=new Float32Array(16),this.set(e)):this.element=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}rc(e,t){return this.getValue(4*t+e)}setRC(e,t,i){this.setValue(4*t+e,i)}getValue(e){if(e>=0&&e<=15)return this.element[e];a.z3("index out of Matrix4's rang [0 - 15]",o,58)}setValue(e,t){e>=0&&e<=15?this.element[e]=t:a.z3("index out of Matrix4's rang [0 - 15]",o,67)}setIdentity(){return this.element=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this}set(e){return s.__(e,((e,t)=>{this.element[t]=e})),this}multiply(e){let t,i,r,s,a,n,o,c;if(s=i=this.element,r=e.element,s===r)for(r=new Float32Array(16),t=0;t<16;t++)r[t]=s[t];for(t=0;t<4;t++)a=i[t],n=i[t+4],o=i[t+8],c=i[t+12],s[t]=a*r[0]+n*r[1]+o*r[2]+c*r[3],s[t+4]=a*r[4]+n*r[5]+o*r[6]+c*r[7],s[t+8]=a*r[8]+n*r[9]+o*r[10]+c*r[11],s[t+12]=a*r[12]+n*r[13]+o*r[14]+c*r[15];return this}multiplyVector3(e){let t=this.element,i=e.element;return new n.P([i[0]*t[0]+i[1]*t[4]+i[2]*t[8]+t[12],i[0]*t[1]+i[1]*t[5]+i[2]*t[9]+t[13],i[0]*t[2]+i[1]*t[6]+i[2]*t[10]+t[14]])}multiplyVector4(e){let t=this.element,i=e.element;return new n.I([i[0]*t[0]+i[1]*t[4]+i[2]*t[8]+i[3]*t[12],i[0]*t[1]+i[1]*t[5]+i[2]*t[9]+i[3]*t[13],i[0]*t[2]+i[1]*t[6]+i[2]*t[10]+i[3]*t[14],i[0]*t[3]+i[1]*t[7]+i[2]*t[11]+i[3]*t[15]])}transpose(){let e,t;return e=this.element,t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setInverseOf(e){let t,i,r,s,a;if(i=e.element,r=this.element,s=new Float32Array(16),s[0]=i[5]*i[10]*i[15]-i[5]*i[11]*i[14]-i[9]*i[6]*i[15]+i[9]*i[7]*i[14]+i[13]*i[6]*i[11]-i[13]*i[7]*i[10],s[1]=-i[1]*i[10]*i[15]+i[1]*i[11]*i[14]+i[9]*i[2]*i[15]-i[9]*i[3]*i[14]-i[13]*i[2]*i[11]+i[13]*i[3]*i[10],s[2]=i[1]*i[6]*i[15]-i[1]*i[7]*i[14]-i[5]*i[2]*i[15]+i[5]*i[3]*i[14]+i[13]*i[2]*i[7]-i[13]*i[3]*i[6],s[3]=-i[1]*i[6]*i[11]+i[1]*i[7]*i[10]+i[5]*i[2]*i[11]-i[5]*i[3]*i[10]-i[9]*i[2]*i[7]+i[9]*i[3]*i[6],s[4]=-i[4]*i[10]*i[15]+i[4]*i[11]*i[14]+i[8]*i[6]*i[15]-i[8]*i[7]*i[14]-i[12]*i[6]*i[11]+i[12]*i[7]*i[10],s[5]=i[0]*i[10]*i[15]-i[0]*i[11]*i[14]-i[8]*i[2]*i[15]+i[8]*i[3]*i[14]+i[12]*i[2]*i[11]-i[12]*i[3]*i[10],s[6]=-i[0]*i[6]*i[15]+i[0]*i[7]*i[14]+i[4]*i[2]*i[15]-i[4]*i[3]*i[14]-i[12]*i[2]*i[7]+i[12]*i[3]*i[6],s[7]=i[0]*i[6]*i[11]-i[0]*i[7]*i[10]-i[4]*i[2]*i[11]+i[4]*i[3]*i[10]+i[8]*i[2]*i[7]-i[8]*i[3]*i[6],s[8]=i[4]*i[9]*i[15]-i[4]*i[11]*i[13]-i[8]*i[5]*i[15]+i[8]*i[7]*i[13]+i[12]*i[5]*i[11]-i[12]*i[7]*i[9],s[9]=-i[0]*i[9]*i[15]+i[0]*i[11]*i[13]+i[8]*i[1]*i[15]-i[8]*i[3]*i[13]-i[12]*i[1]*i[11]+i[12]*i[3]*i[9],s[10]=i[0]*i[5]*i[15]-i[0]*i[7]*i[13]-i[4]*i[1]*i[15]+i[4]*i[3]*i[13]+i[12]*i[1]*i[7]-i[12]*i[3]*i[5],s[11]=-i[0]*i[5]*i[11]+i[0]*i[7]*i[9]+i[4]*i[1]*i[11]-i[4]*i[3]*i[9]-i[8]*i[1]*i[7]+i[8]*i[3]*i[5],s[12]=-i[4]*i[9]*i[14]+i[4]*i[10]*i[13]+i[8]*i[5]*i[14]-i[8]*i[6]*i[13]-i[12]*i[5]*i[10]+i[12]*i[6]*i[9],s[13]=i[0]*i[9]*i[14]-i[0]*i[10]*i[13]-i[8]*i[1]*i[14]+i[8]*i[2]*i[13]+i[12]*i[1]*i[10]-i[12]*i[2]*i[9],s[14]=-i[0]*i[5]*i[14]+i[0]*i[6]*i[13]+i[4]*i[1]*i[14]-i[4]*i[2]*i[13]-i[12]*i[1]*i[6]+i[12]*i[2]*i[5],s[15]=i[0]*i[5]*i[10]-i[0]*i[6]*i[9]-i[4]*i[1]*i[10]+i[4]*i[2]*i[9]+i[8]*i[1]*i[6]-i[8]*i[2]*i[5],a=i[0]*s[0]+i[1]*s[4]+i[2]*s[8]+i[3]*s[12],0===a)return this;for(a=1/a,t=0;t<16;t++)r[t]=s[t]*a;return this}invert(){return this.setInverseOf(this),this}setOrtho(e,t,i,r,s,n){let c,l,d;return e!==t&&i!==r&&s!==n||a.h2("null frustum",o,240),c=1/(t-e),l=1/(r-i),d=1/(n-s),this.set([2*c,0,0,0,0,2*l,0,0,0,0,-2*d,0,-(t+e)*c,-(r+i)*l,-(n+s)*d,1]),this}ortho(e,t,i,r,s,a){return this.multiply((new l).setOrtho(e,t,i,r,s,a))}setFrustum(e,t,i,r,s,n){let c,l,d;return e!==t&&i!==r&&s!==n||a.z3("null frustum",o,281),s<=0&&a.h2("near <= 0",o,284),n<=0&&a.h2("far <= 0",o,287),c=1/(t-e),l=1/(r-i),d=1/(n-s),this.set([2*s*c,0,0,0,0,2*s*l,0,0,(t+e)*c,(r+i)*l,-(n+s)*d,-1,0,0,-2*s*n*d,0]),this}frustum(e,t,i,r,s,a){return this.multiply((new l).setOrtho(e,t,i,r,s,a))}setPerspective(e,t,i,r){let s,n,c;return i!==r&&0!==t||a.h2("null frustum",o,328),i<=0&&a.h2("near <= 0",o,331),r<=0&&a.h2("far <= 0",o,334),e=Math.PI*e/180/2,n=Math.sin(e),0===n&&a.h2("null frustum",o,342),s=1/(r-i),c=Math.cos(e)/n,this.set([c/t,0,0,0,0,c,0,0,0,0,-(r+i)*s,-1,0,0,-2*i*r*s,0]),this}perspective(e,t,i,r){return this.multiply((new l).setPerspective(e,t,i,r))}setScale(e){return this.set([e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1]),this}scale(e){let t=this.element;return t[0]*=e.x,t[1]*=e.x,t[2]*=e.x,t[3]*=e.x,t[4]*=e.y,t[5]*=e.y,t[6]*=e.y,t[7]*=e.y,t[8]*=e.z,t[9]*=e.z,t[10]*=e.z,t[11]*=e.z,this}setTranslate(e){return this.set([1,0,0,0,0,1,0,0,0,0,1,0,e.x,e.y,e.z,1]),this}preTranslate(e){let t=this.element;return t[12]+=t[0]*e.x+t[4]*e.y+t[8]*e.z,t[13]+=t[1]*e.x+t[5]*e.y+t[9]*e.z,t[14]+=t[2]*e.x+t[6]*e.y+t[10]*e.z,t[15]+=t[3]*e.x+t[7]*e.y+t[11]*e.z,this}postTranslate(e){let t=this.element;return t[0]+=e.x*t[3],t[1]+=e.y*t[3],t[2]+=e.z*t[3],t[4]+=e.x*t[7],t[5]+=e.y*t[7],t[6]+=e.z*t[7],t[8]+=e.x*t[11],t[9]+=e.y*t[11],t[10]+=e.z*t[11],t[12]+=e.x*t[15],t[13]+=e.y*t[15],t[14]+=e.z*t[15],this}setRotate(e,t){let i,r,s,a,n,o,c,l,d,h,u,f,p,m;return e=Math.PI*e/180,i=t.x,r=t.y,s=t.z,a=Math.sin(e),n=Math.cos(e),0!==t.x&&0===t.y&&0===t.z?(t.x<0&&(a=-a),this.set([1,0,0,0,0,n,-a,0,0,a,n,0,0,0,0,1])):0===t.x&&0!==t.y&&0===t.z?(t.y<0&&(a=-a),this.set([n,0,a,0,0,1,0,0,-a,0,n,0,0,0,0,1])):0===t.x&&0===t.y&&0!==t.z?(t.z<0&&(a=-a),this.set([n,-a,0,0,a,n,0,0,0,0,1,0,0,0,0,1])):(o=t.magnitude,1!==o&&(c=1/o,i*=c,r*=c,s*=c),l=1-n,d=i*r,h=r*s,u=s*i,f=i*a,p=r*a,m=s*a,this.set([i*i*l+n,d*l+m,u*l-p,0,d*l-m,r*r*l+n,h*l+f,0,u*l+p,h*l-f,s*s*l+n,0,0,0,0,1])),this}rotate(e,t){return this.multiply((new l).setRotate(e,t)),this}setLookAt(e,t,i){let r,s,a,o,c,l,d,h,u,f,p;return r=t.x-e.x,s=t.y-e.y,a=t.z-e.z,o=1/Math.sqrt(r*r+s*s+a*a),r*=o,s*=o,a*=o,c=s*i.z-a*i.y,l=a*i.x-r*i.z,d=r*i.y-s*i.x,h=1/Math.sqrt(c*c+l*l+d*d),c*=h,l*=h,d*=h,u=l*a-d*s,f=d*r-c*a,p=c*s-l*r,this.set([c,u,-r,0,l,f,-s,0,d,p,-a,0,0,0,0,1]),this.preTranslate(new n.P([-e.x,-e.y,-e.z]))}lookAt(e,t,i){return this.multiply((new l).setLookAt(e,t,i))}toArray(){let e=[];for(let t=0;t<16;t++)e[t]=this.element[t];return e}copy(){return(new l).set(this.toArray())}}},1064:(e,t,i)=>{"use strict";i.d(t,{I:()=>a,P:()=>s});var r=i(134);class s{constructor(e){(0,r.A)(this,"element",void 0),this.element=new Float32Array(3),e&&(this.element[0]=e[0],this.element[1]=e[1],this.element[2]=e[2])}normalize(){let e=this.x,t=this.y,i=this.z,r=this.magnitude;return r?(1===r||(r=1/r,this.x=e*r,this.y=t*r,this.z=i*r),this):(this.x=this.y=this.z=0,this)}toArray(){return[this.x,this.y,this.z]}get magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}get sqrMagnitude(){return this.x*this.x+this.y*this.y+this.z*this.z}get x(){return this.element[0]}set x(e){this.element[0]=e}get y(){return this.element[1]}set y(e){this.element[1]=e}get z(){return this.element[2]}set z(e){this.element[2]=e}}class a{constructor(e){(0,r.A)(this,"element",void 0),this.element=new Float32Array(4),e&&(this.element[0]=e[0],this.element[1]=e[1],this.element[2]=e[2],this.element[4]=e[3])}}},95073:(e,t,i)=>{"use strict";function r(e,t){return e+(t-1)&~(t-1)}i.d(t,{A:()=>r})},31658:(e,t,i)=>{"use strict";function r(e,t){for(;0!==t;)[e,t]=[t,e%t];return e}i.d(t,{A:()=>r})},66551:(e,t,i)=>{"use strict";i.d(t,{B:()=>s});var r=i(45726);function s(e,t){const i=new r.A([0,0,0,0,0,0,0,0,0]);for(let r=0;r<3;r++)for(let s=0;s<3;s++){let a=e.rc(r,0)*t.rc(0,s)+e.rc(r,1)*t.rc(1,s)+e.rc(r,2)*t.rc(2,s);i.setRC(r,s,a)}return i}i(12535)},4304:(e,t,i)=>{"use strict";function r(e){return e<=0?1:Math.pow(2,Math.ceil(Math.log2(e)))}i.d(t,{A:()=>r})},60153:(e,t,i)=>{"use strict";i.d(t,{Y3:()=>s}),i(12535);var r=i(1064);function s(e,t){const i=new r.P([0,0,0]);for(let r=0;r<3;r++)i.element[r]=e.rc(r,0)*t.x+e.rc(r,1)*t.y+e.rc(r,2)*t.z;return i}},42577:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(134);class s extends EventTarget{constructor(...e){super(...e),(0,r.A)(this,"peer",void 0),(0,r.A)(this,"onmessage",void 0),(0,r.A)(this,"onmessageerror",void 0)}postMessage(e,t){var i;null!==(i=this.peer)&&void 0!==i&&i.onmessage&&this.peer.onmessage({data:e})}close(){this.peer=null}start(){}}class a{constructor(){(0,r.A)(this,"port1",void 0),(0,r.A)(this,"port2",void 0),this.port1=new s,this.port2=new s,this.port1.peer=this.port2,this.port2.peer=this.port1}}},84149:(e,t,i)=>{"use strict";i.d(t,{Ay:()=>u,S3:()=>h,Wo:()=>d});var r=i(134),s=i(80662),a=i.n(s),n=i(54001),o=i.n(n),c=i(96172),l=i(34677);const d="notify",h="request";class u extends c.A{constructor(e){super(!0),(0,r.A)(this,"port",void 0),(0,r.A)(this,"requestMap",void 0),(0,r.A)(this,"seq",void 0),(0,r.A)(this,"closed",void 0),this.port=e,this.port.onmessage=this.handle.bind(this),this.seq=0,this.requestMap=new(a()),this.port.start(),this.closed=!1}handle(e){const t=e.data,i=t.type,r=t.data;if("notify"===i)this.fire(d,r);else if("reply"===i){const e=this.requestMap.get(r.seq);e&&((0,l.A)(r.result)?e.resolve(r.result):r.error?e.reject(r.error):e.resolve(void 0),this.requestMap.delete(r.seq))}else"request"===i&&this.fire(h,r)}notify(e,t={},i=[]){this.port.postMessage({type:"notify",data:{method:e,params:t}},i)}async request(e,t={},i=[]){return new(o())(((r,s)=>{const a=this.seq++;this.requestMap.set(a,{resolve:r,reject:s}),this.port.postMessage({type:"request",data:{seq:a,method:e,params:t}},i)}))}reply(e,t,i,r=[]){const s={seq:e.seq};(0,l.A)(t)?s.result=t:i&&(s.error=i),null!=r&&r.length?this.port.postMessage({type:"reply",data:s},r):this.port.postMessage({type:"reply",data:s})}getPort(){return this.port}destroy(){this.requestMap.size&&(this.requestMap.forEach((e=>{e.reject("ipc port close")})),this.requestMap.clear()),this.port&&(this.port.close(),this.port=null),this.closed=!0}}},55013:(e,t,i)=>{"use strict";i(84149).Ay},6253:(e,t,i)=>{"use strict";i.d(t,{A:()=>u});var r=i(134),s=i(39638),a=i(86932),n=i(47222),o=i(78995);let c,l=0;function d(){return c?(l++,c):(c=new n.A,l=1,c)}function h(){0!==l&&(l--,0===l&&(c.destroy(),c=null))}class u{constructor(e,t=!0,i=!1){(0,r.A)(this,"messageChannel",void 0),(0,r.A)(this,"interval",void 0),(0,r.A)(this,"started",void 0),(0,r.A)(this,"timer",void 0),(0,r.A)(this,"workerTimer",void 0),(0,r.A)(this,"workerSetTimeout",void 0),(0,r.A)(this,"onClock",void 0),(0,r.A)(this,"nextTick",void 0),(0,r.A)(this,"a",void 0),(0,r.A)(this,"b",void 0),(0,r.A)(this,"beta",void 0),(0,r.A)(this,"alpha",void 0),(0,r.A)(this,"count",void 0),(0,r.A)(this,"equivalent",void 0),(0,r.A)(this,"timestamp",void 0),(0,r.A)(this,"onVisibilityChange",void 0),(0,r.A)(this,"timeoutNext",void 0),(0,r.A)(this,"running",void 0),(0,r.A)(this,"highPerformance",void 0),(0,r.A)(this,"forceWorker",void 0),this.started=!1,this.interval=e,this.highPerformance=t,this.forceWorker=i,this.a=.2,this.b=4,this.equivalent=50,this.timestamp=0,this.nextTick=()=>{if(this.started&&!this.running)if(this.running=!0,this.interval>=4||!this.highPerformance)this.timeoutTick();else if(this.interval<=0)this.messageChannel.port1.postMessage(null);else{const e=(0,a.A)();e-this.timestamp>this.equivalent&&(this.count=0,this.timestamp=e),this.count<this.beta?this.messageChannel.port1.postMessage(null):this.timeoutTick()}},this.compute(),this.messageChannel=new MessageChannel,this.handleEvent(),this.timeoutNext=e=>{e?this.workerTimer=null:this.timer=null,this.running=!1,this.count++,this.onClock?this.onClock(this.nextTick):this.nextTick()},(0,s.A)()||"hidden"!==document.visibilityState||(this.workerSetTimeout=d()),this.running=!1}compute(e=!0){this.interval>0&&(this.beta=Math.ceil(this.equivalent*(1-this.b/this.interval)/(this.a-this.b)),this.alpha=Math.floor(this.equivalent/this.interval-this.beta),e&&(this.count=0))}timeoutTick(){this.workerSetTimeout&&"hidden"===document.visibilityState&&(this.interval<1e3||this.forceWorker)?this.workerTimer=this.workerSetTimeout.setTimeout(this.timeoutNext,this.interval):this.timer=setTimeout(this.timeoutNext,this.interval)}start(){this.started||(this.started=!0,this.timestamp=(0,a.A)(),this.nextTick())}stop(){this.started=!1,this.timer&&(clearTimeout(this.timer),this.timer=null),this.workerTimer&&this.workerSetTimeout&&this.workerSetTimeout.clearTimeout(this.workerTimer),this.running=!1}isStarted(){return this.started}setInterval(e){this.interval=Math.max(e,0),this.compute()}getInterval(){return this.interval}isZeroTimeout(){return this.interval<4}destroy(){this.stop(),this.workerSetTimeout&&(h(),this.workerSetTimeout=null),this.onVisibilityChange&&(document.removeEventListener("visibilitychange",this.onVisibilityChange),this.onVisibilityChange=null)}handleEvent(){this.messageChannel.port2.onmessage=()=>{this.started&&(this.running=!1,this.count++,this.onClock?this.onClock(this.nextTick):this.nextTick())},(0,s.A)()||(this.onVisibilityChange=(0,o.A)((e=>{"hidden"===document.visibilityState?(this.workerSetTimeout=d(),this.timer&&(clearTimeout(this.timer),this.timer=null,this.running=!1),this.nextTick()):(this.workerTimer&&(this.workerSetTimeout.clearTimeout(this.workerTimer),this.workerTimer=null,this.running=!1),this.timer&&(clearTimeout(this.timer),this.timer=null,this.running=!1),h(),this.workerSetTimeout=null,this.nextTick())}),20),document.addEventListener("visibilitychange",this.onVisibilityChange))}}},39148:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(134),s=i(54001),a=i.n(s),n=i(6253),o=i(86932);class c{constructor(e,t=0,i=0,s=!0,a=!0){(0,r.A)(this,"task",void 0),(0,r.A)(this,"count",void 0),(0,r.A)(this,"emptyCount",void 0),(0,r.A)(this,"started",void 0),(0,r.A)(this,"clock",void 0),(0,r.A)(this,"timestamp",void 0),(0,r.A)(this,"timeout",void 0),(0,r.A)(this,"interval",void 0),(0,r.A)(this,"startTimer",void 0),(0,r.A)(this,"autoInterval",void 0),(0,r.A)(this,"sync",void 0),(0,r.A)(this,"tickAfter",void 0),(0,r.A)(this,"processing",void 0),this.task=e,this.timeout=t,this.interval=i,this.autoInterval=s,this.sync=a,this.count=0,this.emptyCount=0,this.timestamp=0,this.started=!1,this.processing=!1,this.clock=new n.A(this.interval),this.clock.onClock=e=>{if(this.started)if(this.count++,this.sync)this.tickAfter&&(this.tickAfter(),this.tickAfter=null),!1===this.task()?this.stop():this.next(e);else{if(this.processing)return;this.processing=!0,this.task().then((t=>{this.processing=!1,this.tickAfter&&(this.tickAfter(),this.tickAfter=null),!1===t?this.stop():this.next(e)}))}}}next(e){if(!this.started)return;const t=(0,o.A)();if(this.autoInterval&&t-this.timestamp>50){const e=this.emptyCount/this.count;0===this.emptyCount?this.clock.setInterval(Math.max(this.clock.getInterval()>>1,this.interval)):e<.1?this.clock.setInterval(this.clock.getInterval()-1):e>.2?this.clock.setInterval(Math.min(this.clock.getInterval()+1,20)):e>.5&&this.clock.setInterval(this.clock.getInterval()<<1),this.count=0,this.emptyCount=0,this.timestamp=t}e()}start(){this.started=!0,this.timeout?this.startTimer=setTimeout((()=>{this.count=0,this.emptyCount=0,this.timestamp=(0,o.A)(),this.clock.start(),this.startTimer=null}),this.timeout):(this.count=0,this.emptyCount=0,this.timestamp=(0,o.A)(),this.clock.start())}stop(){this.started=!1,this.processing=!1,this.startTimer&&(clearTimeout(this.startTimer),this.startTimer=null),this.clock.stop()}async stopBeforeNextTick(){if(this.startTimer&&(clearTimeout(this.startTimer),this.startTimer=null),this.clock.isStarted())return this.sync?(this.started=!1,this.processing=!1,void this.clock.stop()):new(a())((e=>{this.tickAfter=()=>{this.started=!1,this.processing=!1,this.clock.stop(),e()}}))}isStarted(){return this.started}emptyTask(){this.emptyCount++}isZeroTimeout(){var e;return null===(e=this.clock)||void 0===e?void 0:e.isZeroTimeout()}restart(){this.clock&&(this.stop(),this.clock.setInterval(this.interval),this.start())}resetInterval(){this.clock.setInterval(Math.max(this.clock.getInterval()>>1,this.interval)),this.emptyCount=0,this.count=0,this.timestamp=(0,o.A)()}destroy(){this.stop(),this.task=null,this.timeout=null,this.interval=null}}},74936:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(134),s=i(86932);class a{constructor(){(0,r.A)(this,"base",BigInt(0)),(0,r.A)(this,"rate",BigInt(1e3)),(0,r.A)(this,"startTimestamp",BigInt(0))}start(){this.base=BigInt(0),this.startTimestamp=BigInt((0,s.A)())}getMasterTime(){return this.base+(BigInt((0,s.A)())-this.startTimestamp)*this.rate/BigInt(1e3)}setRate(e){this.base=this.getMasterTime(),this.startTimestamp=BigInt((0,s.A)()),this.rate=BigInt(1e3*e>>>0)}setMasterTime(e){this.base=e,this.startTimestamp=BigInt((0,s.A)())}}},13724:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(134),s=i(45249),a=i.n(s);class n{constructor(e){(0,r.A)(this,"timeout",void 0),(0,r.A)(this,"timer",void 0),(0,r.A)(this,"resolve",void 0),(0,r.A)(this,"reject",void 0),(0,r.A)(this,"startTime",void 0),this.timeout=e}then(e,t){this.resolve=e,this.reject=t,this.startTime=a()(),this.timer=setTimeout((()=>{this.resolve(a()()-this.startTime),this.timer=null}),1e3*this.timeout)}stop(e=!0){this.timer&&(clearTimeout(this.timer),this.timer=null,this.resolve&&e?this.resolve(a()()-this.startTime):this.reject&&!e&&this.reject(a()()-this.startTime))}reset(e){e&&(this.timeout=e),this.timer&&(clearTimeout(this.timer),this.timer=setTimeout((()=>{this.resolve(a()()-this.startTime),this.timer=null}),1e3*this.timeout))}}},54058:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(134);class s{constructor(e,t,i){(0,r.A)(this,"task",void 0),(0,r.A)(this,"timeout",void 0),(0,r.A)(this,"interval",void 0),(0,r.A)(this,"timer",void 0),this.task=e,this.timeout=t,this.interval=i}start(){const e=this;e.stop();let t=e.timeout;const i=e.interval,r=function(){!1!==e.task()&&e.timer?e.timer=setTimeout(r,e.interval):e.stop()};null==t&&(t=i),e.timer=setTimeout(r,t)}stop(){this.timer&&(clearTimeout(this.timer),this.timer=null)}updateInterval(e){this.interval=e}isStarted(){return!!this.timer}destroy(){this.stop(),this.task=this.timeout=this.interval=null}}},47222:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(134),s=i(80662),a=i.n(s);function n(e){e.addEventListener("message",(t=>{var i;let r=t.data.data;setTimeout((()=>{e.postMessage({type:"pong",id:r.id})}),Math.max(null!==(i=r.timeout)&&void 0!==i?i:0,4))}))}class o{constructor(){(0,r.A)(this,"worker",void 0),(0,r.A)(this,"workerUrl",void 0),(0,r.A)(this,"taskMap",void 0),(0,r.A)(this,"id",void 0),this.id=0,this.taskMap=new(a());const e=`\n      ${n.toString()}\n      ${n.name}(self)\n    `,t=new Blob([e],{type:"text/javascript"});this.workerUrl=URL.createObjectURL(t),this.worker=new Worker(this.workerUrl),this.worker.addEventListener("message",(e=>{const t=e.data,i=t.type,r=t.id;if("pong"===i){const e=this.taskMap.get(r);e&&e(!0)}}))}setTimeout(e,t=0){const i=this.id++;return this.taskMap.set(i,e),this.worker.postMessage({type:"ping",data:{timeout:t,id:i}}),i}clearTimeout(e){this.taskMap.delete(e)}destroy(){this.worker&&(this.worker.terminate(),this.worker=null),this.workerUrl&&(URL.revokeObjectURL(this.workerUrl),this.workerUrl=null),this.taskMap&&(this.taskMap.clear(),this.taskMap=null)}}},38724:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(134),s=i(6253);class a{constructor(e,t,i){(0,r.A)(this,"task",void 0),(0,r.A)(this,"timeout",void 0),(0,r.A)(this,"interval",void 0),(0,r.A)(this,"clock",void 0),(0,r.A)(this,"started",void 0),(0,r.A)(this,"timer",void 0),this.task=e,this.timeout=t,this.interval=i,this.started=!1,this.clock=new s.A(this.interval,!1,!0),this.clock.onClock=e=>{this.started&&!1===this.task()?this.stop():e()}}start(){this.started=!0,this.timeout>0?this.timer=setTimeout((()=>{this.timer=null,this.clock.start()}),this.timeout):this.clock.start()}stop(){this.started=!1,this.clock.stop(),this.timer&&(clearTimeout(this.timer),this.timer=null)}isStarted(){return this.started}updateInterval(e){this.interval=e,this.clock.setInterval(e)}destroy(){this.clock&&(this.stop(),this.clock.destroy(),this.clock=null),this.started=!1,this.task=this.timeout=this.interval=null}}},72739:(e,t,i)=>{"use strict";i.d(t,{$r:()=>u,El:()=>f,FB:()=>m,TF:()=>d,VC:()=>c,_:()=>p,__:()=>n,qh:()=>l,zy:()=>h});var r=i(67672),s=i(10576),a=i(56401);function n(e,t,i){if(!e)return;const{length:r}=e;if(r)if(i)for(let i=r-1;i>=0&&t(e[i],i)!==s.W8;i--);else for(let i=0;i<r&&t(e[i],i)!==s.W8;i++);}function o(e,t){e[e.length]=t}function c(e,t){!function(e,t,i){r.YO(t)?n(t,(function(t){i(e,t)})):i(e,t)}(e,t,o)}function l(e,t,i){let r=s.Cy;return n(e,(function(e,a){if(i===s.W8?e==t:e===t)return r=a,s.W8})),r}function d(e,t,i){let r=0;return n(e,(function(a,n){(i===s.W8?a==t:a===t)&&(e.splice(n,1),r++)}),s.rT),r}function h(e,t,i){return l(e,t,i)>=0}function u(e){return r.YO(e)?e:(0,a.A)(s.Ml.slice,e)}function f(e,t){let i=0,r=e.length-1,s=-1;for(;i<=r;){let a=(i+r)/2>>>0;const n=t(e[a]);if(0===n){s=a;break}1===n?i=a+1:(r=a-1,s=a)}return s}function p(e,t,i){const r=f(e,i);r>-1?e.splice(r,0,t):e.push(t)}function m(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}},90932:(e,t,i)=>{"use strict";i.d(t,{l:()=>s});const r="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";function s(e,t=!0){const i=e.length;let s=0,a=0,n="";for(let t=0;t<i;t++)for(a=a<<8|e[t],s+=8;s>=5;)n+=r[a>>>s-5&31],s-=5;if(s>0&&(n+=r[a<<5-s&31]),t)for(;n.length%8!=0;)n+="=";return n}},4919:(e,t,i)=>{"use strict";i.d(t,{E_:()=>a});var r=i(72739);const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function a(e){const t="function"==typeof atob?atob(e):function(e){function t(e){const t=s.indexOf(e);return-1===t?0:t}let i="";for(let r=0;r<e.length;){const s=t(e[r++]),a=t(e[r++]),n=t(e[r++]),o=t(e[r++]),c=s<<2|a>>4,l=(15&a)<<4|n>>2,d=(3&n)<<6|o;i+=String.fromCharCode(c),64!==n&&(i+=String.fromCharCode(l)),64!==o&&(i+=String.fromCharCode(d))}return i}(e),i=new Uint8Array(t.length);for(let e=0;e<t.length;e++)i[e]=t.charCodeAt(e);return i}const n={};r.__(["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],((e,t)=>{n[e]=t}))},43607:(e,t,i)=>{"use strict";function r(e){return e>0?e:-e}function s(e,t){return e>t?e:t}function a(e,t){return e>t?t:e}i.d(t,{T9:()=>s,jk:()=>a,tn:()=>r})},86834:(e,t,i)=>{"use strict";i.d(t,{A:()=>p});var r=i(29967),s=i.n(r),a=i(72739),n=i(67672),o=i(84504),c=i(44690);function l(e){return n.Yj(e)&&e.split(".").shift()||""}const d=[["alipay",/alipay/],["wechat",/micromessenger/],["dingtalk",/dingtalk[ \/]([\d_.]+)/],["baiduApp",/baiduboxapp/],["baidu",/baidubrowser/],["baidu",/bdbrowser/],["uc",/ucbrowser/],["uc",/ucweb/],["qq",/qqbrowser/],["qqApp",/qq/],["ie",/iemobile[ \/]([\d_.]+)/],["ie",/msie[ \/]([\d_.]+)/],["ie",/trident[ \/]([\d_.]+)/,4],["edge",/edge[ \/]([\d_.]+)/],["newEdge",/edg[ \/]([\d_.]+)/],["chrome",/chrome[ \/]([\d_.]+)/],["firefox",/firefox[ \/]([\d_.]+)/],["opera",/opera(?:.*version)?[ \/]([\d_.]+)/],["safari",/version[ \/]([\d_.]+) safari/],["safari",/version[ \/]([\d_.]+) \S* safari/],["safari",/safari/]],h={},u={},f=function(e){let t,i;return(0,a.__)(d,(r=>{let a=r[1].exec(e);if(a)return t=r[0],i=a[1],i&&(i=i.replace(/_/g,"."),r[2]&&(i=s()(i,10)+r[2]+".0")),!1})),"safari"!==t||i||(i=c.A.version),{name:t||"",version:i||"",majorVersion:(h[t]||l)(i),checkVersion:u[t]||o.A}}(("object"==typeof navigator&&navigator.userAgent||"").toLowerCase());f.name&&(f[f.name]=!0);const p=f},10576:(e,t,i)=>{"use strict";i.d(t,{Cq:()=>o,Cy:()=>l,M_:()=>p,Ml:()=>v,TK:()=>m,W8:()=>n,ZG:()=>u,ZH:()=>c,aV:()=>d,rT:()=>a,s0:()=>h,u1:()=>y,x7:()=>g});var r=i(7403),s=i.n(r);const a=!0,n=!1,o=null,c=void 0,l=-1,d="undefined",h="function",u=".",f=typeof window!==d?window:c,p=(typeof document!==d&&document,typeof globalThis!==d?globalThis:typeof i.g!==d?i.g:f),m=typeof self!==d?self:p,g=function(){},v=(s()({}),s()([])),y=""},67672:(e,t,i)=>{"use strict";i.d(t,{Ik:()=>d,Pc:()=>c,YO:()=>l,Yj:()=>h,ai:()=>u,o:()=>f,sH:()=>m,sv:()=>g,zM:()=>p});var r=i(68632),s=i.n(r),a=i(88032),n=i.n(a),o=i(10576);function c(e){return typeof e===o.s0}function l(e){return s()(e)}function d(e){return e!==o.Cq&&"object"==typeof e}function h(e){return"string"==typeof e}function u(e){return"number"==typeof e&&!isNaN(e)}function f(e){return"bigint"==typeof e}function p(e){return"boolean"==typeof e}function m(e){return u(e)||h(e)&&!isNaN(n()(e))&&isFinite(+e)}function g(e){return e instanceof ArrayBuffer}},57817:(e,t,i)=>{"use strict";i.d(t,{ZV:()=>n,ay:()=>a,wb:()=>s});var r=i(95335);const s={a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,"`":192,"+":187,"-":189,"=":61,"[":219,"]":221,"\\":220,";":59,"'":222,",":188,".":190,"/":191,$0:96,$1:97,$2:98,$3:99,$4:100,$5:101,$6:102,$7:103,$8:104,$9:105,"$.":110,"$+":107,"$-":109,"$*":106,"$/":111,space:32,tab:9},a={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,enter:13,esc:27,capslock:20,insert:45,home:36,end:35,pageup:33,pagedown:34,left:37,right:39,up:38,down:40},n={shift:16,ctrl:17,meta:91,alt:18};(0,r.BE)(s),(0,r.BE)({backspace:8,delete:46}),(0,r.BE)(a),(0,r.BE)(n)},10534:(e,t,i)=>{"use strict";i.d(t,{__:()=>a}),i(20525);var r=i(10576);const s={};function a(e,t){const i=s.hasOwnProperty(e)?s[e]:s[e]=e.split(r.ZG);for(let e=0,s=i.length-1;e<=s&&t(i[e],e===s)!==r.W8;e++);}},4624:(e,t,i)=>{"use strict";i.d(t,{R8:()=>b,V$:()=>v,Yz:()=>y,h2:()=>x,pq:()=>A,rD:()=>o,z3:()=>w});var r=i(10576),s=i(62100);const a=0,n=1,o=2,c=3,l=4,d=5,h=typeof console!==r.aV?console:r.Cq,u=/common/.test((0,s.A)(r.x7))?o:c,f=h?function(e,t){h.log(e,t)}:r.x7,p=h?function(e,t){h.warn(e,t)}:r.x7,m=h?function(e,t){h.error(e,t)}:r.x7;function g(){if(r.M_){const e=r.TK.COMMON_LOG_LEVEL;if(e>=a&&e<=d)return e}return u}function v(e){r.TK.COMMON_LOG_LEVEL=e}function y(e,t,i){g()<=n&&f(`[${arguments[1]}][line ${arguments[2]}] [debug]`,e)}function A(e,t,i){g()<=o&&f(`[${arguments[1]}][line ${arguments[2]}] [info]`,e)}function b(e,t,i){g()<=c&&p(`[${arguments[1]}][line ${arguments[2]}] [warn]`,e)}function w(e,t,i){g()<=l&&m(`[${arguments[1]}][line ${arguments[2]}] [error]`,e)}function x(e,t,i){if(g()<=d)throw w(e,t,i),new Error(`[${arguments[1]}][line ${arguments[2]}] [fatal]: ${e}`)}},95335:(e,t,i)=>{"use strict";i.d(t,{BE:()=>p,C:()=>f,HP:()=>l,X$:()=>u,__:()=>d});var r=i(69736),s=i.n(r),a=i(67672),n=i(72739),o=i(10576),c=(i(10534),i(34677));function l(e){return(0,c.A)(e)?s()(e):[]}function d(e,t){for(let i in e)if(t(e[i],i)===o.W8)break}function h(e,t){return a.Ik(e)?a.Ik(t)?(d(t,(function(t,i){e[i]=t})),e):e:t}function u(e,t,i){return h(h(e,t),i)}function f(e,t){let i=e;return a.YO(e)?t?(i=[],n.__(e,(function(e,r){i[r]=f(e,t)}))):i=e.slice():a.Ik(e)&&(i={},d(e,(function(e,r){i[r]=t?f(e,t):e}))),i}function p(e){const t={};return d(e,((e,i)=>{t[e]=i})),t}},44690:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(72739);const s=[["harmony",/harmonyos ([\d_.]+)/],["harmony",/openharmony ([\d_.]+)/],["iphone",/iphone os ([\d_.]+)/],["ipad",/ipad; cpu os ([\d_.]+)/],["itouch",/itouch; cpu os ([\d_.]+)/],["android",/android ([\d_.]+)/],["wp",/windows phone ([\d_.]+)/],["windows",/windows nt ([\d_.]+)/],["linux",/linux/],["mac",/mac os x ([\d_.]+)/]],a=function(e){let t,i;return(0,r.__)(s,(r=>{let s=r[1].exec(e);if(s)return t=r[0],i=s[1],i&&(i=i.replace(/_/g,".")),!1})),{name:t||"",version:i||"",mobile:e.indexOf("mobile")>-1}}(("object"==typeof navigator&&navigator.userAgent||"").toLowerCase());a.name&&(a[a.name]=!0,{iphone:1,ipad:1,itouch:1}[a.name]&&(a.ios=!0));const n=a},20525:(e,t,i)=>{"use strict";i.d(t,{GP:()=>h,di:()=>c,qh:()=>l,zy:()=>d});var r=i(29967),s=i.n(r),a=i(67672),n=i(10576),o=i(62100);function c(e,t,i){return a.ai(i)?t===i?n.u1:e.slice(t,i):e.slice(t)}function l(e,t,i){return e.indexOf(t,i!==n.ZH?i:0)}function d(e,t){return l(e,t)>=0}function h(e,...t){let i=0;const r=t.length;return e.replace(/(%[sdvx%])|(%0(\d)+[dx])/g,(e=>{if(i>=r)return e;const a=t[i++];if(/%0(\d)+[dx]/g.test(e)){const t=s()(e.substring(1));let i="d"===e[e.length-1]?(0,o.A)(Number(a)):Number(a).toString(16);return t>i.length&&(i=new Array(t-i.length).fill("0").join("")+i),i}switch(e){case"%%":return"%";case"%s":return String(a);case"%d":return(0,o.A)(Number(a));case"%v":return"";case"%x":return Number(a).toString(16)}return e}))}},95797:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(20149),s=i.n(r),a=i(39638),n=i(86834),o=i(44690);const c=function(){let e="function"==typeof Blob,t="object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate,i="function"==typeof fetch,r="object"==typeof document&&document.createElement("canvas"),c=r&&!!r.getContext("webgl"),l="function"==typeof OffscreenCanvas,d="function"==typeof Worker,h="function"==typeof ArrayBuffer,u="object"==typeof Atomics&&"Atomics"===Atomics[s()],f="function"==typeof AudioContext||"function"==typeof webkitAudioContext,p="function"==typeof AudioWorklet,m="function"==typeof VideoDecoder,g="function"==typeof VideoEncoder,v="function"==typeof AudioDecoder,y="function"==typeof AudioEncoder,A="function"==typeof SharedArrayBuffer,b="function"==typeof MediaSource||"function"==typeof ManagedMediaSource,w="function"==typeof Proxy,x=(d||(0,a.A)())&&A&&u&&w,k="function"==typeof WebAssembly.Suspending&&"function"==typeof WebAssembly.promising;(n.A.safari&&!n.A.checkVersion(n.A.majorVersion,"11",!0)||o.A.ios&&!n.A.checkVersion(o.A.version,"11",!0))&&(t=!1),n.A.chrome&&!n.A.checkVersion(n.A.majorVersion,"94",!0)&&(m=!1,v=!1),(n.A.safari&&!n.A.checkVersion(n.A.majorVersion,"17",!0)||o.A.ios&&!n.A.checkVersion(o.A.version,"17",!0))&&(m=!1);let T="object"==typeof navigator&&"object"==typeof navigator.gpu,I="function"==typeof MediaSourceHandle,S=t&&"function"==typeof WebAssembly.Global,P="function"==typeof MediaStreamTrackGenerator;return{browser:n.A,blob:e,wasm:t,fetch:i,webgl:c,worker:d,mse:b,arrayBuffer:h,audioContext:f,audioWorklet:p,videoDecoder:m,videoEncoder:g,audioDecoder:v,audioEncoder:y,atomics:u,shareArrayBuffer:A,thread:x,webgpu:T,offscreenCanvas:l,workerMSE:I,webAssemblyGlobal:S,jspi:k,proxy:w,simd:(n.A.chrome||n.A.newEdge)&&n.A.checkVersion(n.A.majorVersion,"91",!0)||n.A.firefox&&n.A.checkVersion(n.A.majorVersion,"89",!0)||n.A.safari&&n.A.checkVersion(n.A.version,"16.4",!0)||o.A.ios&&n.A.checkVersion(o.A.version,"16.4",!0),wasmPlayerSupported:i&&t&&c&&f&&h&&S,wasmBaseSupported:t&&S&&h,trackGenerator:P}}()},50011:(e,t,i)=>{"use strict";i.r(t),i.d(t,{decode:()=>o,encode:()=>a});const r="function"==typeof TextEncoder?new TextEncoder:null,s="function"==typeof TextDecoder?new TextDecoder:null;function a(e){if(r)return r.encode(e);const t=[];for(let i=0;i<e.length;++i){let r=e.charCodeAt(i);r>=55296&&r<=57343&&(r=65536+((1023&r)<<10)|1023&e.charCodeAt(++i)),r<=127?t.push(r):r<=2047?(t.push(192|r>>6),t.push(128|63&r)):r<=65535?(t.push(224|r>>12),t.push(128|r>>6&63),t.push(128|63&r)):(t.push(240|r>>18),t.push(128|r>>12&63),t.push(128|r>>6&63),t.push(128|63&r))}return new Uint8Array(t)}function n(e){let t="";for(let i=0;i<e.length;){let r=e[i++>>>0];if(!(128&r)){t+=String.fromCharCode(r);continue}let s=63&e[i++>>>0];if(192==(224&r)){t+=String.fromCharCode((31&r)<<6|s);continue}let a=63&e[i++>>>0];if(r=224==(240&r)?(15&r)<<12|s<<6|a:(7&r)<<18|s<<12|a<<6|63&e[i++>>>0],r<65536)t+=String.fromCharCode(r);else{let e=r-65536;t+=String.fromCharCode(55296|e>>10,56320|1023&e)}}return t}function o(e){if(e instanceof Uint8Array&&s&&!("function"==typeof SharedArrayBuffer&&e.buffer instanceof SharedArrayBuffer))try{return s.decode(e)}catch(t){return n(e)}return n(e)}},54825:(e,t,i)=>{"use strict";function r(e){if(!e)return-BigInt(1);let t=(e=e.trim()).split(":"),i=BigInt(0);return 3===t.length&&(i+=BigInt(+t.shift().trim())*BigInt(36e5)),i+=BigInt(+t.shift().trim())*BigInt(6e4),t=t.shift().trim().split("."),i+=BigInt(+t.shift().trim())*BigInt(1e3),t.length&&(i+=BigInt(+t.shift().trim())),i}function s(e){if(!e)return-BigInt(1);let t=(e=e.trim()).split(":"),i=BigInt(0);return 3===t.length&&(i+=BigInt(+t.shift().trim())*BigInt(36e5)),i+=BigInt(+t.shift().trim())*BigInt(6e4),t=t.shift().trim().split(","),i+=BigInt(+t.shift().trim())*BigInt(1e3),t.length&&(i+=BigInt(+t.shift().trim())),i}i.d(t,{j:()=>r,t:()=>s})},8507:(e,t,i)=>{"use strict";i.d(t,{ll:()=>m,mA:()=>n,qg:()=>o}),i(73146);var r=i(67672),s=i(6498),a=i(72739);function n(e,t="&"){const i={};if(r.Yj(e)&&e.indexOf("=")>=0){let r=e.charAt(0),n="?"===r||"#"===r?1:0;n>0&&(e=e.substr(n)),a.__((0,s.A)(e,t),(e=>{let t=e.split("=");if(2===t.length){var r;let e=null===(r=t[0])||void 0===r?void 0:r.trim();e&&(i[e]=decodeURIComponent(t[1]))}}))}return i}function o(e){const t=e,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],r=/:\/\/([^\/@]*@?)\[(\S+)\]/;let s="";r.test(e)&&(e=e.replace(r,((e,t,i)=>(s=i,`://${t||""}a.b`))));const a={},n=/^(?:(?![^:@\/]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@\/]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e);let o=14;for(;o--;){var c;a[i[o]]=null!==(c=n[o])&&void 0!==c?c:""}return s&&(a.host=s,a.source=t,a.authority=s+(a.port?":"+a.port:"")),{protocol:a.protocol,file:a.file,host:a.host,port:a.port,user:a.user,password:a.password,origin:`${a.protocol}://${a.authority}`,pathname:a.path,search:`?${a.query}`,hash:a.anchor?`#${a.anchor}`:""}}i(95335);const c=/(?:\/|^)\.(?=\/)/g,l=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,d=/^(?=([^\/?#]*))\1([^]*)$/,h=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/;function u(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}function f(e){const t=h.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null}function p(e){for(e=e.split("").reverse().join("").replace(c,"");e.length!==(e=e.replace(l,"")).length;);return e.split("").reverse().join("")}function m(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;let t=f(e);if(!t)throw new Error("Error trying to parse base URL.");return t.path=p(t.path),u(t)}let r=f(t);if(!r)throw new Error("Error trying to parse relative URL.");if(r.scheme)return i.alwaysNormalize?(r.path=p(r.path),u(r)):t;let s=f(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){let e=d.exec(s.path);s.netLoc=e[1],s.path=e[2]}s.netLoc&&!s.path&&(s.path="/");const a={scheme:s.scheme,netLoc:r.netLoc,path:null,params:r.params,query:r.query,fragment:r.fragment};if(!r.netLoc&&(a.netLoc=s.netLoc,"/"!==r.path[0]))if(r.path){let e=s.path,t=e.substring(0,e.lastIndexOf("/")+1)+r.path;a.path=p(t)}else a.path=s.path,r.params||(a.params=s.params,r.query||(a.query=s.query));return null===a.path&&(a.path=i.alwaysNormalize?p(r.path):r.path),u(a)}},88096:(e,t,i)=>{"use strict";i.d(t,{$z:()=>f,GW:()=>c,WP:()=>d,bx:()=>p,p2:()=>h,tt:()=>u});var r=i(729),s=i(31865),a=i(86834),n=i(44690);function o(e){let t=0,i=0;for(;;){const r=e.readUint8();if(t|=(127&r)<<i,i+=7,!(128&r))break}return t}async function c(e){let t=0,i=0;for(;;){const r=await e.readUint8();if(t|=(127&r)<<i,i+=7,!(128&r))break}return t}function l(e){let t,i=0,r=0;for(;t=e.readUint8(),i|=(127&t)<<r,r+=7,128&t;);return 64&t&&(i|=-1<<r),i}async function d(e){let t,i=0,r=0;for(;t=await e.readUint8(),i|=(127&t)<<r,r+=7,128&t;);return 64&t&&(i|=-1<<r),i}function h(e,t){let i=!0;for(;i;){let r=127&t;0==(t>>=7)&&!(64&r)||-1===t&&64&r?i=!1:r|=128,e.writeUint8(r)}}function u(e,t){do{let i=127&t;0!=(t>>=7)&&(i|=128),e.writeUint8(i)}while(0!==t)}async function f(e,t){do{let i=127&t;0!=(t>>=7)&&(i|=128),await e.writeUint8(i)}while(0!==t)}function p(e,t){const i=new s.A(e,!0),c=new r.A(new Uint8Array(e.length+100),!0);for(c.writeBuffer(i.readBuffer(8));i.remainingSize();){const e=i.readUint8();c.writeUint8(e);const s=o(i);if(2===e){const e=new r.A(new Uint8Array(s+100));let d=o(i);for(u(e,d);d--;){const r=o(i);u(e,r),e.writeBuffer(i.readBuffer(r));const s=o(i);u(e,s),e.writeBuffer(i.readBuffer(s));const c=i.readUint8();switch(e.writeUint8(c),c){case 0:u(e,o(i));break;case 3:h(e,l(i)),u(e,o(i));break;case 2:{let r=o(i);t.shared?u(e,2|r):u(e,-3&r);const s=o(i);if(u(e,t.initial||s),1&r){let r=o(i);!t.maximum||n.A.ios&&!a.A.checkVersion(n.A.version,"17",!0)&&t.shared||(r=t.maximum),u(e,r)}break}case 1:{h(e,l(i));const t=o(i);u(e,t),u(e,o(i)),1&t&&u(e,o(i));break}}}const f=e.getWroteBuffer();u(c,f.length),c.writeBuffer(f)}else u(c,s),c.writeBuffer(i.readBuffer(s))}return c.getWroteBuffer()}},79331:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(68632),s=i.n(r),a=i(72739);const n={aloneValueName:"_@attribute"},o=[" ","/",'"',"'","<",">"];function c(e,t=n){e=(e=(e=(e=e.replace(/<!--[\s\S]*?-->/g,"")).replace(/[\n\t\r]/g,"")).replace(/>[ \t]+</g,"><")).replace(/<\?[^>]*\?>/g,"");const i=[];let r=0;function c(e,r){const a=i[i.length-1];a&&(e!==t.aloneValueName||null==a.obj[t.aloneValueName]?null==a.obj[e]?a.obj[e]=r:s()(a.obj[e])?a.obj[e].push(r):a.obj[e]=[a.obj[e],r]:a.obj[t.aloneValueName]=[a.obj[t.aloneValueName],{tagName:e,...r}])}function l(t){for(;r<e.length;){if(e[r]===t)return!0;r++}return!1}function d(){h();let t="";for(;r<e.length&&!a.zy(o,e[r]);)t+=e[r],r++;return t}function h(){for(;r<e.length&&/\s|\r|\n/.test(e[r]);)r++}const u=/\s/,f=/'/,p=/"/;function m(){if(r>=e.length)return!0;h();let t=u;'"'!==e[r]&&"'"!=e[r]||(t='"'===e[r]?p:f,r++);let i="";for(;r<e.length;){if(t.test(e[r])){r++;break}i+=e[r],r++}return i}function g(){h();let t="";for(;r<e.length&&"<"!==e[r];)t+=e[r],r++;return t}function v(){for(;"<"===e[r];){const t=r;if(r++,h(),"/"!==e[r]){r=t;break}if(r++,d()===i[i.length-1].tag){if(i.length>1){const e=i.pop();c(e.tag,e.obj)}l(">"),r++,h()}else i.pop(),l(">"),r++,h()}}return function s(){if(r>=e.length)return;let a=r;if(h(),"<"!==e[r])return r=a,c(t.aloneValueName,g()),v(),s();let n=l("<");if(!n)return;a=r,r++;const o=d();if(i.push({obj:{},tag:o,start:a}),function(){for(;h(),">"!==e[r]&&"/"!==e[r];){let e=d();if(!e)break;"="===e[e.length-1]?e=e.substring(0,e.length-1):(l("="),r++),c(e,m())}}(),h(),"/"===e[r]){if(r++,i.length>1){const e=i.pop();c(e.tag,e.obj)}return l(">"),r++,v(),s()}n=l(">"),n&&(r++,h(),"<"!==e[r]&&(c(t.aloneValueName,g()),h()),v(),s())}(),{[i[0].tag]:i[0].obj}}},72631:(e,t,i)=>{"use strict";i.d(t,{default:()=>V});var r=i(134),s=i(63939),a=i(61634),n=i(47451),o=i.n(n),c=i(95335),l=i(28090),d=i(67672),h=i(72739),u=i(8507),f=i(44690),p=i(23601),m=i(76793),g=i(92053),v=i(37463),y=i(13203),A=i(30019),b=i(7233),w=i(64147),x=i(40777),k=i(59715),T=i(86213),I=i(91011),S=i(14667),P=i(45553),_=i(30499),M=i(65893),C=i(53891),B=i(44341),E=i(83327),D=i.n(E),R=i(35308),U=i.n(R),L=i(6204),$=i(78995),F=i(93108),O=i(72913),N=i(64804);const z={name:"AVPlayer",template:D(),propTypes:{player:{type:"object",required:!0},indicatorUrl:{type:"string"},pauseStateUrl:{type:"string"},errorStateUrl:{type:"string"},fullscreenDom:{type:"object"},hasFolder:{type:"boolean",value:!0},hasHeader:{type:"boolean",value:!0},hasFooter:{type:"boolean",value:!0},folderFolded:{type:"boolean",value:!1}},data:function(){const e=(0,L.A)(),t=[{name:e.MENU_STATS,action:0}];return{style:U(),title:"",error:"",showBar:!0,played:!1,folded:this.get("folderFolded"),loading:!1,language:e,streams:[],videoList:[],audioList:[],subtitleList:[],isLive:!1,menu:t,showMenu:!1,menuTop:0,menuLeft:0,showInfo:!1,showSettings:!1}},events:{error:function(e,t){console.log("error",t.message),this.set("error",t.message)},closeInfo:function(){this.set("showInfo",!1)},openSettings:function(){this.set("showSettings",!0)},closeSettings:function(){this.set("showSettings",!1)},folderLoaded:function(){this.get("player").fire(O.J)}},watchers:{played:function(e){e&&(this.showBarTimer&&clearTimeout(this.showBarTimer),this.get("folded")&&(this.showBarTimer=setTimeout((()=>{this.set("showBar",!1),this.showBarTimer=null}),5e3)))},folded:function(e){e&&(this.showBarTimer&&clearTimeout(this.showBarTimer),this.showBarTimer=setTimeout((()=>{this.set("showBar",!1),this.showBarTimer=null}),5e3))}},computed:{hasVideoTrack:function(){const e=this.get("streams"),t=this.get("videoList");return e.filter((e=>0===s.f[15](e.codecpar))).filter((e=>h.zy(a.KU,s.f[15](e.codecpar+4)))).length>1||t.length>1},hasAudioTrack:function(){const e=this.get("streams"),t=this.get("audioList");return e.filter((e=>1===s.f[15](e.codecpar))).filter((e=>h.zy(a.KU,s.f[15](e.codecpar+4)))).length>1||t.length>1},hasSubtitleTrack:function(){const e=this.get("streams"),t=this.get("subtitleList");return!this.get("isLive")&&e.filter((e=>0===s.f[15](e.codecpar))).filter((e=>h.zy(a.KU,s.f[15](e.codecpar+4)))).length>0||t.length>1},hasPip:function(){return this.get("streams").filter((e=>0===s.f[15](e.codecpar))).filter((e=>h.zy(a.KU,s.f[15](e.codecpar+4)))).length>0},hasPcmVisualization:function(){const e=this.get("streams");return e.filter((e=>1===s.f[15](e.codecpar))).filter((e=>h.zy(a.KU,s.f[15](e.codecpar+4)))).length>0&&0===e.filter((e=>0===s.f[15](e.codecpar))).filter((e=>h.zy(a.KU,s.f[15](e.codecpar+4)))).length}},methods:{init(e){const t=e.getSource();d.Yj(t)?this.set("title",u.qg(decodeURI(t)).file):this.set("title",t.name),this.set("streams",e.getStreams()),this.set("isLive",e.isLive()),this.set("played",6===e.getStatus()),e.getVideoList().then((e=>{this.set("videoList",e.list)})),e.getAudioList().then((e=>{this.set("audioList",e.list)})),e.getSubtitleList().then((e=>{this.set("subtitleList",e.list)}))},mousemove(){setTimeout((()=>{this.set("showBar",!0),this.showBarTimer&&clearTimeout(this.showBarTimer),this.get("played")&&this.get("folded")&&(this.showBarTimer=setTimeout((()=>{this.set("showBar",!1),this.showBarTimer=null}),5e3))}))},playClick(e){const t=this.get("player");t.isSuspended()&&(t.resume(),6===t.getStatus())||f.A.ios||f.A.android||f.A.harmony&&f.A.mobile||this.$refs.play&&(!this.get("showMenu")&&this.get("showBar")||!e)&&this.$refs.play.playClick()},toggleFold(){this.set("folded",!this.get("folded"))},fold(){this.set("folded",!0)},unfold(){this.set("folded",!1)},toggleFolder(){this.set("folded",!this.get("folded"))},menuAction(e){0===e&&this.set("showInfo",!0),this.set("showMenu",!1)},menuOutside(){this.set("showMenu",!1)},addUrl(e,t,i){this.$refs.folder&&this.$refs.folder.openUrl(e,t,i)}},afterMount(){this.namespace=".avplayer"+Math.random();const e=this.get("player"),t=this.$el.querySelectorAll(".avplayer-ui-player")[0];e.options.container=t,e.on(l.F5+this.namespace,(()=>{this.set("loading",!0),this.set("error","")})),e.on(l.S2+this.namespace,(()=>{this.init(e)})),e.on(l.CN+this.namespace,(()=>{this.set("loading",!1),this.set("played",!0)})),e.on(l.NN+this.namespace,(()=>{this.set("played",!1)})),e.on(l.yd+this.namespace,(()=>{this.set("title",""),this.set("streams",[]),this.set("played",!1)})),e.getStatus()>=4&&this.init(e),this.onresize=(0,$.A)((()=>{e.resize(t.offsetWidth,t.offsetHeight)}),500),window.addEventListener("resize",this.onresize),this.oncontextmenu=e=>{this.$refs.playerContainer.contains(e.target)&&(this.set("showMenu",!0),this.set("menuTop",e.clientY),this.set("menuLeft",e.clientX),e.preventDefault())},window.addEventListener("contextmenu",this.oncontextmenu)},beforeDestroy(){const e=this.get("player");this.namespace&&e.off(this.namespace),window.removeEventListener("resize",this.onresize),window.removeEventListener("contextmenu",this.oncontextmenu)},components:{Progress:p.A,Play:m.A,Volume:g.A,Timer:v.A,Setting:y.A,Fullscreen:A.A,Playrate:b.A,AudioTrack:w.A,VideoTrack:x.A,SubtitleTrack:k.A,Loop:T.A,Pip:I.A,Folder:S.A,Loading:P.A,PcmVisualization:_.A,LoadingTip:M.A,Info:C.A,Settings:B.A}};class V extends a.Ay{constructor(e){var t,i,s,a;super(c.X$({},e,{container:null})),(0,r.A)(this,"ui",void 0),(0,r.A)(this,"keyboard",void 0),o().dom.addSpecialEvent("outside",N.A),this.ui=new(o())(c.X$({el:e.container,replace:!1,props:{player:this,indicatorUrl:e.indicatorUrl,pauseStateUrl:e.pauseStateUrl,errorStateUrl:e.errorStateUrl,fullscreenDom:e.fullscreenDom,hasFolder:null===(t=e.ui)||void 0===t?void 0:t.hasFolder,hasHeader:null===(i=e.ui)||void 0===i?void 0:i.hasHeader,hasFooter:null===(s=e.ui)||void 0===s?void 0:s.hasFooter,folderFolded:null===(a=e.ui)||void 0===a?void 0:a.folderFolded}},z)),this.keyboard=new F.A(this)}foldFolder(){this.ui.fold()}unfoldFolder(){this.ui.unfold()}toggleFolder(){this.ui.toggleFolder()}addUrl(e,t,i){this.ui.addUrl(e,t,i)}async destroy(){await super.destroy(),this.keyboard.destroy(),this.ui.destroy()}}},93108:(e,t,i)=>{"use strict";i.d(t,{A:()=>f});var r=i(134),s=i(80662),a=i.n(s),n=i(57817),o=i(95335),c=i(72739),l=i(65196),d=i(43607),h=i(67672);const u={16:[{keyCode:n.wb["+"],with:[n.ZV.ctrl],action:"up",playerStatus:[6,8]},{keyCode:n.wb["+"],with:[n.ZV.ctrl,n.ZV.shift],action:"up",playerStatus:[6,8]}],17:[{keyCode:n.wb["-"],with:[n.ZV.ctrl],action:"up",playerStatus:[6,8]},{keyCode:n.wb["-"],with:[n.ZV.ctrl,n.ZV.shift],action:"up",playerStatus:[6,8]}],1:{keyCode:n.wb.space,with:[],action:"up",playerStatus:[6,8]},3:{keyCode:n.ay.right,with:[],action:"up",playerStatus:[6]},2:{keyCode:n.ay.left,with:[],action:"up",playerStatus:[6,8]},4:{keyCode:n.ay.right,with:[],action:"longDown",playerStatus:[6]},5:{keyCode:n.ay.right,with:[],action:"up",playerStatus:[6],longDownBefore:!0},6:{keyCode:n.wb.n,with:[n.ZV.ctrl],action:"up"},7:{keyCode:n.wb.p,with:[n.ZV.ctrl],action:"up"},8:{keyCode:n.ay.right,with:[],action:"up",playerStatus:[8]},9:{keyCode:n.wb.p,with:[n.ZV.ctrl,n.ZV.shift],action:"up",playerStatus:[8,6]},10:{keyCode:n.wb.s,with:[n.ZV.ctrl],action:"up",playerStatus:[8,6]},12:{keyCode:n.ay.down,with:[],action:"up"},11:{keyCode:n.ay.up,with:[],action:"up"},13:{keyCode:n.ay.esc,with:[],action:"up"},14:{keyCode:n.wb.f,with:[n.ZV.ctrl],action:"up"},15:{keyCode:n.wb.u,with:[n.ZV.ctrl],action:"up"}};class f{constructor(e){(0,r.A)(this,"onKeyDown_",void 0),(0,r.A)(this,"onKeyUp_",void 0),(0,r.A)(this,"player",void 0),(0,r.A)(this,"seekQueue",void 0),(0,r.A)(this,"lastPlayrate",void 0),(0,r.A)(this,"longDownTimer",void 0),(0,r.A)(this,"longDownRunning",void 0),this.player=e,this.longDownTimer=new(a()),this.longDownRunning=new(a()),this.seekQueue=new l.A,this.onKeyDown_=e=>{this.onKeyDown(e)},this.onKeyUp_=e=>{this.onKeyUp(e)},document.addEventListener("keydown",this.onKeyDown_),document.addEventListener("keyup",this.onKeyUp_)}actionPlayOrPause(){8===this.player.getStatus()?this.player.play():this.player.pause()}actionSeekForward(){this.seekQueue.clearPadding(),this.seekQueue.push((async()=>this.player.seek(d.jk(this.player.currentTime+BigInt(1e4),this.player.getDuration()-BigInt(1e4)))))}actionSeekBack(){this.seekQueue.clearPadding(),this.seekQueue.push((async()=>this.player.seek(d.T9(this.player.currentTime-BigInt(1e4),BigInt(0)))))}actionUpperPlayrate(){this.lastPlayrate=this.player.getPlaybackRate(),this.player.setPlaybackRate(2)}actionStopUpperPlayrate(){this.player.setPlaybackRate(this.lastPlayrate)}actionNextFile(){}actionPrevFile(){}actionNextFrame(){this.player.playNextFrame()}actionSnapshot(){if(!this.player.hasVideo())return;const e=this.player.snapshot("png"),t=atob(e.replace(/^data:image\/(png|jpeg|jpg);base64,/,"")),i=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),s=new Uint8Array(r);for(let e=0;e<t.length;e++)s[e]=t.charCodeAt(e);const a=new Blob([r],{type:i}),n=document.createElement("a");let o=this.player.getSource(),c="";c=h.Yj(o)?o:o.name;const l=c.split(".");l.pop(),n.download=l.join(".")+".png",n.href=URL.createObjectURL(a),n.click()}actionStop(){this.player.stop()}actionVolumeUp(){this.player.setVolume(Math.min(this.player.getVolume()+.1,1))}actionVolumeDown(){this.player.setVolume(Math.max(this.player.getVolume()-.1,0))}actionExitFullscreen(){this.player.exitFullscreen()}actionFoldFolder(){this.player.toggleFolder()}actionUnFoldFolder(){this.player.unfoldFolder()}actionSubtitleDelayAdd(){this.player.setSubtitleDelay(Math.min(5e3,this.player.getSubtitleDelay()+100))}actionSubtitleDelaySub(){this.player.setSubtitleDelay(Math.max(-5e3,this.player.getSubtitleDelay()-100))}runAction(e){switch(e){case 1:this.actionPlayOrPause();break;case 8:this.actionNextFrame();break;case 13:this.actionExitFullscreen();break;case 6:this.actionNextFile();break;case 7:this.actionPrevFile();break;case 2:this.actionSeekBack();break;case 3:this.actionSeekForward();break;case 9:this.actionSnapshot();break;case 10:this.actionStop();break;case 14:this.actionFoldFolder();break;case 15:this.actionUnFoldFolder();break;case 4:this.actionUpperPlayrate();break;case 5:this.actionStopUpperPlayrate();break;case 12:this.actionVolumeDown();break;case 11:this.actionVolumeUp();break;case 16:this.actionSubtitleDelayAdd();break;case 17:this.actionSubtitleDelaySub()}}longDownAction(e,t){this.longDownTimer.has(t.keyCode)||this.longDownTimer.set(t.keyCode,setTimeout((()=>{this.longDownTimer.delete(t.keyCode),this.runAction(e),this.longDownRunning.set(t.keyCode,e)}),1e3))}getActionKeys(e,t,i=!1){let r,s;if(o.__(u,((a,o)=>{const l=a=>{if(a.keyCode===e.keyCode&&t===a.action&&(!a.playerStatus||c.zy(a.playerStatus,this.player.getStatus()))&&(!i||a.longDownBefore)){const t=[];if(e.shiftKey&&t.push(n.ZV.shift),e.ctrlKey&&t.push(n.ZV.ctrl),e.metaKey&&t.push(n.ZV.meta),e.altKey&&t.push(n.ZV.alt),t.length===a.with.length){let e=!0;for(let i=0;i<t.length;i++)if(!c.zy(a.with,t[i])){e=!1;break}if(e)return r=+o,s=a,!0}}};if(!h.YO(a))return!l(a);{let e=!1;if(c.__(a,(t=>{if(l(t))return e=!0,!1})),e)return!1}})),s)return{key:r,action:s}}onKeyDown(e){let t=this.getActionKeys(e,"down");t?this.runAction(t.key):(t=this.getActionKeys(e,"longDown"),t&&!this.longDownRunning.has(t.action.keyCode)&&this.longDownAction(t.key,t.action))}onKeyUp(e){this.longDownTimer.has(e.keyCode)&&(clearTimeout(this.longDownTimer.get(e.keyCode)),this.longDownTimer.delete(e.keyCode));let t=this.getActionKeys(e,"up",this.longDownRunning.has(e.keyCode));t&&(t.action.longDownBefore&&!this.longDownRunning.has(e.keyCode)||this.runAction(t.key)),this.longDownRunning.delete(e.keyCode)}destroy(){document.removeEventListener("keydown",this.onKeyDown_),document.removeEventListener("keyup",this.onKeyUp_)}}},64147:(e,t,i)=>{"use strict";i.d(t,{A:()=>l});var r=i(63939),s=i(28090),a=i(82723),n=i.n(a),o=i(41192),c=i.n(o);const l={name:"AudioTrack",template:n(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{streams:[],audioInfo:null,selectIndex:0,style:c()}},computed:{list:function(){const e=this.get("player"),t=this.get("streams"),i=this.get("audioInfo");return i?i.list.length?i.list.map(((e,t)=>{let i="";return e.bandwidth&&(i=e.bandwidth>1e3?`${Math.round(e.bandwidth/1e3)} kbps`:`${e.bandwidth} bps`),e.codec&&(i+=i?` (${e.codec})`:e.codec),e.lang&&(i+=i?` ${e.lang}`:e.lang),{value:t,name:i,codec:e.codec}})):[]:t.map(((t,i)=>(t.id===e.getSelectedAudioStreamId()&&this.set("selectIndex",i),{value:t.id,name:t.metadata.title||t.metadata.languageString||t.metadata.language||t.metadata.name||"default"})))}},methods:{change:function(e){this.get("selectIndex")!==e&&this.get("player").selectAudio(this.get("list")[e].value).then((()=>{this.set("selectIndex",e)}))},init:function(e){e.isDash()||e.isHls()?e.getAudioList().then((e=>{this.set("audioInfo",e),this.set("selectIndex",e.selectedIndex)})):this.set("streams",e.getStreams().filter((e=>1===r.f[15](e.codecpar))))}},afterMount(){this.namespace=".component_control_audio_track"+Math.random();const e=this.get("player");e.on(s.S2+this.namespace,(()=>{this.init(e)})),e.on(s.xv+this.namespace,(()=>{this.init(e)})),e.getStatus()>=4&&this.init(e)},beforeDestroy(){const e=this.get("player");this.namespace&&e.off(this.namespace)}}},30019:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(22179),s=i.n(r),a=i(56872),n=i.n(a);const o={name:"Fullscreen",template:s(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0},dom:{type:"object"}},data:function(){return{style:n(),fullscreen:!1}},methods:{init(e){},fullscreenClick(){const e=this.get("player");if(this.get("fullscreen"))document.exitFullscreen?document.exitFullscreen():document.mozExitFullScreen?document.mozExitFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else{const t=this.get("dom")||e.getOptions().container.parentElement;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}}},afterMount(){this.namespace=".component_control_fullscreen"+Math.random();const e=this.get("player");this.onfullscreenchange=()=>{if(null==document.fullscreenElement){const t=e.getOptions().container;e.resize(t.offsetWidth,t.offsetHeight),this.set("fullscreen",!1)}else e.resize(screen.width,screen.height),this.set("fullscreen",!0)},document.addEventListener("fullscreenchange",this.onfullscreenchange)},beforeDestroy(){const e=this.get("player");this.namespace&&e.off(this.namespace),document.removeEventListener("fullscreenchange",this.onfullscreenchange)}}},86213:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(11302),s=i(82237),a=i.n(s),n=i(68738),o=i.n(n);const c={name:"Loop",template:a(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{style:o(),loop:!!+r.Jt(r.vd,0)}},watchers:{loop:function(e){this.get("player").setLoop(e),r.hZ(r.vd,e?1:0)}},methods:{init(e){},change(){this.set("loop",!this.get("loop"))}},afterMount(){this.namespace=".component_control_loop"+Math.random(),this.get("player").setLoop(this.get("loop"))},beforeDestroy(){const e=this.get("player");this.namespace&&e.off(this.namespace)}}},91011:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(16979),s=i.n(r),a=i(38712),n=i.n(a);const o={name:"Pip",template:s(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{style:n(),pip:!1}},methods:{init(e){},async pipClick(){const e=this.get("player");if(this.get("pip"))if(this.set("pip",!1),e.isMSE())document.exitPictureInPicture();else{const t=this.pipWindow.document.body.children[0];t&&(this.playerContainer.prepend(t),e.resize(t.offsetWidth,t.offsetHeight)),this.pipWindow.close()}else e.isMSE()?e.video.requestPictureInPicture():(this.playerContainer=e.getOptions().container.parentElement,this.pipWindow=await documentPictureInPicture.requestWindow({disallowReturnToOpener:!0,width:320,height:180}),this.pipWindow.addEventListener("pagehide",(t=>{if(this.get("pip")){const i=t.target.body.children[0];i&&(this.playerContainer.prepend(i),e.resize(i.offsetWidth,i.offsetHeight)),this.set("pip",!1)}})),this.pipWindow.addEventListener("resize",(t=>{if(this.pipWindow.document){const t=this.pipWindow.document.children[0];e.resize(t.offsetWidth,t.offsetHeight)}})),[...document.styleSheets].forEach((e=>{try{const t=[...e.cssRules].map((e=>e.cssText)).join(""),i=document.createElement("style");i.textContent=t,this.pipWindow.document.head.appendChild(i)}catch(t){const i=document.createElement("link");i.rel="stylesheet",i.type=e.type,i.media=e.media,i.href=e.href,this.pipWindow.document.head.appendChild(i)}})),this.pipWindow.document.body.append(e.getOptions().container))}},afterMount(){this.namespace=".component_control_pip"+Math.random(),this.onenter=e=>{this.pipWindow=e.window,this.set("pip",!0)},"object"==typeof documentPictureInPicture&&documentPictureInPicture.addEventListener("enter",this.onenter)},beforeDestroy(){const e=this.get("player");"object"==typeof documentPictureInPicture&&documentPictureInPicture.removeEventListener("enter",this.onenter),this.namespace&&e.off(this.namespace)}}},76793:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(1449),s=i.n(r),a=i(90902),n=i.n(a);const o={name:"Play",template:s(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0},played:{type:"boolean",required:!0}},data:function(){return{style:n()}},methods:{playClick(){const e=this.get("player");if(e.getSource()){if(this.get("played")){if(e.isLive())return;e.pause()}else 0===e.getStatus()?e.load(e.getSource(),{externalSubtitles:e.getExternalSubtitle()}).then((()=>{e.play()})):e.play();this.set("played",!this.get("played"))}}}}},7233:(e,t,i)=>{"use strict";i.d(t,{A:()=>l});var r=i(72739),s=i(11302),a=i(8809),n=i.n(a),o=i(33814),c=i.n(o);const l={name:"Playrate",template:n(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){const e=[2,1.5,1.25,1,.75,.5];let t=r.qh(e,+s.Jt(s.Yt,1));return t<0&&(t=3),{list:e,index:t,style:c()}},watchers:{index:function(e){s.hZ(s.Yt,this.get("list")[e]),this.get("player").setPlaybackRate(this.get("list")[e])}},methods:{change:function(e){this.set("index",e)}},afterMount(){this.namespace=".component_control_play_rate"+Math.random(),this.get("player").setPlaybackRate(this.get("list")[this.get("index")])},beforeDestroy(){const e=this.get("player");this.namespace&&e.off(this.namespace)}}},13203:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(78675),s=i.n(r),a=i(97176),n=i.n(a);const o={name:"Setting",template:s(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{style:n()}},methods:{init(e){},click(){this.fire("openSettings")}},afterMount(){this.namespace=".component_control_setting"+Math.random(),this.get("player")},beforeDestroy(){const e=this.get("player");this.namespace&&e.off(this.namespace)}}},59715:(e,t,i)=>{"use strict";i.d(t,{A:()=>d});var r=i(63939),s=i(28090),a=i(95683),n=i.n(a),o=i(66328),c=i.n(o),l=i(9391);const d={name:"SubtitleTrack",template:n(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{streams:[],subtitleInfo:null,selectIndex:0,style:c(),accept:l._Y.map((e=>"."+e)).join(", "),canUseFilePicker:"function"==typeof showOpenFilePicker}},computed:{list:function(){const e=this.get("player"),t=this.get("streams"),i=this.get("subtitleInfo");return i?i.list.length?i.list.map(((e,t)=>{let i="";return e.lang&&(i=e.lang),e.codec&&(i+=i?` ${e.codec}`:e.codec),{value:t,name:i,codec:e.codec}})):[]:t.map(((t,i)=>(t.id===e.getSelectedSubtitleStreamId()&&this.set("selectIndex",i),{value:t.id,name:t.metadata.title||t.metadata.languageString||t.metadata.language||t.metadata.name||"default"})))}},methods:{change:function(e){this.get("selectIndex")!==e&&this.get("player").selectSubtitle(this.get("list")[e].value).then((()=>{this.set("selectIndex",e)}))},openFile(){const e={startIn:"videos",types:[{description:"Subtitles",accept:{"application/octet-stream":l._Y.map((e=>"."+e))}}],excludeAcceptAllOption:!0,multiple:!0},t=this.get("player");showOpenFilePicker(e).then((async e=>{for(let i=0;i<e.length;i++){const r=await e[i].getFile(),s=r.name.split(".");s.pop(),t.loadExternalSubtitle({title:s.join("."),source:r})}}))},fileChange(e){const t=e.originalEvent.target.files[0],i=this.get("player"),r=t.name.split(".");r.pop(),i.loadExternalSubtitle({title:r.join("."),source:t})},init:function(e){e.isDash()||e.isHls()?e.getSubtitleList().then((e=>{this.set("subtitleInfo",e),this.set("selectIndex",e.selectedIndex)})):this.set("streams",e.getStreams().filter((e=>3===r.f[15](e.codecpar))))}},afterMount(){this.namespace=".component_control_subtitle_track"+Math.random();const e=this.get("player");e.on(s.S2+this.namespace,(()=>{this.init(e)})),e.on(s.xv+this.namespace,(()=>{this.init(e)})),e.getStatus()>=4&&this.init(e)},beforeDestroy(){const e=this.get("player");this.namespace&&e.off(this.namespace)}}},37463:(e,t,i)=>{"use strict";i.d(t,{A:()=>l});var r=i(28090),s=i(20525),a=i(9127),n=i.n(a),o=i(52068),c=i.n(o);const l={name:"Time",template:n(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{totalTime:BigInt(0),currentTime:BigInt(0),style:c()}},filters:{formatTime(e){e<0&&(e=BigInt(0));const t=Number(BigInt.asIntN(32,e/BigInt(1e3)%BigInt(60))),i=Number(BigInt.asIntN(32,e/BigInt(1e3)/BigInt(60)%BigInt(60))),r=Number(BigInt.asIntN(32,e/BigInt(1e3)/BigInt(3600)));return s.GP("%02d:%02d:%02d",r,i,t)}},methods:{init(e){this.set("currentTime",e.currentTime),this.set("totalTime",e.getDuration())}},afterMount(){this.namespace=".component_control_timer"+Math.random();const e=this.get("player");e.on(r.S2+this.namespace,(()=>{this.init(e)})),e.on(r.E9+this.namespace,(e=>{this.set("currentTime",e)})),e.getStatus()>=4&&this.init(e)},beforeDestroy(){const e=this.get("player");this.namespace&&e.off(this.namespace)}}},40777:(e,t,i)=>{"use strict";i.d(t,{A:()=>l});var r=i(63939),s=i(28090),a=i(43145),n=i.n(a),o=i(15478),c=i.n(o);const l={name:"VideoTrack",template:n(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{streams:[],videoInfo:null,selectIndex:0,style:c()}},computed:{list:function(){const e=this.get("player"),t=this.get("streams"),i=this.get("videoInfo");if(!i)return t.map(((t,i)=>(t.id===e.getSelectedVideoStreamId()&&this.set("selectIndex",i),{value:t.id,name:t.metadata.title||t.metadata.languageString||t.metadata.language||t.metadata.name||"default"})));if(i.list.length){const e=i.list[i.selectedIndex].codec;return i.list.map(((e,t)=>{let i="";e.bandwidth&&(i=e.bandwidth>1e3?`${Math.round(e.bandwidth/1e3)} kbps`:`${e.bandwidth} bps`);let r=`${e.width}x${e.height}`;return e.frameRate&&(r+=`@${e.frameRate}`),i&&(r=` (${r})`),i+=r,e.codec&&(i+=` (${e.codec})`),{value:t,name:i,codec:e.codec}})).filter((t=>t.codec.split(".")[0]===e.split(".")[0]))}return[]}},methods:{change:function(e){this.get("selectIndex")!==e&&this.get("player").selectVideo(this.get("list")[e].value).then((()=>{this.set("selectIndex",e)}))},init:function(e){e.isDash()||e.isHls()?e.getVideoList().then((e=>{this.set("videoInfo",e),this.set("selectIndex",e.selectedIndex)})):this.set("streams",e.getStreams().filter((e=>0===r.f[15](e.codecpar))))}},afterMount(){this.namespace=".component_control_video_track"+Math.random();const e=this.get("player");e.on(s.S2+this.namespace,(()=>{this.init(e)})),e.on(s.xv+this.namespace,(()=>{this.init(e)})),e.getStatus()>=4&&this.init(e)},beforeDestroy(){const e=this.get("player");this.namespace&&e.off(this.namespace)}}},92053:(e,t,i)=>{"use strict";i.d(t,{A:()=>d});var r=i(11302),s=i(53924),a=i(28090),n=i(93069),o=i.n(n),c=i(92066),l=i.n(c);const d={name:"Volume",template:o(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{lastVolume:50,volume:+r.Jt(r.xc,50),style:l()}},watchers:{volume:function(e){const t=this.get("player");t.setVolume(e/100),t.isSuspended()&&0===e||r.hZ(r.xc,e)}},methods:{volumeClick(){if(this.get("volume"))this.set("lastVolume",this.get("volume")),this.set("volume",0);else{this.set("volume",this.get("lastVolume"));const e=this.get("player");e.isSuspended()&&e.resume()}}},afterMount(){this.namespace=".component_control_volume"+Math.random();const e=this.get("player");e.on(a.Wu+this.namespace,(e=>{this.set("volume",Math.floor(100*e))})),e.on(a.CN+this.namespace,(()=>{e.isSuspended()&&this.get("volume")&&this.volumeClick()})),e.on(a.dQ+this.namespace,(()=>{this.get("volume")||this.volumeClick()})),e.setVolume(this.get("volume")/100)},beforeDestroy(){const e=this.get("player");this.namespace&&e.off(this.namespace)},components:{Slider:s.A}}},14667:(e,t,i)=>{"use strict";i.d(t,{A:()=>m});var r=i(28090),s=i(94907),a=i.n(s),n=i(74320),o=i.n(n),c=i(9391),l=i(72739),d=i(66521),h=i(8284),u=i(4624),f=i(8507),p=i(67672);const m={name:"Folder",template:a(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{style:o(),canOpenFolder:"function"==typeof showDirectoryPicker,canUseFilePicker:"function"==typeof showOpenFilePicker,tip:"",tipTop:0,tipShow:!1,root:[],accept:c.z_.concat(c.KQ).map((e=>"."+e)).join(", "),nextPlayNodeId:""}},methods:{init(e){},findRootNodeBySource(e,t){const i=this.get("root");for(let r=0;r<i.length;r++)if(i[r].source===e&&i[r].isLive===t)return i[r];return null},async addDir(e){let t=0;const i=[];async function r(e){const r=await e.getFile(),s=r.name.split(".").pop();if(l.zy(c.KQ,s)||l.zy(c.z_,s)){const s={id:(0,h.A)(),type:"file",name:r.name,depth:t,source:r,handle:e,played:!1,parent:i.length?i[i.length-1]:null};i[i.length-1].children.push(s)}}await async function e(s){const a={id:(0,h.A)(),type:"folder",name:s.name,depth:t,children:[],opened:!1,handle:s,played:!1,parent:i.length?i[i.length-1]:null};i.length&&i[i.length-1].children.push(a),i.push(a),t++;for await(const a of s.values())"file"===a.kind?await r(a):"directory"===a.kind&&(await e(a),i.pop(),t--)}(e),this.append("root",i.pop())},async addFile(e,t){this.findRootNodeBySource(e,!1)||this.append("root",{id:(0,h.A)(),type:"file",name:e.name,depth:0,source:e,handle:t})},addUrl(e,t,i){const r=this.findRootNodeBySource(e,t);if(r)return void(i&&(r.ref?r.ref.fire("play",r.ref):this.set("nextPlayNodeId",r.id)));const s=(0,h.A)(),a=f.qg(e);this.append("root",{id:s,type:"file",name:a.file||e,depth:0,source:e,isLive:t}),i&&this.set("nextPlayNodeId",s)},async addFileHandle(e){const t=await e.getFile();await this.addFile(t,e)},openDir(){showDirectoryPicker({mode:"read",startIn:"videos"}).then((async e=>{this.addDir(e),this.root.push(e),d.M_(d.qd,this.root)}))},openFile(){const e={startIn:"videos",types:[{description:"Audios & Videos",accept:{"application/octet-stream":c.z_.map((e=>"."+e)).concat(c.KQ.map((e=>"."+e)))}}],excludeAcceptAllOption:!0,multiple:!0};showOpenFilePicker(e).then((async e=>{for(let t=0;t<e.length;t++)this.addFileHandle(e[t]),this.root.push(e[t]);d.M_(d.qd,this.root)}))},generateStoreUrl:(e,t)=>`${t?"libmediaLive:":""}${e}`,openUrl(e,t,i){e&&p.Yj(e)||(e=this.$refs.url.value),e&&(null==t&&(t=this.$refs.live.checked),this.addUrl(e,t,i),this.root.push(this.generateStoreUrl(e,t)),d.M_(d.qd,this.root),this.$refs.url.value="",this.$refs.live.checked=!1)},fileChange(e){const t=e.originalEvent.target.files[0];this.addFile(t)},findNodeById(e,t){for(let i=0;i<t.length;i++){if(t[i].id===e)return t[i];if("folder"===t[i].type){let r=this.findNodeById(e,t[i].children);if(r)return r}}},async findSubtitle(e){const t=e.parent,i=e.handle,r=[];if(t){let e=(await i.getFile()).name.split(".");e.pop();let s=e.join(".");for await(const e of t.handle.values())if("file"===e.kind){const t=await e.getFile(),i=t.name.split(".").pop();let a=t.name.split(".");a.pop();let n=a.join(".");l.zy(c._Y,i)&&s===n&&r.push({title:n,source:t})}if(r.length){const e=this.get("player");r.forEach((t=>{e.loadExternalSubtitle(t)}))}}},preventDefault(e){e.preventDefault()},play(e){const t=this.get("player");if(e.get("node.id")===this.playNodeId)return void(6===t.getStatus()?(t.pause(),e.set("node.paused",!0)):8===t.getStatus()&&(t.play(),e.set("node.paused",!1)));if(this.playNodeId){let e=this.findNodeById(this.playNodeId,this.get("root"));for(;e;)e.ref?e.ref.set("node.played",!1):e.played=!1,e=e.parent;this.playNodeId=null}let i=e;for(;i!==this;)i.set("node.played",!0),i=i.$parent;1!==t.getStatus()&&2!==t.getStatus()&&(0===t.getStatus()?(t.load(e.get("node.source"),{isLive:!!e.get("node.isLive")}).then((()=>{t.play().catch((e=>{this.fire("error",{message:`${e}`})})),e.set("node.paused",!1),this.findSubtitle(e.get("node"))})).catch((e=>{this.fire("error",{message:`${e}`})})),this.playNodeId=e.get("node.id"),this.fire("playNode",e.get("node"))):t.stop().then((()=>{t.load(e.get("node.source"),{isLive:!!e.get("node.isLive")}).then((()=>{t.play().catch((e=>{this.fire("error",{message:`${e}`})})),e.set("node.paused",!1),this.findSubtitle(e.get("node"))})).catch((e=>{this.fire("error",{message:`${e}`})})),this.playNodeId=e.get("node.id"),this.fire("playNode",e.get("node"))})))}},events:{play(e,t){this.play(t)},delete(e,t){let i=-1;const r=this.get("root");for(let e=0;e<r.length;e++)if(r[e].id===t.id){i=e;break}i>-1&&this.removeAt("root",i),l.TF(this.root,t.handle||this.generateStoreUrl(t.source,t.isLive)),d.M_(d.qd,this.root)},tip(e,t){t?(this.set("tipShow",!0),this.set("tip",t.text),this.set("tipTop",t.top-this.$refs.scroll.scrollTop+90)):this.set("tipShow",!1)}},afterMount(){this.namespace=".component_folder"+Math.random(),d.Hh(d.qd).then((async e=>{this.root=e||[];const t=[];for(let e=0;e<this.root.length;e++){const i=this.root[e];try{if(p.Yj(i)){let e=i;const t=/^libmediaLive:/.test(e);t&&(e=e.replace(/^libmediaLive:/,"")),this.addUrl(e,t)}else{let e=await i.queryPermission({mode:"read"});if("granted"!==e&&(e=await i.requestPermission({mode:"read"}),"granted"!==e))throw new Error(`not has permission to access ${i.name}`);"file"===i.kind?await this.addFileHandle(i):"directory"===i.kind&&await this.addDir(i)}t.push(i)}catch(e){u.z3("load file handle error, ignore it","src/ui/avplayer/components/folder/Folder.ts",468)}}t.length!==this.root.length&&d.M_(d.qd,t),this.fire("folderLoaded")}));const e=this.get("player");e.on(r.yd+this.namespace,(()=>{if(this.playNodeId){let e=this.findNodeById(this.playNodeId,this.get("root"));if(e){e.ref?e.ref.set("node.paused",!0):e.paused=!0;let t=e;for(;t;)t.ref?t.ref.set("node.played",!1):t.played=!1,t=t.parent}}})),e.on(r.NN+this.namespace,(()=>{if(this.playNodeId){let e=this.findNodeById(this.playNodeId,this.get("root"));e&&(e.ref?e.ref.set("node.paused",!0):e.paused=!0)}})),e.on(r.CN+this.namespace,(()=>{if(this.playNodeId){let e=this.findNodeById(this.playNodeId,this.get("root"));e&&(e.ref?e.ref.set("node.paused",!1):e.paused=!1)}}))},beforeDestroy(){const e=this.get("player");this.namespace&&e.off(this.namespace)},afterUpdate(){if(this.get("nextPlayNodeId")){const e=this.findNodeById(this.get("nextPlayNodeId"),this.get("root"));e&&(this.set("nextPlayNodeId",""),e.ref.fire("play",e.ref))}},components:{FolderNode:c.Ay}}},9391:(e,t,i)=>{"use strict";i.d(t,{Ay:()=>d,KQ:()=>o,_Y:()=>c,z_:()=>n});var r=i(67672),s=i(72739),a=i(81747);const n=["mp3","aac","flac","ogg","ogg","wav","m4a","mka","opus"],o=["mp4","webm","mkv","flv","ts","mov","m4s","h264","264","avc","h265","265","hevc","h266","266","vvc","ivf","mpeg","avi"],c=["ass","ssa","vvt","srt","xml","ttml"],l={name:"Node",template:i.n(a)(),propTypes:{node:{type:"object"},language:{type:"object",required:!0}},data:function(){return{}},filters:{isFolder:function(e){return"folder"===e.type},paddingStart:function(e){return 24*e.depth},isUrl:function(e){return r.Yj(e.source)},isMusic:function(e){const t=e.source.name.split(".").pop();return s.zy(n,t)}},methods:{toggle(){this.set("node.opened",!this.get("node.opened"))},play(){this.fire("play",this)},delete(){this.fire("delete",this.get("node"))},mouseenter(){this.$refs.name.scrollWidth>this.$refs.name.clientWidth?this.fire("tip",{top:this.$el.offsetTop,text:r.Yj(this.get("node.source"))?this.get("node.source"):this.get("node.name")}):r.Yj(this.get("node.source"))&&r.Yj(this.get("node.source"))!==this.get("node.name")&&this.fire("tip",{top:this.$el.offsetTop,text:this.get("node.source")})},mouseleave(){this.fire("tip","")}},afterMount(){this.get("node").ref=this},beforeDestroy(){this.get("node").ref=null},components:{}};l.components.FolderNode=l;const d=l},53891:(e,t,i)=>{"use strict";i.d(t,{A:()=>f});var r=i(28090),s=i(67672),a=i(15491),n=i.n(a),o=i(51e3),c=i.n(o),l=i(548);const d=["jitter","bandwidth"],h=["audioStutter","audioBitrate","audioEncodeFramerate","audioDecodeFramerate","audioRenderFramerate","audioFrameDecodeIntervalMax","audioFrameRenderIntervalMax"],u=["videoStutter","videoBitrate","videoEncodeFramerate","videoDecodeFramerate","videoRenderFramerate","keyFrameInterval","videoFrameDecodeIntervalMax","videoFrameRenderIntervalMax"],f={name:"Info",template:n(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{style:c(),info:"",list:[]}},methods:{getStats:function(e){const t=e.getStats();this.set("list",[]);let i=d;e.hasVideo()&&(i=i.concat(u)),e.hasAudio()&&(i=i.concat(h)),i.forEach((e=>{let i=t[e];"audioBitrate"!==e&&"videoBitrate"!==e&&"bandwidth"!==e||(i=8*i/1e3+" kbps"),this.append("list",{key:e.replace(/([A-Z])/g," $1").replace(/^[a-z]/,(e=>e.toUpperCase())),value:i})}))},init(e){const t=e.getSource(),i=(0,l.Ay)([e.getFormatContext()],[{from:s.Yj(t)?t:t.name,tag:"Input"}]);this.set("info",i.replace(/\n/g,"<br>").replace(/\s/g,"&nbsp;")),this.set("list",[]),this.getStats(e),this.timer||(this.timer=setInterval((()=>{this.getStats(e)}),1e3))},close(){return this.fire("closeInfo"),!1},preventDefault(e){e.preventDefault()}},afterMount(){this.namespace=".component_info"+Math.random();const e=this.get("player");e.on(r.S2+this.namespace,(()=>{this.init(e)})),e.getStatus()>=4&&this.init(e)},beforeDestroy(){const e=this.get("player");this.namespace&&e.off(this.namespace),this.timer&&(clearInterval(this.timer),this.timer=null)}}},45553:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(28090),s=i(32849),a=i.n(s),n=i(17246),o=i.n(n);const c={name:"Loading",template:a(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{style:o(),loading:!1}},methods:{},afterMount(){this.namespace=".component_loading"+Math.random();const e=this.get("player");e.on(r.CN+this.namespace,(()=>{this.timer&&(clearTimeout(this.timer),this.timer=null),this.set("loading",!1)})),e.on(r.F5+this.namespace,(()=>{this.timer&&clearTimeout(this.timer),this.timer=setTimeout((()=>{this.set("loading",!0),this.timer=null}),500)})),this.set("loading",3===e.getStatus())},beforeDestroy(){const e=this.get("player");this.namespace&&e.off(this.namespace)}}},65893:(e,t,i)=>{"use strict";i.d(t,{A:()=>u});var r=i(63939),s=i(28090),a=i(23077),n=i.n(a),o=i(85466),c=i.n(o),l=i(548),d=i(68391);const h={0:"LOADING_MESSAGE_OPEN_FILE",1:"LOADING_MESSAGE_ANALYZE_FILE",2:"LOADING_MESSAGE_LOAD_AUDIO_DECODER",3:"LOADING_MESSAGE_LOAD_VIDEO_DECODER"},u={name:"LoadingTip",template:n(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0},error:{type:"string"}},data:function(){return{style:c(),messages:[],showMessage:!1}},watchers:{error:function(){this.queue.push((()=>{this.append("message",this.get("language.LOADING_MESSAGE_LOAD_FAILED"))}))}},methods:{},afterMount(){this.namespace=".component_loading"+Math.random();const e=this.get("player");this.queue=new d.A(100),this.queue.onEnd=()=>{this.showTimer&&clearTimeout(this.showTimer),this.showTimer=setTimeout((()=>{this.showTimer=null,e.isSuspended()?this.set("message",[this.get("language.LOADING_MESSAGE_RESUME")]):this.set("showMessage",!1)}),2e3)},e.on(s.CN+this.namespace,(()=>{this.queue.push((()=>{this.append("message",this.get("language.LOADING_MESSAGE_LOAD_END"))})),e.isSuspended()&&this.queue.push((()=>{this.append("message",this.get("language.LOADING_MESSAGE_RESUME"))})),this.queue.end()})),e.on(s.F5+this.namespace,(()=>{this.showTimer&&(clearTimeout(this.showTimer),this.showTimer=null),this.queue.reset(),this.set("message",[]),this.set("showMessage",!0)})),e.on(s.dQ+this.namespace,(()=>{const e=this.get("message");this.showTimer||1!==e.length||e[0]!==this.get("language.LOADING_MESSAGE_RESUME")||this.set("showMessage",!1)})),e.on(s.Gd+this.namespace,((e,t)=>{let i=this.get("language."+h[e]);switch(e){case 1:i=i.replace("${mux}",t);break;case 2:case 3:i=i.replace("${decoder}",(0,l.eG)(r.f[15](t.codecpar),r.f[15](t.codecpar+4)))}this.queue.push((()=>{this.append("message",i)}))})),e.getStatus()>=3&&this.set("showMessage",!0)},beforeDestroy(){const e=this.get("player");this.namespace&&e.off(this.namespace)}}},30499:(e,t,i)=>{"use strict";i.d(t,{A:()=>m});var r=i(134),s=i(61634),a=i(28090),n=i(65051),o=i.n(n),c=i(5840),l=i.n(c),d=i(78995),h=i(86932);function u(e,t,i){let r,s,a;if(0==t)r=s=a=i;else{const n=function(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<.16666666666666666?e+6*(t-e)*i:i<.3333333333333333?t:i<.5?e+(t-e)*(.6666666666666666-i)*6:e},o=i<.5?i*(1+t):i+t-i*t,c=2*i-o;r=n(c,o,.3333333333333333+(e/=360)),s=n(c,o,e),a=n(c,o,e-.3333333333333333)}return[Math.round(255*r),Math.round(255*s),Math.round(255*a)]}function f(e,t){let i=(e+t)%360;return i<0&&(i+=360),i}class p{constructor(){(0,r.A)(this,"OUTER_MAX_HEIGHT",.4),(0,r.A)(this,"MIDDLE_MAX_HEIGHT",.3),(0,r.A)(this,"INNER_MAX_HEIGHT",.2),(0,r.A)(this,"MAX_LENGTH",100),(0,r.A)(this,"MAX_FRAMERATE",30),(0,r.A)(this,"timeDelta",Math.floor(1e3/this.MAX_FRAMERATE)),(0,r.A)(this,"lastTimestamp",(0,h.A)())}draw(e,t){const i=(0,h.A)();if(i-this.lastTimestamp<this.timeDelta)return;this.lastTimestamp=i;const r=t.canvas.width,s=t.canvas.height,a=Math.min(r,s)/2;let n=Math.floor(this.MAX_LENGTH*(1+Math.min(1,(a-500)/200)));const o=Math.floor(e.length/n*.6);t.clearRect(0,0,r,s);const c=Math.min(r/2,s/2)*(.95-this.OUTER_MAX_HEIGHT),l=[],d=[],p=[],m=[],g=2*Math.PI/n,v=360/n,y=function(){const e=Math.max(1,0,0),t=Math.min(1,0,0);let i,r,s=(e+t)/2;if(e===t)i=r=0;else{const a=e-t;switch(r=s>.5?a/(2-e-t):a/(e+t),e){case 1:i=0/a+0;break;case 0:i=-1/a+2;break;case 0:i=1/a+4}i/=6}return[360*i,r,s]}();for(let t=0;t<n;t++){const i=Math.pow(e[t*o]/255,1.5),n=Math.pow(e[t*o]/255,1),h=Math.pow(e[t*o]/255,2.2);l.push({x:r/2+(c+this.OUTER_MAX_HEIGHT*a*i)*Math.cos(t*g*-1),y:s/2+(c+this.OUTER_MAX_HEIGHT*a*i)*Math.sin(t*g*-1)}),p.push({x:r/2+(c-this.INNER_MAX_HEIGHT*a*n)*Math.cos(t*g*-1),y:s/2+(c-this.INNER_MAX_HEIGHT*a*n)*Math.sin(t*g*-1)}),d.push({start:{x:r/2+c*Math.cos(t*g*-1),y:s/2+c*Math.sin(t*g*-1)},end:{x:r/2+(c+this.MIDDLE_MAX_HEIGHT*a*h)*Math.cos(t*g*-1),y:s/2+(c+this.MIDDLE_MAX_HEIGHT*a*h)*Math.sin(t*g*-1)}});let A=Math.floor(t*v)-60;A<0&&(A+=360);const b=u(f(y[0],A),y[1],y[2]);m.push(`rgb(${b[0]},${b[1]},${b[2]})`)}t.lineCap="round",t.lineWidth=8,t.shadowBlur=20,t.shadowOffsetX=0,t.shadowOffsetY=0;for(let e=0;e<l.length;e++)t.strokeStyle=m[e],t.fillStyle=m[e],t.beginPath(),t.arc(l[e].x,l[e].y,4,0,2*Math.PI,!0),t.fill(),t.beginPath(),t.arc(p[e].x,p[e].y,4,0,2*Math.PI,!0),t.fill(),t.beginPath(),t.moveTo(d[e].start.x,d[e].start.y),t.lineTo(d[e].end.x,d[e].end.y),t.stroke();t.lineWidth=2;for(let e=0;e<p.length;e++){let i=e===p.length-1?0:e+1;const r=t.createLinearGradient(p[e].x,p[e].y,p[i].x,p[i].y);r.addColorStop(0,m[e]),r.addColorStop(1,m[i]),t.strokeStyle=r,t.beginPath(),t.moveTo(p[e].x,p[e].y),t.lineTo(p[i].x,p[i].y),t.stroke()}}}const m={name:"PcmVisualization",template:o(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{style:l()}},methods:{draw(){this.analyser.getByteFrequencyData(this.buffer),this.drawer.draw(this.buffer,this.context),requestAnimationFrame((()=>{this.playing&&this.draw()}))},init(e){e.hasVideo()?(this.playing=!1,this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height)):e.hasAudio()&&(this.playing=!0,this.analyser||(this.analyser=s.Ay.audioContext.createAnalyser(),this.buffer=new Uint8Array(this.analyser.frequencyBinCount)),e.getAudioOutputNode().connect(this.analyser),this.draw())}},afterMount(){this.namespace=".component_pcm_visualization"+Math.random(),this.$refs.canvas.width=this.$el.offsetWidth*devicePixelRatio,this.$refs.canvas.height=this.$el.offsetHeight*devicePixelRatio,this.context=this.$refs.canvas.getContext("2d"),this.drawer=new p;const e=this.get("player");e.on(a.CN+this.namespace,(()=>{this.init(e)})),6===e.getStatus()&&this.init(e),this.onresize=(0,d.A)((()=>{this.$refs.canvas.width=this.$el.offsetWidth*devicePixelRatio,this.$refs.canvas.height=this.$el.offsetHeight*devicePixelRatio}),500),window.addEventListener("resize",this.onresize)},beforeDestroy(){const e=this.get("player");this.namespace&&e.off(this.namespace),this.playing=!1,window.removeEventListener("resize",this.onresize)}}},23601:(e,t,i)=>{"use strict";i.d(t,{A:()=>p});var r=i(29967),s=i.n(r),a=i(90577),n=i.n(a),o=i(99726),c=i.n(o),l=i(28090),d=i(44328),h=i(20525),u=i(67672),f=i(77231);const p={name:"Progress",template:n(),propTypes:{player:{type:"object",required:!0},indicatorUrl:{type:"string"}},data:function(){return{style:c(),startX:0,start:!1,seekTime:0,currentTime:0,totalTime:0,loadedTime:0,hoverX:0,indicatorSize:0,showTip:!1,isFileSource:!1,chapters:[],hoverChapter:""}},computed:{playedWidth:function(){const e=this.get("seekTime"),t=this.get("currentTime"),i=this.get("totalTime");return this.get("start")?e/i*100:t/i*100},loadedWidth:function(){return this.get("isFileSource")?0:(this.get("currentTime")+this.get("loadedTime"))/this.get("totalTime")*100},hoverWidth:function(){const e=this.get("hoverX");if(this.$refs&&this.$refs.slider){let t=e-this.$refs.slider.getBoundingClientRect().left;return t<0&&(t=0),t>this.$refs.slider.offsetWidth&&(t=this.$refs.slider.offsetWidth),t/this.$refs.slider.offsetWidth*100}return 0},hoverTime:function(){const e=this.get("hoverWidth");return Math.round(e/100*this.get("totalTime"))}},filters:{formatTime(e){e<0&&(e=0);const t=e/1e3%60|0,i=e/1e3/60%60|0,r=e/1e3/3600|0;return r?h.GP("%02d:%02d:%02d",r,i,t):h.GP("%02d:%02d",i,t)}},methods:{mousemove:function(e){if(!this.get("start"))return;const t=this.get("startX"),i=this.$refs.slider.offsetWidth;let r=0;r=(e.screenX-t)/i*this.get("totalTime");let s=this.get("seekTime")+r;s<0&&(s=0),s>this.get("totalTime")&&(s=this.get("totalTime")),this.set("seekTime",s),this.set("startX",e.screenX)},mouseup:function(){if(this.get("start")){this.set("start",!1);const e=this.get("player");this.seeking=!0,e.seek(BigInt(Math.floor(this.get("seekTime")))).then((()=>{this.seeking=!1})),this.set("currentTime",this.get("seekTime"))}},hoverEnter:function(e){this.set("hoverX",e.originalEvent.clientX),this.set("showTip",!0)},hoverMove:function(e){this.set("hoverX",e.originalEvent.clientX)},hoverLeave:function(e){this.set("hoverX",this.$refs.slider.offsetLeft),this.set("showTip",!1)},hoverClick:function(e){const t=this.get("player"),i=t.getStatus();6!==i&&8!==i||(this.seeking=!0,t.seek(BigInt(Math.floor(this.get("hoverTime")))).then((()=>{this.seeking=!1})),this.set("currentTime",this.get("hoverTime")))},indicatorDown:function(e){this.set("startX",e.originalEvent.screenX),this.set("start",!0),this.set("seekTime",this.get("currentTime"))},chapterEnter(e){this.set("hoverChapter",e.text),this.set("showTip",!0)},chapterLeave(e){this.set("hoverChapter",""),this.set("showTip",!0)},chapterClick(e){const t=this.get("player");this.seeking=!0,t.seek(e.start).then((()=>{this.seeking=!1})),this.set("currentTime",Number(e.start))},init(e){this.set("currentTime",Number(e.currentTime)),this.set("totalTime",Number(e.getDuration())),this.set("isFileSource",!u.Yj(e.getSource())),this.set("chapters",e.getChapters().map((e=>{const t=(0,d.k)(e.start,e.timeBase,f.i0);return{text:e.metadata.title,start:t,left:Number(t)/this.get("totalTime")*100}})))}},afterMount(){this.onmouseup=e=>{this.mouseup()},this.onmousemove=e=>{this.mousemove(e)},document.addEventListener("mouseup",this.onmouseup),document.addEventListener("mousemove",this.onmousemove),this.namespace=".Progress"+Math.random();const e=this.get("player");e.on(l.S2+this.namespace,(()=>{this.init(e)})),e.on(l.yd+this.namespace,(()=>{this.set("currentTime",0),this.set("loadedTime",0)})),e.on(l.mQ+this.namespace,(()=>{this.set("currentTime",Number(e.currentTime))})),e.on(l.E9+this.namespace,(t=>{if(this.seeking)return;this.set("currentTime",Number(t));const i=e.getStats();i.audioEncodeFramerate?this.set("loadedTime",i.audioPacketQueueLength/i.audioEncodeFramerate*1e3):i.videoEncodeFramerate&&this.set("loadedTime",i.videoPacketQueueLength/i.videoEncodeFramerate*1e3)})),e.getStatus()>=4&&this.init(e);const t=document.querySelector("#avplayer-ui-container"),i=getComputedStyle(t).getPropertyValue("--libmedia-ui-indicator-size").trim();this.set("indicatorSize",s()(i))},beforeDestroy(){document.removeEventListener("mouseup",this.onmouseup),document.removeEventListener("mousemove",this.onmousemove),this.get("player").off(this.namespace)}}},44341:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r,s=i(42461),a=i.n(s),n=i(47410),o=i.n(n);!function(e){e[e.DECODER=0]="DECODER",e[e.PLAY=1]="PLAY",e[e.SUBTITLE=2]="SUBTITLE",e[e.VIDEO=3]="VIDEO",e[e.AUDIO=4]="AUDIO",e[e.FILTER=5]="FILTER",e[e.KEYBOARD=6]="KEYBOARD",e[e.LANGUAGE=7]="LANGUAGE",e[e.SKIN=8]="SKIN"}(r||(r={}));const c={name:"Settings",template:a(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){const e=this.get("language"),t=[{id:r.DECODER,name:e.SETTING_TAB_DECODER},{id:r.PLAY,name:e.SETTING_TAB_PLAY},{id:r.SUBTITLE,name:e.SETTING_TAB_SUBTITLE},{id:r.VIDEO,name:e.SETTING_TAB_VIDEO},{id:r.AUDIO,name:e.SETTING_TAB_AUDIO},{id:r.FILTER,name:e.SETTING_TAB_FILTER},{id:r.KEYBOARD,name:e.SETTING_TAB_KEYBOARD},{id:r.LANGUAGE,name:e.SETTING_TAB_LANGUAGE},{id:r.SKIN,name:e.SETTING_TAB_SKIN}];return{style:o(),tab:r.DECODER,list:t}},methods:{close:function(){this.fire("closeSettings")}},afterMount(){this.namespace=".component_settings"+Math.random()},beforeDestroy(){const e=this.get("player");this.namespace&&e.off(this.namespace)}}},72913:(e,t,i)=>{"use strict";i.d(t,{J:()=>r});const r="folderLoaded"},93269:(e,t,i)=>{"use strict";i.r(t),i.d(t,{BUTTON_ADD:()=>x,CHECKBOX_LIVE:()=>k,CONTROL_AUDIO_TRACK:()=>m,CONTROL_PLAYRATE:()=>p,CONTROL_SUBTITLE_TRACK:()=>v,CONTROL_SUBTITLE_TRACK_ADD:()=>y,CONTROL_VIDEO_TRACK:()=>g,FOLDER_OPEN_DIR:()=>A,FOLDER_OPEN_FILE:()=>b,FOLDER_OPEN_URL_PLACEHOLDER:()=>w,INFO_TITLE:()=>B,LOADING_MESSAGE_ANALYZE_FILE:()=>I,LOADING_MESSAGE_LOAD_AUDIO_DECODER:()=>S,LOADING_MESSAGE_LOAD_END:()=>_,LOADING_MESSAGE_LOAD_FAILED:()=>M,LOADING_MESSAGE_LOAD_VIDEO_DECODER:()=>P,LOADING_MESSAGE_OPEN_FILE:()=>T,LOADING_MESSAGE_RESUME:()=>C,MENU_STATS:()=>E,SETTINGS_TITLE:()=>D,SETTING_TAB_AUDIO:()=>F,SETTING_TAB_DECODER:()=>R,SETTING_TAB_FILTER:()=>O,SETTING_TAB_KEYBOARD:()=>N,SETTING_TAB_LANGUAGE:()=>z,SETTING_TAB_PLAY:()=>U,SETTING_TAB_SKIN:()=>V,SETTING_TAB_SUBTITLE:()=>L,SETTING_TAB_VIDEO:()=>$,TIP_DELETE:()=>f,TIP_FOLD:()=>h,TIP_FULLSCREEN:()=>n,TIP_LOOP_START:()=>o,TIP_LOOP_STOP:()=>c,TIP_PAUSE:()=>s,TIP_PIP_START:()=>l,TIP_PIP_STOP:()=>d,TIP_PLAY:()=>r,TIP_SETTING:()=>a,TIP_UNFOLD:()=>u});const r="",s="",a="",n="",o="",c="",l="",d="",h="",u="",f="",p="",m="",g="",v="",y="",A="",b="",w="",x="",k="",T="...",I="(${mux})...",S="(${decoder})...",P="(${decoder})...",_=" (`)",M=" ()",C="",B="",E="",D="",R="",U="",L="",$="",F="",O="",N="",z="",V=""},69094:(e,t,i)=>{"use strict";i.r(t),i.d(t,{BUTTON_ADD:()=>w,CHECKBOX_LIVE:()=>x,CONTROL_AUDIO_TRACK:()=>p,CONTROL_PLAYRATE:()=>f,CONTROL_SUBTITLE_TRACK:()=>g,CONTROL_SUBTITLE_TRACK_ADD:()=>v,CONTROL_VIDEO_TRACK:()=>m,FOLDER_OPEN_DIR:()=>y,FOLDER_OPEN_FILE:()=>A,FOLDER_OPEN_URL_PLACEHOLDER:()=>b,INFO_TITLE:()=>C,LOADING_MESSAGE_ANALYZE_FILE:()=>T,LOADING_MESSAGE_LOAD_AUDIO_DECODER:()=>I,LOADING_MESSAGE_LOAD_END:()=>P,LOADING_MESSAGE_LOAD_FAILED:()=>_,LOADING_MESSAGE_LOAD_VIDEO_DECODER:()=>S,LOADING_MESSAGE_OPEN_FILE:()=>k,LOADING_MESSAGE_RESUME:()=>M,MENU_STATS:()=>B,SETTINGS_TITLE:()=>E,SETTING_TAB_AUDIO:()=>$,SETTING_TAB_DECODER:()=>D,SETTING_TAB_FILTER:()=>F,SETTING_TAB_KEYBOARD:()=>O,SETTING_TAB_LANGUAGE:()=>N,SETTING_TAB_PLAY:()=>R,SETTING_TAB_SKIN:()=>z,SETTING_TAB_SUBTITLE:()=>U,SETTING_TAB_VIDEO:()=>L,TIP_DELETE:()=>u,TIP_FOLD:()=>d,TIP_FULLSCREEN:()=>n,TIP_LOOP_START:()=>o,TIP_LOOP_STOP:()=>c,TIP_PAUSE:()=>s,TIP_PIP:()=>l,TIP_PLAY:()=>r,TIP_SETTING:()=>a,TIP_UNFOLD:()=>h});const r="Play",s="Pause",a="Settings",n="Fullscreen",o="Open Loop",c="Close Loop",l="Picture In Picture",d="Fold",h="Unfold",u="Delete",f="Speed",p="Audio",m="Video",g="Subtitle",v="Add",y="Open Fold",A="Open File",b="Input Url",w="Add",x="Live",k="opening source...",T="analyzing source(${mux})...",I="loading audio decoder(${decoder})...",S="loading video decoder(${decoder})...",P="readied (`)",_="failed ()",M="Click on the screen or volume button in footer to unmute audio",C="Stats Info",B="Source Stats Info",E="Settings",D="Decoder",R="Play",U="Subtitle",L="Picture",$="Sound",F="Filter",O="Shortcut",N="Language",z="Skin"},6204:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(93269),s=i(69094),a=i(8507),n=i(11302);const o={chinese:1,chinese_traditional:1,english:1};function c(){let e=a.mA(location.search).language;switch(o[e]||(e=n.Jt(n.f7),e||(e=(navigator.systemLanguage||navigator.browserLanguage||navigator.userLanguage||navigator.language).toLowerCase(),e=e.indexOf("en")>-1?"english":e.indexOf("zh-hk")>-1||e.indexOf("zh-tw")>-1?"chinese_traditional":(e.indexOf("zh"),"chinese")),n.hZ(n.f7,e)),e){case"chinese":default:return r;case"english":return s}}},53924:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(82042);const s={name:"slider",model:"value",template:i.n(r)(),propTypes:{value:{type:"number",required:!0},max:{type:"number",value:100},min:{type:"number",value:0},step:{type:"number",value:1},direction:{type:"string",value:"vertical"}},data:function(){return{startX:0,startY:0,start:!1}},computed:{offset:function(){return"vertical"===this.get("direction")?`top: ${100*(1-this.get("value")/this.get("max"))}%`:`right: ${100*(1-this.get("value")/this.get("max"))}%`}},methods:{mousedown:function(e){this.set("startX",e.originalEvent.screenX),this.set("startY",e.originalEvent.screenY),this.set("start",!0)},mousemove:function(e){if(!this.get("start"))return;const t=this.get("startX"),i=this.get("startY");let r=0;const s=this.get("direction"),a=this.get("step");if("vertical"===s){const t=this.$refs.slider.offsetHeight;r=-(e.screenY-i)/t*this.get("max")*a}else if("horizontal"===s){const i=this.$refs.slider.offsetWidth;r=(e.screenX-t)/i*this.get("max")*a}let n=this.get("value")+r;n<this.get("min")&&(n=this.get("min")),n>this.get("max")&&(n=this.get("max")),this.set("value",Math.round(n)),this.set("startX",e.screenX),this.set("startY",e.screenY)},mouseup:function(){this.get("start")&&this.set("start",!1)}},afterMount(){this.onmouseup=e=>{this.mouseup()},this.onmousemove=e=>{this.mousemove(e)},document.addEventListener("mouseup",this.onmouseup),document.addEventListener("mousemove",this.onmousemove)},beforeDestroy(){document.removeEventListener("mouseup",this.onmouseup),document.removeEventListener("mousemove",this.onmousemove)}}},66521:(e,t,i)=>{"use strict";i.d(t,{Hh:()=>h,M_:()=>u,qd:()=>a});var r=i(54001),s=i.n(r);const a="libmedia_folder_root",n="libmedia_db",o="store";let c,l;async function d(){return l=new(s())(((e,t)=>{const i=indexedDB.open(n,1);i.onupgradeneeded=function(e){c=e.target.result,c.objectStoreNames.contains(o)||c.createObjectStore(o,{keyPath:"id",autoIncrement:!0}).createIndex("name","name",{unique:!1})},i.onsuccess=function(t){c=t.target.result,e()},i.onerror=function(e){t(e)}})),l}async function h(e){return c||(l?await l:await d()),new(s())(((t,i)=>{const r=c.transaction([o],"readwrite").objectStore(o).index("name").get(e);r.onsuccess=function(e){var i;t(null===(i=e.target.result)||void 0===i?void 0:i.data)},r.onerror=function(e){i(e)}}))}async function u(e,t){return c||(l?await l:await d()),new(s())(((i,r)=>{const s=c.transaction([o],"readwrite").objectStore(o),a=s.index("name").get(e);a.onsuccess=function(a){if(a.target.result){const n=s.put({id:a.target.result.id,name:e,data:t});n.onsuccess=function(){i()},n.onerror=function(e){r(e)}}else{const a=s.put({name:e,data:t});a.onsuccess=function(){i()},a.onerror=function(e){r(e)}}},a.onerror=function(e){r(e)}}))}},64804:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r={on:function(e,t,i){setTimeout((function(){document.addEventListener("click",t.onOutside=function(i){let r=i.target;r.parentNode&&!e.contains(r)&&t(i)})}),0)},off:function(e,t,i){t.onOutside&&(document.removeEventListener("click",t.onOutside),t.onOutside=null)}}},11302:(e,t,i)=>{"use strict";i.d(t,{Jt:()=>c,Yt:()=>a,f7:()=>s,hZ:()=>o,vd:()=>n,xc:()=>r});const r="libmedia_volume",s="libmedia_system_language",a="libmedia_play_rate",n="libmedia_play_loop";function o(e,t){localStorage.setItem(e,t)}function c(e,t){const i=localStorage.getItem(e);return null==i?t:i}},34268:(e,t,i)=>{"use strict";var r=i(134),s=i(54001),a=i.n(s),n=i(84149),o=i(87503),c=i(67672),l=i(4624),d=i(44690);let h=d.A.windows||d.A.mac||d.A.linux?10:20;class u extends o.A{constructor(){super(),(0,r.A)(this,"pullIPC",void 0),(0,r.A)(this,"frontBuffer",void 0),(0,r.A)(this,"backBuffer",void 0),(0,r.A)(this,"channels",void 0),(0,r.A)(this,"backBufferOffset",void 0),(0,r.A)(this,"ended",void 0),(0,r.A)(this,"frontBuffered",void 0),(0,r.A)(this,"pause",void 0),(0,r.A)(this,"firstRendered",void 0),(0,r.A)(this,"stopped",void 0),(0,r.A)(this,"afterPullResolve",void 0),(0,r.A)(this,"lastStutterTimestamp",void 0),this.ended=!1,this.pause=!0,this.ipcPort.on(n.S3,(async e=>{switch(e.method){case"init":e.params&&e.params.bufferLength&&(h=e.params.bufferLength),this.ipcPort.reply(e);break;case"start":{const{port:t,channels:i}=e.params;this.channels=i,this.pullIPC=new n.Ay(t);const r=[],s=[];await this.pull(r),await this.pull(s),this.frontBuffer=s,this.backBuffer=r,this.backBufferOffset=0,this.ended=!1,this.frontBuffered=!0,this.pause=!1,this.firstRendered=!1,this.stopped=!1,this.lastStutterTimestamp=currentTime,this.ipcPort.reply(e);break}case"restart":{if(!this.ended)return void this.ipcPort.reply(e);const t=[],i=[];await this.pull(t),await this.pull(i),this.frontBuffer=i,this.backBuffer=t,this.backBufferOffset=0,this.ended=!1,this.frontBuffered=!0,this.pause=!1,this.firstRendered=!1,this.stopped=!1,this.lastStutterTimestamp=currentTime,this.ipcPort.reply(e);break}case"clear":this.backBufferOffset=h,this.ipcPort.reply(e);break;case"stop":this.ended||this.pause||this.frontBuffered||await new(a())((e=>{this.afterPullResolve=e})),this.stopped=!0,this.pullIPC.destroy(),this.ipcPort.reply(e);break;case"pause":this.pause=!0,this.ipcPort.reply(e);break;case"unpause":this.pause=!1,this.ipcPort.reply(e)}}))}async pull(e){const t=await this.pullIPC.request("pullBuffer",{nbSamples:128*h});if(c.ai(t))this.ended=!0;else{const i=new Float32Array(t);for(let t=0;t<this.channels;t++)e[t]=i.subarray(t*h*128,(t+1)*h*128)}this.afterPullResolve&&this.afterPullResolve()}swapBuffer(){return!!this.frontBuffered&&(this.backBuffer=this.frontBuffer,this.backBufferOffset=0,this.frontBuffer=[],this.frontBuffered=!1,this.pull(this.frontBuffer).then((()=>{this.frontBuffered=!0})),!0)}process(e,t,i){if(this.stopped)return!1;if(this.backBuffer&&!this.pause){if(this.backBufferOffset===h){if(this.ended)return this.backBuffer=null,this.frontBuffer=null,l.pq("audio source ended","src/avrender/pcm/AudioSourceWorkletProcessor.ts",207),this.ipcPort.notify("ended"),!0;if(!this.swapBuffer())return currentTime-this.lastStutterTimestamp>1&&(this.ipcPort.notify("stutter"),this.lastStutterTimestamp=currentTime),!0}const e=t[0];for(let t=0;t<this.channels;t++)e[t].set(this.backBuffer[t].subarray(128*this.backBufferOffset,128*(this.backBufferOffset+1)),0);this.backBufferOffset++,this.firstRendered||(this.firstRendered=!0,this.ipcPort.notify("firstRendered"))}return!0}}registerProcessor("audio-source-processor",u)},5676:(e,t,i)=>{"use strict";var r=i(134),s=i(54001),a=i.n(s),n=i(63939),o=i(50932),c=i(84149),l=i(87503),d=i(11473),h=(i(10278),i(37837)),u=i(4624),f=i(44690);let p=f.A.windows||f.A.mac||f.A.linux?10:20;class m extends l.A{constructor(){super(),(0,r.A)(this,"pullIPC",void 0),(0,r.A)(this,"frontBuffer",void 0),(0,r.A)(this,"backBuffer",void 0),(0,r.A)(this,"channels",void 0),(0,r.A)(this,"backBufferOffset",void 0),(0,r.A)(this,"ended",void 0),(0,r.A)(this,"frontBuffered",void 0),(0,r.A)(this,"firstRendered",void 0),(0,r.A)(this,"pause",void 0),(0,r.A)(this,"stopped",void 0),(0,r.A)(this,"afterPullResolve",void 0),(0,r.A)(this,"lastStutterTimestamp",void 0),this.ended=!1,this.pause=!0,this.ipcPort.on(c.S3,(async e=>{switch(e.method){case"init":{const{memory:t,bufferLength:i}=e.params;e.params.bufferLength&&(p=i),await(0,d.Tg)({memory:t,disableAsm:!0}),this.ipcPort.reply(e);break}case"start":{const{port:t,channels:i}=e.params;this.channels=i,this.pullIPC=new c.Ay(t);const r=this.allocBuffer(),s=this.allocBuffer();await this.pullIPC.request("pull",{buffer:s}),await this.pullIPC.request("pull",{buffer:r}),this.frontBuffer=r,this.backBuffer=s,this.backBufferOffset=0,this.ended=!1,this.pause=!1,this.frontBuffered=!0,this.firstRendered=!1,this.stopped=!1,this.lastStutterTimestamp=currentTime,this.ipcPort.reply(e);break}case"restart":{if(!this.ended)return void this.ipcPort.reply(e);const t=this.backBuffer?this.backBuffer:this.allocBuffer(),i=this.frontBuffer?this.frontBuffer:this.allocBuffer();await this.pullIPC.request("pull",{buffer:i}),await this.pullIPC.request("pull",{buffer:t}),this.frontBuffer=t,this.backBuffer=i,this.backBufferOffset=0,this.ended=!1,this.pause=!1,this.frontBuffered=!0,this.firstRendered=!1,this.stopped=!1,this.lastStutterTimestamp=currentTime,this.ipcPort.reply(e);break}case"stop":this.ended||this.pause||this.frontBuffered||await new(a())((e=>{this.afterPullResolve=e})),this.freeBuffer(this.backBuffer),this.freeBuffer(this.frontBuffer),this.backBuffer=0,this.frontBuffer=0,this.stopped=!0,this.pullIPC.destroy(),this.ipcPort.reply(e);break;case"clear":this.backBufferOffset=p,this.ipcPort.reply(e);break;case"pause":this.pause=!0,this.ipcPort.reply(e);break;case"unpause":this.pause=!1,this.ipcPort.reply(e)}}))}allocBuffer(){const e=(0,h.Gy)(48);o.M[20](e,(0,h.Gy)(4*this.channels)),o.M[15](e+16,this.channels);const t=(0,h.Gy)(512*p*this.channels);for(let i=0;i<this.channels;i++)o.M[20](n.f[20](e)+4*i,t+128*p*4*i);return o.M[15](e+12,128*p),e}freeBuffer(e){e&&((0,h.aI)(n.f[20](e)),(0,h.aI)(e),(0,h.Eb)(e))}async pull(){await this.pullIPC.request("pull",{buffer:this.frontBuffer})<0&&(this.ended=!0),this.afterPullResolve&&this.afterPullResolve()}swapBuffer(){if(!this.frontBuffered)return!1;{const e=this.backBuffer;this.backBuffer=this.frontBuffer,this.frontBuffer=e,this.backBufferOffset=0}return this.frontBuffered=!1,this.pull().then((()=>{this.frontBuffered=!0})),!0}process(e,t,i){if(this.stopped)return!1;if(this.backBuffer&&!this.pause){if(this.backBufferOffset===p){if(this.ended)return this.freeBuffer(this.backBuffer),this.freeBuffer(this.frontBuffer),this.backBuffer=0,this.frontBuffer=0,u.pq("audio source ended","src/avrender/pcm/AudioSourceWorkletProcessor2.ts",246),this.ipcPort.notify("ended"),!0;if(!this.swapBuffer())return currentTime-this.lastStutterTimestamp>1&&(this.ipcPort.notify("stutter"),this.lastStutterTimestamp=currentTime),!0}const e=t[0];for(let t=0;t<this.channels;t++)e[t].set(new Float32Array((0,d.Lv)(),n.f[20](n.f[20](this.backBuffer)+4*t)+128*this.backBufferOffset*4,128),0);this.backBufferOffset++,this.firstRendered||(this.firstRendered=!0,this.ipcPort.notify("firstRendered"))}return!0}}registerProcessor("audio-source-processor",m)},87503:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(134),s=i(84149);class a extends AudioWorkletProcessor{constructor(){super(),(0,r.A)(this,"ipcPort",void 0),this.ipcPort=new s.Ay(this.port)}async request(e,t,i){return this.ipcPort.request(e,t,i)}notify(e,t,i){this.ipcPort.notify(e,t,i)}}},74385:(e,t,i)=>{i(97863),i(25263),e.exports=i(46438).Array.from},37149:(e,t,i)=>{i(18355),e.exports=i(46438).Array.isArray},87172:(e,t,i)=>{i(23204),e.exports=i(46438).Date.now},85079:(e,t,i)=>{var r=i(46438),s=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return s.stringify.apply(s,arguments)}},92861:(e,t,i)=>{i(78978),i(97863),i(7914),i(96050),i(28337),i(74674),i(62223),e.exports=i(46438).Map},11837:(e,t,i)=>{i(21489),e.exports=i(46438).Number.isNaN},92696:(e,t,i)=>{i(74712);var r=i(46438).Object;e.exports=function(e,t,i){return r.defineProperty(e,t,i)}},22948:(e,t,i)=>{i(51780),e.exports=i(46438).Object.freeze},62160:(e,t,i)=>{i(18128),e.exports=i(46438).Object.getPrototypeOf},47567:(e,t,i)=>{i(96847),e.exports=i(46438).Object.keys},21724:(e,t,i)=>{i(4284),e.exports=i(46438).Object.setPrototypeOf},27279:(e,t,i)=>{i(95828),e.exports=i(46438).parseFloat},25216:(e,t,i)=>{i(65331),e.exports=i(46438).parseInt},34750:(e,t,i)=>{i(78978),i(97863),i(7914),i(91229),i(2639),i(46121),e.exports=i(46438).Promise},31707:(e,t,i)=>{i(66801),e.exports=i(46438).setImmediate},16560:(e,t,i)=>{i(19626),i(78978),i(42860),i(60716),e.exports=i(46438).Symbol},54220:(e,t,i)=>{i(97863),i(7914),e.exports=i(84336).f("iterator")},39967:(e,t,i)=>{e.exports=i(84336).f("toPrimitive")},48652:(e,t,i)=>{i(78978),e.exports=i(84336).f("toStringTag")},25219:e=>{e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},12560:e=>{e.exports=function(){}},2832:e=>{e.exports=function(e,t,i,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(i+": incorrect invocation!");return e}},80812:(e,t,i)=>{var r=i(24401);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},77076:(e,t,i)=>{var r=i(95838);e.exports=function(e,t){var i=[];return r(e,!1,i.push,i,t),i}},84448:(e,t,i)=>{var r=i(65133),s=i(70181),a=i(72917);e.exports=function(e){return function(t,i,n){var o,c=r(t),l=s(c.length),d=a(n,l);if(e&&i!=i){for(;l>d;)if((o=c[d++])!=o)return!0}else for(;l>d;d++)if((e||d in c)&&c[d]===i)return e||d||0;return!e&&-1}}},48219:(e,t,i)=>{var r=i(58852),s=i(7001),a=i(66310),n=i(70181),o=i(99244);e.exports=function(e,t){var i=1==e,c=2==e,l=3==e,d=4==e,h=6==e,u=5==e||h,f=t||o;return function(t,o,p){for(var m,g,v=a(t),y=s(v),A=r(o,p,3),b=n(y.length),w=0,x=i?f(t,b):c?f(t,0):void 0;b>w;w++)if((u||w in y)&&(g=A(m=y[w],w,v),e))if(i)x[w]=g;else if(g)switch(e){case 3:return!0;case 5:return m;case 6:return w;case 2:x.push(m)}else if(d)return!1;return h?-1:l||d?d:x}}},49742:(e,t,i)=>{var r=i(24401),s=i(15461),a=i(30254)("species");e.exports=function(e){var t;return s(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!s(t.prototype)||(t=void 0),r(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?Array:t}},99244:(e,t,i)=>{var r=i(49742);e.exports=function(e,t){return new(r(e))(t)}},44968:(e,t,i)=>{var r=i(93417),s=i(30254)("toStringTag"),a="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,i,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),s))?i:a?r(t):"Object"==(n=r(t))&&"function"==typeof t.callee?"Arguments":n}},93417:e=>{var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},95933:(e,t,i)=>{"use strict";var r=i(78423).f,s=i(22087),a=i(30953),n=i(58852),o=i(2832),c=i(95838),l=i(88839),d=i(20322),h=i(45274),u=i(58219),f=i(75172).fastKey,p=i(6096),m=u?"_s":"size",g=function(e,t){var i,r=f(t);if("F"!==r)return e._i[r];for(i=e._f;i;i=i.n)if(i.k==t)return i};e.exports={getConstructor:function(e,t,i,l){var d=e((function(e,r){o(e,d,t,"_i"),e._t=t,e._i=s(null),e._f=void 0,e._l=void 0,e[m]=0,null!=r&&c(r,i,e[l],e)}));return a(d.prototype,{clear:function(){for(var e=p(this,t),i=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete i[r.i];e._f=e._l=void 0,e[m]=0},delete:function(e){var i=p(this,t),r=g(i,e);if(r){var s=r.n,a=r.p;delete i._i[r.i],r.r=!0,a&&(a.n=s),s&&(s.p=a),i._f==r&&(i._f=s),i._l==r&&(i._l=a),i[m]--}return!!r},forEach:function(e){p(this,t);for(var i,r=n(e,arguments.length>1?arguments[1]:void 0,3);i=i?i.n:this._f;)for(r(i.v,i.k,this);i&&i.r;)i=i.p},has:function(e){return!!g(p(this,t),e)}}),u&&r(d.prototype,"size",{get:function(){return p(this,t)[m]}}),d},def:function(e,t,i){var r,s,a=g(e,t);return a?a.v=i:(e._l=a={i:s=f(t,!0),k:t,v:i,p:r=e._l,n:void 0,r:!1},e._f||(e._f=a),r&&(r.n=a),e[m]++,"F"!==s&&(e._i[s]=a)),e},getEntry:g,setStrong:function(e,t,i){l(e,t,(function(e,i){this._t=p(e,t),this._k=i,this._l=void 0}),(function(){for(var e=this,t=e._k,i=e._l;i&&i.r;)i=i.p;return e._t&&(e._l=i=i?i.n:e._t._f)?d(0,"keys"==t?i.k:"values"==t?i.v:[i.k,i.v]):(e._t=void 0,d(1))}),i?"entries":"values",!i,!0),h(t)}}},5874:(e,t,i)=>{var r=i(44968),s=i(77076);e.exports=function(e){return function(){if(r(this)!=e)throw TypeError(e+"#toJSON isn't generic");return s(this)}}},99373:(e,t,i)=>{"use strict";var r=i(66670),s=i(88535),a=i(75172),n=i(81984),o=i(2677),c=i(30953),l=i(95838),d=i(2832),h=i(24401),u=i(1356),f=i(78423).f,p=i(48219)(0),m=i(58219);e.exports=function(e,t,i,g,v,y){var A=r[e],b=A,w=v?"set":"add",x=b&&b.prototype,k={};return m&&"function"==typeof b&&(y||x.forEach&&!n((function(){(new b).entries().next()})))?(b=t((function(t,i){d(t,b,e,"_c"),t._c=new A,null!=i&&l(i,v,t[w],t)})),p("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(e){var t="add"==e||"set"==e;!(e in x)||y&&"clear"==e||o(b.prototype,e,(function(i,r){if(d(this,b,e),!t&&y&&!h(i))return"get"==e&&void 0;var s=this._c[e](0===i?0:i,r);return t?this:s}))})),y||f(b.prototype,"size",{get:function(){return this._c.size}})):(b=g.getConstructor(t,e,v,w),c(b.prototype,i),a.NEED=!0),u(b,e),k[e]=b,s(s.G+s.W+s.F,k),y||g.setStrong(b,e,v),b}},46438:e=>{var t=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=t)},31891:(e,t,i)=>{"use strict";var r=i(78423),s=i(86260);e.exports=function(e,t,i){t in e?r.f(e,t,s(0,i)):e[t]=i}},58852:(e,t,i)=>{var r=i(25219);e.exports=function(e,t,i){if(r(e),void 0===t)return e;switch(i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,r){return e.call(t,i,r)};case 3:return function(i,r,s){return e.call(t,i,r,s)}}return function(){return e.apply(t,arguments)}}},87608:e=>{e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},58219:(e,t,i)=>{e.exports=!i(81984)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},3802:(e,t,i)=>{var r=i(24401),s=i(66670).document,a=r(s)&&r(s.createElement);e.exports=function(e){return a?s.createElement(e):{}}},77956:e=>{e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},36473:(e,t,i)=>{var r=i(54311),s=i(59820),a=i(36569);e.exports=function(e){var t=r(e),i=s.f;if(i)for(var n,o=i(e),c=a.f,l=0;o.length>l;)c.call(e,n=o[l++])&&t.push(n);return t}},88535:(e,t,i)=>{var r=i(66670),s=i(46438),a=i(58852),n=i(2677),o=i(75509),c="prototype",l=function(e,t,i){var d,h,u,f=e&l.F,p=e&l.G,m=e&l.S,g=e&l.P,v=e&l.B,y=e&l.W,A=p?s:s[t]||(s[t]={}),b=A[c],w=p?r:m?r[t]:(r[t]||{})[c];for(d in p&&(i=t),i)(h=!f&&w&&void 0!==w[d])&&o(A,d)||(u=h?w[d]:i[d],A[d]=p&&"function"!=typeof w[d]?i[d]:v&&h?a(u,r):y&&w[d]==u?function(e){var t=function(t,i,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,i)}return new e(t,i,r)}return e.apply(this,arguments)};return t[c]=e[c],t}(u):g&&"function"==typeof u?a(Function.call,u):u,g&&((A.virtual||(A.virtual={}))[d]=u,e&l.R&&b&&!b[d]&&n(b,d,u)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},81984:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},95838:(e,t,i)=>{var r=i(58852),s=i(27904),a=i(12828),n=i(80812),o=i(70181),c=i(55298),l={},d={},h=e.exports=function(e,t,i,h,u){var f,p,m,g,v=u?function(){return e}:c(e),y=r(i,h,t?2:1),A=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(a(v)){for(f=o(e.length);f>A;A++)if((g=t?y(n(p=e[A])[0],p[1]):y(e[A]))===l||g===d)return g}else for(m=v.call(e);!(p=m.next()).done;)if((g=s(m,y,p.value,t))===l||g===d)return g};h.BREAK=l,h.RETURN=d},66670:e=>{var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},75509:e=>{var t={}.hasOwnProperty;e.exports=function(e,i){return t.call(e,i)}},2677:(e,t,i)=>{var r=i(78423),s=i(86260);e.exports=i(58219)?function(e,t,i){return r.f(e,t,s(1,i))}:function(e,t,i){return e[t]=i,e}},76260:(e,t,i)=>{var r=i(66670).document;e.exports=r&&r.documentElement},32484:(e,t,i)=>{e.exports=!i(58219)&&!i(81984)((function(){return 7!=Object.defineProperty(i(3802)("div"),"a",{get:function(){return 7}}).a}))},20709:e=>{e.exports=function(e,t,i){var r=void 0===i;switch(t.length){case 0:return r?e():e.call(i);case 1:return r?e(t[0]):e.call(i,t[0]);case 2:return r?e(t[0],t[1]):e.call(i,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(i,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(i,t[0],t[1],t[2],t[3])}return e.apply(i,t)}},7001:(e,t,i)=>{var r=i(93417);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},12828:(e,t,i)=>{var r=i(20210),s=i(30254)("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||a[s]===e)}},15461:(e,t,i)=>{var r=i(93417);e.exports=Array.isArray||function(e){return"Array"==r(e)}},24401:e=>{e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},27904:(e,t,i)=>{var r=i(80812);e.exports=function(e,t,i,s){try{return s?t(r(i)[0],i[1]):t(i)}catch(t){var a=e.return;throw void 0!==a&&r(a.call(e)),t}}},48248:(e,t,i)=>{"use strict";var r=i(22087),s=i(86260),a=i(1356),n={};i(2677)(n,i(30254)("iterator"),(function(){return this})),e.exports=function(e,t,i){e.prototype=r(n,{next:s(1,i)}),a(e,t+" Iterator")}},88839:(e,t,i)=>{"use strict";var r=i(74742),s=i(88535),a=i(61331),n=i(2677),o=i(20210),c=i(48248),l=i(1356),d=i(66123),h=i(30254)("iterator"),u=!([].keys&&"next"in[].keys()),f="keys",p="values",m=function(){return this};e.exports=function(e,t,i,g,v,y,A){c(i,t,g);var b,w,x,k=function(e){if(!u&&e in P)return P[e];switch(e){case f:case p:return function(){return new i(this,e)}}return function(){return new i(this,e)}},T=t+" Iterator",I=v==p,S=!1,P=e.prototype,_=P[h]||P["@@iterator"]||v&&P[v],M=_||k(v),C=v?I?k("entries"):M:void 0,B="Array"==t&&P.entries||_;if(B&&(x=d(B.call(new e)))!==Object.prototype&&x.next&&(l(x,T,!0),r||"function"==typeof x[h]||n(x,h,m)),I&&_&&_.name!==p&&(S=!0,M=function(){return _.call(this)}),r&&!A||!u&&!S&&P[h]||n(P,h,M),o[t]=M,o[T]=m,v)if(b={values:I?M:k(p),keys:y?M:k(f),entries:C},A)for(w in b)w in P||a(P,w,b[w]);else s(s.P+s.F*(u||S),t,b);return b}},27899:(e,t,i)=>{var r=i(30254)("iterator"),s=!1;try{var a=[7][r]();a.return=function(){s=!0},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!s)return!1;var i=!1;try{var a=[7],n=a[r]();n.next=function(){return{done:i=!0}},a[r]=function(){return n},e(a)}catch(e){}return i}},20322:e=>{e.exports=function(e,t){return{value:t,done:!!e}}},20210:e=>{e.exports={}},74742:e=>{e.exports=!0},75172:(e,t,i)=>{var r=i(19191)("meta"),s=i(24401),a=i(75509),n=i(78423).f,o=0,c=Object.isExtensible||function(){return!0},l=!i(81984)((function(){return c(Object.preventExtensions({}))})),d=function(e){n(e,r,{value:{i:"O"+ ++o,w:{}}})},h=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!s(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,r)){if(!c(e))return"F";if(!t)return"E";d(e)}return e[r].i},getWeak:function(e,t){if(!a(e,r)){if(!c(e))return!0;if(!t)return!1;d(e)}return e[r].w},onFreeze:function(e){return l&&h.NEED&&c(e)&&!a(e,r)&&d(e),e}}},53792:(e,t,i)=>{var r=i(66670),s=i(8036).set,a=r.MutationObserver||r.WebKitMutationObserver,n=r.process,o=r.Promise,c="process"==i(93417)(n);e.exports=function(){var e,t,i,l=function(){var r,s;for(c&&(r=n.domain)&&r.exit();e;){s=e.fn,e=e.next;try{s()}catch(r){throw e?i():t=void 0,r}}t=void 0,r&&r.enter()};if(c)i=function(){n.nextTick(l)};else if(!a||r.navigator&&r.navigator.standalone)if(o&&o.resolve){var d=o.resolve(void 0);i=function(){d.then(l)}}else i=function(){s.call(r,l)};else{var h=!0,u=document.createTextNode("");new a(l).observe(u,{characterData:!0}),i=function(){u.data=h=!h}}return function(r){var s={fn:r,next:void 0};t&&(t.next=s),e||(e=s,i()),t=s}}},11642:(e,t,i)=>{"use strict";var r=i(25219);function s(e){var t,i;this.promise=new e((function(e,r){if(void 0!==t||void 0!==i)throw TypeError("Bad Promise constructor");t=e,i=r})),this.resolve=r(t),this.reject=r(i)}e.exports.f=function(e){return new s(e)}},22087:(e,t,i)=>{var r=i(80812),s=i(90082),a=i(77956),n=i(4566)("IE_PROTO"),o=function(){},c="prototype",l=function(){var e,t=i(3802)("iframe"),r=a.length;for(t.style.display="none",i(76260).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;r--;)delete l[c][a[r]];return l()};e.exports=Object.create||function(e,t){var i;return null!==e?(o[c]=r(e),i=new o,o[c]=null,i[n]=e):i=l(),void 0===t?i:s(i,t)}},78423:(e,t,i)=>{var r=i(80812),s=i(32484),a=i(10752),n=Object.defineProperty;t.f=i(58219)?Object.defineProperty:function(e,t,i){if(r(e),t=a(t,!0),r(i),s)try{return n(e,t,i)}catch(e){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(e[t]=i.value),e}},90082:(e,t,i)=>{var r=i(78423),s=i(80812),a=i(54311);e.exports=i(58219)?Object.defineProperties:function(e,t){s(e);for(var i,n=a(t),o=n.length,c=0;o>c;)r.f(e,i=n[c++],t[i]);return e}},81033:(e,t,i)=>{var r=i(36569),s=i(86260),a=i(65133),n=i(10752),o=i(75509),c=i(32484),l=Object.getOwnPropertyDescriptor;t.f=i(58219)?l:function(e,t){if(e=a(e),t=n(t,!0),c)try{return l(e,t)}catch(e){}if(o(e,t))return s(!r.f.call(e,t),e[t])}},36309:(e,t,i)=>{var r=i(65133),s=i(1743).f,a={}.toString,n="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return n&&"[object Window]"==a.call(e)?function(e){try{return s(e)}catch(e){return n.slice()}}(e):s(r(e))}},1743:(e,t,i)=>{var r=i(85081),s=i(77956).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,s)}},59820:(e,t)=>{t.f=Object.getOwnPropertySymbols},66123:(e,t,i)=>{var r=i(75509),s=i(66310),a=i(4566)("IE_PROTO"),n=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=s(e),r(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?n:null}},85081:(e,t,i)=>{var r=i(75509),s=i(65133),a=i(84448)(!1),n=i(4566)("IE_PROTO");e.exports=function(e,t){var i,o=s(e),c=0,l=[];for(i in o)i!=n&&r(o,i)&&l.push(i);for(;t.length>c;)r(o,i=t[c++])&&(~a(l,i)||l.push(i));return l}},54311:(e,t,i)=>{var r=i(85081),s=i(77956);e.exports=Object.keys||function(e){return r(e,s)}},36569:(e,t)=>{t.f={}.propertyIsEnumerable},47331:(e,t,i)=>{var r=i(88535),s=i(46438),a=i(81984);e.exports=function(e,t){var i=(s.Object||{})[e]||Object[e],n={};n[e]=t(i),r(r.S+r.F*a((function(){i(1)})),"Object",n)}},49709:(e,t,i)=>{var r=i(66670).parseFloat,s=i(24269).trim;e.exports=1/r(i(80459)+"-0")!=-1/0?function(e){var t=s(String(e),3),i=r(t);return 0===i&&"-"==t.charAt(0)?-0:i}:r},15722:(e,t,i)=>{var r=i(66670).parseInt,s=i(24269).trim,a=i(80459),n=/^[-+]?0[xX]/;e.exports=8!==r(a+"08")||22!==r(a+"0x16")?function(e,t){var i=s(String(e),3);return r(i,t>>>0||(n.test(i)?16:10))}:r},41704:e=>{e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},61037:(e,t,i)=>{var r=i(80812),s=i(24401),a=i(11642);e.exports=function(e,t){if(r(e),s(t)&&t.constructor===e)return t;var i=a.f(e);return(0,i.resolve)(t),i.promise}},86260:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},30953:(e,t,i)=>{var r=i(2677);e.exports=function(e,t,i){for(var s in t)i&&e[s]?e[s]=t[s]:r(e,s,t[s]);return e}},61331:(e,t,i)=>{e.exports=i(2677)},643:(e,t,i)=>{"use strict";var r=i(88535),s=i(25219),a=i(58852),n=i(95838);e.exports=function(e){r(r.S,e,{from:function(e){var t,i,r,o,c=arguments[1];return s(this),(t=void 0!==c)&&s(c),null==e?new this:(i=[],t?(r=0,o=a(c,arguments[2],2),n(e,!1,(function(e){i.push(o(e,r++))}))):n(e,!1,i.push,i),new this(i))}})}},44398:(e,t,i)=>{"use strict";var r=i(88535);e.exports=function(e){r(r.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},32074:(e,t,i)=>{var r=i(24401),s=i(80812),a=function(e,t){if(s(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=i(58852)(Function.call,i(81033).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,i){return a(e,i),t?e.__proto__=i:r(e,i),e}}({},!1):void 0),check:a}},45274:(e,t,i)=>{"use strict";var r=i(66670),s=i(46438),a=i(78423),n=i(58219),o=i(30254)("species");e.exports=function(e){var t="function"==typeof s[e]?s[e]:r[e];n&&t&&!t[o]&&a.f(t,o,{configurable:!0,get:function(){return this}})}},1356:(e,t,i)=>{var r=i(78423).f,s=i(75509),a=i(30254)("toStringTag");e.exports=function(e,t,i){e&&!s(e=i?e:e.prototype,a)&&r(e,a,{configurable:!0,value:t})}},4566:(e,t,i)=>{var r=i(96308)("keys"),s=i(19191);e.exports=function(e){return r[e]||(r[e]=s(e))}},96308:(e,t,i)=>{var r=i(46438),s=i(66670),a="__core-js_shared__",n=s[a]||(s[a]={});(e.exports=function(e,t){return n[e]||(n[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:i(74742)?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},85614:(e,t,i)=>{var r=i(80812),s=i(25219),a=i(30254)("species");e.exports=function(e,t){var i,n=r(e).constructor;return void 0===n||null==(i=r(n)[a])?t:s(i)}},43172:(e,t,i)=>{var r=i(49383),s=i(87608);e.exports=function(e){return function(t,i){var a,n,o=String(s(t)),c=r(i),l=o.length;return c<0||c>=l?e?"":void 0:(a=o.charCodeAt(c))<55296||a>56319||c+1===l||(n=o.charCodeAt(c+1))<56320||n>57343?e?o.charAt(c):a:e?o.slice(c,c+2):n-56320+(a-55296<<10)+65536}}},24269:(e,t,i)=>{var r=i(88535),s=i(87608),a=i(81984),n=i(80459),o="["+n+"]",c=RegExp("^"+o+o+"*"),l=RegExp(o+o+"*$"),d=function(e,t,i){var s={},o=a((function(){return!!n[e]()||""!=""[e]()})),c=s[e]=o?t(h):n[e];i&&(s[i]=c),r(r.P+r.F*o,"String",s)},h=d.trim=function(e,t){return e=String(s(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(l,"")),e};e.exports=d},80459:e=>{e.exports="\t\n\v\f\r \u2028\u2029\ufeff"},8036:(e,t,i)=>{var r,s,a,n=i(58852),o=i(20709),c=i(76260),l=i(3802),d=i(66670),h=d.process,u=d.setImmediate,f=d.clearImmediate,p=d.MessageChannel,m=d.Dispatch,g=0,v={},y="onreadystatechange",A=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},b=function(e){A.call(e.data)};u&&f||(u=function(e){for(var t=[],i=1;arguments.length>i;)t.push(arguments[i++]);return v[++g]=function(){o("function"==typeof e?e:Function(e),t)},r(g),g},f=function(e){delete v[e]},"process"==i(93417)(h)?r=function(e){h.nextTick(n(A,e,1))}:m&&m.now?r=function(e){m.now(n(A,e,1))}:p?(a=(s=new p).port2,s.port1.onmessage=b,r=n(a.postMessage,a,1)):d.addEventListener&&"function"==typeof postMessage&&!d.importScripts?(r=function(e){d.postMessage(e+"","*")},d.addEventListener("message",b,!1)):r=y in l("script")?function(e){c.appendChild(l("script"))[y]=function(){c.removeChild(this),A.call(e)}}:function(e){setTimeout(n(A,e,1),0)}),e.exports={set:u,clear:f}},72917:(e,t,i)=>{var r=i(49383),s=Math.max,a=Math.min;e.exports=function(e,t){return(e=r(e))<0?s(e+t,0):a(e,t)}},49383:e=>{var t=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:t)(e)}},65133:(e,t,i)=>{var r=i(7001),s=i(87608);e.exports=function(e){return r(s(e))}},70181:(e,t,i)=>{var r=i(49383),s=Math.min;e.exports=function(e){return e>0?s(r(e),9007199254740991):0}},66310:(e,t,i)=>{var r=i(87608);e.exports=function(e){return Object(r(e))}},10752:(e,t,i)=>{var r=i(24401);e.exports=function(e,t){if(!r(e))return e;var i,s;if(t&&"function"==typeof(i=e.toString)&&!r(s=i.call(e)))return s;if("function"==typeof(i=e.valueOf)&&!r(s=i.call(e)))return s;if(!t&&"function"==typeof(i=e.toString)&&!r(s=i.call(e)))return s;throw TypeError("Can't convert object to primitive value")}},19191:e=>{var t=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++t+i).toString(36))}},80218:(e,t,i)=>{var r=i(66670).navigator;e.exports=r&&r.userAgent||""},6096:(e,t,i)=>{var r=i(24401);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},67816:(e,t,i)=>{var r=i(66670),s=i(46438),a=i(74742),n=i(84336),o=i(78423).f;e.exports=function(e){var t=s.Symbol||(s.Symbol=a?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||o(t,e,{value:n.f(e)})}},84336:(e,t,i)=>{t.f=i(30254)},30254:(e,t,i)=>{var r=i(96308)("wks"),s=i(19191),a=i(66670).Symbol,n="function"==typeof a;(e.exports=function(e){return r[e]||(r[e]=n&&a[e]||(n?a:s)("Symbol."+e))}).store=r},55298:(e,t,i)=>{var r=i(44968),s=i(30254)("iterator"),a=i(20210);e.exports=i(46438).getIteratorMethod=function(e){if(null!=e)return e[s]||e["@@iterator"]||a[r(e)]}},25263:(e,t,i)=>{"use strict";var r=i(58852),s=i(88535),a=i(66310),n=i(27904),o=i(12828),c=i(70181),l=i(31891),d=i(55298);s(s.S+s.F*!i(27899)((function(e){Array.from(e)})),"Array",{from:function(e){var t,i,s,h,u=a(e),f="function"==typeof this?this:Array,p=arguments.length,m=p>1?arguments[1]:void 0,g=void 0!==m,v=0,y=d(u);if(g&&(m=r(m,p>2?arguments[2]:void 0,2)),null==y||f==Array&&o(y))for(i=new f(t=c(u.length));t>v;v++)l(i,v,g?m(u[v],v):u[v]);else for(h=y.call(u),i=new f;!(s=h.next()).done;v++)l(i,v,g?n(h,m,[s.value,v],!0):s.value);return i.length=v,i}})},18355:(e,t,i)=>{var r=i(88535);r(r.S,"Array",{isArray:i(15461)})},52293:(e,t,i)=>{"use strict";var r=i(12560),s=i(20322),a=i(20210),n=i(65133);e.exports=i(88839)(Array,"Array",(function(e,t){this._t=n(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,i=this._i++;return!e||i>=e.length?(this._t=void 0,s(1)):s(0,"keys"==t?i:"values"==t?e[i]:[i,e[i]])}),"values"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},23204:(e,t,i)=>{var r=i(88535);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},96050:(e,t,i)=>{"use strict";var r=i(95933),s=i(6096),a="Map";e.exports=i(99373)(a,(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=r.getEntry(s(this,a),e);return t&&t.v},set:function(e,t){return r.def(s(this,a),0===e?0:e,t)}},r,!0)},21489:(e,t,i)=>{var r=i(88535);r(r.S,"Number",{isNaN:function(e){return e!=e}})},74712:(e,t,i)=>{var r=i(88535);r(r.S+r.F*!i(58219),"Object",{defineProperty:i(78423).f})},51780:(e,t,i)=>{var r=i(24401),s=i(75172).onFreeze;i(47331)("freeze",(function(e){return function(t){return e&&r(t)?e(s(t)):t}}))},18128:(e,t,i)=>{var r=i(66310),s=i(66123);i(47331)("getPrototypeOf",(function(){return function(e){return s(r(e))}}))},96847:(e,t,i)=>{var r=i(66310),s=i(54311);i(47331)("keys",(function(){return function(e){return s(r(e))}}))},4284:(e,t,i)=>{var r=i(88535);r(r.S,"Object",{setPrototypeOf:i(32074).set})},78978:()=>{},95828:(e,t,i)=>{var r=i(88535),s=i(49709);r(r.G+r.F*(parseFloat!=s),{parseFloat:s})},65331:(e,t,i)=>{var r=i(88535),s=i(15722);r(r.G+r.F*(parseInt!=s),{parseInt:s})},91229:(e,t,i)=>{"use strict";var r,s,a,n,o=i(74742),c=i(66670),l=i(58852),d=i(44968),h=i(88535),u=i(24401),f=i(25219),p=i(2832),m=i(95838),g=i(85614),v=i(8036).set,y=i(53792)(),A=i(11642),b=i(41704),w=i(80218),x=i(61037),k="Promise",T=c.TypeError,I=c.process,S=I&&I.versions,P=S&&S.v8||"",_=c[k],M="process"==d(I),C=function(){},B=s=A.f,E=!!function(){try{var e=_.resolve(1),t=(e.constructor={})[i(30254)("species")]=function(e){e(C,C)};return(M||"function"==typeof PromiseRejectionEvent)&&e.then(C)instanceof t&&0!==P.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(e){}}(),D=function(e){var t;return!(!u(e)||"function"!=typeof(t=e.then))&&t},R=function(e,t){if(!e._n){e._n=!0;var i=e._c;y((function(){for(var r=e._v,s=1==e._s,a=0,n=function(t){var i,a,n,o=s?t.ok:t.fail,c=t.resolve,l=t.reject,d=t.domain;try{o?(s||(2==e._h&&$(e),e._h=1),!0===o?i=r:(d&&d.enter(),i=o(r),d&&(d.exit(),n=!0)),i===t.promise?l(T("Promise-chain cycle")):(a=D(i))?a.call(i,c,l):c(i)):l(r)}catch(e){d&&!n&&d.exit(),l(e)}};i.length>a;)n(i[a++]);e._c=[],e._n=!1,t&&!e._h&&U(e)}))}},U=function(e){v.call(c,(function(){var t,i,r,s=e._v,a=L(e);if(a&&(t=b((function(){M?I.emit("unhandledRejection",s,e):(i=c.onunhandledrejection)?i({promise:e,reason:s}):(r=c.console)&&r.error&&r.error("Unhandled promise rejection",s)})),e._h=M||L(e)?2:1),e._a=void 0,a&&t.e)throw t.v}))},L=function(e){return 1!==e._h&&0===(e._a||e._c).length},$=function(e){v.call(c,(function(){var t;M?I.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})}))},F=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),R(t,!0))},O=function(e){var t,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===e)throw T("Promise can't be resolved itself");(t=D(e))?y((function(){var r={_w:i,_d:!1};try{t.call(e,l(O,r,1),l(F,r,1))}catch(e){F.call(r,e)}})):(i._v=e,i._s=1,R(i,!1))}catch(e){F.call({_w:i,_d:!1},e)}}};E||(_=function(e){p(this,_,k,"_h"),f(e),r.call(this);try{e(l(O,this,1),l(F,this,1))}catch(e){F.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=i(30953)(_.prototype,{then:function(e,t){var i=B(g(this,_));return i.ok="function"!=typeof e||e,i.fail="function"==typeof t&&t,i.domain=M?I.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&R(this,!1),i.promise},catch:function(e){return this.then(void 0,e)}}),a=function(){var e=new r;this.promise=e,this.resolve=l(O,e,1),this.reject=l(F,e,1)},A.f=B=function(e){return e===_||e===n?new a(e):s(e)}),h(h.G+h.W+h.F*!E,{Promise:_}),i(1356)(_,k),i(45274)(k),n=i(46438)[k],h(h.S+h.F*!E,k,{reject:function(e){var t=B(this);return(0,t.reject)(e),t.promise}}),h(h.S+h.F*(o||!E),k,{resolve:function(e){return x(o&&this===n?_:this,e)}}),h(h.S+h.F*!(E&&i(27899)((function(e){_.all(e).catch(C)}))),k,{all:function(e){var t=this,i=B(t),r=i.resolve,s=i.reject,a=b((function(){var i=[],a=0,n=1;m(e,!1,(function(e){var o=a++,c=!1;i.push(void 0),n++,t.resolve(e).then((function(e){c||(c=!0,i[o]=e,--n||r(i))}),s)})),--n||r(i)}));return a.e&&s(a.v),i.promise},race:function(e){var t=this,i=B(t),r=i.reject,s=b((function(){m(e,!1,(function(e){t.resolve(e).then(i.resolve,r)}))}));return s.e&&r(s.v),i.promise}})},97863:(e,t,i)=>{"use strict";var r=i(43172)(!0);i(88839)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,i=this._i;return i>=t.length?{value:void 0,done:!0}:(e=r(t,i),this._i+=e.length,{value:e,done:!1})}))},19626:(e,t,i)=>{"use strict";var r=i(66670),s=i(75509),a=i(58219),n=i(88535),o=i(61331),c=i(75172).KEY,l=i(81984),d=i(96308),h=i(1356),u=i(19191),f=i(30254),p=i(84336),m=i(67816),g=i(36473),v=i(15461),y=i(80812),A=i(24401),b=i(66310),w=i(65133),x=i(10752),k=i(86260),T=i(22087),I=i(36309),S=i(81033),P=i(59820),_=i(78423),M=i(54311),C=S.f,B=_.f,E=I.f,D=r.Symbol,R=r.JSON,U=R&&R.stringify,L="prototype",$=f("_hidden"),F=f("toPrimitive"),O={}.propertyIsEnumerable,N=d("symbol-registry"),z=d("symbols"),V=d("op-symbols"),W=Object[L],j="function"==typeof D&&!!P.f,G=r.QObject,H=!G||!G[L]||!G[L].findChild,q=a&&l((function(){return 7!=T(B({},"a",{get:function(){return B(this,"a",{value:7}).a}})).a}))?function(e,t,i){var r=C(W,t);r&&delete W[t],B(e,t,i),r&&e!==W&&B(W,t,r)}:B,Y=function(e){var t=z[e]=T(D[L]);return t._k=e,t},K=j&&"symbol"==typeof D.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof D},Q=function(e,t,i){return e===W&&Q(V,t,i),y(e),t=x(t,!0),y(i),s(z,t)?(i.enumerable?(s(e,$)&&e[$][t]&&(e[$][t]=!1),i=T(i,{enumerable:k(0,!1)})):(s(e,$)||B(e,$,k(1,{})),e[$][t]=!0),q(e,t,i)):B(e,t,i)},X=function(e,t){y(e);for(var i,r=g(t=w(t)),s=0,a=r.length;a>s;)Q(e,i=r[s++],t[i]);return e},J=function(e){var t=O.call(this,e=x(e,!0));return!(this===W&&s(z,e)&&!s(V,e))&&(!(t||!s(this,e)||!s(z,e)||s(this,$)&&this[$][e])||t)},Z=function(e,t){if(e=w(e),t=x(t,!0),e!==W||!s(z,t)||s(V,t)){var i=C(e,t);return!i||!s(z,t)||s(e,$)&&e[$][t]||(i.enumerable=!0),i}},ee=function(e){for(var t,i=E(w(e)),r=[],a=0;i.length>a;)s(z,t=i[a++])||t==$||t==c||r.push(t);return r},te=function(e){for(var t,i=e===W,r=E(i?V:w(e)),a=[],n=0;r.length>n;)!s(z,t=r[n++])||i&&!s(W,t)||a.push(z[t]);return a};j||(o((D=function(){if(this instanceof D)throw TypeError("Symbol is not a constructor!");var e=u(arguments.length>0?arguments[0]:void 0),t=function(i){this===W&&t.call(V,i),s(this,$)&&s(this[$],e)&&(this[$][e]=!1),q(this,e,k(1,i))};return a&&H&&q(W,e,{configurable:!0,set:t}),Y(e)})[L],"toString",(function(){return this._k})),S.f=Z,_.f=Q,i(1743).f=I.f=ee,i(36569).f=J,P.f=te,a&&!i(74742)&&o(W,"propertyIsEnumerable",J,!0),p.f=function(e){return Y(f(e))}),n(n.G+n.W+n.F*!j,{Symbol:D});for(var ie="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),re=0;ie.length>re;)f(ie[re++]);for(var se=M(f.store),ae=0;se.length>ae;)m(se[ae++]);n(n.S+n.F*!j,"Symbol",{for:function(e){return s(N,e+="")?N[e]:N[e]=D(e)},keyFor:function(e){if(!K(e))throw TypeError(e+" is not a symbol!");for(var t in N)if(N[t]===e)return t},useSetter:function(){H=!0},useSimple:function(){H=!1}}),n(n.S+n.F*!j,"Object",{create:function(e,t){return void 0===t?T(e):X(T(e),t)},defineProperty:Q,defineProperties:X,getOwnPropertyDescriptor:Z,getOwnPropertyNames:ee,getOwnPropertySymbols:te});var ne=l((function(){P.f(1)}));n(n.S+n.F*ne,"Object",{getOwnPropertySymbols:function(e){return P.f(b(e))}}),R&&n(n.S+n.F*(!j||l((function(){var e=D();return"[null]"!=U([e])||"{}"!=U({a:e})||"{}"!=U(Object(e))}))),"JSON",{stringify:function(e){for(var t,i,r=[e],s=1;arguments.length>s;)r.push(arguments[s++]);if(i=t=r[1],(A(t)||void 0!==e)&&!K(e))return v(t)||(t=function(e,t){if("function"==typeof i&&(t=i.call(this,e,t)),!K(t))return t}),r[1]=t,U.apply(R,r)}}),D[L][F]||i(2677)(D[L],F,D[L].valueOf),h(D,"Symbol"),h(Math,"Math",!0),h(r.JSON,"JSON",!0)},62223:(e,t,i)=>{i(643)("Map")},74674:(e,t,i)=>{i(44398)("Map")},28337:(e,t,i)=>{var r=i(88535);r(r.P+r.R,"Map",{toJSON:i(5874)("Map")})},2639:(e,t,i)=>{"use strict";var r=i(88535),s=i(46438),a=i(66670),n=i(85614),o=i(61037);r(r.P+r.R,"Promise",{finally:function(e){var t=n(this,s.Promise||a.Promise),i="function"==typeof e;return this.then(i?function(i){return o(t,e()).then((function(){return i}))}:e,i?function(i){return o(t,e()).then((function(){throw i}))}:e)}})},46121:(e,t,i)=>{"use strict";var r=i(88535),s=i(11642),a=i(41704);r(r.S,"Promise",{try:function(e){var t=s.f(this),i=a(e);return(i.e?t.reject:t.resolve)(i.v),t.promise}})},42860:(e,t,i)=>{i(67816)("asyncIterator")},60716:(e,t,i)=>{i(67816)("observable")},7914:(e,t,i)=>{i(52293);for(var r=i(66670),s=i(2677),a=i(20210),n=i(30254)("toStringTag"),o="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),c=0;c<o.length;c++){var l=o[c],d=r[l],h=d&&d.prototype;h&&!h[n]&&s(h,n,l),a[l]=a.Array}},66801:(e,t,i)=>{var r=i(88535),s=i(8036);r(r.G+r.B,{setImmediate:s.set,clearImmediate:s.clear})},84209:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r="precision highp float;\n\nattribute vec3 point;\nattribute vec4 color;\nvarying vec4 v_color;\n\nuniform mat4 rotateMatrix;\n\nvoid main(void){\n  gl_Position = rotateMatrix * vec4(point, 1.0);\n  v_color = color;\n}\n"},23195:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r="\n@group(0) @binding(1) var eTexture: texture_external;\n@group(0) @binding(2) var s: sampler;\n\n@fragment\nfn main(@location(0) in_texcoord: vec4<f32>) -> @location(0) vec4<f32> {\n  return textureSampleBaseClampToEdge(eTexture, s, in_texcoord.xy);\n}"},54895:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r="struct PositionColorInput {\n    @location(0) in_position_3d: vec3<f32>,\n    @location(1) in_color_rgba: vec4<f32>\n};\n\nstruct PositionColorOutput {\n    @builtin(position) coords_output: vec4<f32>,\n    @location(0) color_output: vec4<f32>\n};\n\nstruct RotateMatrix {\n    matrix: mat4x4<f32>\n};\n\n@group(0) @binding(0) var<uniform> rotateMatrix: RotateMatrix;\n\n@vertex\nfn main(input: PositionColorInput) -> PositionColorOutput {\n    var output: PositionColorOutput;\n    output.color_output = input.in_color_rgba;\n    output.coords_output = rotateMatrix.matrix * vec4<f32>(input.in_position_3d, 1.0);\n    return output;\n}"},47451:function(e){e.exports=function(){"use strict";var e="beforeCreate",t="afterCreate",i="beforeRender",r="afterRender",s="beforeMount",a="beforeUpdate",n="beforeDestroy",o="afterDestroy",c=!0,l=!1,d=null,h=void 0,u="true",f="undefined",p="component",m="function",g="length",v=".",y=typeof window!==f?window:h,A=typeof document!==f?document:h,b="input",w="change",x="model",k=function(){},T=Object.freeze({}),I=Object.freeze([]),S="",P=/yox/.test(k.toString())?2:3,_={leftDelimiter:"{",rightDelimiter:"}",uglifyCompiled:l,minifyCompiled:l,logLevel:P};function M(e){return typeof e===m}function C(e){return Array.isArray(e)}function B(e){return e!==d&&"object"==typeof e}function E(e){return"string"==typeof e}function D(e){return"number"==typeof e&&!isNaN(e)}function R(e){return e===c||e===l}function U(e){return!isNaN(e-parseFloat(e))}var L=Object.freeze({__proto__:null,func:M,array:C,object:B,string:E,number:D,boolean:R,numeric:U});function $(e,t,i){return C(i)?e.apply(t,i):t!==h?e.call(t,i):i!==h?e(i):e()}var F=function(e,t){this.type=e,this.phase=F.PHASE_CURRENT,t&&(this.originalEvent=t)};function O(e,t,i){var r=e.length;if(r)if(i)for(var s=r-1;s>=0&&t(e[s],s)!==l;s--);else for(var a=0;a<r&&t(e[a],a)!==l;a++);}function N(e,t){e[e.length]=t}function z(e,t){e.unshift(t)}function V(e,t,i){C(t)?O(t,(function(t){i(e,t)})):i(e,t)}function W(e,t){V(e,t,N)}function j(e,t){V(e,t,z)}function G(e,t,i){var r=-1;return O(e,(function(e,s){if(i===l?e==t:e===t)return r=s,l})),r}function H(e){var t=e.length;if(t>0)return e[t-1]}function q(e,t,i){var r=0;return O(e,(function(s,a){(i===l?s==t:s===t)&&(e.splice(a,1),r++)}),c),r}function Y(e,t,i){return G(e,t,i)>=0}function K(e){return C(e)?e:$(I.slice,e)}function Q(e,t,i){var r={};return O(e,(function(e){r[t?e[t]:e]=i||e})),r}function X(e,t){return e.join(t)}function J(e){return!C(e)||!e.length}F.is=function(e){return e instanceof F},F.prototype.preventDefault=function(){var e=this;if(!e.isPrevented){var t=e.originalEvent;t&&t.preventDefault(),e.isPrevented=c}return e},F.prototype.stopPropagation=function(){var e=this;if(!e.isStoped){var t=e.originalEvent;t&&t.stopPropagation(),e.isStoped=c}return e},F.prototype.prevent=function(){return this.preventDefault()},F.prototype.stop=function(){return this.stopPropagation()},F.PHASE_CURRENT=0,F.PHASE_UPWARD=1,F.PHASE_DOWNWARD=-1;var Z=Object.freeze({__proto__:null,each:O,push:W,unshift:j,indexOf:G,last:H,pop:function(e){if(e.length>0)return e.pop()},remove:q,has:Y,toArray:K,toObject:Q,join:X,falsy:J});function ee(e,t){return e!=d&&e.toString?e.toString():t!==h?t:S}function te(e){return M(e)&&ee(e).indexOf("[native code]")>=0}var ie=function(){var e=Object.create(d);return{get:function(t){return e[t]},set:function(t,i){e[t]=i},has:function(t){return t in e},keys:function(){return Object.keys(e)}}};function re(e){var t=ie();return function(i){var r=t.get(i);if(r!==h)return r;var s=e(i);return t.set(i,s),s}}function se(e){var t=ie();return function(i,r){var s=t.get(i);if(s){var a=s.get(r);if(a)return a}else s=ie(),t.set(i,s);var n=e(i,r);return s.set(r,n),n}}var ae=/-([a-z])/gi,ne=/\B([A-Z])/g,oe=/^[a-z]/,ce=re((function(e){return e.replace(ae,(function(e,t){return ve(t)}))})),le=re((function(e){return e.replace(ne,(function(e,t){return"-"+ye(t)}))})),de=re((function(e){return e.replace(oe,ve)}));function he(e){return we(e)?S:e.trim()}function ue(e,t,i){return D(i)?t===i?S:e.slice(t,i):e.slice(t)}function fe(e,t,i){return e.indexOf(t,i!==h?i:0)}function pe(e,t,i){return e.lastIndexOf(t,i!==h?i:e.length)}function me(e,t){return 0===fe(e,t)}function ge(e,t){return e.charCodeAt(t||0)}function ve(e){return e.toUpperCase()}function ye(e){return e.toLowerCase()}function Ae(e,t){return fe(e,t)>=0}function be(e,t){var i=Object.create(d);return O(e.split(t||","),(function(e){i[e]=c})),i}function we(e){return!E(e)||!e.length}var xe=Object.freeze({__proto__:null,camelize:ce,hyphenate:le,capitalize:de,repeat:function(e,t){return X(new Array(t+1),e)},trim:he,slice:ue,indexOf:fe,lastIndexOf:pe,startsWith:me,endsWith:function(e,t){var i=e.length-t.length;return i>=0&&pe(e,t)===i},charAt:function(e,t){return e.charAt(t||0)},codeAt:ge,upper:ve,lower:ye,has:Ae,toMap:be,falsy:we}),ke=/\./g,Te=/\*/g,Ie=/\*\*/g,Se=se((function(e,t){return e===t||me(e,t+=v)?t.length:-1})),Pe=re((function(e){return fe(e,v)<0?[e]:e.split(v)}));function _e(e,t){for(var i=E(e)?Pe(e):e,r=0,s=i.length-1;r<=s&&t(i[r],r,s)!==l;r++);}var Me=se((function(e,t){return e&&t?e+v+t:e||t})),Ce=re((function(e){return Ae(e,"*")})),Be=re((function(e){return new RegExp("^"+e.replace(ke,"\\.").replace(Te,"(\\w+)").replace(Ie,"([.\\w]+?)")+"$")})),Ee=se((function(e,t){var i=e.match(Be(t));return i?i[1]:h})),De={value:h};function Re(e){return Object.keys(e)}function Ue(e,t){for(var i in e)if(t(e[i],i)===l)break}function Le(e,t){return Ue(t,(function(t,i){e[i]=t})),e}function $e(e,t){var i=e;return C(e)?t?(i=[],O(e,(function(e,r){i[r]=$e(e,t)}))):i=e.slice():B(e)&&(i={},Ue(e,(function(e,r){i[r]=t?$e(e,t):e}))),i}function Fe(e){return M(e.get)?e.get():e}function Oe(e,t,i){var r=e;return _e(t,(function(e,t,s){if(r==d)return r=h,l;var a=r[e],n=a!==h;a&&(a=(i||Fe)(a)),t===s?n?(De.value=a,r=De):r=h:r=a})),r}function Ne(e,t){return e[t]!==h}var ze=Object.freeze({__proto__:null,keys:Re,each:Ue,extend:Le,merge:function(e,t){return e&&t?Le(Le({},e),t):e||t},copy:$e,get:Oe,set:function(e,t,i,r){var s=e;_e(t,(function(e,t,a){if(t===a)s[e]=i;else if(s[e])s=s[e];else{if(!r)return l;s=s[e]={}}}))},has:Ne,falsy:function(e){return!B(e)||C(e)||!Re(e).length}}),Ve=typeof console!==f?console:d,We=y&&/edge|msie|trident/i.test(y.navigator.userAgent)?S:"%c",je=Ve?We?function(e,t,i){Ve.log(We+e,i,t)}:function(e,t){Ve.log(e,t)}:k;function Ge(){var e=_.logLevel;return e>=1&&e<=5?e:P}function He(e){return"background-color:"+e+";border-radius:12px;color:#fff;font-size:10px;padding:3px 6px;"}var qe=Object.freeze({__proto__:null,DEBUG:1,INFO:2,WARN:3,ERROR:4,FATAL:5,debug:function(e,t){Ge()<=1&&je(t||"Yox debug",e,He("#999"))},info:function(e,t){Ge()<=2&&je(t||"Yox info",e,He("#2db7f5"))},warn:function(e,t){Ge()<=3&&je(t||"Yox warn",e,He("#f90"))},error:function(e,t){Ge()<=4&&je(t||"Yox error",e,He("#ed4014"))},fatal:function(e,t){if(Ge()<=5)throw new Error("["+(t||"Yox fatal")+"]: "+e)}}),Ye=function(e){this.ns=e||l,this.listeners={}};function Ke(e,t){return e?e===t.listener:c}function Qe(e,t){var i=t.ns;return i&&e?i===e:c}Ye.prototype.fire=function(e,t,i){var r=this,s=E(e)?r.toEvent(e):e,a=r.listeners[s.type],n=c;if(a){a=a.slice();for(var o=t&&F.is(t[0])?t[0]:h,d=0,u=a.length;d<u;d++){var f=a[d];if(Qe(s.ns,f)&&Y(a,f)&&(!i||i(s,t,f))){var p=$(f.listener,f.ctx,t);if(f.num=f.num?f.num+1:1,f.num===f.max&&r.off(s.type,{ns:s.ns,listener:f.listener}),o&&(p===l?o.prevent().stop():o.isStoped&&(p=l)),p===l){n=l;break}}}}return n},Ye.prototype.on=function(e,t){var i=this.listeners,r=M(t)?{listener:t}:t;if(B(r)&&M(r.listener)){if(!E(r.ns)){var s=this.toEvent(e);r.ns=s.ns,e=s.type}W(i[e]||(i[e]=[]),r)}},Ye.prototype.off=function(e,t){var i=this,r=i.listeners;if(e){var s=i.toFilter(e,t),a=function(e,t){O(e,(function(t,i){Ke(s.listener,t)&&Qe(s.ns,t)&&e.splice(i,1)}),c),e.length||delete r[t]};s.type?r[s.type]&&a(r[s.type],s.type):s.ns&&Ue(r,a)}else i.listeners={}},Ye.prototype.has=function(e,t){var i=this.listeners,r=this.toFilter(e,t),s=c,a=function(e){return O(e,(function(e){if(Ke(r.listener,e)&&Qe(r.ns,e))return s=l})),s};return r.type?i[r.type]&&a(i[r.type]):r.ns&&Ue(i,a),!s},Ye.prototype.toEvent=function(e){var t={type:e,ns:S};if(this.ns){var i=fe(e,v);i>=0&&(t.type=ue(e,0,i),t.ns=ue(e,i+1))}return t},Ye.prototype.toFilter=function(e,t){var i;if(E((i=t?M(t)?{listener:t}:t:{}).ns))i.type=e;else{var r=this.toEvent(e);i.type=r.type,i.ns=r.ns}return i},typeof setImmediate===m&&te(setImmediate)&&setImmediate;var Xe,Je=typeof MessageChannel===m&&te(MessageChannel)?function(e){var t=new MessageChannel;t.port1.onmessage=e,t.port2.postMessage(1)}:setTimeout,Ze=function(e){this.tasks=[],this.hooks=e||T};function et(e,t,i){var r;return function(){if(!r){var s=K(arguments);i&&$(e,h,s),r=setTimeout((function(){r=h,i||$(e,h,s)}),t)}}}Ze.shared=function(){return Xe||(Xe=new Ze)},Ze.prototype.append=function(e,t){var i=this,r=i.tasks;W(r,{fn:e,ctx:t}),1===r.length&&Je((function(){i.run()}))},Ze.prototype.prepend=function(e,t){var i=this,r=i.tasks;j(r,{fn:e,ctx:t}),1===r.length&&Je((function(){i.run()}))},Ze.prototype.clear=function(){this.tasks.length=0},Ze.prototype.run=function(){var e=this,t=e.tasks,i=e.hooks,r=t.length;if(r){e.tasks=[],i.beforeTask&&i.beforeTask();for(var s=0;s<r;s++)$(t[s].fn,t[s].ctx);i.afterTask&&i.afterTask()}};var tt="$vnode",it="$loading",rt="$leaving",st="$model_control",at="$model_destroy",nt="$event_destroy",ot="$directive_hooks",ct="$directive_updating";function lt(e,t,i,r,s,a,n){var o=n.name,l=n.listener;if(a){var d=a[o]||a[""];d===c?o=w:d>0&&(l=et(l,d,"click"===o||"tap"===o))}if(i){if(n.isNative){var h=i.$el;return e.on(h,o,l),function(){e.off(h,o,l)}}i.on(o,n),r[nt+s]=function(){i.off(o,n),delete r[nt+s]}}else e.on(t,o,l),r[nt+s]=function(){e.off(t,s,l),delete r[nt+s]}}var dt=Object.freeze({__proto__:null,afterCreate:function(e,t){var i=t.events;if(i){var r=t.node,s=t.component,a=t.lazy,n=t.data;for(var o in i)lt(e,r,s,n,o,a,i[o])}},afterUpdate:function(e,t,i){var r=t.events,s=i.events;if(r!==s){var a=t.node,n=t.component,o=t.lazy,c=t.data;if(s){var l=r||T;for(var d in s)if(!l[d]){var h=c[nt+d];h&&h()}}if(r){var u=s||T;for(var f in r){var p=r[f],m=u[f];if(m)if(p.value!==m.value){var g=c[nt+f];g&&g(),lt(e,a,n,c,f,o,p)}else m.runtime&&p.runtime&&(m.runtime.execute=p.runtime.execute,p.runtime=m.runtime);else lt(e,a,n,c,f,o,p)}}}},beforeDestroy:function(e,t){var i=t.events,r=t.data;if(i)for(var s in i){var a=r[nt+s];a&&a()}}});function ht(e,t){return t&&t!==c?et(e,t):e}var ut={set:function(e,t){e.value=ee(t)},sync:function(e,t,i){i.set(t,e.value)}},ft={set:function(e,t){e.checked=e.value===ee(t)},sync:function(e,t,i){e.checked&&i.set(t,e.value)}},pt={set:function(e,t){e.checked=C(t)?Y(t,e.value,l):!!t},sync:function(e,t,i){var r=i.get(t);C(r)?e.checked?i.append(t,e.value):i.removeAt(t,G(r,e.value,l)):i.set(t,e.checked)}},mt={set:function(e,t){for(var i=e.multiple,r=e.options,s=0,a=r.length;s<a;s++)if(i)r[s].selected=Y(t,r[s].value,l);else if(r[s].value==t)return void(e.selectedIndex=s);i||(e.selectedIndex=-1)},sync:function(e,t,i){var r=e.multiple,s=e.options;if(r){for(var a=[],n=0,o=s.length;n<o;n++)s[n].selected&&a.push(s[n].value);i.set(t,a)}else i.set(t,s[e.selectedIndex].value)}};function gt(e,t,i,r,s){var a=s.context,n=s.model,o=s.lazy,l=s.nativeAttrs,d=n.keypath,h=n.value,u=o&&(o.model||o[""]);if(i){var f=i.$model,p=ht((function(e){a.set(d,e)}),u);i.watch(f,p),r[at]=function(){i.unwatch(f,p),delete r[at]}}else{var m="select"===s.tag?mt:ut,g=w;if(m===ut){var v=l&&l.type;"radio"===v?m=ft:"checkbox"===v?m=pt:u!==c&&(g=x)}var y=ht((function(){m.sync(t,d,a)}),u);e.on(t,g,y),m.set(t,h),r[st]=m,r[at]=function(){e.off(t,g,y),delete r[at],delete r[st]}}}var vt=Object.freeze({__proto__:null,afterCreate:function(e,t){t.model&&gt(e,t.node,t.component,t.data,t)},afterUpdate:function(e,t,i){var r=t.data,s=t.model,a=i.model;if(s){var n=t.node,o=t.component;if(a)if(s.keypath!==a.keypath)r[at](),gt(e,n,o,r,t);else if(o)o.set(o.$model,s.value);else{var c=r[st];c&&c.set(n,s.value)}else gt(e,n,o,r,t)}else a&&r[at]()},beforeDestroy:function(e,t){var i=t.data[at];i&&i()}});var yt=Object.freeze({__proto__:null,afterCreate:function(e,t){var i=t.nativeAttrs;if(i){var r=t.node;for(var s in i)e.setAttr(r,s,i[s])}},afterUpdate:function(e,t,i){var r=t.nativeAttrs,s=i.nativeAttrs;if(r!==s){var a=t.node;if(r){var n=s||T;for(var o in r)n[o]!==h&&r[o]===n[o]||e.setAttr(a,o,r[o])}if(s){var c=r||T;for(var l in s)c[l]===h&&e.removeAttr(a,l)}}}});var At=Object.freeze({__proto__:null,afterCreate:function(e,t){var i=t.nativeStyles;if(i){var r=t.node.style;for(var s in i)e.setStyle(r,s,i[s])}},afterUpdate:function(e,t,i){var r=t.nativeStyles,s=i.nativeStyles;if(r!==s){var a=t.node.style;if(r){var n=s||T;for(var o in r)n[o]!==h&&r[o]===n[o]||e.setStyle(a,o,r[o])}if(s){var c=r||T;for(var l in s)c[l]===h&&e.removeStyle(a,l)}}}});function bt(e,t,i){e[ot+i.name]=i.create(t.component||t.node,i,t)}function wt(e,t,i,r){var s=e[ot+i.name],a=s&&s[r];a&&a(i,t)}function xt(e){return function(t,i){var r=i.directives;if(r){var s=i.data;for(var a in r)wt(s,i,r[a],e)}}}var kt=xt("afterMount"),Tt=xt("beforeDestroy"),It=Object.freeze({__proto__:null,afterCreate:function(e,t){var i=t.directives;if(i){var r=t.data;for(var s in i)bt(r,t,i[s])}},beforeUpdate:function(e,t,i){var r=t.directives,s=i.directives,a=t.data;if(s){var n=r||T;for(var o in s)n[o]===h&&wt(a,t,s[o],"beforeDestroy")}if(r){var c=s||T,l=[];for(var d in r){var u=r[d];c[d]===h?bt(a,t,u):u.value!==c[d].value&&(wt(a,t,u,"beforeUpdate"),l.push(u))}a[ct]=l}},afterUpdate:function(e,t,i){var r=t.data;if(r){var s=r[ct];if(s){for(var a=0,n=s.length;a<n;a++)wt(r,t,s[a],"afterUpdate");r[ct]=h}}},afterMount:kt,beforeDestroy:Tt});function St(e,t){if(5===t.type||7===t.type){var i=t.children[0];return i?St(e,i):e.createComment(S)}return t.node}function Pt(e,t,i,r){r?e.before(t,i,r):e.append(t,i)}function _t(e,t,i){var r=i.node;t.node=r,t.parentNode=i.parentNode,t.text!==i.text&&e.setNodeText(r,t.text)}function Mt(e){e.data&&si(e,e.node)}function Ct(e,t){e.data&&ai(e,e.node,t)||t()}function Bt(e,t,i,r){r?e.before(t,i.node,r.node):e.append(t,i.node)}function Et(e,t){e.remove(t.parentNode,t.node)}function Dt(e,t){t()}function Rt(e,t){for(var i=t.children,r=0,s=i.length;r<s;r++)Jt(e,i[r])}function Ut(e,t,i,r){ni(e,t,i.children,r.children)}function Lt(e,t){for(var i=t.children,r=0,s=i.length;r<s;r++)ii(e,i[r])}function $t(e,t,i,r){for(var s=i.children,a=0,n=s.length;a<n;a++)ei(e,t,s[a],r)}function Ft(e,t){for(var i=t.children,r=0,s=i.length;r<s;r++)ri(e,i[r])}var Ot={create:function(e,t){t.node=e.createText(t.text)},update:_t,destroy:k,insert:Bt,remove:Et,enter:k,leave:Dt},Nt={create:function(e,t){t.node=e.createComment(t.text)},update:_t,destroy:k,insert:Bt,remove:Et,enter:k,leave:Dt},zt=[yt,At,Object.freeze({__proto__:null,afterCreate:function(e,t){var i=t.ref;if(i){var r=t.context,s=r.$refs;s||(s=r.$refs={}),s[i]=t.component||t.node}},beforeUpdate:function(e,t,i){var r=t.ref,s=i.ref;if(r||s){var a=t.context,n=t.component||t.node,o=a.$refs;r?s?r!==s&&(o?o[r]===n&&delete o[r]:o=a.$refs={},o[r]=n):(o||(o=a.$refs={}),o[r]=n):o&&s&&o[s]===n&&delete o[s]}},beforeDestroy:function(e,t){var i=t.ref;if(i){var r=t.context.$refs,s=t.component||t.node;r&&r[i]===s&&delete r[i]}}}),dt,vt,It],Vt=zt.length;function Wt(e,t){for(var i=0;i<Vt;i++){var r=zt[i][e];r&&r.apply(h,t)}}var jt={create:function(e,t){var i=t.node=e.createElement(t.tag,t.isSvg);t.children?Zt(e,i,t.children):t.text?e.setElementText(i,t.text):t.html&&e.setHtml(i,t.html),t.isPure||(t.data={}),Wt("afterCreate",[e,t])},update:function(e,t,i){var r=i.node;t.node=r,t.parentNode=i.parentNode,t.data=i.data,!t.isPure&&i.isPure&&(t.data={}),Wt("beforeUpdate",[e,t,i]);var s=t.text,a=t.html,n=t.children,o=i.text,c=i.html,l=i.children;E(s)?(l&&ti(e,l),s!==o&&e.setElementText(r,s)):E(a)?(l&&ti(e,l),a!==c&&e.setHtml(r,a)):n?l?n!==l&&ni(e,r,n,l):((o||c)&&e.setElementText(r,S),Zt(e,r,n)):l?ti(e,l):(o||c)&&e.setElementText(r,S),Wt("afterUpdate",[e,t,i])},destroy:function(e,t){if(!t.isPure){Wt("beforeDestroy",[e,t]);var i=t.children;if(i)for(var r=0,s=i.length;r<s;r++)ii(e,i[r])}},insert:Bt,remove:Et,enter:Mt,leave:Ct},Gt={create:function(e,t){var i=t.data={},r=h;t.tag&&t.context.loadComponent(t.tag,(function(s){Ne(i,it)?i[it]&&(i[tt]&&(t=i[tt],delete i[tt]),Xt(e,t,s),t.operator.enter(t)):r=s})),t.node=e.createComment(p),r?Xt(e,t,r):i[it]=c},update:function(e,t,i){var r=i.data;if(t.data=r,t.node=i.node,t.parentNode=i.parentNode,t.component=i.component,r[it])r[tt]=t;else{Wt("beforeUpdate",[e,t,i]);var s=t.component,a=t.slots;if(s){var n=t.props;a&&(n=Le(n||{},a)),n&&s.forceUpdate(n)}Wt("afterUpdate",[e,t,i])}},destroy:function(e,t){var i=t.component;i?(Wt("beforeDestroy",[e,t]),i.destroy(),t.shadow=i.$vnode,t.component=h):t.data[it]=l},insert:function(e,t,i,r){var s=i.shadow;s?(s.operator.insert(e,t,s,r),s.parentNode=t):Bt(e,t,i,r)},remove:function(e,t){var i=t.shadow;i?(i.operator.remove(e,i),i.parentNode=h):Et(e,t)},enter:function(e){var t=e.shadow;t&&(e.transition?si(e,t.node):t.operator.enter(t))},leave:function(e,t){var i=e.shadow;if(i){if(!e.transition)return void i.operator.leave(i,t);if(ai(e,i.node,t))return}t()}},Ht={create:function(e,t){Rt(e,t),t.node=St(e,t)},update:function(e,t,i){var r=i.parentNode;t.node=i.node,t.parentNode=r,Ut(e,r,t,i)},destroy:Lt,insert:$t,remove:Ft,enter:k,leave:Dt},qt={create:function(e,t){var i=h;t.to&&(i=e.find(t.to)),i||(i=e.getBodyElement()),t.target=i,t.node=e.createComment(S);for(var r=t.children,s=0,a=r.length;s<a;s++)Jt(e,r[s]),ei(e,i,r[s])},update:function(e,t,i){var r=i.target;t.node=i.node,t.parentNode=i.parentNode,t.target=r,Ut(e,r,t,i)},destroy:function(e,t){for(var i=t.children,r=0,s=i.length;r<s;r++)ii(e,i[r]),ri(e,i[r])},insert:Bt,remove:Et,enter:k,leave:Dt},Yt={create:function(e,t){Rt(e,t),t.data={},t.node=St(e,t),Wt("afterCreate",[e,t])},update:function(e,t,i){var r=i.parentNode;t.node=i.node,t.parentNode=r,t.data=i.data,Wt("beforeUpdate",[e,t,i]),Ut(e,r,t,i),Wt("afterUpdate",[e,t,i])},destroy:function(e,t){Wt("beforeDestroy",[e,t]),Lt(e,t)},insert:$t,remove:Ft,enter:Mt,leave:Ct};function Kt(e,t){return e.type===t.type&&e.tag===t.tag&&e.key===t.key}function Qt(e,t,i){for(var r,s,a;t<=i;)(s=e[t])&&(a=s.key)&&(r||(r={}),r[a]=t),t++;return r||T}function Xt(e,t,i){var r=t.data,s=(t.parent||t.context).createComponent(i,t);return t.component=s,t.shadow=s.$vnode,r[it]=l,Wt("afterCreate",[e,t]),s}function Jt(e,t){t.node||t.operator.create(e,t)}function Zt(e,t,i,r,s,a){for(var n,o=r||0,c=s!==h?s:i.length-1;o<=c;)Jt(e,n=i[o]),ei(e,t,n,a),o++}function ei(e,t,i,r){var s=i.operator;s.insert(e,t,i,r),i.parentNode=t,Wt("afterMount",[e,i]),s.enter(i)}function ti(e,t,i,r){for(var s,a=i||0,n=r!==h?r:t.length-1;a<=n;)(s=t[a])&&(ii(e,s),ri(e,s)),a++}function ii(e,t){t.operator.destroy(e,t)}function ri(e,t){var i=t.operator;i.leave(t,(function(){i.remove(e,t),t.parentNode=h}))}function si(e,t){var i=e.context,r=e.transition,s=e.data[rt];if(s&&s(),r){var a=r.enter;a&&a.call(i,t)}}function ai(e,t,i){var r=e.context,s=e.transition,a=e.data,n=a[rt];if(n&&n(),s){var o=s.leave;if(o)return o.call(r,t,a[rt]=function(){a[rt]&&(i(),a[rt]=h)}),c}}function ni(e,t,i,r){for(var s,a,n=0,o=i.length-1,c=i[n],l=i[o],d=0,u=r.length-1,f=r[d],p=r[u];d<=u&&n<=o;)c?l?f?p?Kt(c,f)?(oi(e,c,f),c=i[++n],f=r[++d]):Kt(l,p)?(oi(e,l,p),l=i[--o],p=r[--u]):Kt(l,f)?(oi(e,l,f),Pt(e,t,f.node,e.next(p.node)),l=i[--o],f=r[++d]):Kt(c,p)?(oi(e,c,p),Pt(e,t,p.node,f.node),c=i[++n],p=r[--u]):(s||(s=Qt(r,d,u)),(a=c.key?s[c.key]:h)!==h?(ci(e,c,r[a]),r[a]=h):Jt(e,c),ei(e,t,c,f),c=i[++n]):p=r[--u]:f=r[++d]:l=i[--o]:c=i[++n];d>u?Zt(e,t,i,n,o,i[o+1]):n>o&&ti(e,r,d,u)}function oi(e,t,i){t!==i&&t.operator.update(e,t,i)}function ci(e,t,i){if(t!==i){if(!Kt(t,i)){var r=i.parentNode;return Jt(e,t),void(r&&(ei(e,r,t,i),ii(e,i),ri(e,i)))}oi(e,t,i)}}function li(e){var t=e.children;return{type:e.type,data:e.data,node:e.node,parentNode:e.parentNode,target:e.target,shadow:e.shadow,parent:e.parent,component:e.component,context:e.context,operator:e.operator,tag:e.tag,isSvg:e.isSvg,isStatic:e.isStatic,isPure:e.isPure,slots:e.slots,props:e.props,nativeAttrs:e.nativeAttrs,nativeStyles:e.nativeStyles,directives:e.directives,events:e.events,lazy:e.lazy,transition:e.transition,model:e.model,to:e.to,ref:e.ref,key:e.key,text:e.text,html:e.html,children:t?t.map(li):t}}function di(e,t){return ee(t)}function hi(e,t,i){var r=t===c||t===u||t===e;return r===i?h:r?u:"false"}be("abstract,goto,native,static,enum,implements,package,super,byte,export,import,private,protected,public,synchronized,char,extends,int,throws,class,final,interface,transient,yield,let,const,float,double,boolean,long,short,volatile,default");function ui(e){var t=e.input,i=e.getter;e.value=t?i.apply(h,t):i()}var fi=function(){this.map={},this.list=[]};fi.prototype.add=function(e,t){var i=this.map[e.id]||(this.map[e.id]={});i[t]||(i[t]=e,this.list.push([e,t]))},fi.prototype.watch=function(e){var t=this.list;if(t)for(var i=0,r=t.length;i<r;i++)t[i][0].watch(t[i][1],e)},fi.prototype.unwatch=function(e){var t=this.list;if(t)for(var i=0,r=t.length;i<r;i++)t[i][0].unwatch(t[i][1],e)};var pi=function(e,t,i,r,s,a,n,o){var c=this;c.status=1,c.keypath=e,c.cache=t,c.input=r,c.output=s,c.setter=n,c.getter=a,c.onChange=o,c.watcherOptions={sync:i,watcher:function(){c.refresh()}}};pi.prototype.get=function(){var e=this,t=e.status,i=e.watcherOptions;if(e.cache){if(2!==t)if(e.staticDeps)ui(e);else{var r=e.dynamicDeps;r&&r.unwatch(i.watcher),e.dynamicDeps=h;var s=pi.current;pi.current=e,ui(e),pi.current=s,(r=e.dynamicDeps)&&r.watch(i)}}else ui(e);return 2!==t&&(e.status=2),function(e){var t=e.value,i=e.output;return i?i(t):t}(e)},pi.prototype.set=function(e){var t=this.setter;t?t(e):M(e)&&(this.getter=e,this.refresh())},pi.prototype.refresh=function(){var e=this.value;this.status=3;var t=this.get();t!==e&&this.onChange(this.keypath,t,e)},pi.prototype.addStaticDeps=function(e,t){for(var i=this.staticDeps||(this.staticDeps=new fi),r=0,s=t.length;r<s;r++)i.add(e,t[r]);i.watch(this.watcherOptions)},pi.prototype.addDynamicDep=function(e,t){(this.dynamicDeps||(this.dynamicDeps=new fi)).add(e,t)};var mi=function(e,t,i){this.keypath=e,this.scopeValue=t,this.scopeKey=i};function gi(e,t,i,r,s,a,n,o,d,u){var f=[new mi("",i)],p=[],m=function(e,t,i,r){if(e[t])e[t][i]=r;else{var s={};s[i]=r,e[t]=s}},g=function(e){var t={};return function(e,t){for(var i=e.split(";"),r=0,s=i.length;r<s;r++){var a=i[r],n=a.indexOf(":");if(n>0){var o=he(a.substring(0,n)),c=he(a.substring(n+1));o&&c&&t(ce(o),c)}}}(e,(function(e,i){t[e]=i})),t},y=function(e){if(C(e)){for(var t={},i=0,r=e.length;i<r;i++){var s=y(e[i]);if(s)for(var a in s)t[a]=s[a]}return t}return B(e)?e:E(e)?g(e):void 0},A=function(e,t){return t},b=function(e){return{keypath:e.keypath,value:e.value}},w=function(t,i,r){return function(s,a,n){r&&s.phase===F.PHASE_DOWNWARD||(t===s.type&&i===s.ns||((s=new F(t,n?s.originalEvent:s)).ns=i),e.fire(s,a))}},x=function(e,t,i){return function(r,s){i&&r.phase===F.PHASE_DOWNWARD||S(e,t?t.execute(r,s):s?[r,s]:[r])===l&&r.prevent().stop()}},k=function(e,t,i,r,s,a,n,o){return{key:e,value:t,name:i,ns:r,isNative:o,runtime:a,listener:x(s,a,n)}},T=function(e,t,i,r,s,a,n,o){return{key:e,value:t,name:i,ns:r,isNative:o,listener:w(s,a,n)}},I=function(e,t,i,r,s){return{ns:"o",name:t,value:r,modifier:i,create:s}},S=function(t,i){var r=e[t];return i&&i.length>0?$(r,e,i):e[t]()},P=function(e,t,i){if(B(i))for(var r in i)m(e,t,r,i[r])},_=function(e,t,i){var r=e.keypath,s=e.value,a=0,n=!!r,o=f,c=H(f).keypath;if(C(s)){a=s.length;for(var l=0;l<a;l++)n&&(c=r+v+l,(f=o.slice()).push(new mi(c,s,l))),t(f,s[l],c,a,l)}else if(B(s)){var d=Re(s);a=d.length;for(var h=0;h<a;h++){var u=d[h];n&&(c=r+v+u,(f=o.slice()).push(new mi(c,s,u))),t(f,s[u],c,a,u)}}f!==o&&(f=o),i&&0===a&&i()},D=function(e,t,i,r,s){var a=0,n=0,o=H(f).keypath;if(e<t)if(n=t-e,i)for(var c=e;c<=t;c++)r(f,c,o,n,a++);else for(var l=e;l<t;l++)r(f,l,o,n,a++);else if(n=e-t,i)for(var d=e;d>=t;d--)r(f,d,o,n,a++);else for(var h=e;h>t;h--)r(f,h,o,n,a++);s&&0===n&&s()},R=function(e,t){u(e);var r=i[e];if(r)return r instanceof pi?t?r.getter(t):r.get():r},U=function(e,t,i,r,s,a){for(var n;t>=0;){var o=e[t],c=o.getKeypath(i),l=Oe(o.getScope(),r),d=N(l?l.value:h,c);if(l)return d;if(n||(n=d),!(s&&t>0))break;t--}return a?N(a):n},L=function(e,t,i,r){return U(e,t,i,[i],c,r)},O=function(e,t){var i=Oe(e,t);return N(i?i.value:h)},N=function(e,t){return e&&M(e.get)&&(e=e.get()),De.keypath=t,De.value=e,t!==h&&u(t),De};return function(t,i,c,l){t(g,y,A,b,k,T,I,P,_,D,R,m,di,hi,U,L,O,N,ee,Ot,Nt,jt,Gt,Ht,qt,Yt,e,qe,r,s,a,n,o,d,f,i,c,l)}(t,i,"",p),p[0]}mi.prototype.getScope=function(){var e=this.scopeValue,t=this.scopeKey;return t!==h?e[t]:e},mi.prototype.getKeypath=function(e){var t=this.keypath;return t?t+v+e:e};var vi=0,yi="textContent",Ai=yi,bi="innerHTML",wi="cssFloat",xi=function(e,t,i){e.addEventListener(t,i,l)},ki=function(e,t,i){e.removeEventListener(t,i,l)},Ti=function(e,t){e.classList.add(t)},Ii=function(e,t){e.classList.remove(t)};if(A){var Si=A.documentElement;wi in Si.style||(wi="styleFloat"),Si.classList||(Ti=function(e,t){var i=e.className.split(Pi);Y(i,t)||(W(i,t),e.className=X(i,Pi))},Ii=function(e,t){var i=e.className.split(Pi);q(i,t)&&(e.className=X(i,Pi))}),Si=h}var Pi=" ",_i="$event",Mi="compositionstart",Ci="compositionend",Bi="http://www.w3.org/2000/svg",Ei={},Di={},Ri={},Ui={};function Li(e){return A.createComment(e)}function $i(e,t){e.appendChild(t)}Ui[x]={on:function(e,t){var i=l;Vi(e,Mi,t[Mi]=function(){i=c}),Vi(e,Ci,t[Ci]=function(e){i=l,t(e)}),xi(e,b,t[b]=function(e){i||t(e)})},off:function(e,t){Wi(e,Mi,t[Mi]),Wi(e,Ci,t[Ci]),ki(e,b,t[b]),t[Mi]=t[Ci]=t[b]=h}};var Fi=function(e){var t=A.querySelector(e);if(t)return t};function Oi(e){return e[bi]}var Ni=Ti,zi=Ii;function Vi(e,t,i){var r=e[_i]||(e[_i]=++vi),s=Di[r]||(Di[r]={}),a=Ri[r]||(Ri[r]={}),n=a[t]||(a[t]=[]);if(!s[t]){var o=Ui[t],l=function(e){var i;F.is(e)?(i=e).type!==t&&(i.type=t):i=new F(t,function(e){return e}(e));for(var r=n.slice(),s=0,a=r.length;s<a;s++)r[s](i,h,c)};s[t]=l,Ei[r]?Ei[r]++:Ei[r]=1,o?o.on(e,l):xi(e,t,l)}n.push(i)}function Wi(e,t,i){var r=e[_i],s=Di[r],a=Ri[r],n=a&&a[t];if(n&&(q(n,i),n.length||(n=h,delete a[t])),s&&s[t]&&!n){var o=Ui[t],c=s[t];o?o.off(e,c):ki(e,t,c),delete s[t],Ei[r]&&Ei[r]--}Ei[r]||(e[_i]=h,delete Di[r],delete Ri[r])}var ji=Object.freeze({__proto__:null,getBodyElement:function(){return A.body},createElement:function(e,t){return t?A.createElementNS(Bi,e):A.createElement(e)},createText:function(e){return A.createTextNode(e)},createComment:Li,getAttr:function(e,t){var i=e.getAttribute(t);if(i!=d)return i},setAttr:function(e,t,i){i===h?e.removeAttribute(t):e.setAttribute(t,i)},removeAttr:function(e,t){e.removeAttribute(t)},setStyle:function(e,t,i){i!=d?e["float"===t?wi:t]=i:e[t]=S},removeStyle:function(e,t){e[t]=S},before:function(e,t,i){e.insertBefore(t,i)},append:$i,replace:function(e,t,i){e.replaceChild(t,i)},remove:function(e,t){e.removeChild(t)},parent:function(e){var t=e.parentNode;if(t)return t},next:function(e){var t=e.nextSibling;if(t)return t},find:Fi,tag:function(e){if(1===e.nodeType)return ye(e.tagName)},getNodeText:function(e){return e[yi]},setNodeText:function(e,t){e[yi]=t},getElementText:function(e){return e[Ai]},setElementText:function(e,t){e[Ai]=t},getHtml:Oi,setHtml:function(e,t){e[bi]=t},addClass:Ni,removeClass:zi,on:Vi,off:Wi,addSpecialEvent:function(e,t){Ui[e]=t}});function Gi(e,t){return U(e)?+e:t!==h?t:0}function Hi(e,t){if(e==d||t===S)return e;var i=Oe(e,t);return i?i.value:void 0}function qi(e,t,i,r,s,a){var n=function(t,i,n){if(i!==n){for(var o=Me(e,t),c=0;c<s;c++){var l=r[c];Ee(o,l)!==h&&a(l,o,i,n)}qi(o,i,n,r,s,a)}};(function(e,t,i){var r=E(e),s=E(t);if(r||s)return i(g,r?e.length:h,s?t.length:h),c})(t,i,n)||function(e,t,i){var r=C(e),s=C(t);if(r||s){var a=r?e.length:h,n=s?t.length:h;i(g,a,n);for(var o=0,l=Math.max(a||0,n||0);o<l;o++)i(S+o,r?e[o]:h,s?t[o]:h);return c}}(t,i,n)||function(e,t,i){var r=B(e),s=B(t);if(r||s){var a=ie(),n=r?e:T,o=s?t:T;if(r)for(var l in n){var d=n[l];d!==o[l]&&(a.set(l,c),i(l,d,o[l]))}if(s)for(var u in o){var f=o[u];a.get(u)===h&&f!==n[u]&&i(u,n[u],f)}}}(t,i,n)}function Yi(e,t,i,r,s,a){var n;for(var o in r)if(Ce(o))Ee(e,o)!==h?a(o,e,t,i):s&&(n?n.push(o):n=[o]);else{var c=Se(o,e);if(c>=0){var l=ue(o,c),d=Hi(t,l),u=Hi(i,l);d!==u&&a(o,o,d,u)}}n&&qi(e,t,i,n,n.length,a)}var Ki={watcher:k};function Qi(e,t){return M(e)?(Ki.watcher=e,Ki.immediate=t===c,Ki):e}var Xi=0,Ji=function(e,t,i){var r=this;r.id=Xi++,r.data=e||{},r.context=t||r,r.nextTask=i||new Ze,r.syncEmitter=new Ye,r.asyncEmitter=new Ye,r.asyncOldValues={},r.asyncKeypaths={},r.onComputedChange=function(e,t,i){r.diff(e,t,i)}};Ji.prototype.get=function(e,t,i){var r=this.data,s=pi.current;if(e===S)return r;s&&!i&&s.addDynamicDep(this,e);var a=Oe(r,e);return a?a.value:t},Ji.prototype.set=function(e,t){var i=this,r=i.data,s=function(e,t){var s,a=i.get(e);t!==a&&(_e(e,(function(e,i,a){if(0!==i)s&&(i===a?s[e]=t:s=s[e]||(s[e]={}));else{var n=r[e];n&&n instanceof pi?0===a?n.set(t):s=n.get():0===a?r[e]=t:s=r[e]||(r[e]={})}})),i.diff(e,t,a))};if(E(e))s(e,t);else if(B(e))for(var a in e)s(a,e[a])},Ji.prototype.diff=function(e,t,i){var r=this,s=r.syncEmitter,a=r.asyncEmitter,n=r.asyncOldValues,o=r.asyncKeypaths,l=36!==ge(e);Yi(e,t,i,s.listeners,l,(function(e,t,i,r){s.fire({type:e,ns:S},[i,r,t])})),Yi(e,t,i,a.listeners,l,(function(e,t,i,s){for(var l=a.listeners[e],d=0,h=l.length;d<h;d++)l[d].count++;o[t]||(n[t]=s,o[t]={}),o[t][e]=c,r.pending||(r.pending=c,r.nextTask.append((function(){r.pending&&r.diffAsync()})))}))},Ji.prototype.diffAsync=function(){var e=this,t=e.asyncEmitter,i=e.asyncOldValues,r=e.asyncKeypaths;e.pending=h,e.asyncOldValues={},e.asyncKeypaths={};var s=function(s){var a=[e.get(s),i[s],s],n=r[s],o=a[0]!==a[1],c=function(e,t,i){if(i.count)return i.count--,o};for(var l in n)t.fire({type:l,ns:S},a,c)};for(var a in i)s(a)},Ji.prototype.addComputed=function(e,t){var i,r,s,a,n,o=this,l=o.context,d=c,h=c;if(M(t))s=t.bind(l);else if(B(t)){var u=t;R(u.cache)&&(d=u.cache),R(u.sync)&&(h=u.sync),C(u.deps)&&(i=u.deps),J(u.input)||(r=u.input),M(u.output)&&(n=u.output),M(u.get)&&(s=u.get.bind(l)),M(u.set)&&(a=u.set.bind(l))}if(s){var f=new pi(e,d,h,r,n,s,a,o.onComputedChange);return d&&i&&f.addStaticDeps(o,i),o.data[e]=f}},Ji.prototype.removeComputed=function(e){delete this.data[e]},Ji.prototype.watch=function(e,t,i){var r=this,s=r.context,a=r.syncEmitter,n=r.asyncEmitter,o=function(e,t){var i=t.sync?a:n,o={ns:S,listener:t.watcher,ctx:s,count:0};t.once&&(o.max=1),i.on(e,o),t.immediate&&t.watcher.call(s,r.get(e),h,e)};if(E(e))o(e,Qi(t,i));else for(var c in e)o(c,Qi(e[c]))},Ji.prototype.unwatch=function(e,t){this.syncEmitter.off(e,t),this.asyncEmitter.off(e,t)},Ji.prototype.toggle=function(e){var t=!this.get(e);return this.set(e,t),t},Ji.prototype.increase=function(e,t,i){var r=Gi(this.get(e),0)+(t||1);if(!D(i)||r<=i)return this.set(e,r),r},Ji.prototype.decrease=function(e,t,i){var r=Gi(this.get(e),0)-(t||1);if(!D(i)||r>=i)return this.set(e,r),r},Ji.prototype.insert=function(e,t,i){var r=this.get(e),s=(r=C(r)?r.slice():[]).length;if(i===c||i===s)r.push(t);else if(i===l||0===i)r.unshift(t);else{if(!(i>0&&i<s))return;r.splice(i,0,t)}return this.set(e,r),c},Ji.prototype.append=function(e,t){return this.insert(e,t,c)},Ji.prototype.prepend=function(e,t){return this.insert(e,t,l)},Ji.prototype.removeAt=function(e,t){var i=this.get(e);if(C(i)&&t>=0&&t<i.length)return(i=i.slice()).splice(t,1),this.set(e,i),c},Ji.prototype.remove=function(e,t){var i=this.get(e);if(C(i)&&q(i=i.slice(),t))return this.set(e,i),c},Ji.prototype.copy=function(e,t){return $e(e,t)},Ji.prototype.destroy=function(){var e=this;e.syncEmitter.off(),e.asyncEmitter.off(),e.nextTask.clear(),e.data={}};var Zi=function(){this.$emitter=new Ye};Zi.prototype.fire=function(e,t,i){this.$emitter.fire(t,[e,i])},Zi.prototype.on=function(e,t){return this.$emitter.on(e,t),this},Zi.prototype.off=function(e,t){return this.$emitter.off(e,t),this};var er={},tr={},ir={},rr={},sr=/^[#.][-\w+]+$/,ar=new Zi,nr="$$template",or={watcher:function(e){this.update(e,this.$vnode)},sync:c},cr=function(e){return e?e.map(li):e},lr=function(i){var r=this,s=i||T;r.$emitter=new Ye(c),s.events&&r.on(s.events),s.parent&&(r.$parent=s.parent);var a=s[e];a&&a.call(r,s),ar.fire(r,e,{options:s});var n=s.data,o=s.props,d=s.vnode,u=s.propTypes,f=s.computed,g=s.methods,v=s.watchers,y=s.extensions;r.$options=s,y&&Le(r,y);var A=o?$e(o):{};u&&Ue(u,(function(e,t){var i=A[t];i===h&&(i=e.value)!==h&&(A[t]=e.type===m?i:M(i)?i():i)}));var b=r.$observer=new Ji(A,r,r.$nextTask=new Ze);f&&Ue(f,(function(e,t){b.addComputed(t,e)}));var w=M(n)?n.call(r,i):n;B(w)&&Ue(w,(function(e,t){A[t]=e})),g&&Ue(g,(function(e,t){r[t]=e}));var x=h,k=s.el,I=s.root,P=s.model,_=s.context,C=s.replace,D=s.template,R=s.transitions,U=s.components,L=s.directives,$=s.filters,F=s.slots;if(P&&(r.$model=P),E(D)&&sr.test(D)&&(x=Fi(D))&&(D=Oi(x),x=h),k){if(E(k)){var O=k;sr.test(O)&&(x=Fi(O))}else x=k;C||$i(x,x=Li(S))}if(I&&(r.$root=I),_&&(r.$context=_),mr(r,"transition",R),mr(r,p,U),mr(r,"directive",L),mr(r,"filter",$),D){if(v&&b.watch(v),F)for(var N in F)b.addComputed(N,{get:F[N],input:[r],output:cr});b.addComputed(nr,{get:r.render,sync:l}),b.watch(nr,or);var z=s[t];return z&&z.call(r),ar.fire(r,t),r.$template=E(D)?lr.compile(D):D,d||(d=function(e,t,i){var r={context:i,node:t,parentNode:e.parent(t)};switch(t.nodeType){case 1:r.data={},r.tag=e.tag(t),r.type=3,r.operator=jt;break;case 3:r.isPure=c,r.text=t.nodeValue,r.type=1,r.operator=Ot;break;case 8:r.isPure=c,r.text=t.nodeValue,r.type=2,r.operator=Nt}return r}(ji,x,r)),void r.update(r.get(nr),d)}v&&b.watch(v);var V=s[t];V&&V.call(r),ar.fire(r,t)};lr.define=function(e){return e},lr.use=function(e){e.install(lr)},lr.nextTick=function(e,t){Ze.shared().append(e,t)},lr.compile=function(e,t){return e},lr.directive=function(e,t){if(E(e)&&!t)return ur(er,e);pr(er,e,t)},lr.transition=function(e,t){if(E(e)&&!t)return ur(tr,e);pr(tr,e,t)},lr.component=function(e,t){if(E(e)&&!t)return ur(ir,e);pr(ir,e,t)},lr.filter=function(e,t){if(E(e)&&!t)return ur(rr,e);pr(rr,e,t)},lr.method=function(e,t){if(E(e)&&!t)return dr[e];pr(dr,e,t)},lr.prototype.get=function(e,t){return this.$observer.get(e,t)},lr.prototype.set=function(e,t){var i=this.$observer;i&&i.set(e,t)},lr.prototype.on=function(e,t){return vr(this,e,t),this},lr.prototype.once=function(e,t){return vr(this,e,t,c),this},lr.prototype.off=function(e,t){return this.$emitter.off(e,t),this},lr.prototype.fire=function(e,t,i){var r,s=this,a=s.$emitter,n=s.$parent,o=s.$children;if(F.is(e))r=e;else if(E(e))r=new F(e);else{var l=e;(r=new F(l.type)).ns=l.ns}if(r.ns===h){var d=a.toEvent(r.type);r.type=d.type,r.ns=d.ns}r.target||(r.target=s);var u,f=[r];return B(t)?W(f,t):t===c&&(i=c),(u=i&&r.target===s?c:a.fire(r,f))&&(i?o&&(r.phase=F.PHASE_DOWNWARD,O(o,(function(e){return u=e.fire(r,t,c)}))):n&&(r.phase=F.PHASE_UPWARD,u=n.fire(r,t))),u},lr.prototype.watch=function(e,t,i){return this.$observer.watch(e,t,i),this},lr.prototype.unwatch=function(e,t){return this.$observer.unwatch(e,t),this},lr.prototype.loadComponent=function(e,t){hr(this.$components,e,t)||hr(ir,e,t)},lr.prototype.createComponent=function(e,t){var i=this;(e=$e(e)).root=i.$root||i,e.parent=i,e.context=t.context,e.vnode=t,e.replace=c;var r=t.props,s=t.slots,a=t.model;if(a){r||(r={});var n=e.model||"value";r[n]=a.value,e.model=n}r&&(e.props=r),s&&(e.slots=s);var o=new lr(e);W(i.$children||(i.$children=[]),o);var l=o.$el;return l&&(t.node=l),o},lr.prototype.directive=function(e,t){var i=this.$directives;if(E(e)&&!t)return ur(i,e,lr.directive);pr(i||(this.$directives={}),e,t)},lr.prototype.transition=function(e,t){var i=this.$transitions;if(E(e)&&!t)return ur(i,e,lr.transition);pr(i||(this.$transitions={}),e,t)},lr.prototype.component=function(e,t){var i=this.$components;if(E(e)&&!t)return ur(i,e,lr.component);pr(i||(this.$components={}),e,t)},lr.prototype.filter=function(e,t){var i=this.$filters;if(E(e)&&!t)return ur(i,e,lr.filter);pr(i||(this.$filters={}),e,t)},lr.prototype.forceUpdate=function(e){var t=this,i=t.$options,r=t.$vnode,s=t.$nextTask;if(r){if(e){var a=i.beforePropsUpdate;a&&a.call(t,e),t.set(e)}s.run(),e||r!==t.$vnode||t.update(t.get(nr),r)}},lr.prototype.render=function(){var e=this,t=e.$options,s=e.$observer,a=s.data,n=t[i],o=t[r];n&&n.call(e,a),ar.fire(e,i,{props:a});var c=gi(e,e.$template,a,e.$filters,rr,e.$directives,er,e.$transitions,tr,(function(e){var t=pi.current;t&&t.addDynamicDep(s,e)}));return o&&o.call(e),ar.fire(e,r),c},lr.prototype.update=function(e,t){var i,r=this,n=r.$vnode,o=r.$options;if(n){var c=o[a];c&&c.call(r),ar.fire(r,a),ci(ji,e,t),i="afterUpdate"}else{var l=o[s];l&&l.call(r),ar.fire(r,s),ci(ji,e,t),r.$el=e.node,i="afterMount"}r.$vnode=e,lr.nextTick((function(){if(r.$vnode){var e=o[i];e&&e.call(r),ar.fire(r,i)}}))},lr.prototype.checkProp=function(e,t){},lr.prototype.destroy=function(){var e=this,t=e.$parent,i=e.$options,r=e.$emitter,s=e.$observer,a=i[n];a&&a.call(e),ar.fire(e,n),t&&t.$children&&q(t.$children,e);var c,l,d,u=e.$vnode;u&&(d=!t,ii(c=ji,l=u),d&&ri(c,l)),s.destroy();var f=i[o];f&&f.call(e),ar.fire(e,o),r.off(),e.$el=h},lr.prototype.nextTick=function(e){this.$nextTask.append(e,this)},lr.prototype.toggle=function(e){return this.$observer.toggle(e)},lr.prototype.increase=function(e,t,i){return this.$observer.increase(e,t,i)},lr.prototype.decrease=function(e,t,i){return this.$observer.decrease(e,t,i)},lr.prototype.insert=function(e,t,i){return this.$observer.insert(e,t,i)},lr.prototype.append=function(e,t){return this.$observer.append(e,t)},lr.prototype.prepend=function(e,t){return this.$observer.prepend(e,t)},lr.prototype.removeAt=function(e,t){return this.$observer.removeAt(e,t)},lr.prototype.remove=function(e,t){return this.$observer.remove(e,t)},lr.prototype.copy=function(e,t){return this.$observer.copy(e,t)},lr.version="1.0.0-alpha.408",lr.is=L,lr.dom=ji,lr.array=Z,lr.object=ze,lr.string=xe,lr.logger=qe,lr.Event=F,lr.Emitter=Ye,lr.lifeCycle=ar,lr.config=_;var dr=lr.prototype;function hr(e,t,i){if(e&&e[t]){var r=e[t];if(M(r)){e[t]=[i];var s=function(i){var r=e[t],s=i.default||i;e[t]=s,O(r,(function(e){e(s)}))},a=r(s);a&&a.then(s)}else C(r)?W(r,i):i(r);return c}}function ur(e,t,i){return e&&e[t]?e[t]:i?i(t):void 0}function fr(e,t,i,r){r&&r.format&&(i=r.format(i)),e[t]=i}function pr(e,t,i,r){E(t)?fr(e,t,i,r):Ue(t,(function(t,i){fr(e,i,t,r)}))}function mr(e,t,i){M(i)?e[t](i.call(e)):B(i)&&e[t](i)}function gr(e,t,i){e.$emitter.on(t.type,{listener:t.listener,ns:t.ns,max:i?1:-1,ctx:e})}function vr(e,t,i,r){var s=e.$emitter;E(t)?gr(e,s.toFilter(t,i),r):C(t)?O(t,(function(t){gr(e,t,r)})):Ue(t,(function(t,i){gr(e,s.toFilter(i,t),r)}))}return Q(Re(dr)),lr}()},42096:(e,t,i)=>{e.exports=i(74385)},68632:(e,t,i)=>{e.exports=i(37149)},45249:(e,t,i)=>{e.exports=i(87172)},73146:(e,t,i)=>{e.exports=i(85079)},80662:(e,t,i)=>{e.exports=i(92861)},7210:(e,t,i)=>{e.exports=i(11837)},66681:(e,t,i)=>{e.exports=i(92696)},7403:(e,t,i)=>{e.exports=i(22948)},75019:(e,t,i)=>{e.exports=i(62160)},69736:(e,t,i)=>{e.exports=i(47567)},11919:(e,t,i)=>{e.exports=i(21724)},88032:(e,t,i)=>{e.exports=i(27279)},29967:(e,t,i)=>{e.exports=i(25216)},54001:(e,t,i)=>{e.exports=i(34750)},64236:(e,t,i)=>{e.exports=i(31707)},75062:(e,t,i)=>{e.exports=i(16560)},20149:(e,t,i)=>{e.exports=i(48652)},134:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(92696),s=i(87361);function a(e,t,i){return(t=(0,s.A)(t))in e?r(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}},91908:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(23509),s=i(39967);function a(e,t){if("object"!=(0,r.A)(e)||!e)return e;var i=e[s];if(void 0!==i){var a=i.call(e,t||"default");if("object"!=(0,r.A)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}},87361:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(23509),s=i(91908);function a(e){var t=(0,s.A)(e,"string");return"symbol"==(0,r.A)(t)?t:String(t)}},23509:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(16560),s=i(54220);function a(e){return a="function"==typeof r&&"symbol"==typeof s?function(e){return typeof e}:function(e){return e&&"function"==typeof r&&e.constructor===r&&e!==r.prototype?"symbol":typeof e},a(e)}},65749:(e,t,i)=>{"use strict";function r(e){var t=e.toLowerCase().trim().split(/\s*;\s*/);return"banner"===t[0]?{name:t[0],delay:1*t[1]||0,leftToRight:1*t[2]||0,fadeAwayWidth:1*t[3]||0}:/^scroll\s/.test(t[0])?{name:t[0],y1:Math.min(1*t[1],1*t[2]),y2:Math.max(1*t[1],1*t[2]),delay:1*t[3]||0,fadeAwayHeight:1*t[4]||0}:""!==e?{name:e}:null}function s(e){return e?e.toLowerCase().replace(/([+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?)/g," $1 ").replace(/([mnlbspc])/g," $1 ").trim().replace(/\s+/g," ").split(/\s(?=[mnlbspc])/).map((function(e){return e.split(" ").filter((function(e,t){return!(t&&isNaN(1*e))}))})):[]}i.d(t,{wE:()=>S});var a=["b","i","u","s","fsp","k","K","kf","ko","kt","fe","q","p","pbo","a","an","fscx","fscy","fax","fay","frx","fry","frz","fr","be","blur","bord","xbord","ybord","shad","xshad","yshad"].map((function(e){return{name:e,regex:new RegExp("^"+e+"-?\\d")}}));function n(e){for(var t,i={},r=0;r<a.length;r++){var o=a[r],c=o.name;if(o.regex.test(e))return i[c]=1*e.slice(c.length),i}if(/^fn/.test(e))i.fn=e.slice(2);else if(/^r/.test(e))i.r=e.slice(1);else if(/^fs[\d+-]/.test(e))i.fs=e.slice(2);else if(/^\d?c&?H?[0-9a-fA-F]+|^\d?c$/.test(e)){var l=e.match(/^(\d?)c&?H?(\w*)/),d=l[1],h=l[2];i["c"+(d||1)]=h&&("000000"+h).slice(-6)}else if(/^\da&?H?[0-9a-fA-F]+/.test(e)){var u=e.match(/^(\d)a&?H?([0-9a-f]+)/i),f=u[1],p=u[2];i["a"+f]=("00"+p).slice(-2)}else if(/^alpha&?H?[0-9a-fA-F]+/.test(e))t=e.match(/^alpha&?H?([0-9a-f]+)/i),i.alpha=t[1],i.alpha=("00"+i.alpha).slice(-2);else if(/^(?:pos|org|move|fad|fade)\([^)]+/.test(e)){var m=e.match(/^(\w+)\((.*?)\)?$/),g=m[1],v=m[2];i[g]=v.trim().split(/\s*,\s*/).map(Number)}else if(/^i?clip\([^)]+/.test(e)){var y=e.match(/^i?clip\((.*?)\)?$/)[1].trim().split(/\s*,\s*/);i.clip={inverse:/iclip/.test(e),scale:1,drawing:null,dots:null},1===y.length&&(i.clip.drawing=s(y[0])),2===y.length&&(i.clip.scale=1*y[0],i.clip.drawing=s(y[1])),4===y.length&&(i.clip.dots=y.map(Number))}else if(/^t\(/.test(e)){var A=e.match(/^t\((.*?)\)?$/)[1].trim().replace(/\\.*/,(function(e){return e.replace(/,/g,"\n")})).split(/\s*,\s*/);if(!A[0])return i;i.t={t1:0,t2:0,accel:1,tags:A[A.length-1].replace(/\n/g,",").split("\\").slice(1).map(n)},2===A.length&&(i.t.accel=1*A[0]),3===A.length&&(i.t.t1=1*A[0],i.t.t2=1*A[1]),4===A.length&&(i.t.t1=1*A[0],i.t.t2=1*A[1],i.t.accel=1*A[2])}return i}function o(e){for(var t=[],i=0,r="",s=e.split("\\").slice(1).concat("").join("\\"),a=0;a<s.length;a++){var o=s[a];"("===o&&i++,")"===o&&i--,i<0&&(i=0),i||"\\"!==o?r+=o:(r&&t.push(r),r="")}return t.map(n)}function c(e){var t=e.split(/{(.*?)}/),i=[];t[0].length&&i.push({tags:[],text:t[0],drawing:[]});for(var r=1;r<t.length;r+=2){var a=o(t[r]),n=a.reduce((function(e,t){return void 0===t.p?e:!!t.p}),!1);i.push({tags:a,text:n?"":t[r+1],drawing:n?s(t[r+1]):[]})}return{raw:e,combined:i.map((function(e){return e.text})).join(""),parsed:i}}function l(e,t){var i=e.split(",");if(i.length>t.length){var s=i.slice(t.length-1).join();(i=i.slice(0,t.length-1)).push(s)}for(var a,n={},o=0;o<i.length;o++){var l=t[o],d=i[o].trim();switch(l){case"Layer":case"MarginL":case"MarginR":case"MarginV":n[l]=1*d;break;case"Start":case"End":n[l]=(void 0,3600*(a=d.split(":"))[0]+60*a[1]+1*a[2]);break;case"Effect":n[l]=r(d);break;case"Text":n[l]=c(d);break;default:n[l]=d}}return n}var d=["Name","Fontname","Fontsize","PrimaryColour","SecondaryColour","OutlineColour","BackColour","Bold","Italic","Underline","StrikeOut","ScaleX","ScaleY","Spacing","Angle","BorderStyle","Outline","Shadow","Alignment","MarginL","MarginR","MarginV","Encoding"],h=["Layer","Start","End","Style","Name","MarginL","MarginR","MarginV","Effect","Text"];function u(e){var t=d.concat(h);return e.match(/Format\s*:\s*(.*)/i)[1].split(/\s*,\s*/).map((function(e){return t.find((function(t){return t.toLowerCase()===e.toLowerCase()}))||e}))}function f(e,t){var i=e.match(/Style\s*:\s*(.*)/i)[1].split(/\s*,\s*/);return Object.assign.apply(Object,[{}].concat(t.map((function(e,t){var r;return(r={})[e]=i[t],r}))))}function p(e){var t={type:null,prev:null,next:null,points:[]};/[mnlbs]/.test(e[0])&&(t.type=e[0].toUpperCase().replace("N","L").replace("B","C"));for(var i=e.length-!(1&e.length),r=1;r<i;r+=2)t.points.push({x:1*e[r],y:1*e[r+1]});return t}function m(e){return!(!e.points.length||!e.type||/C|S/.test(e.type)&&e.points.length<3)}function g(e){return e.map((function(e){return e.type+e.points.map((function(e){return e.x+","+e.y})).join(",")})).join("")}function v(e){for(var t,i=[],r=0;r<e.length;){var s=e[r],a=p(s);if(m(a)){if("S"===a.type){var n=(i[r-1]||{points:[{x:0,y:0}]}).points.slice(-1)[0],o=n.x,c=n.y;a.points.unshift({x:o,y:c})}r&&(a.prev=i[r-1].type,i[r-1].next=a.type),i.push(a),r++}else{if(r&&"S"===i[r-1].type){var l={p:a.points,c:i[r-1].points.slice(0,3)};i[r-1].points=i[r-1].points.concat((l[s[0]]||[]).map((function(e){return{x:e.x,y:e.y}})))}e.splice(r,1)}}var d=(t=[]).concat.apply(t,i.map((function(e){var t=e.type,i=e.points,r=e.prev,s=e.next;return"S"===t?function(e,t,i){var r=[],s=[0,2/3,1/3,0],a=[0,1/3,2/3,0],n=[0,1/6,2/3,1/6],o=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},c=[e[e.length-1].x,e[0].x,e[1].x,e[2].x],l=[e[e.length-1].y,e[0].y,e[1].y,e[2].y];r.push({type:"M"===t?"M":"L",points:[{x:o(n,c),y:o(n,l)}]});for(var d=3;d<e.length;d++)c=[e[d-3].x,e[d-2].x,e[d-1].x,e[d].x],l=[e[d-3].y,e[d-2].y,e[d-1].y,e[d].y],r.push({type:"C",points:[{x:o(s,c),y:o(s,l)},{x:o(a,c),y:o(a,l)},{x:o(n,c),y:o(n,l)}]});if("L"===i||"C"===i){var h=e[e.length-1];r.push({type:"L",points:[{x:h.x,y:h.y}]})}return r}(i,r,s):{type:t,points:i}})));return Object.assign({instructions:d,d:g(d)},function(e){var t,i=1/0,r=1/0,s=-1/0,a=-1/0;return(t=[]).concat.apply(t,e.map((function(e){return e.points}))).forEach((function(e){var t=e.x,n=e.y;i=Math.min(i,t),r=Math.min(r,n),s=Math.max(s,t),a=Math.max(a,n)})),{minX:i,minY:r,width:s-i,height:a-r}}(i))}var y=["fs","fsp","clip","c1","c2","c3","c4","a1","a2","a3","a4","alpha","fscx","fscy","fax","fay","frx","fry","frz","fr","be","blur","bord","xbord","ybord","shad","xshad","yshad"];function A(e,t,i){var r,s,a;void 0===i&&(i={});var n=e[t];if(void 0===n)return null;if("pos"===t||"org"===t)return 2===n.length?((r={})[t]={x:n[0],y:n[1]},r):null;if("move"===t){var o=n[0],c=n[1],l=n[2],d=n[3],h=n[4];void 0===h&&(h=0);var u=n[5];return void 0===u&&(u=0),4===n.length||6===n.length?{move:{x1:o,y1:c,x2:l,y2:d,t1:h,t2:u}}:null}if("fad"===t||"fade"===t)return 2===n.length?{fade:{type:"fad",t1:n[0],t2:n[1]}}:7===n.length?{fade:{type:"fade",a1:n[0],a2:n[1],a3:n[2],t1:n[3],t2:n[4],t3:n[5],t4:n[6]}}:null;if("clip"===t){var f=n.inverse,p=n.scale,m=n.drawing,g=n.dots;return m?{clip:{inverse:f,scale:p,drawing:v(m),dots:g}}:g?{clip:{inverse:f,scale:p,drawing:m,dots:{x1:g[0],y1:g[1],x2:g[2],y2:g[3]}}}:null}if(/^[xy]?(bord|shad)$/.test(t)&&(n=Math.max(n,0)),"bord"===t)return{xbord:n,ybord:n};if("shad"===t)return{xshad:n,yshad:n};if(/^c\d$/.test(t))return(s={})[t]=n||i[t],s;if("alpha"===t)return{a1:n,a2:n,a3:n,a4:n};if("fr"===t)return{frz:n};if("fs"===t)return{fs:/^\+|-/.test(n)?(1*n>-10?1+n/10:1)*i.fs:1*n};if("K"===t)return{kf:n};if("t"===t){var b=n.t1,w=n.accel,x=n.tags,k=n.t2||1e3*(i.end-i.start),T={};return x.forEach((function(e){var t=Object.keys(e)[0];~y.indexOf(t)&&("clip"!==t||e[t].dots)&&Object.assign(T,A(e,t,i))})),{t:{t1:b,t2:k,accel:w,tag:T}}}return(a={})[t]=n,a}var b=[null,1,2,3,null,7,8,9,null,4,5,6],w=["r","a","an","pos","org","move","fade","fad","clip"];function x(e){for(var t,i,r,s,a,n,o,c=e.styles,l=e.style,d=e.parsed,h=e.start,u=e.end,f={q:c[l].tag.q},p=[],m={style:l,fragments:[]},g={},y=0;y<d.length;y++){for(var x=d[y],k=x.tags,T=x.text,I=x.drawing,S=void 0,P=0;P<k.length;P++){var _=k[P];S=void 0===_.r?S:_.r}for(var M={tag:void 0===S?(o=g,JSON.parse(JSON.stringify(Object.assign({},o,{k:void 0,kf:void 0,ko:void 0,kt:void 0})))):{},text:T,drawing:I.length?v(I):null},C=0;C<k.length;C++){var B=k[C];t=t||b[B.a||0]||B.an,f=A(B,"q")||f,s||(i=i||A(B,"pos")),r=r||A(B,"org"),i||(s=s||A(B,"move")),a=a||A(B,"fade")||A(B,"fad"),n=A(B,"clip")||n;var E=Object.keys(B)[0];if(E&&!~w.indexOf(E)){var D=c[l].tag,R=A(B,E,{start:h,end:u,c1:D.c1,c2:D.c2,c3:D.c3,c4:D.c4,fs:g.fs||D.fs});"t"===E?(M.tag.t=M.tag.t||[],M.tag.t.push(R.t)):Object.assign(M.tag,R)}}if(g=M.tag,void 0!==S&&(p.push(m),m={style:c[S]?S:l,fragments:[]}),M.text||M.drawing){var U=m.fragments[m.fragments.length-1]||{};U.text&&M.text&&!Object.keys(M.tag).length?U.text+=M.text:m.fragments.push(M)}}return p.push(m),Object.assign({alignment:t,slices:p},f,i,r,s,a,n)}function k(e){for(var t=e.styles,i=e.dialogues,r=1/0,s=[],a=0;a<i.length;a++){var n=i[a];if(!(n.Start>=n.End)){t[n.Style]||(n.Style="Default");var o=t[n.Style].style,c=x({styles:t,style:n.Style,parsed:n.Text.parsed,start:n.Start,end:n.End}),l=c.alignment||o.Alignment;r=Math.min(r,n.Layer),s.push(Object.assign({layer:n.Layer,start:n.Start,end:n.End,style:n.Style,name:n.Name,margin:{left:n.MarginL||o.MarginL,right:n.MarginR||o.MarginR,vertical:n.MarginV||o.MarginV},effect:n.Effect},c,{alignment:l}))}}for(var d=0;d<s.length;d++)s[d].layer-=r;return s.sort((function(e,t){return e.start-t.start||e.end-t.end}))}var T={Name:"Default",Fontname:"Arial",Fontsize:"20",PrimaryColour:"&H00FFFFFF&",SecondaryColour:"&H000000FF&",OutlineColour:"&H00000000&",BackColour:"&H00000000&",Bold:"0",Italic:"0",Underline:"0",StrikeOut:"0",ScaleX:"100",ScaleY:"100",Spacing:"0",Angle:"0",BorderStyle:"1",Outline:"2",Shadow:"2",Alignment:"2",MarginL:"10",MarginR:"10",MarginV:"10",Encoding:"1"};function I(e){if(/^(&|H|&H)[0-9a-f]{6,}/i.test(e)){var t=e.match(/&?H?([0-9a-f]{2})?([0-9a-f]{6})/i);return[t[1]||"00",t[2]]}var i=parseInt(e,10);if(!isNaN(i)){var r=-2147483648;if(i<r)return["00","000000"];var s=r<=i&&i<=2147483647?("00000000"+(i<0?i+4294967296:i).toString(16)).slice(-8):String(i).slice(0,8);return[s.slice(0,2),s.slice(2)]}return["00","000000"]}function S(e,t){void 0===t&&(t={});var i=function(e){for(var t={info:{},styles:{format:[],style:[]},events:{format:[],comment:[],dialogue:[]}},i=e.split(/\r?\n/),r=0,s=0;s<i.length;s++){var a=i[s].trim();if(!/^;/.test(a)&&(/^\[Script Info\]/i.test(a)?r=1:/^\[V4\+? Styles\]/i.test(a)?r=2:/^\[Events\]/i.test(a)?r=3:/^\[.*\]/.test(a)&&(r=0),0!==r)){if(1===r&&/:/.test(a)){var n=a.match(/(.*?)\s*:\s*(.*)/),o=n[1],c=n[2];t.info[o]=c}if(2===r&&(/^Format\s*:/i.test(a)&&(t.styles.format=u(a)),/^Style\s*:/i.test(a)&&t.styles.style.push(f(a,t.styles.format))),3===r&&(/^Format\s*:/i.test(a)&&(t.events.format=u(a)),/^(?:Comment|Dialogue)\s*:/i.test(a))){var d=a.match(/^(\w+?)\s*:\s*(.*)/i),h=d[1],p=d[2];t.events[h.toLowerCase()].push(l(p,t.events.format))}}}return t}(e),r=Object.assign(t.defaultInfo||{},i.info),s=function(e){for(var t=e.info,i=e.style,r=e.defaultStyle,s={},a=[Object.assign({},r,{Name:"Default"})].concat(i),n=function(e){var i=Object.assign({},T,a[e]);/^(\*+)Default$/.test(i.Name)&&(i.Name="Default"),Object.keys(i).forEach((function(e){"Name"===e||"Fontname"===e||/Colour/.test(e)||(i[e]*=1)}));var r=I(i.PrimaryColour),n=r[0],o=r[1],c=I(i.SecondaryColour),l=c[0],d=c[1],h=I(i.OutlineColour),u=h[0],f=h[1],p=I(i.BackColour),m=p[0],g=p[1],v={fn:i.Fontname,fs:i.Fontsize,c1:o,a1:n,c2:d,a2:l,c3:f,a3:u,c4:g,a4:m,b:Math.abs(i.Bold),i:Math.abs(i.Italic),u:Math.abs(i.Underline),s:Math.abs(i.StrikeOut),fscx:i.ScaleX,fscy:i.ScaleY,fsp:i.Spacing,frz:i.Angle,xbord:i.Outline,ybord:i.Outline,xshad:i.Shadow,yshad:i.Shadow,fe:i.Encoding,q:/^[0-3]$/.test(t.WrapStyle)?1*t.WrapStyle:2};s[i.Name]={style:i,tag:v}},o=0;o<a.length;o++)n(o);return s}({info:r,style:i.styles.style,defaultStyle:t.defaultStyle||{}});return{info:r,width:1*r.PlayResX||null,height:1*r.PlayResY||null,wrapStyle:/^[0-3]$/.test(r.WrapStyle)?1*r.WrapStyle:2,collisions:r.Collisions||"Normal",styles:s,dialogues:k({styles:s,dialogues:i.events.dialogue})}}var P={M:"m",L:"l",C:"b"};var _=function(e){return function(t){return function(i){return""+t+e+"&H"+i+"&"}}},M=_("c"),C=_("a"),B={c1:M(1),c2:M(2),c3:M(3),c4:M(4),a1:C(1),a2:C(2),a3:C(3),a4:C(4),pos:function(e){return"pos("+[e.x,e.y]+")"},org:function(e){return"org("+[e.x,e.y]+")"},move:function(e){return"move("+[e.x1,e.y1,e.x2,e.y2,e.t1,e.t2]+")"},fade:function(e){return"fad"===e.type?"fad("+[e.t1,e.t2]+")":"fade("+[e.a1,e.a2,e.a3,e.t1,e.t2,e.t3,e.t4]+")"},clip:function(e){return(e.inverse?"i":"")+"clip("+(e.dots?""+[e.dots.x1,e.dots.y1,e.dots.x2,e.dots.y2]:(1===e.scale?"":e.scale+",")+e.drawing.instructions.map((function(e){var t,i=e.type,r=e.points;return(t=[P[i]]).concat.apply(t,r.map((function(e){return[e.x,e.y]}))).join(" ")})).join(" "))+")"},t:function(e){return e.map((function(e){return"t("+[e.t1,e.t2,e.accel,(t=e.tag,Object.keys(t).map((function(e){return"\\"+(B[e]||function(t){return""+e+t})(t[e])})).join(""))]+")";var t})).join("\\")}}},49963:(e,t,i)=>{"use strict";i.d(t,{b:()=>s});var r=i(32517);function s({styles:e,dialogues:t}){let i=1/0;const s=[];for(let a=0;a<t.length;a++){const n=t[a];if(n.Start>=n.End)continue;e[n.Style]||(n.Style="Default");const o=e[n.Style].style,c=(0,r.t)({styles:e,style:n.Style,parsed:n.Text.parsed,start:n.Start,end:n.End}),l=c.alignment||o.Alignment;i=Math.min(i,n.Layer),s.push(Object.assign({layer:n.Layer,start:n.Start,end:n.End,style:n.Style,name:n.Name,margin:{left:n.MarginL||o.MarginL,right:n.MarginR||o.MarginR,vertical:n.MarginV||o.MarginV},effect:n.Effect},c,{alignment:l}))}for(let e=0;e<s.length;e++)s[e].layer-=i;return s.sort(((e,t)=>e.start-t.start||e.end-t.end))}},98786:(e,t,i)=>{"use strict";function r(e){const t={type:null,prev:null,next:null,points:[]};/[mnlbs]/.test(e[0])&&(t.type=e[0].toUpperCase().replace("N","L").replace("B","C"));for(let i=e.length-!(1&e.length),r=1;r<i;r+=2)t.points.push({x:1*e[r],y:1*e[r+1]});return t}function s(e){return!(!e.points.length||!e.type||/C|S/.test(e.type)&&e.points.length<3)}function a(e){return e.map((({type:e,points:t})=>e+t.map((({x:e,y:t})=>`${e},${t}`)).join(","))).join("")}function n(e){const t=[];let i=0;for(;i<e.length;){const a=e[i],n=r(a);if(s(n)){if("S"===n.type){const{x:e,y:r}=(t[i-1]||{points:[{x:0,y:0}]}).points.slice(-1)[0];n.points.unshift({x:e,y:r})}i&&(n.prev=t[i-1].type,t[i-1].next=n.type),t.push(n),i++}else{if(i&&"S"===t[i-1].type){const e={p:n.points,c:t[i-1].points.slice(0,3)};t[i-1].points=t[i-1].points.concat((e[a[0]]||[]).map((({x:e,y:t})=>({x:e,y:t}))))}e.splice(i,1)}}const n=[].concat(...t.map((({type:e,points:t,prev:i,next:r})=>"S"===e?function(e,t,i){const r=[],s=[0,2/3,1/3,0],a=[0,1/3,2/3,0],n=[0,1/6,2/3,1/6],o=(e,t)=>e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3];let c=[e[e.length-1].x,e[0].x,e[1].x,e[2].x],l=[e[e.length-1].y,e[0].y,e[1].y,e[2].y];r.push({type:"M"===t?"M":"L",points:[{x:o(n,c),y:o(n,l)}]});for(let t=3;t<e.length;t++)c=[e[t-3].x,e[t-2].x,e[t-1].x,e[t].x],l=[e[t-3].y,e[t-2].y,e[t-1].y,e[t].y],r.push({type:"C",points:[{x:o(s,c),y:o(s,l)},{x:o(a,c),y:o(a,l)},{x:o(n,c),y:o(n,l)}]});if("L"===i||"C"===i){const t=e[e.length-1];r.push({type:"L",points:[{x:t.x,y:t.y}]})}return r}(t,i,r):{type:e,points:t})));return Object.assign({instructions:n,d:a(n)},function(e){let t=1/0,i=1/0,r=-1/0,s=-1/0;return[].concat(...e.map((({points:e})=>e))).forEach((({x:e,y:a})=>{t=Math.min(t,e),i=Math.min(i,a),r=Math.max(r,e),s=Math.max(s,a)})),{minX:t,minY:i,width:r-t,height:s-i}}(t))}i.d(t,{EB:()=>n})},78040:(e,t,i)=>{"use strict";i.d(t,{W:()=>a});const r={Name:"Default",Fontname:"Arial",Fontsize:"20",PrimaryColour:"&H00FFFFFF&",SecondaryColour:"&H000000FF&",OutlineColour:"&H00000000&",BackColour:"&H00000000&",Bold:"0",Italic:"0",Underline:"0",StrikeOut:"0",ScaleX:"100",ScaleY:"100",Spacing:"0",Angle:"0",BorderStyle:"1",Outline:"2",Shadow:"2",Alignment:"2",MarginL:"10",MarginR:"10",MarginV:"10",Encoding:"1"};function s(e){if(/^(&|H|&H)[0-9a-f]{6,}/i.test(e)){const[,t,i]=e.match(/&?H?([0-9a-f]{2})?([0-9a-f]{6})/i);return[t||"00",i]}const t=parseInt(e,10);if(!Number.isNaN(t)){const e=-2147483648;if(t<e)return["00","000000"];const i=e<=t&&t<=2147483647?`00000000${(t<0?t+4294967296:t).toString(16)}`.slice(-8):String(t).slice(0,8);return[i.slice(0,2),i.slice(2)]}return["00","000000"]}function a({info:e,style:t,defaultStyle:i}){const a={},n=[Object.assign({},i,{Name:"Default"})].concat(t);for(let t=0;t<n.length;t++){const i=Object.assign({},r,n[t]);/^(\*+)Default$/.test(i.Name)&&(i.Name="Default"),Object.keys(i).forEach((e=>{"Name"===e||"Fontname"===e||/Colour/.test(e)||(i[e]*=1)}));const[o,c]=s(i.PrimaryColour),[l,d]=s(i.SecondaryColour),[h,u]=s(i.OutlineColour),[f,p]=s(i.BackColour),m={fn:i.Fontname,fs:i.Fontsize,c1:c,a1:o,c2:d,a2:l,c3:u,a3:h,c4:p,a4:f,b:Math.abs(i.Bold),i:Math.abs(i.Italic),u:Math.abs(i.Underline),s:Math.abs(i.StrikeOut),fscx:i.ScaleX,fscy:i.ScaleY,fsp:i.Spacing,frz:i.Angle,xbord:i.Outline,ybord:i.Outline,xshad:i.Shadow,yshad:i.Shadow,fe:i.Encoding,q:/^[0-3]$/.test(e.WrapStyle)?1*e.WrapStyle:2};a[i.Name]={style:i,tag:m}}return a}},64484:(e,t,i)=>{"use strict";i.d(t,{k:()=>a});var r=i(98786);const s=["fs","fsp","clip","c1","c2","c3","c4","a1","a2","a3","a4","alpha","fscx","fscy","fax","fay","frx","fry","frz","fr","be","blur","bord","xbord","ybord","shad","xshad","yshad"];function a(e,t,i={}){let n=e[t];if(void 0===n)return null;if("pos"===t||"org"===t)return 2===n.length?{[t]:{x:n[0],y:n[1]}}:null;if("move"===t){const[e,t,i,r,s=0,a=0]=n;return 4===n.length||6===n.length?{move:{x1:e,y1:t,x2:i,y2:r,t1:s,t2:a}}:null}if("fad"===t||"fade"===t){if(2===n.length){const[e,t]=n;return{fade:{type:"fad",t1:e,t2:t}}}if(7===n.length){const[e,t,i,r,s,a,o]=n;return{fade:{type:"fade",a1:e,a2:t,a3:i,t1:r,t2:s,t3:a,t4:o}}}return null}if("clip"===t){const{inverse:e,scale:t,drawing:i,dots:s}=n;if(i)return{clip:{inverse:e,scale:t,drawing:(0,r.EB)(i),dots:s}};if(s){const[r,a,n,o]=s;return{clip:{inverse:e,scale:t,drawing:i,dots:{x1:r,y1:a,x2:n,y2:o}}}}return null}if(/^[xy]?(bord|shad)$/.test(t)&&(n=Math.max(n,0)),"bord"===t)return{xbord:n,ybord:n};if("shad"===t)return{xshad:n,yshad:n};if(/^c\d$/.test(t))return{[t]:n||i[t]};if("alpha"===t)return{a1:n,a2:n,a3:n,a4:n};if("fr"===t)return{frz:n};if("fs"===t)return{fs:/^\+|-/.test(n)?(1*n>-10?1+n/10:1)*i.fs:1*n};if("K"===t)return{kf:n};if("t"===t){const{t1:e,accel:t,tags:r}=n,o=n.t2||1e3*(i.end-i.start),c={};return r.forEach((e=>{const t=Object.keys(e)[0];~s.indexOf(t)&&("clip"!==t||e[t].dots)&&Object.assign(c,a(e,t,i))})),{t:{t1:e,t2:o,accel:t,tag:c}}}return{[t]:n}}},32517:(e,t,i)=>{"use strict";i.d(t,{t:()=>o});var r=i(98786),s=i(64484);const a=[null,1,2,3,null,7,8,9,null,4,5,6],n=["r","a","an","pos","org","move","fade","fad","clip"];function o({styles:e,style:t,parsed:i,start:o,end:c}){let l,d,h,u,f,p,m={q:e[t].tag.q};const g=[];let v={style:t,fragments:[]},y={};for(let b=0;b<i.length;b++){const{tags:w,text:x,drawing:k}=i[b];let T;for(let e=0;e<w.length;e++){const t=w[e];T=void 0===t.r?T:t.r}const I={tag:void 0===T?(A=y,JSON.parse(JSON.stringify(Object.assign({},A,{k:void 0,kf:void 0,ko:void 0,kt:void 0})))):{},text:x,drawing:k.length?(0,r.EB)(k):null};for(let i=0;i<w.length;i++){const r=w[i];l=l||a[r.a||0]||r.an,m=(0,s.k)(r,"q")||m,u||(d=d||(0,s.k)(r,"pos")),h=h||(0,s.k)(r,"org"),d||(u=u||(0,s.k)(r,"move")),f=f||(0,s.k)(r,"fade")||(0,s.k)(r,"fad"),p=(0,s.k)(r,"clip")||p;const g=Object.keys(r)[0];if(g&&!~n.indexOf(g)){const i=e[t].tag,{c1:a,c2:n,c3:l,c4:d}=i,h=y.fs||i.fs,u=(0,s.k)(r,g,{start:o,end:c,c1:a,c2:n,c3:l,c4:d,fs:h});"t"===g?(I.tag.t=I.tag.t||[],I.tag.t.push(u.t)):Object.assign(I.tag,u)}}if(y=I.tag,void 0!==T&&(g.push(v),v={style:e[T]?T:t,fragments:[]}),I.text||I.drawing){const e=v.fragments[v.fragments.length-1]||{};e.text&&I.text&&!Object.keys(I.tag).length?e.text+=I.text:v.fragments.push(I)}}var A;return g.push(v),Object.assign({alignment:l,slices:g},m,d,h,u,f,p)}},74672:(e,t,i)=>{"use strict";function r(e){return e?e.toLowerCase().replace(/([+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?)/g," $1 ").replace(/([mnlbspc])/g," $1 ").trim().replace(/\s+/g," ").split(/\s(?=[mnlbspc])/).map((e=>e.split(" ").filter(((e,t)=>!(t&&Number.isNaN(1*e)))))):[]}i.d(t,{O:()=>r})},44453:(e,t,i)=>{"use strict";function r(e){const t=e.toLowerCase().trim().split(/\s*;\s*/);return"banner"===t[0]?{name:t[0],delay:1*t[1]||0,leftToRight:1*t[2]||0,fadeAwayWidth:1*t[3]||0}:/^scroll\s/.test(t[0])?{name:t[0],y1:Math.min(1*t[1],1*t[2]),y2:Math.max(1*t[1],1*t[2]),delay:1*t[3]||0,fadeAwayHeight:1*t[4]||0}:""!==e?{name:e}:null}i.d(t,{d:()=>r})},53534:(e,t,i)=>{"use strict";i.d(t,{E:()=>a});var r=i(74672);const s=["b","i","u","s","fsp","k","K","kf","ko","kt","fe","q","p","pbo","a","an","fscx","fscy","fax","fay","frx","fry","frz","fr","be","blur","bord","xbord","ybord","shad","xshad","yshad"].map((e=>({name:e,regex:new RegExp(`^${e}-?\\d`)})));function a(e){const t={};for(let i=0;i<s.length;i++){const{name:r,regex:a}=s[i];if(a.test(e))return t[r]=1*e.slice(r.length),t}if(/^fn/.test(e))t.fn=e.slice(2);else if(/^r/.test(e))t.r=e.slice(1);else if(/^fs[\d+-]/.test(e))t.fs=e.slice(2);else if(/^\d?c&?H?[0-9a-fA-F]+|^\d?c$/.test(e)){const[,i,r]=e.match(/^(\d?)c&?H?(\w*)/);t[`c${i||1}`]=r&&`000000${r}`.slice(-6)}else if(/^\da&?H?[0-9a-fA-F]+/.test(e)){const[,i,r]=e.match(/^(\d)a&?H?([0-9a-f]+)/i);t[`a${i}`]=`00${r}`.slice(-2)}else if(/^alpha&?H?[0-9a-fA-F]+/.test(e))[,t.alpha]=e.match(/^alpha&?H?([0-9a-f]+)/i),t.alpha=`00${t.alpha}`.slice(-2);else if(/^(?:pos|org|move|fad|fade)\([^)]+/.test(e)){const[,i,r]=e.match(/^(\w+)\((.*?)\)?$/);t[i]=r.trim().split(/\s*,\s*/).map(Number)}else if(/^i?clip\([^)]+/.test(e)){const i=e.match(/^i?clip\((.*?)\)?$/)[1].trim().split(/\s*,\s*/);t.clip={inverse:/iclip/.test(e),scale:1,drawing:null,dots:null},1===i.length&&(t.clip.drawing=(0,r.O)(i[0])),2===i.length&&(t.clip.scale=1*i[0],t.clip.drawing=(0,r.O)(i[1])),4===i.length&&(t.clip.dots=i.map(Number))}else if(/^t\(/.test(e)){const i=e.match(/^t\((.*?)\)?$/)[1].trim().replace(/\\.*/,(e=>e.replace(/,/g,"\n"))).split(/\s*,\s*/);if(!i[0])return t;t.t={t1:0,t2:0,accel:1,tags:i[i.length-1].replace(/\n/g,",").split("\\").slice(1).map(a)},2===i.length&&(t.t.accel=1*i[0]),3===i.length&&(t.t.t1=1*i[0],t.t.t2=1*i[1]),4===i.length&&(t.t.t1=1*i[0],t.t.t2=1*i[1],t.t.accel=1*i[2])}return t}},27637:(e,t,i)=>{"use strict";i.d(t,{r:()=>s});var r=i(53534);function s(e){const t=[];let i=0,s="";const a=e.split("\\").slice(1).concat("").join("\\");for(let e=0;e<a.length;e++){const r=a[e];"("===r&&i++,")"===r&&i--,i<0&&(i=0),i||"\\"!==r?s+=r:(s&&t.push(s),s="")}return t.map(r.E)}},93935:(e,t,i)=>{"use strict";i.d(t,{r:()=>a});var r=i(74672),s=i(27637);function a(e){const t=e.split(/{(.*?)}/),i=[];t[0].length&&i.push({tags:[],text:t[0],drawing:[]});for(let e=1;e<t.length;e+=2){const a=(0,s.r)(t[e]),n=a.reduce(((e,t)=>void 0===t.p?e:!!t.p),!1);i.push({tags:a,text:n?"":t[e+1],drawing:n?(0,r.O)(t[e+1]):[]})}return{raw:e,combined:i.map((e=>e.text)).join(""),parsed:i}}},21194:(e,t,i)=>{"use strict";i.d(t,{By:()=>n,IU:()=>a});var r=i(47924),s=i(77334);function a(e){const{box:t}=e;for(;t.lastChild;)t.lastChild.remove();e.actives=[],e.space=[]}function n(e,t){const{video:i,box:n,layoutRes:o}=t;return function(){const c=i.clientWidth,l=i.clientHeight,d=o.width||i.videoWidth||c,h=o.height||i.videoHeight||l,u=t.scriptRes.width,f=t.scriptRes.height;let p=u,m=f;const g=Math.min(c/d,l/h);"video_width"===e.resampling&&(m=u/d*h),"video_height"===e.resampling&&(p=f/h*d),t.scale=Math.min(c/p,l/m),"script_width"===e.resampling&&(t.scale=g*(d/p)),"script_height"===e.resampling&&(t.scale=g*(h/m));const v=t.scale*p,y=t.scale*m;t.width=v,t.height=y,t.resampledRes={width:p,height:m},n.style.cssText=`width:${v}px;height:${y}px;top:${(l-y)/2}px;left:${(c-v)/2}px;`,n.style.setProperty("--ass-scale",t.scale),n.style.setProperty("--ass-scale-stroke",t.sbas?t.scale:1),function(e){return function(){a(e);const{video:t,dialogues:i}=e,n=t.currentTime-e.delay;e.index=(()=>{for(let e=0;e<i.length;e+=1)if(n<i[e].end)return e;return(i.length||1)-1})(),function(e,t){const{dialogues:i,actives:a}=e,n=t-e.delay;for(let e=a.length-1;e>=0;e-=1){const t=a[e],{end:i}=t;i<n&&(t.$div.remove(),a.splice(e,1))}for(;e.index<i.length&&n>=i[e.index].start;){if(n<i[e.index].end){const t=(0,r.U)(i[e.index],e);(t.animations||[]).forEach((e=>{e.currentTime=1e3*(n-t.start)})),a.push(t),e.video.paused||(0,s.MA)(t,"play")}e.index+=1}}(e,t.currentTime)}}(t)()}}},23873:(e,t,i)=>{"use strict";i.d(t,{Mx:()=>p,Ul:()=>f,nq:()=>h,o3:()=>m});var r=i(77334),s=i(77658),a=i(60913),n=i(57131);function o(e,t){const{name:i,delay:r,leftToRight:s}=e,a="banner"===i?"X":"Y",n={X:s?1:-1,Y:/up/.test(i)?-1:1}[a],o=-100*n;return[[{offset:0,transform:`translate${a}(${o}%)`},{offset:1,transform:`translate${a}(calc(${o}% + var(--ass-scale) * ${t/(r||1)*n}px))`}],{duration:t,fill:"forwards"}]}function c(e){return`calc(var(--ass-scale) * ${e}px)`}function l(e,t){const{x1:i,y1:r,x2:s,y2:a,t1:n,t2:o}=e,l=`translate(${c(i)}, ${c(r)})`,d=`translate(${c(s)}, ${c(a)})`,h=Math.max(o,t);return[[{offset:0,transform:l},n>0?{offset:n/h,transform:l}:null,o>0&&o<t?{offset:o/h,transform:d}:null,{offset:1,transform:d}].filter(Boolean),{duration:h,fill:"forwards"}]}function d(e,t){const{type:i,a1:r,a2:s,a3:a,t1:n,t2:o,t3:c,t4:l}=e;if("fad"===i)return[[[{offset:0,opacity:1},{offset:1,opacity:0}],{duration:o,delay:t-o,fill:"forwards"}],[[{offset:0,opacity:0},{offset:1,opacity:1}],{duration:n,composite:"replace"}]];const d=Math.max(t,l),h=[r,s,a].map((e=>1-e/255));return[[[0,n,o,c,l].map((e=>e/d)).map(((e,t)=>({offset:e,opacity:h[t>>1]}))),{duration:d,fill:"forwards"}]]}function h(e){return[["real-fs",(0,s.F)(e.fn,e.fs)],["tag-fs",e.fs],["tag-fsp",e.fsp],["fill-color",(0,r.qG)(e.a1+e.c1)]].filter((([,e])=>e)).map((([e,t])=>[`--ass-${e}`,t]))}function u(e,t){if(1===t)return"linear";const i=Math.ceil(e/1e3*60);return`linear(${Array.from({length:i+1}).map(((e,r)=>(r/i)**t)).join(",")})`}function f(e,t){const{start:i,end:s,effect:a,move:n,fade:c}=t,h=1e3*(s-i);return[a&&!n?o(a,h):null,n?l(n,h):null,...c?d(c,h):[]].filter(Boolean).map((([t,i])=>(0,r.dT)(e,t,i)))}function p(e,t,i){const a={...i,...t.tag};return(t.tag.t||[]).map((({t1:t,t2:i,accel:n,tag:o})=>{const c=Object.fromEntries(Object.keys(o).flatMap((e=>function(e,t,i){const a=t[i];return void 0===a||"clip"===i?[]:"a1"===i||"c1"===i?[["fill-color",(0,r.qG)((t.a1||e.a1)+(t.c1||e.c1))]]:"a3"===i||"c3"===i?[["border-color",(0,r.qG)((t.a3||e.a3)+(t.c3||e.c3))]]:"a4"===i||"c4"===i?[["shadow-color",(0,r.qG)((t.a4||e.a4)+(t.c4||e.c4))]]:"fs"===i?[["real-fs",(0,s.F)(t.fn||e.fn,t.fs)],["tag-fs",a]]:"fscx"===i||"fscy"===i?[[`tag-${i}`,(a||100)/100]]:"xbord"===i||"ybord"===i?[["border-width",2*a]]:[[`tag-${i}`,a]]}(a,o,e))).map((([e,t])=>[`--ass-${e}`,t])).concat([["offset",1]])),l=Math.max(0,i-t);return(0,r.dT)(e,[c],{duration:l,delay:t,fill:"forwards",easing:u(l,n)})}))}function m(e,t,i){return t.slices.flatMap((e=>e.fragments)).flatMap((e=>e.tag.t||[])).filter((({tag:e})=>e.clip)).map((({t1:t,t2:s,accel:n,tag:o})=>{const c={offset:1,clipPath:(0,a.r)(o.clip,i.scriptRes.width,i.scriptRes.height)},l=Math.max(0,s-t);return(0,r.dT)(e,[c],{duration:l,delay:t,fill:"forwards",easing:u(l,n)})}))}window.CSS.registerProperty&&(["real-fs","tag-fs","tag-fsp","border-width",...["blur","xbord","ybord","xshad","yshad",...n.r8,...n.ge].map((e=>`tag-${e}`))].forEach((e=>{window.CSS.registerProperty({name:`--ass-${e}`,syntax:"<number>",inherits:!0,initialValue:0})})),["border-opacity","shadow-opacity",...n.IZ.map((e=>`tag-${e}`))].forEach((e=>{window.CSS.registerProperty({name:`--ass-${e}`,syntax:"<number>",inherits:!0,initialValue:1})})),["fill-color","border-color","shadow-color"].forEach((e=>{window.CSS.registerProperty({name:`--ass-${e}`,syntax:"<color>",inherits:!0,initialValue:"transparent"})})))},60913:(e,t,i)=>{"use strict";i.d(t,{C:()=>a,r:()=>s});var r=i(23873);function s(e,t,i){if(!e.dots)return"";const{x1:r,y1:s,x2:a,y2:n}=e.dots;return`polygon(evenodd, ${[[r,s],[r,n],[a,n],[a,s],[r,s]].map((([e,r])=>[e/t,r/i])).concat(e.inverse?[[0,0],[0,1],[1,1],[1,0],[0,0]]:[]).map((e=>e.map((e=>100*e+"%")).join(" "))).join(",")})`}function a(e,t){const{clip:i,animations:a}=e;if(!i)return{};const{width:n,height:o}=t.scriptRes,c=document.createElement("div");return t.box.insertBefore(c,e.$div),c.append(e.$div),c.className="ASS-clip-area",c.style.zIndex=e.$div.style.zIndex,c.style.clipPath=i.dots?s(i,n,o):function(e,t,i,r){if(!e.drawing)return"";const s=r.scale/(1<<e.scale-1);let a=e.drawing.instructions.map((({type:e,points:t})=>e+t.map((({x:e,y:t})=>`${e*s},${t*s}`)).join(","))).join("");return e.inverse&&(a+=`M0,0L0,${i},${t},${i},${t},0,0,0Z`),`path(evenodd, "${a}")`}(i,n,o,t),a.push(...(0,r.o3)(c,e,t)),{$div:c}}},21643:(e,t,i)=>{"use strict";i.d(t,{p:()=>c});var r=i(82873),s=i(23873),a=i(39923),n=i(57131),o=i(77334);function c(e,t){const{styles:i}=t,c=document.createElement("div");c.className="ASS-dialogue",c.dataset.wrapStyle=e.q;const l=document.createDocumentFragment(),{align:d,slices:h}=e;[["--ass-align-h",["0%","50%","100%"][d.h]],["--ass-align-v",["100%","50%","0%"][d.v]]].forEach((([e,t])=>{c.style.setProperty(e,t)}));const u=[];return h.forEach((c=>{const d=i[c.style].tag,h=i[c.style].style.BorderStyle;c.fragments.forEach((i=>{const{text:c,drawing:f}=i,p={...d,...i.tag};let m="";const g=[];g.push(...(0,a.F)(p));let v=null;const y=p.xbord||p.ybord||p.xshad||p.yshad;if(y&&(f||"00"!==p.a1||p.xbord!==p.ybord)){const e=(0,a.x)(p,t.sbas?t.scale:1),i=(0,o.An)("svg",[["width",0],["height",0]]);i.append(e.el),v={id:e.id,el:i}}if(g.push(...(0,s.nq)(p)),f||(m+=`font-family:"${p.fn}";`,m+=p.b?`font-weight:${1===p.b?"bold":p.b};`:"",m+=p.i?"font-style:italic;":"",m+=p.u||p.s?`text-decoration:${p.u?"underline":""} ${p.s?"line-through":""};`:""),f&&p.pbo){const e=-p.pbo*(p.fscy||100)/100;m+=`vertical-align:calc(var(--ass-scale) * ${e}px);`}g.push(...(0,n.l1)(p));const A=[p,...(p.t||[]).map((e=>e.tag))],b=n.r8.some((e=>A.some((t=>t[e])))),w=n.IZ.some((e=>A.some((t=>void 0!==t[e]&&100!==t[e])))),x=n.ge.some((e=>A.some((t=>t[e]))));(function(e,t){return e.replace(/\\h/g," ").replace(/\\N/g,"\n").replace(/\\n/g,2===t?"\n":" ")})(c,e.q).split("\n").forEach(((e,a)=>{const n=document.createElement("span"),o=document.createElement("span");if((w||x)&&(w&&(o.dataset.scale=""),x&&(o.dataset.skew=""),o.textContent=e),b&&(n.dataset.rotate=""),f){n.dataset.drawing="";const e=(0,r.v)(i,d,t);if(!e)return;n.style.cssText=e.cssText,n.append(e.$svg)}else{if(a){const e=document.createElement("div");e.dataset.is="br",e.style.setProperty("--ass-tag-fs",p.fs),l.append(e)}if(!e)return;w||x?n.append(o):n.textContent=e;const t=w||x?o:n;t.dataset.text=e,y&&(t.dataset.borderStyle=h,t.dataset.stroke="css"),v&&(t.dataset.stroke="svg",t.style.filter=`url(#${v.id})`,t.append(v.el))}n.style.cssText+=m,g.forEach((([e,t])=>{n.style.setProperty(e,t)})),u.push(...(0,s.Mx)(n,i,d)),l.append(n)}))}))})),u.push(...(0,s.Ul)(c,e)),c.append(l),{$div:c,animations:u}}},82873:(e,t,i)=>{"use strict";i.d(t,{v:()=>a});var r=i(77334),s=i(39923);function a(e,t,i){if(!e.drawing.d)return null;const a={...t,...e.tag},{minX:n,minY:o,width:c,height:l}=e.drawing,d=i.scale/(1<<a.p-1),h=(a.fscx?a.fscx/100:1)*d,u=(a.fscy?a.fscy/100:1)*d,f=a.blur||a.be||0,p=a.xbord+(a.xshad<0?-a.xshad:0)+f,m=a.ybord+(a.yshad<0?-a.yshad:0)+f,g=c*h+2*a.xbord+Math.abs(a.xshad)+2*f,v=l*u+2*a.ybord+Math.abs(a.yshad)+2*f,y=(0,r.An)("svg",[["width",g],["height",v],["viewBox",`${-p} ${-m} ${g} ${v}`]]),A=i.sbas?i.scale:1,b=(0,r.An)("defs"),w=(0,s.x)(a,A);b.append(w.el),y.append(b);const x=`ASS-${(0,r.uR)()}`,k=(0,r.An)("symbol",[["id",x],["viewBox",`${n} ${o} ${c} ${l}`]]);return k.append((0,r.An)("path",[["d",e.drawing.d]])),y.append(k),y.append((0,r.An)("use",[["width",c*h],["height",l*u],["xlink:href",`#${x}`],["filter",`url(#${w.id})`]])),y.style.cssText=`position:absolute;left:${n*h-p}px;top:${o*u-m}px;`,{$svg:y,cssText:`position:relative;width:${c*h}px;height:${l*u}px;`}}},76762:(e,t,i)=>{"use strict";function r(e,t){const i=document.createElement("div");i.className="ASS-effect-area",t.box.insertBefore(i,e.$div),i.append(e.$div);const{width:r,height:s}=t.scriptRes,{name:a,y1:n,y2:o,leftToRight:c,fadeAwayWidth:l,fadeAwayHeight:d}=e.effect,h=Math.min(n,o),u=Math.max(n,o);if(i.dataset.effect=a,"banner"===a&&(i.style.alignItems=c?"flex-start":"flex-end",i.style.justifyContent=["flex-end","center","flex-start"][e.align.v]),a.startsWith("scroll")){const t=h/s*100,r=(s-u)/s*100;i.style.cssText=`top:${t}%;bottom:${r}%;`,i.style.justifyContent=["flex-start","center","flex-end"][e.align.h]}if(d){const e=d/(u-h)*100;i.style.maskImage=[`linear-gradient(#000 ${100-e}%, transparent)`,`linear-gradient(transparent, #000 ${e}%)`].join(",")}if(l){const e=l/r*100;i.style.maskImage=`linear-gradient(90deg, transparent, #000 ${e}%)`}return i}i.d(t,{c:()=>r})},77658:(e,t,i)=>{"use strict";i.d(t,{F:()=>h,Y:()=>d});const r="fontBoundingBoxAscent"in TextMetrics.prototype,s=navigator.userAgent.toLowerCase().includes("firefox"),a=!r&&s?512:2048,n=Object.create(null),o=document.createElement("canvas").getContext("2d"),c=document.createElement("div");c.className="ASS-fix-font-size",c.style.fontSize=`${a}px`;const l=document.createElement("span");l.textContent="0",c.append(l);const d=r?null:c;function h(e,t){if(!n[e])if(r){o.font=`${a}px "${e}"`;const t=o.measureText("");n[e]=t.fontBoundingBoxAscent+t.fontBoundingBoxDescent}else l.style.fontFamily=`"${e}"`,n[e]=l.clientHeight;return t*a/n[e]}},51776:(e,t,i)=>{"use strict";function r(e,t){const{scale:i}=t,{move:r,align:s,width:a,height:n,margin:o,slices:c}=e;let l=0,d=0;if(e.pos||r){const t=e.pos||{x:0,y:0},r=i*t.x,o=i*t.y;l=[r,r-a/2,r-a][s.h],d=[o-n,o-n/2,o][s.v]}else l=[0,(t.width-a)/2,t.width-a-i*o.right][s.h],d=c.some((e=>e.fragments.some((({keyframes:e})=>e?.length))))?[t.height-n-o.vertical,(t.height-n)/2,o.vertical][s.v]:function(e,t){const{video:i,space:r,scale:s}=t,{layer:a,margin:n,width:o,height:c,alignment:l,end:d}=e,h=t.width-Math.trunc(s*(n.left+n.right)),u=t.height,f=Math.trunc(s*n.vertical),p=100*i.currentTime;r[a]=r[a]||{left:{width:new Uint16Array(u+1),end:new Uint32Array(u+1)},center:{width:new Uint16Array(u+1),end:new Uint32Array(u+1)},right:{width:new Uint16Array(u+1),end:new Uint32Array(u+1)}};const m=r[a],g=["right","left","center"][l%3];let v=0,y=0;const A=e=>(v=(e=>{const t=m.left.width[e],i=m.center.width[e],r=m.right.width[e],s=m.left.end[e],a=m.center.end[e],n=m.right.end[e];return"left"===g&&(s>p&&t||a>p&&i&&2*o+i>h||n>p&&r&&o+r>h)||"center"===g&&(s>p&&t&&2*t+o>h||a>p&&i||n>p&&r&&2*r+o>h)||"right"===g&&(s>p&&t&&t+o>h||a>p&&i&&2*o+i>h||n>p&&r)})(e)?0:v+1,v>=c&&(y=e,!0));if(l<=3){y=u-f-1;for(let e=y;e>f&&!A(e);e-=1);}else if(l>=7){y=f+1;for(let e=y;e<u-f&&!A(e);e+=1);}else{y=u-c>>1;for(let e=y;e<u-f&&!A(e);e+=1);}l>3&&(y-=c-1);for(let e=y;e<y+c;e+=1)m[g].width[e]=o,m[g].end[e]=100*d;return y}(e,t);return{x:l+[0,a/2,a][s.h],y:d+[n,n/2,0][s.v]}}i.d(t,{E:()=>r})},47924:(e,t,i)=>{"use strict";i.d(t,{U:()=>l});var r=i(60913),s=i(21643),a=i(51776),n=i(59950),o=i(57131),c=i(76762);function l(e,t){const{$div:i,animations:l}=(0,s.p)(e,t);Object.assign(e,{$div:i,animations:l}),t.box.append(i);const{width:d}=i.getBoundingClientRect();Object.assign(e,{width:d}),i.style.cssText+=(0,n._)(e);const{height:h}=i.getBoundingClientRect();Object.assign(e,{height:h});const{x:u,y:f}=(0,a.E)(e,t);return Object.assign(e,{x:u,y:f}),i.style.cssText+=`left:${u}px;top:${f}px;`,(0,o.Lu)(e,t.scale),Object.assign(e,(0,r.C)(e,t)),e.effect&&Object.assign(e,{$div:(0,c.c)(e,t)}),e}},39923:(e,t,i)=>{"use strict";i.d(t,{F:()=>a,x:()=>s});var r=i(77334);function s(e,t){const i=`ASS-${(0,r.uR)()}`,s=e.xbord||e.ybord,a=e.xshad||e.yshad,n="ff"!==(e.a1||"00").toLowerCase(),o=(e.blur||e.be||0)*t,c=(0,r.An)("filter",[["id",i]]);c.append((0,r.An)("feGaussianBlur",[["stdDeviation",s?0:o],["in","SourceGraphic"],["result","sg_b"]])),c.append((0,r.An)("feFlood",[["flood-color","var(--ass-fill-color)"],["result","c1"]])),c.append((0,r.An)("feComposite",[["operator","in"],["in","c1"],["in2","sg_b"],["result","main"]])),s&&(c.append((0,r.An)("feMorphology",[["radius",`${e.xbord*t} ${e.ybord*t}`],["operator","dilate"],["in","SourceGraphic"],["result","dil"]])),c.append((0,r.An)("feGaussianBlur",[["stdDeviation",o],["in","dil"],["result","dil_b"]])),c.append((0,r.An)("feComposite",[["operator","out"],["in","dil_b"],["in2","SourceGraphic"],["result","dil_b_o"]])),c.append((0,r.An)("feFlood",[["flood-color","var(--ass-border-color)"],["result","c3"]])),c.append((0,r.An)("feComposite",[["operator","in"],["in","c3"],["in2","dil_b_o"],["result","border"]]))),a&&(s||n)&&(c.append((0,r.An)("feOffset",[["dx",e.xshad*t],["dy",e.yshad*t],["in",s?n?"dil":"dil_b_o":"SourceGraphic"],["result","off"]])),c.append((0,r.An)("feGaussianBlur",[["stdDeviation",o],["in","off"],["result","off_b"]])),n||(c.append((0,r.An)("feOffset",[["dx",e.xshad*t],["dy",e.yshad*t],["in","SourceGraphic"],["result","sg_off"]])),c.append((0,r.An)("feComposite",[["operator","out"],["in","off_b"],["in2","sg_off"],["result","off_b_o"]]))),c.append((0,r.An)("feFlood",[["flood-color","var(--ass-shadow-color)"],["result","c4"]])),c.append((0,r.An)("feComposite",[["operator","in"],["in","c4"],["in2",n?"off_b":"off_b_o"],["result","shadow"]])));const l=(0,r.An)("feMerge",[]);return a&&(s||n)&&l.append((0,r.An)("feMergeNode",[["in","shadow"]])),s&&l.append((0,r.An)("feMergeNode",[["in","border"]])),l.append((0,r.An)("feMergeNode",[["in","main"]])),c.append(l),{id:i,el:c}}function a(e){return[["border-width",2*e.xbord],["border-color",(0,r.qG)(`${e.a3}${e.c3}`)],["shadow-color",(0,r.qG)(`${e.a4}${e.c4}`)],["tag-blur",e.blur||e.be||0],["tag-xbord",e.xbord],["tag-ybord",e.ybord],["tag-xshad",e.xshad],["tag-yshad",e.yshad]].map((([e,t])=>[`--ass-${e}`,t]))}},59950:(e,t,i)=>{"use strict";function r(e){const{layer:t,align:i,effect:r,pos:s,margin:a,q:n}=e;let o="";return t&&(o+=`z-index:${t};`),o+=`text-align:${["left","center","right"][i.h]};`,r||(2!==n&&(o+=`max-width:calc(100% - var(--ass-scale) * ${a.left+a.right}px);`),s||(0!==i.h&&(o+=`padding-right:calc(var(--ass-scale) * ${a.right}px);`),2!==i.h&&(o+=`padding-left:calc(var(--ass-scale) * ${a.left}px);`))),o}i.d(t,{_:()=>r})},57131:(e,t,i)=>{"use strict";i.d(t,{IZ:()=>s,Lu:()=>o,ge:()=>a,l1:()=>n,r8:()=>r});const r=["frx","fry","frz"],s=["fscx","fscy"],a=["fax","fay"];function n(e){return[...[...r,...a].map((t=>[`--ass-tag-${t}`,`${e[t]||0}`])),...s.map((t=>[`--ass-tag-${t}`,e.p?1:(e[t]||100)/100]))]}function o(e,t){const{align:i,width:r,height:s,x:a,y:n,$div:o}=e,c=(e.org?e.org.x*t:a)+[0,r/2,r][i.h],l=(e.org?e.org.y*t:n)+[s,s/2,0][i.v];for(let e=o.childNodes.length-1;e>=0;e-=1){const t=o.childNodes[e];if(""===t.dataset.rotate){const e=c-a-t.offsetLeft,i=l-n-t.offsetTop;t.style.cssText+=`transform-origin:${e}px ${i}px;`}}}},77334:(e,t,i)=>{"use strict";function r(e){const t=e.match(/(\w\w)(\w\w)(\w\w)(\w\w)/),i=function(e){return 1-`0x${e}`/255}(t[1]),r=+`0x${t[2]}`,s=+`0x${t[3]}`;return`rgba(${+`0x${t[4]}`},${s},${r},${i})`}function s(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=Math.trunc(16*Math.random());return("x"===e?t:3&t|8).toString(16)}))}function a(e,t=[]){const i=document.createElementNS("http://www.w3.org/2000/svg",e);for(let e=0;e<t.length;e+=1){const r=t[e];i.setAttributeNS("xlink:href"===r[0]?"http://www.w3.org/1999/xlink":null,r[0],r[1])}return i}function n(e,t,i){const r=e.animate(t,i);return r.pause(),r}function o(e,t){(e.animations||[]).forEach((e=>{e[t]()}))}i.d(t,{An:()=>a,MA:()=>o,dT:()=>n,qG:()=>r,uR:()=>s})}},r={};function s(e){var t=r[e];if(void 0!==t)return t.exports;var a=r[e]={exports:{}};return i[e].call(a.exports,a,a.exports,s),a.exports}s.m=i,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,i)=>(s.f[i](e,t),t)),[])),s.u=e=>e+".avplayer.js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="AVPlayer:",s.l=(i,r,a,n)=>{if(e[i])e[i].push(r);else{var o,c;if(void 0!==a)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var h=l[d];if(h.getAttribute("src")==i||h.getAttribute("data-webpack")==t+a){o=h;break}}o||(c=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,s.nc&&o.setAttribute("nonce",s.nc),o.setAttribute("data-webpack",t+a),o.src=i),e[i]=[r];var u=(t,r)=>{o.onerror=o.onload=null,clearTimeout(f);var s=e[i];if(delete e[i],o.parentNode&&o.parentNode.removeChild(o),s&&s.forEach((e=>e(r))),t)return t(r)},f=setTimeout(u.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=u.bind(null,o.onerror),o.onload=u.bind(null,o.onload),c&&document.head.appendChild(o)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var r=i.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=i[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={792:0};s.f.j=(t,i)=>{var r=s.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var a=new Promise(((i,s)=>r=e[t]=[i,s]));i.push(r[2]=a);var n=s.p+s.u(t),o=new Error;s.l(n,(i=>{if(s.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var a=i&&("load"===i.type?"missing":i.type),n=i&&i.target&&i.target.src;o.message="Loading chunk "+t+" failed.\n("+a+": "+n+")",o.name="ChunkLoadError",o.type=a,o.request=n,r[1](o)}}),"chunk-"+t,t)}};var t=(t,i)=>{var r,a,[n,o,c]=i,l=0;if(n.some((t=>0!==e[t]))){for(r in o)s.o(o,r)&&(s.m[r]=o[r]);c&&c(s)}for(t&&t(i);l<n.length;l++)a=n[l],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0},i=self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var a=s(72631);return a.default})()));