"use strict";(self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[]).push([[642],{38743:(t,e,i)=>{i.d(e,{B:()=>d,h:()=>c});var s=i(49859),r=i(73363),a=i.n(r),n=i(77231),o=i(50011);class h{constructor(){(0,s.A)(this,"list",void 0),this.list=[]}read(t,e){for(let i=0;i<e;i++){const e=t.readUint32();this.list.push(t.readString(e))}}write(t){for(let e=0;e<this.list.length;e++){const i=o.encode(this.list[e]);t.writeUint32(i.length),t.writeBuffer(i)}}addComment(t){this.list.push(t)}}class d{constructor(){(0,s.A)(this,"capturePattern",void 0),(0,s.A)(this,"streamStructureVersion",void 0),(0,s.A)(this,"headerTypeFlag",void 0),(0,s.A)(this,"granulePosition",void 0),(0,s.A)(this,"serialNumber",void 0),(0,s.A)(this,"pageSequenceNumber",void 0),(0,s.A)(this,"crcCheckSum",void 0),(0,s.A)(this,"numberPageSegments",void 0),(0,s.A)(this,"segmentTable",void 0),(0,s.A)(this,"payload",void 0),(0,s.A)(this,"pos",void 0),this.reset()}reset(){this.capturePattern="OggS",this.streamStructureVersion=0,this.headerTypeFlag=0,this.granulePosition=n.Dh,this.serialNumber=0,this.pageSequenceNumber=0,this.crcCheckSum=0,this.numberPageSegments=0,this.segmentTable=[],this.pos=BigInt(0)}async read(t){var e;this.pos=t.getPos(),await this.readPageHeader(t);const i=a()(e=this.segmentTable).call(e,((t,e)=>t+e),0);i&&(this.payload=await t.readBuffer(i))}async readPageHeader(t){if(this.capturePattern=await t.readString(4),this.streamStructureVersion=await t.readUint8(),this.headerTypeFlag=await t.readUint8(),this.granulePosition=await t.readUint64(),this.serialNumber=await t.readUint32(),this.pageSequenceNumber=await t.readUint32(),this.crcCheckSum=await t.readUint32(),this.numberPageSegments=await t.readUint8(),this.numberPageSegments)for(let e=0;e<this.numberPageSegments;e++){const e=await t.readUint8();this.segmentTable.push(e)}}write(t){if(this.pos=t.getPos(),t.writeString(this.capturePattern),t.writeUint8(this.streamStructureVersion),t.writeUint8(this.headerTypeFlag),t.writeUint64(this.granulePosition),t.writeUint32(this.serialNumber),t.writeUint32(this.pageSequenceNumber),t.writeUint32(this.crcCheckSum),this.payload){this.numberPageSegments=Math.floor(this.payload.length/255)+1;const e=this.payload.length%255;t.writeUint8(this.numberPageSegments);for(let e=0;e<this.numberPageSegments-1;e++)t.writeUint8(255);t.writeUint8(e),t.writeBuffer(this.payload)}else t.writeUint8(0)}}class c{constructor(){(0,s.A)(this,"streamIndex",void 0),(0,s.A)(this,"signature",void 0),(0,s.A)(this,"vendorStringLength",void 0),(0,s.A)(this,"vendorString",void 0),(0,s.A)(this,"userCommentListLength",void 0),(0,s.A)(this,"comments",void 0),this.vendorString="libmedia-v0.6.1-355-g72ba4aa7",this.vendorStringLength=this.vendorString.length,this.userCommentListLength=0,this.comments=new h}read(t){this.vendorStringLength=t.readUint32(),this.vendorString=t.readString(this.vendorStringLength),this.userCommentListLength=t.readUint32(),this.userCommentListLength&&this.comments.read(t,this.userCommentListLength)}write(t){const e=o.encode(this.vendorString);t.writeUint32(e.length),t.writeBuffer(e),t.writeUint32(this.comments.list.length),this.comments.write(t)}addComment(t){this.comments.addComment(t)}setCodec(t){}}},87400:(t,e,i)=>{i.d(e,{GM:()=>u,mS:()=>l,ol:()=>g});var s=i(49859),r=i(86226),a=i.n(r),n=i(11265),o=i.n(n),h=i(54810),d=i.n(h),c=i(38743);i(95335),i(34677);const m={album:"album",artist:"artist",description:"description",encoder:"encoder",title:"title",tracknumber:"track",date:"date",genre:"genre",comment:"comment",albumartist:"albumArtist",composer:"composer",performer:"performer",discnumber:"disc",organization:"vendor",copyright:"copyright",license:"license",isrc:"isrc",lyrics:"lyrics",language:"language",label:"vendor",script:"lyrics",encoded_by:"vendor"};function g(t,e){t&&a()(t).call(t,(t=>{const i=t.split("=");if(2===i.length){var s,r;const t=o()(s=i[0]).call(s).toLowerCase(),a=o()(r=i[1]).call(r);m[t]?e[m[t]]=a:e[t.toLowerCase()]=a}}))}class l{constructor(t="vorbis"){(0,s.A)(this,"streamIndex",void 0),(0,s.A)(this,"packetType",void 0),(0,s.A)(this,"signature",void 0),(0,s.A)(this,"version",void 0),(0,s.A)(this,"channels",void 0),(0,s.A)(this,"sampleRate",void 0),(0,s.A)(this,"bitrateMaximum",void 0),(0,s.A)(this,"bitrateNominal",void 0),(0,s.A)(this,"bitrateMinimum",void 0),(0,s.A)(this,"blocksize0",void 0),(0,s.A)(this,"blocksize1",void 0),(0,s.A)(this,"framingFlag",void 0),this.signature=t,this.version=0,this.channels=1,this.sampleRate=48e3,this.bitrateMaximum=0,this.bitrateNominal=0,this.bitrateMinimum=0,this.blocksize0=2048,this.blocksize1=256}read(t){this.packetType=t.readUint8(),this.signature=t.readString(6),this.version=t.readUint32(),this.channels=t.readUint8(),this.sampleRate=t.readInt32(),this.bitrateMaximum=t.readInt32(),this.bitrateNominal=t.readInt32(),this.bitrateMinimum=t.readInt32();const e=255&t.readUint8();this.blocksize0=Math.pow(2,e>>>4),this.blocksize1=Math.pow(2,15&e),this.framingFlag=t.readUint8()}write(t){t.writeUint8(1),t.writeString(this.signature),t.writeUint32(this.version),t.writeUint8(this.channels),t.writeInt32(this.sampleRate),t.writeInt32(this.bitrateMaximum),t.writeInt32(this.bitrateNominal),t.writeInt32(this.bitrateMinimum),t.writeUint8(d()(this.blocksize0)<<4|d()(this.blocksize1)),t.writeUint8(1)}setCodec(t){this.sampleRate=t.sampleRate,this.channels=t.chLayout.nbChannels}}class u extends c.h{constructor(t="vorbis"){super(),(0,s.A)(this,"packetType",void 0),(0,s.A)(this,"framingFlag",void 0),this.signature=t,this.packetType=1,this.framingFlag=1}read(t){this.packetType=t.readUint8(),this.signature=t.readString(6),super.read(t),"vorbis"===this.signature&&(this.framingFlag=t.readUint8())}write(t){t.writeUint8(this.packetType),t.writeString(this.signature),super.write(t),"vorbis"===this.signature&&t.writeUint8(this.framingFlag)}addComment(t){this.comments.addComment(t)}setCodec(t){}}},2187:(t,e,i)=>{i.d(e,{d:()=>n});var s=i(72739),r=i(44328),a=i(77231);function n(t,e,i){let n=BigInt(0);return s.__(t,(t=>{n+=t.codecpar.bitrate*(0,r.k)(e,i,a.i0)/BigInt(8e3)})),n}},52071:(t,e,i)=>{i.d(e,{A:()=>l});var s=i(52730),r=i.n(s),a=i(63939),n=(i(9599),i(77231)),o=i(44328),h=i(2187),d=i(71517),c=i(9705),m=i(4624);const g="src/avformat/function/seekInBytes.ts";async function l(t,e,i,s,l,u){const p=t.ioReader.getPos(),w=await t.ioReader.fileSize();let b=n.Dh,v=i;e.startTime!==n.Dh?v-=e.startTime:v-=e.firstDTS;const f=(0,o.k)(i,e.timeBase,n.i0);if(f<BigInt(1e4))return m.Yz(`seek pts is earlier then 10s, seek to first packet pos(${s}) directly`,g,64),await t.ioReader.seek(s),p;let k=(0,h.d)(t.streams,v,e.timeBase);const S=w-(0,h.d)(t.streams,BigInt(1e4),n.i0),U=(0,h.d)(t.streams,BigInt(1e4),n.i0);if(k>S&&(k=S),k<s)return await t.ioReader.seek(s),p;const A=(0,d._5)();let y=w,I=BigInt(0);t:for(;y-I<U&&(k=I),await t.ioReader.seek(k),await u(t),!(8&r()(t.ioReader));){let i=await l(t,A),s=a.f[17](A+56);if(!(i>=0)){b=n.Dh;break}{const r=(0,o.Mr)(a.f[17](A+8),A+72,n.i0);let h=r-f;if(m.Yz(`try to seek to pos: ${k}, got packet pts: ${a.f[17](A+8)}(${r}ms), diff: ${h}ms`,g,101),h<=BigInt(0)&&-h<BigInt(1e4)||y-I<U){const r=[s];for(;h<=0;){if(a.f[15](A+32)===e.index&&1&a.f[15](A+36)&&r.push(s),(0,d.Up)(A),i=await l(t,A),i<0){if(-1048576===i)break;if(-1048575===i)continue;b=n.Dh;break t}s=a.f[17](A+56),h=(0,o.Mr)(a.f[17](A+8),A+72,n.i0)-f}b=r.pop();break}h>BigInt(0)?(y=k,k=I+y>>BigInt(1)):(I=k,k=I+y>>BigInt(1))}if(8&r()(t.ioReader))break}return(0,d.Qe)(A),b!==n.Dh?(m.Yz(`finally seek to pos ${b}`,g,156),await t.ioReader.seek(b),await u(t),p):(await t.ioReader.seek(p),8&r()(t.ioReader)?BigInt(c.LT):BigInt(c.E$))}}}]);