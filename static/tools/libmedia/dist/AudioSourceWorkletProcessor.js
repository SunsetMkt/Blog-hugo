var processor;(()=>{"use strict";var t={399:(t,e,r)=>{r.d(e,{A:()=>n});var s=r(8590),i=r(2494);function n(t,e,r){if(s.Pc(t))return s.YO(r)?t.apply(e,r):e!==i.ZH?t.call(e,r):r!==i.ZH?t(r):t()}},665:(t,e,r)=>{r.d(e,{C:()=>f,__:()=>o});var s=r(8590),i=r(3321),n=r(2494);function o(t,e){for(let r in t)if(e(t[r],r)===n.W8)break}function f(t,e){let r=t;return s.YO(t)?e?(r=[],i.__(t,(function(t,s){r[s]=f(t,e)}))):r=t.slice():s.Ik(t)&&(r={},o(t,(function(t,s){r[s]=e?f(t,e):t}))),r}},1042:(t,e,r)=>{r.d(e,{A:()=>h});var s=r(4467),i=r(8590),n=r(3321),o=r(5041),f=r(665),u=r(8927),a=r(399),c=r(2494);class h{constructor(t){(0,s.A)(this,"ns",void 0),(0,s.A)(this,"listeners",void 0),(0,s.A)(this,"nativeListeners",void 0),this.ns=t||c.W8,this.listeners={}}fire(t,e,r){let s=this,u=i.Yj(t)?s.parse(t):t,h=s.listeners[u.type],p=c.rT;if(h){h=f.C(h);const t=e&&e[0]instanceof o.A?e[0]:c.ZH;n.__(h,(function(i){if(!d(u.ns,i,c.rT)||!n.zy(h,i)||r&&!r(u,e,i))return;t&&(t.listener=i.fn);let o=(0,a.A)(i.fn,i.ctx,e);return t&&(t.listener=c.ZH),i.num=i.num?i.num+1:1,i.num===i.max&&s.off(u,i.fn),t&&(o===c.W8?t.prevent().stop():t.isStopped&&(o=c.W8)),o===c.W8?p=c.W8:void 0}))}return p}on(t,e){const r=this,s=r.listeners,o=i.Pc(e)?{fn:e}:e;if(i.Ik(o)&&i.Pc(o.fn)){const e=i.Yj(t)?r.parse(t):t;o.ns=e.ns,n.VC(s[e.type]||(s[e.type]=[]),o)}return this}one(t,e){return i.Pc(e)?e={fn:e,max:1}:e.max=1,this.on(t,e)}off(t,e){const r=this,s=r.listeners;if(t){const o=i.Yj(t)?r.parse(t):t,u=o.type,a=o.ns,h=l(e),p=function(t,e){n.__(t,(function(e,r){h(e)&&t.splice(r,1)}),c.rT),t.length||delete s[e]},y=function(t,e){n.__(t,(function(e,r){d(a,e)&&t.splice(r,1)}),c.rT),t.length||delete s[e]};u?s[u]&&p(s[u],u):a&&f.__(s,y)}else r.listeners={}}has(t,e){let r=this.listeners,s=i.Yj(t)?this.parse(t):t,o=s.type,u=s.ns,a=c.rT,h=l(e);var p;return o?r[o]&&(p=r[o],n.__(p,(function(t){if(h(t))return a=c.W8}))):u&&f.__(r,(function(t){return n.__(t,(function(t){if(d(u,t))return a=c.W8})),a})),!a}parse(t){const e={type:t,ns:c.u1};if(this.ns){const r=u.qh(t,c.ZG);r>=0&&(e.type=u.di(t,0,r),e.ns=u.di(t,r+1))}return e}}function p(){return c.rT}function l(t){return i.Pc(t)?function(e){return t===e.fn}:p}function d(t,e,r){const{ns:s}=e;return s&&t?s===t:r?c.rT:c.W8}},2284:(t,e,r)=>{function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}r.d(e,{A:()=>s})},2327:(t,e,r)=>{r.d(e,{A:()=>i});var s=r(2284);function i(t,e){if("object"!=(0,s.A)(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=(0,s.A)(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}},2494:(t,e,r)=>{r.d(e,{Cq:()=>n,Cy:()=>f,M_:()=>p,TK:()=>l,W8:()=>i,ZG:()=>c,ZH:()=>o,aV:()=>u,rT:()=>s,s0:()=>a,u1:()=>y,x7:()=>d});const s=!0,i=!1,n=null,o=void 0,f=-1,u="undefined",a="function",c=".",h=typeof window!==u?window:o,p=(typeof document!==u&&document,typeof globalThis!==u?globalThis:typeof r.g!==u?r.g:h),l=typeof self!==u?self:p,d=function(){},y=(Object.freeze({}),Object.freeze([]),"")},2935:(t,e,r)=>{r.d(e,{Ay:()=>f,S3:()=>o});var s=r(4467),i=r(1042),n=r(5967);const o="request";class f extends i.A{constructor(t){super(!0),(0,s.A)(this,"port",void 0),(0,s.A)(this,"requestMap",void 0),(0,s.A)(this,"seq",void 0),(0,s.A)(this,"closed",void 0),this.port=t,this.port.onmessage=this.handle.bind(this),this.seq=0,this.requestMap=new Map,this.port.start(),this.closed=!1}handle(t){const e=t.data,r=e.type,s=e.data;if("notify"===r)this.fire("notify",s);else if("reply"===r){const t=this.requestMap.get(s.seq);t&&((0,n.A)(s.result)?t.resolve(s.result):s.error?t.reject(s.error):t.resolve(void 0),this.requestMap.delete(s.seq))}else"request"===r&&this.fire(o,s)}notify(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.port.postMessage({type:"notify",data:{method:t,params:e}},r)}async request(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return new Promise(((s,i)=>{const n=this.seq++;this.requestMap.set(n,{resolve:s,reject:i}),this.port.postMessage({type:"request",data:{seq:n,method:t,params:e}},r)}))}reply(t,e,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const i={seq:t.seq};(0,n.A)(e)?i.result=e:r&&(i.error=r),null!=s&&s.length?this.port.postMessage({type:"reply",data:i},s):this.port.postMessage({type:"reply",data:i})}getPort(){return this.port}destroy(){this.requestMap.size&&(this.requestMap.forEach((t=>{t.reject("ipc port close")})),this.requestMap.clear()),this.port&&(this.port.close(),this.port=null),this.closed=!0}}},3321:(t,e,r)=>{r.d(e,{VC:()=>f,__:()=>n,zy:()=>u});var s=r(8590),i=r(2494);function n(t,e,r){if(!t)return;const{length:s}=t;if(s)if(r)for(let r=s-1;r>=0&&e(t[r],r)!==i.W8;r--);else for(let r=0;r<s&&e(t[r],r)!==i.W8;r++);}function o(t,e){t[t.length]=e}function f(t,e){!function(t,e,r){s.YO(e)?n(e,(function(e){r(t,e)})):r(t,e)}(t,e,o)}function u(t,e,r){return function(t,e,r){let s=i.Cy;return n(t,(function(t,n){if(r===i.W8?t==e:t===e)return s=n,i.W8})),s}(t,e,r)>=0}},4467:(t,e,r)=>{r.d(e,{A:()=>i});var s=r(9922);function i(t,e,r){return(e=(0,s.A)(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}},4566:(t,e,r)=>{r.d(e,{A:()=>i});var s=r(2494);function i(t,e){return t!=s.Cq&&t.toString?t.toString():e!==s.ZH?e:s.u1}},5041:(t,e,r)=>{r.d(e,{A:()=>n});var s=r(4467),i=r(2494);class n{constructor(t,e){(0,s.A)(this,"type",void 0),(0,s.A)(this,"phase",void 0),(0,s.A)(this,"ns",void 0),(0,s.A)(this,"target",void 0),(0,s.A)(this,"originalEvent",void 0),(0,s.A)(this,"isPrevented",void 0),(0,s.A)(this,"isStopped",void 0),(0,s.A)(this,"listener",void 0),this.type=t,this.phase=n.PHASE_CURRENT,e&&(this.originalEvent=e)}preventDefault(){const t=this;if(!t.isPrevented){const{originalEvent:e}=t;e&&e.preventDefault(),t.isPrevented=i.rT}return t}stopPropagation(){const t=this;if(!t.isStopped){const{originalEvent:e}=t;e&&e.stopPropagation(),t.isStopped=i.rT}return t}prevent(){return this.preventDefault()}stop(){return this.stopPropagation()}}(0,s.A)(n,"PHASE_CURRENT",0),(0,s.A)(n,"PHASE_UPWARD",1),(0,s.A)(n,"PHASE_DOWNWARD",i.Cy)},5967:(t,e,r)=>{r.d(e,{A:()=>i});var s=r(2494);function i(t){return t!==s.ZH}},7084:(t,e,r)=>{r.d(e,{A:()=>o});var s=r(3321);const i=[["harmony",/harmonyos ([\d_.]+)/],["harmony",/openharmony ([\d_.]+)/],["iphone",/iphone os ([\d_.]+)/],["ipad",/ipad; cpu os ([\d_.]+)/],["itouch",/itouch; cpu os ([\d_.]+)/],["android",/android ([\d_.]+)/],["wp",/windows phone ([\d_.]+)/],["windows",/windows nt ([\d_.]+)/],["linux",/linux/],["mac",/mac os x ([\d_.]+)/]],n=function(t){let e,r;return(0,s.__)(i,(s=>{let i=s[1].exec(t);if(i)return e=s[0],r=i[1],r&&(r=r.replace(/_/g,".")),!1})),{name:e||"",version:r||"",mobile:t.indexOf("mobile")>-1}}(("object"==typeof navigator&&navigator.userAgent||"").toLowerCase());n.name&&(n[n.name]=!0,{iphone:1,ipad:1,itouch:1}[n.name]&&(n.ios=!0));const o=n},8590:(t,e,r)=>{r.d(e,{Ik:()=>o,Pc:()=>i,YO:()=>n,Yj:()=>f,ai:()=>u});var s=r(2494);function i(t){return typeof t===s.s0}function n(t){return Array.isArray(t)}function o(t){return t!==s.Cq&&"object"==typeof t}function f(t){return"string"==typeof t}function u(t){return"number"==typeof t&&!isNaN(t)}},8644:(t,e,r)=>{r.d(e,{A:()=>n});var s=r(4467),i=r(2935);class n extends AudioWorkletProcessor{constructor(){super(),(0,s.A)(this,"ipcPort",void 0),this.ipcPort=new i.Ay(this.port)}async request(t,e,r){return this.ipcPort.request(t,e,r)}notify(t,e,r){this.ipcPort.notify(t,e,r)}}},8927:(t,e,r)=>{r.d(e,{di:()=>n,qh:()=>o});var s=r(8590),i=r(2494);function n(t,e,r){return s.ai(r)?e===r?i.u1:t.slice(e,r):t.slice(e)}function o(t,e,r){return t.indexOf(e,r!==i.ZH?r:0)}},9906:(t,e,r)=>{r.d(e,{pq:()=>h});var s=r(2494),i=r(4566);const n=0,o=2,f=5,u=typeof console!==s.aV?console:s.Cq,a=/common/.test((0,i.A)(s.x7))?o:3,c=u?function(t,e){u.log(t,e)}:s.x7;function h(t,e,r){(function(){if(s.M_){const t=s.TK.COMMON_LOG_LEVEL;if(t>=n&&t<=f)return t}return a})()<=o&&c(`[${arguments[1]}][line ${arguments[2]}] [info]`,t)}u||s.x7,u||s.x7},9922:(t,e,r)=>{r.d(e,{A:()=>n});var s=r(2284),i=r(2327);function n(t){var e=(0,i.A)(t,"string");return"symbol"==(0,s.A)(e)?e:e+""}}},e={};function r(s){var i=e[s];if(void 0!==i)return i.exports;var n=e[s]={exports:{}};return t[s](n,n.exports,r),n.exports}r.d=(t,e)=>{for(var s in e)r.o(e,s)&&!r.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var s={};r.r(s),r.d(s,{default:()=>h});var i=r(4467),n=r(8644),o=r(7084),f=r(8590),u=r(9906),a=r(2935);let c=o.A.windows||o.A.mac||o.A.linux?10:20;class h extends n.A{constructor(){super(),(0,i.A)(this,"pullIPC",void 0),(0,i.A)(this,"frontBuffer",void 0),(0,i.A)(this,"backBuffer",void 0),(0,i.A)(this,"channels",void 0),(0,i.A)(this,"backBufferOffset",void 0),(0,i.A)(this,"ended",void 0),(0,i.A)(this,"frontBuffered",void 0),(0,i.A)(this,"pause",void 0),(0,i.A)(this,"firstRendered",void 0),(0,i.A)(this,"stopped",void 0),(0,i.A)(this,"afterPullResolve",void 0),(0,i.A)(this,"lastStutterTimestamp",void 0),this.ended=!1,this.pause=!0,this.ipcPort.on(a.S3,(async t=>{switch(t.method){case"init":t.params&&t.params.bufferLength&&(c=t.params.bufferLength),this.ipcPort.reply(t);break;case"start":{const{port:e,channels:r}=t.params;this.channels=r,this.pullIPC=new a.Ay(e),this.backBufferOffset=0,this.ended=!1,this.frontBuffered=!0,this.pause=!1,this.firstRendered=!1,this.stopped=!1,this.lastStutterTimestamp=currentTime;const s=[],i=[];await this.pull(s),s.length?(await this.pull(i),i.length||(this.ended=!0,this.frontBuffered=!1)):(this.ended=!0,this.frontBuffered=!1,this.backBufferOffset=c),this.frontBuffer=i,this.backBuffer=s,this.ipcPort.reply(t);break}case"restart":{if(!this.ended)return void this.ipcPort.reply(t);this.backBufferOffset=0,this.ended=!1,this.frontBuffered=!0,this.pause=!1,this.firstRendered=!1,this.stopped=!1,this.lastStutterTimestamp=currentTime;const e=[],r=[];await this.pull(e),e.length?(await this.pull(r),r.length||(this.ended=!0,this.frontBuffered=!1)):(this.ended=!0,this.frontBuffered=!1,this.backBufferOffset),this.frontBuffer=r,this.backBuffer=e,this.ipcPort.reply(t);break}case"clear":this.backBufferOffset=c,this.ipcPort.reply(t);break;case"stop":this.ended||this.pause||this.frontBuffered||await new Promise((t=>{this.afterPullResolve=t})),this.stopped=!0,this.pullIPC.destroy(),this.ipcPort.reply(t);break;case"pause":this.pause=!0,this.ipcPort.reply(t);break;case"unpause":this.pause=!1,this.ipcPort.reply(t)}}))}async pull(t){const e=await this.pullIPC.request("pullBuffer",{nbSamples:128*c});if(f.ai(e))this.ended=!0;else{const r=new Float32Array(e);for(let e=0;e<this.channels;e++)t[e]=r.subarray(e*c*128,(e+1)*c*128)}this.afterPullResolve&&this.afterPullResolve()}swapBuffer(){return!!this.frontBuffered&&(this.backBuffer=this.frontBuffer,this.backBufferOffset=0,this.frontBuffer=[],this.frontBuffered=!1,this.pull(this.frontBuffer).then((()=>{this.frontBuffered=!0})),!0)}process(t,e,r){if(this.stopped)return!1;if(this.backBuffer&&!this.pause){if(this.backBufferOffset===c){if(this.ended)return this.backBuffer=null,this.frontBuffer=null,u.pq("audio source ended","packages/avrender/src/pcm/AudioSourceWorkletProcessor.ts",237),this.ipcPort.notify("ended"),!0;if(!this.swapBuffer())return currentTime-this.lastStutterTimestamp>1&&(this.ipcPort.notify("stutter"),this.lastStutterTimestamp=currentTime),!0}const t=e[0];for(let e=0;e<this.channels;e++)t[e].set(this.backBuffer[e].subarray(128*this.backBufferOffset,128*(this.backBufferOffset+1)),0);this.backBufferOffset++,this.firstRendered||(this.firstRendered=!0,this.ipcPort.notify("firstRendered"))}return!0}}registerProcessor("audio-source-processor",h),processor=s})();