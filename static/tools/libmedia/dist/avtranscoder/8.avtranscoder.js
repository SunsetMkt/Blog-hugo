"use strict";(self.webpackChunkAVTranscoder=self.webpackChunkAVTranscoder||[]).push([[8],{64436:(t,i,e)=>{e.d(i,{A:()=>a});var r=e(49859),s=e(63939),c=(e(77162),e(37837)),h=e(71766);class a{constructor(){(0,r.A)(this,"inCodecpar",void 0),(0,r.A)(this,"inTimeBase",void 0),(0,r.A)(this,"outCodecpar",void 0)}init(t,i){return this.inCodecpar=(0,c.Gy)(168),(0,h.Yi)(this.inCodecpar,t),this.inTimeBase={den:s.f[15](i+4),num:s.f[15](i)},0}destroy(){this.inCodecpar&&((0,h.dn)(this.inCodecpar),this.inCodecpar=0)}}},9848:(t,i,e)=>{e.d(i,{A:()=>u});var r=e(49859),s=e(63939),c=e(50932),h=e(64436),a=e(95832),o=e(14686),n=e(71517),d=e(37837),p=e(9705);class u extends h.A{constructor(...t){super(...t),(0,r.A)(this,"cache",void 0),(0,r.A)(this,"cached",void 0)}init(t,i){return super.init(t,i),this.cache=(0,n._5)(),0}destroy(){super.destroy(),(0,n.Qe)(this.cache),this.cache=0,this.cached=!1}sendAVPacket(t){if(!s.f[20](t+24)||!s.f[15](t+28))return 0;const i=(0,n.rU)(t,1);if(i){const{profile:t,sampleRate:e,channels:r}=(0,a._5)((0,o.s3)(s.f[20](i),s.f[25](i+4)));c.M[15](this.inCodecpar+48,t),c.M[15](this.inCodecpar+136,e),c.M[15](this.inCodecpar+116,r)}const e=7+s.f[15](t+28),r=(0,d.sY)(e),h=(0,o.s3)(r,e);return h[0]=255,h[1]=240,h[1]|=8,h[1]|=1,h[2]=(s.f[15](this.inCodecpar+48)-1&3)<<6,h[2]|=(15&a.Hm[s.f[15](this.inCodecpar+136)])<<2,h[2]|=(4&s.f[15](this.inCodecpar+116))>>2,h[3]=(3&s.f[15](this.inCodecpar+116))<<6,h[3]|=h.length>>11&3,h[4]=h.length>>3&255,h[5]=(7&h.length)<<5,h[5]|=31,h[6]=252,h.set((0,o.s3)(s.f[20](t+24),s.f[15](t+28)),7),(0,n.zu)(this.cache,t),(0,n.NX)(this.cache,r,e),this.cached=!0,0}receiveAVPacket(t){return this.cached?((0,n.Up)(t),(0,n.rN)(t,this.cache),this.cached=!1,0):p.LT}reset(){return 0}}},60480:(t,i,e)=>{e.d(i,{A:()=>b});var r=e(49859),s=e(63939),c=e(50932),h=e(64436),a=e(95832),o=e(14686),n=e(71517),d=e(37837),p=e(9705),u=e(95335),f=e(83314);const A={mod:20},l=new Uint8Array([86,224,0]);class b extends h.A{constructor(t={}){super(),(0,r.A)(this,"cache",void 0),(0,r.A)(this,"cached",void 0),(0,r.A)(this,"bitWriter",void 0),(0,r.A)(this,"counter",void 0),(0,r.A)(this,"options",void 0),this.options=u.X$({},A,t)}init(t,i){return super.init(t,i),this.cache=(0,n._5)(),this.cached=!1,this.counter=0,this.bitWriter=new f.A,0}destroy(){super.destroy(),(0,n.Qe)(this.cache),this.cache=0}writeHeader(){this.bitWriter.writeU1(0===this.counter?0:1),0===this.counter&&(this.bitWriter.writeU1(0),this.bitWriter.writeU1(1),this.bitWriter.writeU(6,0),this.bitWriter.writeU(4,0),this.bitWriter.writeU(3,0),this.bitWriter.writeU(5,s.f[15](this.inCodecpar+48)-1&31),this.bitWriter.writeU(4,15&a.Hm[s.f[15](this.inCodecpar+136)]),this.bitWriter.writeU(4,15&s.f[15](this.inCodecpar+116)),this.bitWriter.writeU(3,0),this.bitWriter.writeU(3,0),this.bitWriter.writeU(8,255),this.bitWriter.writeU1(0),this.bitWriter.writeU1(0)),this.counter++,this.counter%=this.options.mod}copyBytes(t){for(let i=0;i<t.length;i++)this.bitWriter.writeU(8,t[i])}sendAVPacket(t){if(!s.f[20](t+24)||!s.f[15](t+28))return 0;this.bitWriter.reset();const i=(0,n.rU)(t,1);if(i){const{profile:t,sampleRate:e,channels:r}=(0,a._5)((0,o.s3)(s.f[20](i),s.f[25](i+4)));c.M[15](this.inCodecpar+48,t),c.M[15](this.inCodecpar+136,e),c.M[15](this.inCodecpar+116,r),this.counter=0}this.writeHeader();let e=0;for(;e<=s.f[15](t+28)-255;e+=255)this.bitWriter.writeU(8,255);this.bitWriter.writeU(8,s.f[15](t+28)-e);const r=(0,o.s3)(s.f[20](t+24),s.f[15](t+28));129==(225&r[0])?(this.bitWriter.writeU(8,254&r[0]),this.copyBytes(r.subarray(1))):this.copyBytes(r),this.bitWriter.padding();const h=this.bitWriter.getPointer(),p=3+h,u=(0,d.sY)(p),f=(0,o.s3)(u,p);return f.set(l,0),f[1]|=h>>8&31,f[2]|=255&h,f.set(this.bitWriter.getBuffer().subarray(0,h),3),(0,n.zu)(this.cache,t),(0,n.NX)(this.cache,u,p),this.cached=!0,0}receiveAVPacket(t){return this.cached?((0,n.Up)(t),(0,n.rN)(t,this.cache),this.cached=!1,0):p.LT}reset(){return 0}}},48008:(t,i,e)=>{e.r(i),e.d(i,{default:()=>W});var r=e(49859),s=e(71426),c=e.n(s),h=e(96319),a=e.n(h),o=e(61499),n=e(63939),d=e(51597),p=e(4624),u=e(95335),f=e(9705),A=e(9848),l=e(60480),b=e(71517);const w="src/avformat/formats/OAacFormat.ts",m={frameType:"adts"};class W extends d.A{constructor(t={}){super(),(0,r.A)(this,"type",15),(0,r.A)(this,"options",void 0),(0,r.A)(this,"muxStream",void 0),(0,r.A)(this,"filter",void 0),this.options=u.X$({},m,t)}init(t){return t.ioWriter.setEndian(!0),0}writeHeader(t){var i;const e=c()(i=t.streams).call(i,(t=>1===t.codecpar.codecType&&86018===t.codecpar.codecId));return e?(this.muxStream=e,"adts"===this.options.frameType?(this.filter=new A.A,a()(this).init(e.codecpar[o.o9],e.timeBase[o.o9])):"latm"===this.options.frameType&&(this.filter=new l.A,a()(this).init(e.codecpar[o.o9],e.timeBase[o.o9])),0):(p.z3("can not found stream with aac codec",w,78),f.UY)}writeAVPacket(t,i){const e=t.getStreamByIndex(n.f[15](i+32));if(!e||1024&e.disposition)p.R8(`can not found the stream width the packet's streamIndex: ${n.f[15](i+32)}, ignore it`,w,100);else{if(e===this.muxStream)return a()(this)&&(a()(this).sendAVPacket(i),a()(this).receiveAVPacket(i)),t.ioWriter.writeBuffer((0,b.iI)(i)),0;p.R8(`packet's type is not audio: ${n.f[15](i+32)}, ignore it`,w,105)}}writeTrailer(t){return t.ioWriter.flush(),0}flush(t){return t.ioWriter.flush(),0}getCapabilities(){return W.Capabilities}}(0,r.A)(W,"Capabilities",[86018])},51597:(t,i,e)=>{e.d(i,{A:()=>s});var r=e(49859);class s{constructor(){(0,r.A)(this,"type",-1)}async destroy(t){}}(0,r.A)(s,"Capabilities",[])}}]);