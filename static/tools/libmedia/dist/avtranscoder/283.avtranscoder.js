"use strict";(self.webpackChunkAVTranscoder=self.webpackChunkAVTranscoder||[]).push([[283],{39:(e,t,a)=>{function i(e,t){let a=0;for(let i=0;i<t;i++)a=2*a+e.readU1();return a}function s(e){let t=0;for(;!i(e,1);)t++;return t>=32?0:i(e,t)+(1<<t)-1}function r(e){let t=0;for(let a=0;a<8;a++){let s=i(e,8);if(t|=(127&s)<<7*a,!(128&s))break}return t}a.d(t,{d:()=>s,f:()=>i,v:()=>r})},139:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/stsz.ts";async function r(e,t,a,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=[];let d=0,f=0;if(0===o){d=await e.readUint32(),f=await e.readUint32();for(let t=0;t<f;t++)0===d?c.push(await e.readUint32()):c[t]=d}t.privData.sampleSizes=c;const l=a.size-Number(e.getPos()-n);l>0?await e.skip(l):l<0&&i.z3(`read stsz error, size: ${a.size}, read: ${a.size-l}`,s,63)}},144:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/tkhd.ts";async function r(e,t,a,r){const n=t.privData,o=e.getPos(),c=await e.readUint8();n.flags=await e.readUint24(),1&n.flags&&(t.disposition|=1),1===c?(t.metadata.creationTime=await e.readUint64(),t.metadata.modificationTime=await e.readUint64(),n.trackId=await e.readUint32(),await e.skip(4),n.duration=await e.readUint64()):(t.metadata.creationTime=BigInt(Math.floor(await e.readUint32())),t.metadata.modificationTime=BigInt(Math.floor(await e.readUint32())),n.trackId=await e.readUint32(),await e.skip(4),n.duration=BigInt(Math.floor(await e.readUint32()))),await e.skip(8),n.layer=await e.readInt16(),n.alternateGroup=await e.readInt16(),n.volume=await e.readInt16()>>8,await e.skip(2);const d=[];n.matrix=new Int32Array(9);for(let t=0;t<9;t++)n.matrix[t]=await e.readInt32(),d[t]=8===t?n.matrix[t]/1073741824:n.matrix[t]/65536;n.width=await e.readUint32()>>16,n.height=await e.readUint32()>>16,t.metadata.matrix=d;const f=a.size-Number(e.getPos()-o);f>0?await e.skip(f):f<0&&i.z3(`read tkhd error, size: ${a.size}, read: ${a.size-f}`,s,89)}},182:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/stz2.ts";async function r(e,t,a,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=[];let d=0,f=0;if(0===o)if(await e.skip(3),f=await e.readUint8(),d=await e.readUint32(),4===f)for(let t=0;t<d;t+=2){const a=await e.readUint8();c[t]=a>>4&15,c[t+1]=15&a}else if(8===f)for(let t=0;t<d;t++)c[t]=await e.readUint8();else if(16===f)for(let t=0;t<d;t++)c[t]=await e.readUint16();else i.z3("Error in length field in stz2 box",s,65);t.privData.sampleSizes=c;const l=a.size-Number(e.getPos()-n);l>0?await e.skip(l):l<0&&i.z3(`read stz2 error, size: ${a.size}, read: ${a.size-l}`,s,76)}},192:(e,t,a)=>{a.d(t,{A:()=>l});var i=a(7962),s=a(9906),r=a(3674),n=a(7314),o=a(3690),c=a(1755);const d="packages/avformat/src/formats/isobmff/parsing/esds.ts";async function f(e){let t=0;for(let a=0;a<4;a++){const a=await e.readUint8();if(t=t<<7|127&a,!(128&a))break}return t}async function l(e,t,a,l){const p=e.getPos();await e.skip(4);let m=e.getPos()+BigInt(Math.floor(a.size-4));for(;e.getPos()<m;){let a=await e.readUint8(),p=await f(e);if(0!==p)if(3===a){let m=e.getPos()+BigInt(Math.floor(p));if(await e.skip(2),await e.skip(1),a=await e.readUint8(),p=await f(e),0===p){s.R8("esds invalid ES descriptor size 0, skip",d,78),await e.skip(Number(m-e.getPos()));continue}if(4===a)if(t.codecpar.codecId=i.Q9[await e.readUint8()],await e.skip(1),await e.skip(3),await e.skip(4),await e.skip(4),e.getPos()<m-BigInt(5))if(a=await e.readUint8(),p=await f(e),5===a){const a=(0,c.sY)(p),i=await e.readBuffer(p,(0,r.JW)(a,p));l.foundMoov?(t.sideData[1]=i.slice(),(0,c.Eb)(a)):(t.codecpar.extradata=a,t.codecpar.extradataSize=p,86018===t.codecpar.codecId?n.XC(t,i.slice()):86076===t.codecpar.codecId&&o.XC(t,i.slice()))}else await e.skip(Number(m-e.getPos()));else await e.skip(Number(m-e.getPos()));else await e.skip(Math.min(p,Number(m-e.getPos())))}else await e.skip(Math.min(p,Number(m-e.getPos())));else s.R8("esds invalid descriptor size 0, skip",d,61),await e.skip(Number(m-e.getPos()))}const u=a.size-Number(e.getPos()-p);u>0?await e.skip(u):u<0&&s.z3(`read vpcc error, size: ${a.size}, read: ${a.size-u}`,d,146)}},263:(e,t,a)=>{function i(e,t,a,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;const r=e.privData;let n=t.baseDataOffset+BigInt(Math.floor(t.dataOffset));(t.baseIsMoof||n<i)&&(n+=a.currentFragment.pos);let o=t.baseMediaDecodeTime;const c=t.sampleSizes,d=t.sampleDurations,f=t.sampleFlags,l=t.sampleCompositionTimeOffset,p=t.remainDataOffsets,m=t.remainDataOffsetIndex;let u=0;const w=[];for(let e=0;e<t.sampleCount;e++){m[u]===e&&(n=t.baseDataOffset+BigInt(Math.floor(p[u])),t.baseIsMoof&&(n+=a.currentFragment.pos),u++);const i={dts:o,pts:o+BigInt(Math.floor(l[e])),pos:n,size:c[e],duration:d[e],flags:0};o+=BigInt(Math.floor(i.duration)),n+=BigInt(Math.floor(i.size)),16842752&f[e]||(i.flags|=1),0===e&&c.length>1&&2&s&&(i.flags|=1),w.push(i)}r.samplesIndex=w;const g=a.cencs?a.cencs[r.trackId]:null;g&&t.cenc&&t.cenc.sampleEncryption&&(r.samplesEncryption=t.cenc.sampleEncryption.map((e=>({scheme:g.schemeType,keyId:g.defaultKeyId,skipByteBlock:g.skipByteBlock,cryptByteBlock:g.cryptByteBlock,iv:e.iv,subsamples:e.subsamples}))))}a.d(t,{p:()=>i})},491:(e,t,a)=>{a.d(t,{_l:()=>i,gQ:()=>s});const i=["hmhd","nmhd","iods","xml ","url ","bxml","ipro","mere","stts","ctts","stss","stsz","stz2","stsc","stco","co64","stsd","dref","mvhd","tkhd","mdhd","hdlr"],s=["moov","trak","edts","mdia","minf","dinf","stbl","mvex","moof","traf","vttc","tref","iref","mfra","hnti","hinf","strd","sinf","rinf","schi","trgr","udta","iprp","ipco","strk","meco","encv","enca","sinf","schi","udta","iprp"]},626:(e,t,a)=>{a.d(t,{A:()=>c});var i=a(9906),s=a(3674),r=a(3831),n=a(1755);const o="packages/avformat/src/formats/isobmff/parsing/av1c.ts";async function c(e,t,a,c){const d=e.getPos();if(t.codecpar.codecId=225,a.size<=0)return;const f=(0,n.sY)(a.size),l=await e.readBuffer(a.size,(0,s.JW)(f,a.size));c.foundMoov?(t.sideData[1]=l.slice(),(0,n.Eb)(f)):(t.codecpar.extradata&&(0,n.Eb)(t.codecpar.extradata),t.codecpar.extradata=f,t.codecpar.extradataSize=a.size,r.XC(t,l));const p=a.size-Number(e.getPos()-d);p>0?await e.skip(p):p<0&&i.z3(`read avcc error, size: ${a.size}, read: ${a.size-p}`,o,64)}},697:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(9906),s=a(6262);const r="packages/avformat/src/formats/isobmff/parsing/colr.ts";async function n(e,t,a,n){const o=e.getPos();let c=await e.readString(4);if("nclx"===c||"nclc"===c||"prof"===c){if("prof"===c){const i=await e.readBuffer(a.size-4);t.sideData[28]=i}else if(t instanceof s.Ay){let a=await e.readUint16(),i=await e.readUint16(),s=await e.readUint16();if("nclx"===c){const a=await e.readUint8()>>7;t.codecpar.colorRange=a?2:1}a>=23&&(a=2),i>=19&&(i=2),s>=15&&(s=2),t.codecpar.colorPrimaries=a,t.codecpar.colorTrc=i,t.codecpar.colorSpace=s}}else i.R8(`unsupported color_parameter_type: ${c}`,r,83);const d=a.size-Number(e.getPos()-o);d>0?await e.skip(d):d<0&&i.z3(`read colr error, size: ${a.size}, read: ${a.size-d}`,r,91)}},713:(e,t,a)=>{a.d(t,{ZK:()=>o,bE:()=>c,p$:()=>r,zz:()=>n});var i=a(5815),s=a(187);function r(e){const t=new i.A(e,!0),a=t.readUint32(),s=t.readUint32(),r=t.readUint32(),n=t.readUint32(),o=t.readUint32(),c=t.readUint32(),d={scheme:a,cryptByteBlock:s,skipByteBlock:r,keyId:t.readBuffer(n),iv:t.readBuffer(o),subsamples:[]};if(c)for(let e=0;e<c;e++)d.subsamples.push({bytesOfClearData:t.readUint32(),bytesOfProtectedData:t.readUint32()});return d}function n(e){const t=new Uint8Array(24+e.keyId.length+e.iv.length+8*e.subsamples.length),a=new s.A(t,!0);return a.writeUint32(e.scheme),a.writeUint32(e.cryptByteBlock),a.writeUint32(e.skipByteBlock),a.writeUint32(e.keyId.length),a.writeUint32(e.iv.length),a.writeUint32(e.subsamples.length),a.writeBuffer(e.keyId),a.writeBuffer(e.iv),e.subsamples.forEach((e=>{a.writeUint32(e.bytesOfClearData),a.writeUint32(e.bytesOfProtectedData)})),t}function o(e){const t=new i.A(e,!0),a=t.readUint32(),s=[];for(let e=0;e<a;e++){const e=t.readUint32(),a=t.readUint32(),i=t.readUint32(),r=t.readUint32(),n={systemId:t.readBuffer(e),keyIds:[],data:null};if(a)for(let e=0;e<a;e++)n.keyIds.push(t.readBuffer(i));n.data=t.readBuffer(r),s.push(n)}return s}function c(e){let t=4;e.forEach((e=>{t+=16+e.systemId.length+e.keyIds.length*(e.keyIds.length?e.keyIds[0].length:0)+e.data.length}));const a=new Uint8Array(t),i=new s.A(a,!0);return i.writeUint32(e.length),e.forEach((e=>{i.writeUint32(e.systemId.length),i.writeUint32(e.keyIds.length),i.writeUint32(e.keyIds.length?e.keyIds[0].length:0),i.writeUint32(e.data.length),i.writeBuffer(e.systemId),e.keyIds.forEach((e=>{i.writeBuffer(e)})),i.writeBuffer(e.data)})),a}},1129:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/irot.ts";async function r(e,t,a,r){var n;const o=e.getPos();let c=3&await e.readUint8();null!==(n=r.heif)&&void 0!==n&&n.currentItem&&(r.heif.currentItem.rotation=90*c);const d=a.size-Number(e.getPos()-o);d>0?await e.skip(d):d<0&&i.z3(`read irot error, size: ${a.size}, read: ${a.size-d}`,s,45)}},1278:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/iloc.ts";async function r(e,t,a,r){const n=e.getPos();if(r.heif.foundIloc)i.R8("Duplicate iloc box found",s,35);else{r.heif.foundIloc=!0;const t=await e.readUint8();await e.skip(3);let a=await e.readUint8(),n=a>>4&15,o=15&a;a=await e.readUint8();let c=a>>4&15,d=t?15&a:0,f=t<2?await e.readUint16():await e.readUint32();r.heif.items||(r.heif.items=[]);e:for(let a=0;a<f;a++){let a=t<2?await e.readUint16():await e.readUint32(),f=t>0?15&await e.readUint16():0;f>1&&i.R8(`iloc offset type ${f}`,s,59),await e.readUint16();let l=c>0?await e["readUint"+8*c]():0,p=await e.readUint16();if(p>1){i.z3("iloc: extent_count > 1",s,66),r.heif.foundIloc=!1;break e}let m=0,u=0,w=0;for(let t=0;t<p;t++)d>0&&(m=await e["readUint"+8*d]()),w=n>0?await e["readUint"+8*n]():0,u=o>0?await e["readUint"+8*o]():0;const g=r.heif.items.find((e=>e.id===a));g?(g.isIdatRelative=1===f,g.extentOffset=l+w,g.extentIndex=m,g.extentLength=u):r.heif.items.push({id:a,isIdatRelative:1===f,extentOffset:l+w,extentIndex:m,extentLength:u})}}const o=a.size-Number(e.getPos()-n);o>0?await e.skip(o):o<0&&i.z3(`read iloc error, size: ${a.size}, read: ${a.size-o}`,s,104)}},1326:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/senc.ts";async function r(e,t,a,r){const n=e.getPos(),o=r.currentFragment.currentTrack,c=r.cencs?r.cencs[o.trackId]:null;await e.readUint8();const d=await e.readUint24();o.cenc||(o.cenc={defaultSampleInfoSize:0,sampleCount:0,offset:0,useSubsamples:!1,sampleEncryption:[],sampleSizes:[],sampleInfoOffset:[]});const f=await e.readUint32(),l=2&d,p=c.defaultPerSampleIVSize;for(let t=0;t<f;t++){const t={iv:p?await e.readBuffer(p):c.defaultConstantIV,subsamples:[]};if(l){const a=await e.readUint16();for(let i=0;i<a;i++)t.subsamples.push({bytesOfClearData:await e.readUint16(),bytesOfProtectedData:await e.readUint32()})}o.cenc.sampleEncryption.push(t)}l&&(o.cenc.useSubsamples=!0);const m=a.size-Number(e.getPos()-n);m>0?await e.skip(m):m<0&&i.z3(`read senc error, size: ${a.size}, read: ${a.size-m}`,s,79)}},1328:(e,t,a)=>{a.d(t,{G:()=>r});var i=a(3262),s=a(1237);function r(e,t,a){let r,n,o,c,d,f,l,p=BigInt(0);if(e.streams.forEach((e=>{const t=e.privData;if(!t.samplesIndex||!t.samplesIndex.length||48===e.discard)return t.sampleEnd=!0,!0;if(32===e.discard){for(;t.currentSample<t.samplesIndex.length&&!(1&t.samplesIndex[t.currentSample].flags);)t.currentSample++;if(t.currentSample>=t.samplesIndex.length)return t.sampleEnd=!0,!0}t.sampleEnd||c&&!(t.samplesIndex[t.currentSample].pos<c.pos)||(c=t.samplesIndex[t.currentSample],d=e),t.sampleEnd||f&&!((0,i.k)(t.samplesIndex[t.currentSample].dts,e.timeBase,s.KR)<p)||(f=t.samplesIndex[t.currentSample],p=(0,i.k)(f.dts,e.timeBase,s.KR),l=e)})),c&&f){const t=(0,i.k)(c.dts,d.timeBase,s.KR),o=(0,i.k)(f.dts,l.timeBase,s.KR);Math.abs(Number(t-o))<1e6||2&e.ioReader.flags||4&e.ioReader.flags||!(1&a)?(r=c,n=d):(r=f,n=l)}else c?(r=c,n=d):f&&(r=f,n=l);if(n){const e=n.privData;o=e.samplesEncryption[e.currentSample],e.currentSample++,e.currentSample>=e.samplesIndex.length&&(e.sampleEnd=!0)}if(t.fragment){const a=!!e.streams.find((e=>!1===e.privData.sampleEnd));a||(t.currentFragment=null)}return{sample:r,stream:n,encryption:o}}},1392:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/imir.ts";async function r(e,t,a,r){var n;const o=e.getPos();let c=1&await e.readUint8();null!==(n=r.heif)&&void 0!==n&&n.currentItem&&(r.heif.currentItem.hflip=!!c,r.heif.currentItem.vflip=!c);const d=a.size-Number(e.getPos()-o);d>0?await e.skip(d):d<0&&i.z3(`read imir error, size: ${a.size}, read: ${a.size-d}`,s,46)}},1556:(e,t,a)=>{a.d(t,{A:()=>l});var i=a(7127),s=a(9983),r=a(2320),n=a(9906),o=a(8940),c=a(449),d=a(4187);const f="packages/avformat/src/formats/isobmff/parsing/dac3.ts";async function l(e,t,a,l){const p=e.getPos();if(t.codecpar.codecId=86019,a.size<=0)return;const m=(0,d.E4)(t.codecpar[i.o9]+20,t.codecpar[i.o9]+24,7,4),u=s.f[20](m),w=await e.readUint24(),g=w>>14&7,h=w>>11&7,k=w>>10&1;let z=BigInt(o.j[h]);k&&(z|=BigInt(8)),c.bl(t.codecpar[i.o9]+112),c.ML(t.codecpar[i.o9]+112,z),r.M[15](u,g);const v=a.size-Number(e.getPos()-p);v>0?await e.skip(v):v<0&&n.z3(`read avcc error, size: ${a.size}, read: ${a.size-v}`,f,77)}},1638:(e,t,a)=>{a.d(t,{A:()=>s});var i=a(8590);function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,a="";for(let s=0;s<t;s++)i.ai(e)?(a=String.fromCharCode(255&e)+a,e>>>=8):(a=String.fromCharCode(Number(e&BigInt(255)))+a,e>>=BigInt(8));return a}},1668:(e,t,a)=>{a.d(t,{A:()=>o});var i=a(9515),s=a(9906),r=a(3270);const n="packages/avformat/src/formats/isobmff/parsing/pcmc.ts";async function o(e,t,a,o){const c=e.getPos();await e.readUint8(),await e.readUint24();const d=await e.readUint8(),f=await e.readUint8(),l=1&d,p=t.privData;if(p.format===(0,i.A)("fpcm"))switch(f){case 32:t.codecpar.codecId=l?65557:65556;break;case 64:t.codecpar.codecId=l?65559:65558;break;default:s.z3(`invalid pcmSampleSize: ${f}`,n,55)}else if(p.format===(0,i.A)("ipcm"))switch(f){case 16:t.codecpar.codecId=l?65536:65537;break;case 24:t.codecpar.codecId=l?65548:65549;break;case 32:t.codecpar.codecId=l?65544:65545;break;default:s.z3(`invalid pcmSampleSize: ${f}`,n,71)}p.isPcm=!0,0!==t.codecpar.codecId&&(t.codecpar.bitsPerCodedSample=r.MZ(t.codecpar.codecId));const m=a.size-Number(e.getPos()-c);m>0?await e.skip(m):m<0&&s.z3(`read pcmc error, size: ${a.size}, read: ${a.size-m}`,n,87)}},1700:(e,t,a)=>{a.d(t,{A:()=>s});var i=a(1237);function s(){return{chunkOffsets:null,cttsSampleCounts:null,cttsSampleOffsets:null,stscFirstChunk:null,stscSamplesPerChunk:null,stscSampleDescriptionIndex:null,stssSampleNumbersMap:null,stssSampleNumbers:null,sampleSizes:null,sttsSampleCounts:null,sttsSampleDeltas:null,duration:BigInt(0),trackId:i.N_,layer:0,alternateGroup:0,volume:0,matrix:null,width:0,height:0,audioCid:0,samplesPerFrame:0,bytesPerFrame:0,currentSample:0,sampleEnd:!1,samplesIndex:[],samplesEncryption:[],fragIndexes:[],lastPts:i.Dh,lastDts:i.Dh,startDts:i.Dh,startCT:i.N_,startPts:i.Dh,lastDuration:0,chunkCount:0,firstWrote:!1,lastStscCount:0,perStreamGrouping:!1,index:0,flags:0}}},1846:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(9906),s=a(1237);const r="packages/avformat/src/formats/isobmff/parsing/chpl.ts";async function n(e,t,a,n){const o=e.getPos(),c=await e.readUint8();await e.skip(3),c&&await e.skip(4);const d=await e.readUint8();if(d){const t=[];for(let a=0;a<d;a++){const i=await e.readInt64(),r=await e.readUint8(),n={id:BigInt(a),timeBase:{num:1,den:1e7},start:i,end:s.Dh,metadata:{}};r&&(n.metadata.title=await e.readString(r)),t.push(n)}n.chapters=t}const f=a.size-Number(e.getPos()-o);f>0?await e.skip(f):f<0&&i.z3(`read vpcc error, size: ${a.size}, read: ${a.size-f}`,r,74)}},1945:(e,t,a)=>{a.d(t,{A:()=>s});var i=a(4467);class s{constructor(){(0,i.A)(this,"type",-1),(0,i.A)(this,"onStreamAdd",void 0)}async destroy(e){}}},2281:(e,t,a)=>{a.d(t,{A:()=>c});var i=a(9906),s=a(3674),r=a(4229),n=a(1755);const o="packages/avformat/src/formats/isobmff/parsing/hvcc.ts";async function c(e,t,a,c){const d=e.getPos();if(t.codecpar.codecId=173,a.size<=0)return;const f=(0,n.sY)(a.size),l=await e.readBuffer(a.size,(0,s.JW)(f,a.size));c.foundMoov?(t.sideData[1]=l.slice(),(0,n.Eb)(f)):(t.codecpar.extradata&&(0,n.Eb)(t.codecpar.extradata),t.codecpar.extradata=f,t.codecpar.extradataSize=a.size,r.XC(t,l));const p=a.size-Number(e.getPos()-d);p>0?await e.skip(p):p<0&&i.z3(`read hevc error, size: ${a.size}, read: ${a.size-p}`,o,64)}},2300:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/mdhd.ts";async function r(e,t,a,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);let c=BigInt(0),d=BigInt(0),f=0,l=BigInt(0);1===o?(c=await e.readUint64(),d=await e.readUint64(),f=await e.readUint32(),l=await e.readUint64()):(c=BigInt(Math.floor(await e.readUint32())),d=BigInt(Math.floor(await e.readUint32())),f=await e.readUint32(),l=BigInt(Math.floor(await e.readUint32()))),t.duration=l,t.timeBase.den=f,t.timeBase.num=1,t.metadata.creationTime=c,t.metadata.modificationTime=d;const p=await e.readUint16(),m=[];m[0]=p>>10&31,m[1]=p>>5&31,m[2]=31&p;const u=String.fromCharCode(m[0]+96,m[1]+96,m[2]+96);t.metadata.language=u,await e.skip(2);const w=a.size-Number(e.getPos()-n);w>0?await e.skip(w):w<0&&i.z3(`read mdhd error, size: ${a.size}, read: ${a.size-w}`,s,80)}},2354:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/saiz.ts";async function r(e,t,a,r){const n=e.getPos(),o=r.currentFragment.currentTrack,c=r.cencs?r.cencs[o.trackId]:null;if(await e.skip(1),1&await e.readUint24()){const t=await e.readUint32(),a=await e.readUint32();if(!c)return void await d();if(t!==c.schemeType)return i.R8("Ignoring saiz box with non-zero aux_info_type",s,47),void await d();if(0!==a)return i.R8("Ignoring saiz box with non-zero aux_info_type_parameter",s,52),void await d()}else if(!c)return void await d();if(o.cenc||(o.cenc={defaultSampleInfoSize:0,sampleCount:0,offset:0,useSubsamples:!1,sampleEncryption:[],sampleSizes:[],sampleInfoOffset:[]}),o.cenc.defaultSampleInfoSize=await e.readUint8(),o.cenc.sampleCount=await e.readUint32(),0===o.cenc.defaultSampleInfoSize){if(!o.cenc.sampleCount)return i.z3("invalid saiz data",s,83),void await d();for(let t=0;t<o.cenc.sampleCount;t++)o.cenc.sampleSizes.push(await e.readUint8())}async function d(){const t=a.size-Number(e.getPos()-n);t>0?await e.skip(t):t<0&&i.z3(`read saiz error, size: ${a.size}, read: ${a.size-t}`,s,99)}await d()}},2423:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/ctts.ts";async function r(e,t,a,r){const n=e.getPos(),o=t.privData;await e.skip(4);const c=[],d=[],f=await e.readUint32();for(let t=0;t<f;t++)c.push(await e.readUint32()),d.push(await e.readInt32());o.cttsSampleCounts=c,o.cttsSampleOffsets=d;const l=a.size-Number(e.getPos()-n);l>0?await e.skip(l):l<0&&i.z3(`read ctts error, size: ${a.size}, read: ${a.size-l}`,s,57)}},2454:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/mfhd.ts";async function r(e,t,a,r){const n=e.getPos();await e.readUint8(),await e.skip(3),r.currentFragment.sequence=await e.readUint32();const o=a.size-Number(e.getPos()-n);o>0?await e.skip(o):o<0&&i.z3(`read vpcc error, size: ${a.size}, read: ${a.size-o}`,s,47)}},2741:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/iref.ts";async function r(e,t,a,r){const n=e.getPos(),o=await e.readUint8();if(await e.readUint24(),o>1)i.z3(`Unknown iref box version ${o}`,s,38);else{let t=a.size-4;for(;t;){const a=await e.readUint32(),n=await e.readString(4),f=e.getPos();if("dimg"===n){var c;let t=o?await e.readUint32():await e.readUint16();const a=null===(c=r.heif.items)||void 0===c?void 0:c.find((e=>e.id===t));if(a&&("grid"===a.type||"iovl"===a.type)){const t=await e.readUint16();let i=[];for(let a=0;a<t;a++)i.push(o?await e.readUint32():await e.readUint16());r.heif.grid||(r.heif.grid=[]),r.heif.grid.push({item:a,tileIdList:i})}}else if("thmb"===n||"cdsc"===n){let t=o?await e.readUint32():await e.readUint16();if(await e.readUint16()>1)i.z3("thmb in iref referencing several items",s,70);else{var d;let a=o?await e.readUint32():await e.readUint16();const i=null===(d=r.heif.items)||void 0===d?void 0:d.find((e=>e.id===a));i&&(i.refs||(i.refs={}),i.refs[n]=t)}}else await e.skip(a-8);let l=a-8-Number(e.getPos()-f);l&&await e.skip(l),t-=a}}const f=a.size-Number(e.getPos()-n);f>0?await e.skip(f):f<0&&i.z3(`read ipma error, size: ${a.size}, read: ${a.size-f}`,s,99)}},2971:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/tfhd.ts";async function r(e,t,a,r){const n=e.getPos(),o=(await e.readUint8(),await e.readUint24()),c=await e.readUint32(),d=r.currentFragment.currentTrack;d.trackId=c,d&&(1&o&&(d.baseDataOffset=await e.readUint64()),2&o&&await e.skip(4),8&o&&(d.defaultSampleDuration=await e.readUint32()),16&o&&(d.defaultSampleSize=await e.readUint32()),32&o&&(d.defaultSampleFlags=await e.readUint32()),131072&o&&(d.baseIsMoof=!0));const f=a.size-Number(e.getPos()-n);f>0?await e.skip(f):f<0&&i.z3(`read vpcc error, size: ${a.size}, read: ${a.size-f}`,s,73)}},3016:(e,t,a)=>{a.d(t,{A:()=>o});var i=a(9515),s=a(192),r=a(9906);const n="packages/avformat/src/formats/isobmff/parsing/wave.ts";async function o(e,t,a,o){const c=e.getPos(),d=c+BigInt(Math.floor(a.size));for(;e.getPos()<d;){const a=await e.readUint32(),c=await e.readUint32();0!==a?c===(0,i.A)("esds")?await(0,s.A)(e,t,{type:c,size:a-8},o):await e.skip(Math.min(a-8,Number(d-e.getPos()))):(r.R8("wave invalid box size 0, skip",n,45),await e.skip(Number(d-e.getPos())))}const f=a.size-Number(e.getPos()-c);f>0?await e.skip(f):f<0&&r.z3(`read vpcc error, size: ${a.size}, read: ${a.size-f}`,n,71)}},3043:(e,t,a)=>{a.d(t,{DK:()=>o,XC:()=>d,Xr:()=>c,jA:()=>r,ob:()=>s,oe:()=>n});var i=a(5815);const s=34,r=8,n=[0,8,12,0,16,20,24,32],o=[0,88200,176400,192e3,8e3,16e3,22050,24e3,32e3,44100,48e3,96e3,0,0,0,0],c=[0,192,576,1152,2304,4608,0,0,256,512,1024,2048,4096,8192,16384,32768];function d(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length===s){const{bitsPerRawSample:a,sampleRate:s,channels:r}=function(e){const t=new i.A(e);t.skip(10);const a=t.readUint24();return{sampleRate:a>>4,channels:1+((15&a)>>>1),bitsPerRawSample:1+((1&a)<<4|(240&t.readUint8())>>>4)}}(t);e.codecpar.bitsPerRawSample=a,e.codecpar.sampleRate=s,e.codecpar.chLayout.nbChannels=r}}},3153:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/pitm.ts";async function r(e,t,a,r){const n=e.getPos();await e.skip(4),r.heif.primaryId=await e.readUint16();const o=a.size-Number(e.getPos()-n);o>0?await e.skip(o):o<0&&i.z3(`read pitm error, size: ${a.size}, read: ${a.size-o}`,s,44)}},3180:(e,t,a)=>{a.d(t,{A:()=>s});var i=a(1237);function s(){return{isom:!1,timescale:i.N_,duration:i.Dh,foundMoov:!1,foundMdat:!1,foundHEIF:!1,majorBrand:0,minorVersion:0,compatibleBrand:[],creationTime:BigInt(0),modificationTime:BigInt(0),rate:i.N_,volume:i.N_,matrix:null,nextTrackId:1,fragment:!1,trexs:[],currentFragment:null,boxsPositionInfo:[],holdMoovPos:BigInt(0),currentChunk:null}}},3213:(e,t,a)=>{a.d(t,{A:()=>V});var i=a(5255),s=a(2423),r=a(4036),n=a(139),o=a(182),c=a(7860),d=a(9939),f=a(9657),l=a(2300),p=a(9846),m=a(144),u=a(4871),w=a(3305),g=a(9558),h=a(2454),k=a(2971),z=a(5527),v=a(6384),U=a(5591),A=a(3243),I=a(9307),y=a(9444),b=a(9109),x=a(3941),B=a(2354),P=a(1326),S=a(4860),R=a(1846),M=a(4507),D=a(5603),$=a(1278),C=a(5938),N=a(4374),E=a(2741),T=a(6910),F=a(3153),O=a(1129),_=a(1392),L=a(2281),W=a(626),X=a(9515);const V={[(0,X.A)("stts")]:i.A,[(0,X.A)("ctts")]:s.A,[(0,X.A)("stss")]:r.A,[(0,X.A)("stsz")]:n.A,[(0,X.A)("stz2")]:o.A,[(0,X.A)("stsc")]:c.A,[(0,X.A)("stco")]:d.A,[(0,X.A)("co64")]:f.A,[(0,X.A)("mdhd")]:l.A,[(0,X.A)("mvhd")]:p.A,[(0,X.A)("tkhd")]:m.A,[(0,X.A)("hdlr")]:u.A,[(0,X.A)("stsd")]:w.A,[(0,X.A)("elst")]:U.A,[(0,X.A)("trex")]:g.A,[(0,X.A)("mfhd")]:h.A,[(0,X.A)("tfhd")]:k.A,[(0,X.A)("tfdt")]:z.A,[(0,X.A)("trun")]:v.A,[(0,X.A)("pssh")]:A.A,[(0,X.A)("frma")]:I.A,[(0,X.A)("schm")]:y.A,[(0,X.A)("tenc")]:b.A,[(0,X.A)("saio")]:x.A,[(0,X.A)("saiz")]:B.A,[(0,X.A)("senc")]:P.A,[(0,X.A)("meta")]:S.A,[(0,X.A)("chpl")]:R.A,[(0,X.A)("chap")]:M.A,[(0,X.A)("iinf")]:D.A,[(0,X.A)("iloc")]:$.A,[(0,X.A)("ipco")]:C.A,[(0,X.A)("ipma")]:N.A,[(0,X.A)("iref")]:E.A,[(0,X.A)("ispe")]:T.A,[(0,X.A)("pitm")]:F.A,[(0,X.A)("imir")]:_.A,[(0,X.A)("irot")]:O.A,[(0,X.A)("hvcC")]:L.A,[(0,X.A)("av1C")]:W.A}},3243:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/pssh.ts";async function r(e,t,a,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=r.encryptionInitInfos||[],d={systemId:await e.readBuffer(16),keyIds:[],data:null};if(o>0){const t=await e.readUint32();for(let a=0;a<t;a++)d.keyIds.push(await e.readBuffer(16))}const f=await e.readUint32();d.data=await e.readBuffer(f),c.push(d),r.encryptionInitInfos=c;const l=a.size-Number(e.getPos()-n);l>0?await e.skip(l):l<0&&i.z3(`read pssh error, size: ${a.size}, read: ${a.size-l}`,s,65)}},3270:(e,t,a)=>{function i(e,t,a,i){if(e<=0||e>64)return 0;if(t)switch(e){case 32:return a?65556:65557;case 64:return a?65558:65559;default:return 0}else if(e+=7,i&1<<(e>>>=3)-1)switch(e){case 1:return 65540;case 2:return a?65537:65536;case 3:return a?65549:65548;case 4:return a?65545:65544;case 8:return a?65568:65567;default:return 0}else switch(e){case 1:return 65541;case 2:return a?65539:65538;case 3:return a?65551:65550;case 4:return a?65547:65546;default:return 0}}function s(e){switch(e){case 69649:return 2;case 69648:return 3;case 69647:case 69633:case 69632:case 69645:case 69638:return 4;default:return function(e){switch(e){case 86070:case 86071:case 69674:case 69644:case 69678:case 69651:case 69661:case 69677:case 69655:case 69664:case 69636:case 69675:case 69660:case 69646:case 69670:return 4;case 86089:case 86090:case 86091:case 86092:case 65543:case 65542:case 65571:case 65540:case 65563:case 65572:case 65541:case 81924:case 81926:return 8;case 65537:case 65566:case 65536:case 65554:case 65539:case 65538:return 16;case 65552:case 65549:case 65548:case 65564:case 65551:case 65550:return 24;case 65545:case 65544:case 65565:case 65547:case 65546:case 65556:case 65557:case 65570:case 65569:return 32;case 65558:case 65559:case 65568:case 65567:return 64;default:return 0}}(e)}}a.d(t,{MZ:()=>s,uU:()=>i})},3305:(e,t,a)=>{a.d(t,{A:()=>U});var i=a(9515),s=a(491),r=a(7962),n=a(9906),o=a(6876),c=a(2281),d=a(7939),f=a(8837),l=a(626),p=a(192),m=a(3016),u=a(9676),w=a(7801),g=a(697),h=a(1668),k=a(1556),z=a(7512);const v="packages/avformat/src/formats/isobmff/parsing/stsd.ts";async function U(e,t,a,U){const A=e.getPos(),I=await e.readUint8();await e.skip(3);const y=t.privData,b=await e.readUint32();for(let a=0;a<b;a++){const a=await e.readUint32(),A=await e.readUint32(),b=e.getPos()+BigInt(Math.floor(a-8));if(r.uf[A]&&(t.codecpar.codecId=r.uf[A]),y.format=A,0===a){n.R8("stsd entry invalid box size 0, skip",v,74),await e.skip(Number(b-e.getPos()));break}if(a>=16?(await e.skip(6),await e.skip(2)):a<=7&&n.h2(`invalid size: ${a} in stsd`,v,87),0===t.codecpar.codecType){await e.skip(2),await e.skip(2),t.metadata.vendorId=await e.readString(4),await e.skip(4),await e.skip(4),t.codecpar.width=await e.readUint16(),t.codecpar.height=await e.readUint16(),await e.skip(4),await e.skip(4),await e.skip(4),await e.skip(2);let a=await e.readUint8();for(a>31&&(a=31),t.metadata.encoder=await e.readString(a),a<31&&await e.skip(31-a),await e.skip(2),await e.skip(2);e.getPos()<b;){const a=await e.readUint32(),r=await e.readUint32();0!==a?r===(0,i.A)("avcC")?await(0,o.A)(e,t,{type:r,size:a-8},U):r===(0,i.A)("hvcC")?await(0,c.A)(e,t,{type:r,size:a-8},U):r===(0,i.A)("vvcC")?await(0,d.A)(e,t,{type:r,size:a-8},U):r===(0,i.A)("av1C")?await(0,l.A)(e,t,{type:r,size:a-8},U):r===(0,i.A)("vpcC")?await(0,f.A)(e,t,{type:r,size:a-8},U):r===(0,i.A)("esds")?await(0,p.A)(e,t,{type:r,size:a-8},U):r===(0,i.A)("wave")?await(0,m.A)(e,t,{type:r,size:a-8},U):r===(0,i.A)("colr")?await(0,g.A)(e,t,{type:r,size:a-8},U):U.parsers&&U.parsers[r]?await U.parsers[r](e,null,{type:r,size:a-8},U):U.parseOneBox&&s.gQ.some((e=>(0,i.A)(e)===r))?await U.parseOneBox(e,t,{type:r,size:a-8},U):await e.skip(Math.min(a-8,Number(b-e.getPos()))):(n.R8("stsd video invalid box size 0, skip",v,136),await e.skip(Number(b-e.getPos())))}}else if(1===t.codecpar.codecType){const a=await e.readUint16();for(await e.skip(2),t.metadata.vendorId=await e.readString(4),t.codecpar.chLayout.nbChannels=await e.readUint16(),t.codecpar.bitsPerCodedSample=await e.readUint16(),y.audioCid=await e.readUint16(),await e.skip(2),t.codecpar.sampleRate=await e.readUint32()>>>16,(!U.isom||0===I&&a>0)&&(1===a?(y.samplesPerFrame=await e.readUint32(),await e.skip(4),y.bytesPerFrame=await e.readUint32(),await e.skip(4)):2===a&&(await e.skip(4),t.codecpar.sampleRate=Number(await e.readUint64()),t.codecpar.chLayout.nbChannels=await e.readUint32(),await e.skip(4),t.codecpar.bitsPerCodedSample=await e.readUint32(),await e.skip(4),y.bytesPerFrame=await e.readUint32(),y.samplesPerFrame=await e.readUint32()));e.getPos()<b;){const a=await e.readUint32(),r=await e.readUint32();0!==a?r===(0,i.A)("esds")?await(0,p.A)(e,t,{type:r,size:a-8},U):r===(0,i.A)("dfLa")?await(0,u.A)(e,t,{type:r,size:a-8},U):r===(0,i.A)("dOps")?await(0,w.A)(e,t,{type:r,size:a-8},U):r===(0,i.A)("wave")?await(0,m.A)(e,t,{type:r,size:a-8},U):r===(0,i.A)("dac3")?await(0,k.A)(e,t,{type:r,size:a-8},U):r===(0,i.A)("dec3")?await(0,z.A)(e,t,{type:r,size:a-8},U):r===(0,i.A)("pcmC")?await(0,h.A)(e,t,{type:r,size:a-8},U):U.parsers&&U.parsers[r]?await U.parsers[r](e,null,{type:r,size:a-8},U):U.parseOneBox&&s.gQ.some((e=>(0,i.A)(e)===r))?await U.parseOneBox(e,t,{type:r,size:a-8},U):await e.skip(Math.min(a-8,Number(b-e.getPos()))):(n.R8("stsd audio invalid box size 0, skip",v,309),await e.skip(Number(b-e.getPos())))}}else 3===t.codecpar.codecType?(A===(0,i.A)("stpp")?t.codecpar.codecId=94232:A===(0,i.A)("wvtt")?t.codecpar.codecId=94226:A===(0,i.A)("tx3g")||A===(0,i.A)("text")?t.codecpar.codecId=94213:A===(0,i.A)("c608")&&(t.codecpar.codecId=94218),await e.skip(Math.min(a-8,Number(b-e.getPos())))):await e.skip(Math.min(a-8,Number(b-e.getPos())))}const x=a.size-Number(e.getPos()-A);x>0?await e.skip(x):x<0&&n.z3(`read stsd error, size: ${a.size}, read: ${a.size-x}`,v,447)}},3690:(e,t,a)=>{a.d(t,{Ij:()=>d,XC:()=>c,kt:()=>o});var i=a(3262),s=a(5815),r=a(187);const n=[480,960,1920,2880,480,960,1920,2880,480,960,1920,2880,480,960,480,960,120,240,480,960,120,240,480,960,120,240,480,960,120,240,480,960];function o(e){let t=0,a=0,i=0;if(e.length<1)return 0;switch(t=e[0],a=n[t>>3],3&t){case 0:i=1;break;case 1:case 2:i=2;break;case 3:if(e.length<2)return 0;i=63&e[1]}return i*a}function c(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=19){const a=new s.A(t,!1);a.skip(9),e.codecpar.chLayout.nbChannels=a.readUint8(),e.codecpar.initialPadding=a.readUint16(),e.codecpar.sampleRate=a.readUint32(),e.codecpar.seekPreroll=Number((0,i.k)(BigInt(80),{den:1e3,num:1},{den:48e3,num:1}))}}function d(e){const t=new Uint8Array(19),a=new r.A(t,!1);return a.writeString("OpusHead"),a.writeUint8(1),a.writeUint8(e.chLayout.nbChannels),a.writeUint16(e.initialPadding),a.writeUint32(e.sampleRate),t}},3831:(e,t,a)=>{a.d(t,{Ui:()=>m,XC:()=>p,Yj:()=>u,k9:()=>l,zk:()=>c});var i=a(9983),s=a(39),r=a(3139),n=a(84),o=a(4916);const c={0:"Main",1:"High",2:"Professional"},d=[{level:20,maxResolution:2359296},{level:21,maxResolution:4460544},{level:30,maxResolution:10653696},{level:31,maxResolution:17040384},{level:40,maxResolution:21233664},{level:41,maxResolution:21233664},{level:50,maxResolution:35651584},{level:51,maxResolution:35651584},{level:52,maxResolution:35651584},{level:53,maxResolution:35651584},{level:60,maxResolution:142606336},{level:61,maxResolution:142606336},{level:62,maxResolution:142606336},{level:63,maxResolution:142606336}],f=[20,21,22,23,30,31,32,33,40,41,42,43,50,51,52,53,60,61,62,63,70,71,72,73];function l(e,t,a){const i=e*t;for(const e of d)if(i<=e.maxResolution)return e.level}function p(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=4){const a=m(t);e.codecpar.profile=a.profile,e.codecpar.level=a.level}}function m(e){const t=new n.A(e.length);t.appendBuffer(e),t.readU1(),t.readU(7);const a=t.readU(3),i=t.readU(5),s=t.readU1();let r=t.readU1()?10:8;return t.readU1()&&(r=12),{profile:a,level:i,tier:s,bitDepth:r,monochrome:t.readU1(),chromaSubsamplingX:t.readU1(),chromaSubsamplingY:t.readU1(),chromaSamplePosition:t.readU(2)}}function u(e,t){const a=new o.A(4);a.writeU1(1),a.writeU(7,1);const c=function(e){const t=new n.A;t.appendBuffer(e);const a=[];for(;t.remainingLength();){const i=t.getPointer();t.readU1(),t.readU(4);const r=t.readU1(),n=t.readU1();t.readU1(),r&&t.readU(8);const o=n?s.v(t):e.length-1-r,c=t.getPointer()-i;a.push(e.subarray(i,i+c+o)),t.skip(8*o)}return a}(t).find((e=>1==(e[0]>>>3&15)));if(c){const e=function(e){const t=new n.A(e.length);t.appendBuffer(e),t.readU1(),t.readU(4);const a=t.readU1(),i=t.readU1();t.readU1(),a&&t.readU(8),i&&s.v(t);const r=s.f(t,3),o=(s.f(t,1),s.f(t,1));let c=0,d=0,l=[0],p=[0],m=[0],u=[0],w=[0],g=[0],h=0,k=[0],z=[0],v=[0];if(o)p[0]=s.f(t,5);else{c=s.f(t,1),c?(s.f(t,32),s.f(t,32),s.f(t,1)&&s.d(t),s.f(t,1)&&(h=s.f(t,5),s.f(t,32),s.f(t,5),s.f(t,5))):d=0;let e=s.f(t,1),a=s.f(t,5);for(let i=0;i<=a;i++){if(l[i]=s.f(t,12),p[i]=s.f(t,5),p[i]>7?m[i]=s.f(t,1):m[i]=0,d){if(u[i]=s.f(t,1),u[i]){let e=h+1;k[i]=s.f(t,e),z[i]=s.f(t,e),v[i]=s.f(t,1)}}else u[i]=0;e&&(w[i]=s.f(t,1),w[i]&&(g[i]=s.f(t,4)))}}let U=s.f(t,4),A=s.f(t,4),I=U+1,y=s.f(t,I);I=A+1;let b=s.f(t,I),x=0,B=0,P=0;x=o?0:s.f(t,1),x&&(s.f(t,4),s.f(t,3)),s.f(t,1),s.f(t,1),s.f(t,1);let S=0,R=0,M=0,D=0,$=0,C=0,N=2,E=2,T=0;o||(s.f(t,1),s.f(t,1),s.f(t,1),s.f(t,1),D=s.f(t,1),D?($=s.f(t,1),C=s.f(t,1)):($=0,C=0),N=s.f(t,1)?2:s.f(t,1),N>0?s.f(t,1)?2:s.f(t,1):2,D&&s.f(t,3)),s.f(t,1),s.f(t,1),s.f(t,1);let F=s.f(t,1),O=0,_=0,L=0;2==r&&F?(O=s.f(t,1),_=O?12:10):r<=2&&(_=F?10:8),L=1==r?0:s.f(t,1);let W=0,X=0,V=0;s.f(t,1)?(W=s.f(t,8),X=s.f(t,8),V=s.f(t,8)):(W=2,X=2,V=2);let H=0,j=0,Y=0,G=0,q=0;return L?(H=s.f(t,1),j=1,Y=1,G=0,q=0):1==W&&13==X&&0==V?(H=1,j=0,Y=0,q=s.f(t,1)):(H=s.f(t,1),0==r?(j=1,Y=1):1==r?(j=0,Y=0):12==_?(j=s.f(t,1),Y=j?s.f(t,1):0):(j=1,Y=0),j&&Y&&(G=s.f(t,2)),q=s.f(t,1)),s.f(t,1),{width:y+1,height:b+1,profile:r,level:f[p[0]],tier:m[0],bitDepth:_,monoChrome:L,colorRange:H,colorPrimaries:W,transferCharacteristics:X,matrixCoefficients:V,subsamplingX:j,subsamplingY:Y,chromaSamplePosition:G}}(c);a.writeU(3,e.profile),a.writeU(5,e.level),a.writeU(1,e.tier),a.writeU(1,e.bitDepth>8?1:0),a.writeU(1,12===e.bitDepth?1:0),a.writeU(1,e.monoChrome),a.writeU(1,e.subsamplingX),a.writeU(1,e.subsamplingY),a.writeU(1,e.chromaSamplePosition)}else{const t=(0,r.I)(i.f[15](e+28));a.writeU(3,i.f[15](e+48)),a.writeU(5,i.f[15](e+52)),a.writeU(1,0),a.writeU(1,t.comp[0].depth>8?1:0),a.writeU(1,12===t.comp[0].depth?1:0),a.writeU(1,0),a.writeU(1,1),a.writeU(1,1),a.writeU(1,0)}return a.writeU(8,0),a.padding(),a.getBuffer()}},3941:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/saio.ts";async function r(e,t,a,r){const n=e.getPos(),o=r.currentFragment.currentTrack,c=r.cencs?r.cencs[o.trackId]:null,d=await e.readUint8();if(1&await e.readUint24()){const t=await e.readUint32(),a=await e.readUint32();if(!c)return void await l();if(t!==c.schemeType)return i.R8("Ignoring saio box with non-zero aux_info_type",s,44),void await l();if(0!==a)return i.R8("Ignoring saio box with non-zero aux_info_type_parameter",s,49),void await l()}else if(!c)return void await l();o.cenc||(o.cenc={defaultSampleInfoSize:0,sampleCount:0,offset:0,useSubsamples:!1,sampleEncryption:[],sampleSizes:[],sampleInfoOffset:[]});const f=await e.readUint32();for(let t=0;t<f;t++)o.cenc.sampleInfoOffset.push(0===d?await e.readUint32():await e.readUint64());async function l(){const t=a.size-Number(e.getPos()-n);t>0?await e.skip(t):t<0&&i.z3(`read saio error, size: ${a.size}, read: ${a.size-t}`,s,88)}await l()}},4036:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/stss.ts";async function r(e,t,a,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=new Map,d=await e.readUint32();if(0===o)for(let t=0;t<d;t++)c.set(await e.readUint32(),!0);t.privData.stssSampleNumbersMap=c;const f=a.size-Number(e.getPos()-n);f>0?await e.skip(f):f<0&&i.z3(`read stss error, size: ${a.size}, read: ${a.size-f}`,s,55)}},4283:(e,t,a)=>{a.r(t),a.d(t,{default:()=>x});var i=a(4467),s=a(9983),r=a(2320),n=a(9515),o=a(6385),c=a(1945),d=a(1328),f=a(3180),l=a(1700),p=a(1638),m=a(3674),u=a(495),w=a(713),g=a(4187),h=a(1755),k=a(3262),z=a(1237),v=a(2171),U=a(3321),A=a(665),I=a(9906),y=a(4405);const b="packages/avformat/src/formats/IIsobmffFormat.ts";class x extends c.A{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),(0,i.A)(this,"type",1),(0,i.A)(this,"context",void 0),(0,i.A)(this,"firstAfterSeek",void 0),(0,i.A)(this,"options",void 0),this.options=e,this.context=(0,f.A)(),e.ignoreEditlist&&(this.context.ignoreEditlist=!0)}init(e){e.ioReader&&e.ioReader.setEndian(!0),this.firstAfterSeek=!1}async readHeader(e){try{var t;const a=await e.ioReader.fileSize();let i=0,c=await e.ioReader.readUint32(),d=await e.ioReader.readUint32();d===(0,n.A)("ftyp")?await o.E6(e.ioReader,this.context,{type:d,size:c-8}):(!a||c<a)&&await e.ioReader.skip(c-8);let f=BigInt(0);for(;!this.context.foundMoov;){const t=e.ioReader.getPos();if(t===a){if(this.context.foundHEIF)break;return I.z3("the file format is not mp4",b,144),u.LR}if(c=await e.ioReader.readUint32(),d=await e.ioReader.readUint32(),1===c&&(c=Number(await e.ioReader.readUint64())),c<8||a&&t+BigInt(Math.floor(c))>a||!/^[\x20-\x7E]{4}$/.test((0,p.A)(d))){if(this.context.foundMdat&&(this.context.foundMoov||this.context.foundHEIF))break;return I.z3(`invalid box size ${c}`,b,165),u.LR}d===(0,n.A)("mdat")?(this.context.foundMdat||(f=t),this.context.foundMdat=!0,await e.ioReader.seek(t+BigInt(Math.floor(c)),!1,!1)):d===(0,n.A)("moov")?(await o.wB(e.ioReader,e,this.context,{size:c-8,type:d}),this.context.foundMoov=!0):d!==(0,n.A)("meta")||this.context.majorBrand!==(0,n.A)("avif")&&this.context.majorBrand!==(0,n.A)("avis")&&this.context.majorBrand!==(0,n.A)("heic")&&this.context.majorBrand!==(0,n.A)("heix")&&this.context.majorBrand!==(0,n.A)("hevc")&&this.context.majorBrand!==(0,n.A)("hevx")&&this.context.majorBrand!==(0,n.A)("mif1")&&this.context.majorBrand!==(0,n.A)("msf1")?await e.ioReader.seek(t+BigInt(Math.floor(c))):await o.jF(e.ioReader,e,this.context,{size:c-8,type:d})}if(!this.context.fragment&&!this.context.foundMdat){const t=await e.ioReader.peekUint64()>>BigInt(32);Number(t)===(0,n.A)("moof")&&(this.context.fragment=!0)}if(this.context.fragment&&1&e.ioReader.flags){const t=e.ioReader.getPos(),a=await e.ioReader.fileSize();if(a>BigInt(16)){await e.ioReader.seek(a-BigInt(12));let i=await e.ioReader.readUint32();if(i===(0,n.A)("mfro")){await e.ioReader.skip(4);const t=await e.ioReader.readUint32();await e.ioReader.seek(a-BigInt(Math.floor(t)));const s=await e.ioReader.readUint32();i=await e.ioReader.readUint32(),i===(0,n.A)("mfra")&&await o.t9(e.ioReader,e,this.context,{size:s-8,type:i})}await e.ioReader.seek(t)}}if(!this.context.fragment&&this.context.foundMdat&&await e.ioReader.seek(f),this.context.fragment||e.streams.forEach((e=>{if(27===e.codecpar.codecId||173===e.codecpar.codecId||196===e.codecpar.codecId){const t=e.privData;!(e.codecpar.videoDelay>0)||t.cttsSampleCounts&&t.cttsSampleCounts.length||(e.codecpar.flags|=2)}})),this.context.metadata&&A.X$(e.metadata,this.context.metadata),null!==(t=this.context.chapters)&&void 0!==t&&t.length){for(let e=1;e<this.context.chapters.length;e++)this.context.chapters[e-1].end=(0,k.k)(this.context.chapters[e].start,this.context.chapters[e].timeBase,this.context.chapters[e-1].timeBase);const t=this.context.chapters[this.context.chapters.length-1];e.streams.forEach((e=>{const a=(0,k.k)(e.duration,e.timeBase,t.timeBase);a>t.end&&(t.end=a)})),e.chapters.push(...this.context.chapters)}if(this.context.covr){let t=0;switch(this.context.covr.type){case 13:t=7;break;case 14:t=61;break;case 27:t=78;break;default:I.z3(`"Unknown cover type: ${this.context.covr.type}`,b,291)}if(t){this.context.covr.data.length>=8&&78!==t&&(t=U.FB(this.context.covr.data.subarray(0,8),new Uint8Array([137,80,78,71,13,10,26,10]))?61:7);const a=e.createStream();a.privData=(0,l.A)(),a.codecpar.codecId=t,a.codecpar.codecType=0,a.disposition|=1024,a.attachedPic=(0,g._5)(),r.M[15](a.attachedPic+32,a.index);const i=(0,h.sY)(this.context.covr.data.length);(0,m.lW)(i,this.context.covr.data.length,this.context.covr.data),(0,g.NX)(a.attachedPic,i,this.context.covr.data.length),r.M[15](a.attachedPic+36,1|s.f[15](a.attachedPic+36))}}if(this.context.chapterTrack&&1&e.ioReader.flags&&!this.options.ignoreChapters)for(let t=0;t<this.context.chapterTrack.length;t++){const a=this.context.chapterTrack[t],i=e.streams.find((e=>e.privData.trackId===a));if(i){const t=e.ioReader.getPos(),a=i.privData;if(0===i.codecpar.codecType){if(i.disposition|=1024,i.disposition|=2048,!i.attachedPic){const t=a.samplesIndex[0];if(t){await e.ioReader.seek(t.pos),i.attachedPic=(0,g._5)(),r.M[15](i.attachedPic+32,i.index),r.M[17](i.attachedPic+16,t.dts),r.M[17](i.attachedPic+8,t.pts),r.M[15](i.attachedPic+36,s.f[15](i.attachedPic+36)|t.flags),r.M[15](i.attachedPic+36,1|s.f[15](i.attachedPic+36)),r.M[17](i.attachedPic+56,t.pos);const a=(0,h.sY)(t.size);(0,m.lW)(a,t.size,await e.ioReader.readBuffer(t.size)),(0,g.NX)(i.attachedPic,a,t.size)}}}else{i.codecpar.codecType=2,i.codecpar.codecId=98314,i.discard=48;for(let t=0;t<a.samplesIndex.length;t++){const s=a.samplesIndex[t];await e.ioReader.seek(s.pos);const r=await e.ioReader.readUint16();if(r>s.size-2)continue;let n=s.pts+BigInt(0|s.duration);n<s.pts&&(n=z.Dh),e.chapters.push({id:BigInt(t),timeBase:{den:i.timeBase.den,num:i.timeBase.num},start:s.pts,end:n,metadata:{title:r?y.decode(await e.ioReader.readBuffer(r)):""}})}}await e.ioReader.seek(t)}}return i}catch(t){return I.z3(t.message,b,387),this.context.foundMoov||I.z3("moov not found",b,390),e.ioReader.error}}async readAVPacket_(e,t){const{sample:a,stream:i,encryption:o}=(0,d.G)(e,this.context,e.ioReader.flags);if(!a)return-1048576;{r.M[15](t+32,i.index),r.M[17](t+16,a.dts),2&i.codecpar.flags||r.M[17](t+8,a.pts),r.M[17](t+48,BigInt(Math.floor(a.duration))),r.M[15](t+36,s.f[15](t+36)|a.flags),r.M[17](t+56,a.pos),r.M[15](t+76,i.timeBase.den),r.M[15](t+72,i.timeBase.num),i.startTime===z.Dh&&(i.startTime=s.f[17](t+8));const c=s.f[17](t+56)-e.ioReader.getPos();c!==BigInt(0)&&(c>0&&(4&e.ioReader.flags||2&e.ioReader.flags)&&!this.firstAfterSeek?await e.ioReader.skip(Number(BigInt.asIntN(32,c))):await e.ioReader.seek(s.f[17](t+56))),this.firstAfterSeek&&(this.firstAfterSeek=!1);const d=a.size,f=(0,h.sY)(d);if((0,g.NX)(t,f,d),await e.ioReader.readBuffer(d,(0,m.JW)(f,d)),94226===i.codecpar.codecId&&s.f[15](t+28)>=8){const e=v.Sg(s.f[20](t+24)+4)>>>0,a=s.f[15](t+28);if(e===(0,n.A)("vtte")&&8===a){const e=(0,h.Gy)(1);(0,g.NX)(t,e,1),r.M[15](t+28,1)}if(a>8&&(e===(0,n.A)("vtte")||e===(0,n.A)("vttc"))){let e=s.f[20](t+24)+8;const i=s.f[20](t+24)+a;for(;e<i;){const a=v.Sg(e);if(v.Sg(e+4)>>>0===(0,n.A)("payl")&&a>8){const i=(0,h.sY)(a-8);(0,m.Mr)(i,e+8,a-8),(0,g.NX)(t,i,a-8);break}e+=a}}}if(i.sideData[1]&&1&s.f[15](t+36)){const e=i.sideData[1].length,a=(0,h.sY)(e);(0,g.Ow)(t,1,a,e),(0,m.lW)(a,e,i.sideData[1]),delete i.sideData[1]}if(o){const e=(0,w.zz)(o),a=(0,h.sY)(e.length);(0,m.lW)(a,e.length,e),(0,g.Ow)(t,25,a,e.length)}}return 0}async readAVPacket(e,t){try{if(!e.streams.find((e=>{var t;const a=e.privData;return(null===(t=a.samplesIndex)||void 0===t?void 0:t.length)&&!1===a.sampleEnd}))&&this.context.fragment&&!this.context.currentFragment)for(;!this.context.currentFragment;){const t=e.ioReader.getPos(),a=await e.ioReader.readUint32(),i=await e.ioReader.readUint32();i===(0,n.A)("moof")?(this.context.currentFragment={pos:t,size:a,sequence:0,tracks:[],currentTrack:null},this.context.firstMoof||(this.context.firstMoof=t),await o.wZ(e.ioReader,e,this.context,{type:i,size:a-8})):i===(0,n.A)("moov")?await o.wB(e.ioReader,e,this.context,{size:a-8,type:i}):await e.ioReader.skip(a-8)}return await this.readAVPacket_(e,t)}catch(t){return-1048576!==e.ioReader.error&&-1048572!==e.ioReader.error?(I.z3(`read packet error, ${t}`,b,551),u.LR):e.ioReader.error}}async seek(e,t,a,i){const s=e.ioReader.getPos();if(2&i)return await e.ioReader.seek(a),s;const r=a,n=t.privData,o=()=>{this.context.currentFragment=null,e.streams.forEach((e=>{e.privData.samplesIndex.length=0}))};if(16&i&&this.context.fragment){const i=(0,k.k)(a,t.timeBase,z.i0);return await e.ioReader.seek(i,!0),o(),s}if(this.context.fragment){if(n.fragIndexes.length){let t=U.El(n.fragIndexes,(e=>e.time>r?-1:e.time===r?0:1));if(t>-1)return t>0&&n.fragIndexes[t].time>r&&t--,await e.ioReader.seek(n.fragIndexes[t].pos,!0),o(),s}return r===BigInt(0)&&this.context.firstMoof?(await e.ioReader.seek(this.context.firstMoof),o(),s):BigInt(u.E$)}let c=U.El(n.samplesIndex,(e=>e.pts>r?-1:e.pts===r?0:1));if(c>-1&&0===t.codecpar.codecType){let e=c;for(;e>=0;e--)if(1&n.samplesIndex[e].flags){c=e;break}e<0&&(c=-1)}return c>-1?(n.currentSample=c,n.sampleEnd=!1,U.__(e.streams,(e=>{if(e!==t&&!(1024&e.disposition)){const a=e.privData;let i=(0,k.k)(n.samplesIndex[n.currentSample].pts,t.timeBase,e.timeBase),s=U.El(a.samplesIndex,(e=>e.pts>i?-1:e.pts===i?0:1));if(s>-1&&0===e.codecpar.codecType){let e=s;for(;e>=0;e--)if(1&a.samplesIndex[e].flags){s=e;break}e<0&&(s=-1)}s>=0?(a.currentSample=s,a.sampleEnd=!1):(a.sampleEnd=!0,a.currentSample=a.samplesIndex.length)}})),this.firstAfterSeek=!0,s):BigInt(u.LR)}getAnalyzeStreamsCount(){return 0}}},4374:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/ipma.ts";async function r(e,t,a,r){const n=e.getPos(),o=await e.readUint8(),c=await e.readUint24(),d=await e.readUint32();r.heif.items||(r.heif.items=[]);for(let t=0;t<d;t++){let t=o?await e.readUint32():await e.readUint16(),a=await e.readUint8(),i=r.heif.items.find((e=>e.id===t));i?i.ipma=[]:(i={id:t,ipma:[]},r.heif.items.push(i));for(let t=0;t<a;t++){let t=127&await e.readUint8();1&c&&(t<<=8,t|=await e.readUint8()),i.ipma.push(t-1)}}const f=a.size-Number(e.getPos()-n);f>0?await e.skip(f):f<0&&i.z3(`read ipma error, size: ${a.size}, read: ${a.size-f}`,s,71)}},4507:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/chap.ts";async function r(e,t,a,r){const n=e.getPos(),o=Math.floor(a.size/4);r.chapterTrack=[];for(let t=0;t<o;t++)r.chapterTrack.push(await e.readUint32());const c=a.size-Number(e.getPos()-n);c>0?await e.skip(c):c<0&&i.z3(`read chap error, size: ${a.size}, read: ${a.size-c}`,s,48)}},4860:(e,t,a)=>{a.d(t,{A:()=>d,G:()=>c});var i=a(6362),s=a(1638),r=a(8590),n=a(9906);const o="packages/avformat/src/formats/isobmff/parsing/meta.ts";async function c(e,t,a){const i=[];if(await e.peekUint16()+4===t){let a=await e.readUint16();await e.skip(2),i.push(await e.readString(a)),t-=a+4}else for(;t>16;){let s=await e.readUint32();t-=s,await e.skip(4);const r=await e.readUint32();if(await e.skip(4),s-=16,21===r)switch(s){case 1:s>=1&&(i.push(await e.readInt8()),s--);break;case 2:s>=2&&(i.push(await e.readInt16()),s-=2);break;case 3:s>=3&&(i.push(await e.readInt24()),s-=3);break;case 4:s>=4&&(i.push(await e.readInt32()),s-=4)}else if(22===r)switch(s){case 1:s>=1&&(i.push(await e.readUint8()),s--);break;case 2:s>=2&&(i.push(await e.readUint16()),s-=2);break;case 3:s>=3&&(i.push(await e.readUint24()),s-=3);break;case 4:s>=4&&(i.push(await e.readUint32()),s-=4)}else 23===r&&s>=4?(i.push(await e.readFloat()),s-=4):1===r&&s>0?(i.push(await e.readString(s)),s=0):s>0&&(i.push(await e.readBuffer(s)),s=0,a.type=r);s>0&&await e.skip(s)}return t>0&&await e.skip(t),i}async function d(e,t,a,d){const f=e.getPos();let l=a.size;l>12&&["hdlr","mhdr","keys","ilst","ctry","lang"].indexOf((await e.peekString(12)).substring(8))>=0&&(await e.skip(4),l-=4);let p,m,u=[""],w=[];for(;l>=8;){let t=await e.readUint32();const a=await e.readString(4);let i=t;if(t-=8,"keys"===a){await e.skip(4);const a=await e.readUint32();t-=8;for(let i=0;i<a;i++){const a=await e.readUint32();await e.skip(4),u.push(await e.readString(a-8)),t-=a}}else if("hdlr"===a)t>=12&&(await e.skip(8),p=await e.readString(4),t-=12);else if("ilst"===a)for(;t>8;){let a=await e.readUint32(),i=await e.readUint32();"mdta"!==p&&(i=(0,s.A)(i,4));const r={},n=await c(e,a-8,r);n.length&&("covr"===i?d.covr={type:r.type,data:n[0]}:w.push({key:i,value:1===n.length?n[0]:n})),t-=a}else{if(!(t<l-8))break;await e.skip(t),t=0}t&&await e.skip(t),l-=i}t?m=t.metadata:(d.metadata||(d.metadata={}),m=d.metadata),w.forEach((e=>{let t=e.key;r.ai(t)?u[t]&&(t=u[t]):i.c[t]&&(t=i.c[t]),m[t]=e.value}));const g=a.size-Number(e.getPos()-f);g>0?await e.skip(g):g<0&&n.z3(`read meta error, size: ${a.size}, read: ${a.size-g}`,o,262)}},4871:(e,t,a)=>{a.d(t,{A:()=>o});var i=a(7962),s=a(9906),r=a(5967);const n="packages/avformat/src/formats/isobmff/parsing/hdlr.ts";async function o(e,t,a,o){const c=e.getPos(),d=await e.readUint8();if(await e.skip(3),0===d){await e.skip(4);const s=await e.readString(4),n=i.f3[s];(0,r.A)(n)&&(t.codecpar.codecType=n),await e.skip(4),await e.skip(4),await e.skip(4);const c=a.size-24;if(c>0){const a=!o.isom&&await e.peekUint8()===c-1;a&&await e.skip(1),t.metadata.handlerName=await e.readString(c-(a?1:0))}}const f=a.size-Number(e.getPos()-c);f>0?await e.skip(f):f<0&&s.z3(`read hdlr error, size: ${a.size}, read: ${a.size-f}`,n,74)}},4876:(e,t,a)=>{a.d(t,{A:()=>s});var i=a(1237);function s(){return{trackId:0,baseDataOffset:BigInt(0),defaultSampleDuration:0,defaultSampleSize:0,defaultSampleFlags:0,baseMediaDecodeTime:BigInt(0),sampleCount:0,dataOffset:0,remainDataOffsets:[],remainDataOffsetIndex:[],dataOffsetPos:BigInt(0),firstSampleFlags:0,sampleDurations:[],sampleSizes:[],sampleFlags:[],sampleCompositionTimeOffset:[],baseIsMoof:!1,ioWriter:null,buffers:[],lastFragIndexDts:BigInt(0),tfdtDelay:i.Dh,trunPtsDelay:BigInt(0)}}},5255:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/stts.ts";async function r(e,t,a,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=t.privData,d=[],f=[],l=await e.readUint32();let p=1;if(0===o)for(let t=0;t<l;t++)d.push(await e.readUint32()),p=await e.readInt32(),p<0&&(i.R8("File uses negative stts sample delta, using value 1 instead, sync may be lost!",s,51),p=1),f.push(p);c.sttsSampleCounts=d,c.sttsSampleDeltas=f;const m=a.size-Number(e.getPos()-n);m>0?await e.skip(m):m<0&&i.z3(`read stts error, size: ${a.size}, read: ${a.size-m}`,s,66)}},5485:(e,t,a)=>{a.d(t,{_B:()=>r,_r:()=>n,pj:()=>s});var i=a(8308);const s={[(0,i.A)("mp4v")]:12,[(0,i.A)("DIVX")]:12,[(0,i.A)("XVID")]:12,[(0,i.A)("3IV2")]:12,[(0,i.A)("vvc1")]:196,[(0,i.A)("vvi1")]:196,[(0,i.A)("hev1")]:173,[(0,i.A)("hvc1")]:173,[(0,i.A)("dvhe")]:173,[(0,i.A)("hev1")]:173,[(0,i.A)("avc1")]:27,[(0,i.A)("avc2")]:27,[(0,i.A)("avc3")]:27,[(0,i.A)("avc4")]:27,[(0,i.A)("ai5p")]:27,[(0,i.A)("ai5q")]:27,[(0,i.A)("ai52")]:27,[(0,i.A)("ai53")]:27,[(0,i.A)("ai55")]:27,[(0,i.A)("ai56")]:27,[(0,i.A)("ai1p")]:27,[(0,i.A)("ai1q")]:27,[(0,i.A)("ai12")]:27,[(0,i.A)("ai13")]:27,[(0,i.A)("ai15")]:27,[(0,i.A)("ai16")]:27,[(0,i.A)("AVin")]:27,[(0,i.A)("aivx")]:27,[(0,i.A)("rv64")]:27,[(0,i.A)("xalg")]:27,[(0,i.A)("avlg")]:27,[(0,i.A)("dva1")]:27,[(0,i.A)("dvav")]:27,[(0,i.A)("vp08")]:139,[(0,i.A)("vp09")]:167,[(0,i.A)("av01")]:225},r={[(0,i.A)("mp4a")]:86018,[(0,i.A)("ac-3")]:86019,[(0,i.A)("sac3")]:86019,[(0,i.A)("ac-4")]:86119,[(0,i.A)("dtsc")]:86020,[(0,i.A)("dtsh")]:86020,[(0,i.A)("dtsl")]:86020,[(0,i.A)("dtse")]:86020,[(0,i.A)("DTS ")]:86020,[(0,i.A)("ec-3")]:86056,[(0,i.A)(".mp3")]:86017,[(0,i.A)("mp3 ")]:86017,1836253269:86017,[(0,i.A)("spex")]:86051,[(0,i.A)("SPXN")]:86051,[(0,i.A)("fLaC")]:86028,[(0,i.A)("Opus")]:86076,[(0,i.A)("alaw")]:65543,[(0,i.A)("ulaw")]:65542,[(0,i.A)("fl32")]:65557,[(0,i.A)("fl64")]:65559,[(0,i.A)("twos")]:65537,[(0,i.A)("lpcm")]:65536,[(0,i.A)("sowt")]:65536,[(0,i.A)("in24")]:65548,[(0,i.A)("in32")]:65544,[(0,i.A)("sowt")]:65540,[(0,i.A)("raw ")]:65541,[(0,i.A)("NONE")]:65541},n={[(0,i.A)("text")]:94213,[(0,i.A)("tx3g")]:94213,[(0,i.A)("c608")]:94218}},5527:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/tfdt.ts";async function r(e,t,a,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=r.currentFragment.currentTrack;c&&(c.baseMediaDecodeTime=1===o?await e.readUint64():BigInt(Math.floor(await e.readUint32())));const d=a.size-Number(e.getPos()-n);d>0?await e.skip(d):d<0&&i.z3(`read vpcc error, size: ${a.size}, read: ${a.size-d}`,s,55)}},5591:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/elst.ts";async function r(e,t,a,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=await e.readInt32(),d=[];for(let t=0;t<c;t++){let t=BigInt(0),a=BigInt(0);1===o?(t=await e.readInt64(),a=await e.readInt64()):(t=BigInt(Math.floor(await e.readInt32())),a=BigInt(Math.floor(await e.readInt32())));const i=await e.readInt16(),s=await e.readInt16();d.push({segmentDuration:t,mediaTime:a,mediaRate:i,mediaRateFraction:s})}t.metadata.elst=d;const f=a.size-Number(e.getPos()-n);f>0?await e.skip(f):f<0&&i.z3(`read elst error, size: ${a.size}, read: ${a.size-f}`,s,74)}},5603:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/iinf.ts";async function r(e,t,a,r){const n=e.getPos();if(r.heif.foundIinf)i.R8("Duplicate iinf box found",s,35);else{r.heif.foundIinf=!0;const t=await e.readUint8();await e.skip(3);let a=t?await e.readUint32():await e.readUint16();r.heif.items||(r.heif.items=[]);e:for(let t=0;t<a;t++){let t=await e.readUint32();if(t-=8,"infe"===await e.readString(4)){const a=await e.readUint8();if(await e.skip(3),t-=4,a<2){i.z3("infe version < 2",s,59),r.heif.foundIinf=!1;break e}let n=a>2?await e.readUint32():await e.readUint16();t-=a>2?4:2,await e.readUint16();let o=await e.readString(4);t-=6;let c="";t>0&&(c=await e.readString(t),0===c.charCodeAt(c.length-1)&&(c=c.substring(0,c.length-1)));const d=r.heif.items.find((e=>e.id===n));d?(d.name=c,d.type=o):r.heif.items.push({id:n,name:c,type:o})}else await e.skip(t-8)}}const o=a.size-Number(e.getPos()-n);o>0?await e.skip(o):o<0&&i.z3(`read iloc error, size: ${a.size}, read: ${a.size-o}`,s,104)}},5938:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/ipco.ts";async function r(e,t,a,r){const n=e.getPos();let o=a.size;for(r.heif.ipcoItem=[];o;){const t=await e.readUint32(),a=await e.readUint32();r.heif.ipcoItem.push({tag:a,data:await e.readBuffer(t-8)}),o-=t}const c=a.size-Number(e.getPos()-n);c>0?await e.skip(c):c<0&&i.z3(`read ipco error, size: ${a.size}, read: ${a.size-c}`,s,55)}},6362:(e,t,a)=>{a.d(t,{c:()=>i});const i={"@PRM":"premiere_version","@PRQ":"quicktime_version",XMP_:"xmp",aART:"albumArtist",akID:"account_type",apID:"account_id",catg:"category",cpil:"compilation",cprt:"copyright",desc:"description",disk:"disc",egid:"episode_uid",FIRM:"firmware",gnre:"genre",hdvd:"hd_video",HMMT:"hmmt",keyw:"keywords",ldes:"synopsis",loci:"loci",manu:"make",modl:"model",pcst:"podcast",pgap:"gapless_playback",purd:"purchase_date",rtng:"rating",soaa:"albumArtistSort",soal:"albumSort",soar:"artistSort",soco:"composerSort",sonm:"nameSort",sosn:"showSort",stik:"media_type",trkn:"track",tven:"episode_id",tves:"episode_sort",tvnn:"network",tvsh:"show",tvsn:"season_number","ART":"albumArtist","PRD":"producer","alb":"album","aut":"artist","chp":"chapter","cmt":"comment","com":"composer","cpy":"copyright","day":"date","dir":"director","dis":"disclaimer","ed1":"edit_date","enc":"encoder","fmt":"original_format","gen":"genre","grp":"grouping","hst":"host_computer","inf":"comment","lyr":"lyrics","mak":"make","mod":"mod","nam":"title","ope":"original_artist","prd":"producer","prf":"performer","req":"playback_requirements","src":"original_source","st3":"subtitle","swr":"encoder","too":"encoder","trk":"track","url":"url","wrn":"warning","wrt":"composer","xyz":"location"}},6384:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/trun.ts";async function r(e,t,a,r){const n=e.getPos(),o=await e.readUint8(),c=await e.readUint24(),d=r.currentFragment.currentTrack,f=r.trexs.find((e=>e.trackId===d.trackId));if(d){const t=await e.readUint32();1&c&&(d.sampleCount?(d.remainDataOffsets.push(await e.readInt32()),d.remainDataOffsetIndex.push(d.sampleCount)):d.dataOffset=await e.readInt32());let a=-1;4&c&&(a=await e.readUint32());for(let i=0;i<t;i++)256&c?d.sampleDurations.push(await e.readUint32()):d.sampleDurations.push(d.defaultSampleDuration||(null==f?void 0:f.duration)),512&c?d.sampleSizes.push(await e.readUint32()):d.sampleSizes.push(d.defaultSampleSize||(null==f?void 0:f.size)),1024&c?d.sampleFlags.push(await e.readUint32()):d.sampleFlags.push(d.defaultSampleFlags||(null==f?void 0:f.flags)),2048&c?0===o?d.sampleCompositionTimeOffset.push(await e.readUint32()):d.sampleCompositionTimeOffset.push(await e.readInt32()):d.sampleCompositionTimeOffset.push(0),a>-1&&0===i&&(d.sampleFlags.pop(),d.sampleFlags.push(a));d.sampleCount+=t}const l=a.size-Number(e.getPos()-n);l>0?await e.skip(l):l<0&&i.z3(`read vpcc error, size: ${a.size}, read: ${a.size-l}`,s,103)}},6385:(e,t,a)=>{a.d(t,{E6:()=>x,jF:()=>$,t9:()=>R,wB:()=>P,wZ:()=>S});var i=a(7127),s=a(9515),r=a(491),n=a(3213),o=a(263),c=a(8535),d=a(4876),f=a(1700),l=a(1638),p=a(6362),m=a(4860),u=a(7962),w=a(665),g=a(9906),h=a(3201),k=a(3674),z=a(6262),v=a(495),U=a(713),A=a(4187),I=a(1755),y=a(1237);const b="packages/avformat/src/formats/isobmff/iisobmff.ts";async function x(e,t,a){const i=e.getPos()+BigInt(Math.floor(a.size));for(t.majorBrand=await e.readUint32(),t.minorVersion=await e.readUint32(),t.majorBrand===(0,s.A)("qt  ")&&(t.isom=!0);e.getPos()<i;)t.compatibleBrand.push(await e.readUint32())}async function B(e,t,a,i){const o=e.getPos()+BigInt(Math.floor(a.size));for(;e.getPos()<o;){const o=await e.readUint32(),c=await e.readUint32();if(o<8)return void g.z3(`invalid box size ${o}`,b,91);if(n.A[c])await n.A[c](e,t,{type:c,size:o-8},i);else if(c===(0,s.A)("mdia")){let a=!1,c=BigInt(0);const d=e.getPos()+BigInt(Math.floor(o-8));for(;e.getPos()<d;){const o=await e.readUint32(),d=await e.readUint32();d===(0,s.A)("hdlr")?(await n.A[d](e,t,{type:d,size:o-8},i),a=!0):d===(0,s.A)("minf")&&a?await B(e,t,{type:d,size:o-8},i):d!==(0,s.A)("minf")||a?n.A[d]?await n.A[d](e,t,{type:d,size:o-8},i):r.gQ.some((e=>(0,s.A)(e)===d))?await B(e,t,{type:d,size:o-8},i):await e.skip(o-8):(c=e.getPos()-BigInt(8),await e.skip(o-8))}if(c){const a=e.getPos();await e.seek(c);const s=await e.readUint32(),r=await e.readUint32();await B(e,t,{type:r,size:s-8},i),await e.seek(a)}}else if(r.gQ.some((e=>(0,s.A)(e)===c)))await B(e,t,{type:c,size:o-8},i);else if(c===(0,s.A)("name")&&a.type===(0,s.A)("udta")&&o-8>0){const a=await e.readString(o-8);t?t.metadata.title=a:(i.metadata||(i.metadata={}),i.metadata.title=a)}else if(a.type===(0,s.A)("udta")&&p.c[(0,l.A)(c)]&&o-8>0){const a=await(0,m.G)(e,o-8,{});a.length&&(t?t.metadata[p.c[(0,l.A)(c)]]=1===a.length?a[0]:a:(i.metadata||(i.metadata={}),i.metadata[p.c[(0,l.A)(c)]]=1===a.length?a[0]:a))}else await e.skip(o-8)}}async function P(e,t,a,o){a.parseOneBox=B,a.parsers=n.A;const d=e.getPos()+BigInt(Math.floor(o.size));for(;e.getPos()<d;){const i=await e.readUint32(),o=await e.readUint32();if(i<8)return void g.z3(`invalid box, type: ${o}, size ${i}`,b,253);if(n.A[o])await n.A[o](e,null,{type:o,size:i-8},a);else if(o===(0,s.A)("trak"))if(!a.foundMoov||a.fragment){const s=t.createStream();if(s.privData=(0,f.A)(),await B(e,s,{type:o,size:i-8},a),a.fragment){const e=s.privData,a=t.streams.find((t=>{const a=t.privData;if(t.index!==s.index&&a.trackId===e.trackId)return!0}));a?(s.sideData[1]&&(a.sideData[1]=s.sideData[1],a.codecpar.extradata&&(0,I.Eb)(a.codecpar.extradata),a.codecpar.extradataSize=a.sideData[1].length,a.codecpar.extradata=(0,I.sY)(a.codecpar.extradataSize),(0,k.lW)(a.codecpar.extradata,a.codecpar.extradataSize,a.sideData[1]),s.codecpar.width!==y.N_&&e.width>0&&(a.codecpar.width=e.width),s.codecpar.width!==y.N_&&e.height>0&&(a.codecpar.height=e.height)),t.removeStream(s),t.streamIndex--):(s.codecpar.width===y.N_&&e.width>0&&(s.codecpar.width=e.width),s.codecpar.width===y.N_&&e.height>0&&(s.codecpar.height=e.height))}else(0,c.X)(s,a)}else await e.skip(i-8);else o===(0,s.A)("mvex")?(a.fragment=!0,await B(e,null,{type:o,size:i-8},a)):r.gQ.some((e=>(0,s.A)(e)===o))?await B(e,null,{type:o,size:i-8},a):await e.skip(i-8)}t.streams.forEach((e=>{if(a.encryptionInitInfos){const t=(0,U.bE)(a.encryptionInitInfos),s=(0,I.sY)(t.length);(0,k.lW)(s,t.length,t),(0,A.$W)(e.codecpar[i.o9]+20,e.codecpar[i.o9]+24,24,s,t.length)}if(a.cencs){const t=e.privData,i=a.cencs[t.trackId];i&&(e.metadata.encryption={schemeType:i.schemeType,schemeVersion:i.schemeVersion,cryptByteBlock:i.cryptByteBlock,skipByteBlock:i.skipByteBlock,perSampleIVSize:i.defaultPerSampleIVSize,kid:i.defaultKeyId,constantIV:i.defaultConstantIV,pattern:i.pattern})}}))}async function S(e,t,a,i){const r=e.getPos()+BigInt(Math.floor(i.size));for(;e.getPos()<r;){const i=await e.readUint32(),r=await e.readUint32();if(i<8)return void g.z3(`invalid box, type: ${r}, size ${i}`,b,400);if(n.A[r])await n.A[r](e,null,{type:r,size:i-8},a);else if(r===(0,s.A)("traf")){const s=(0,d.A)();a.currentFragment.currentTrack=s,await B(e,null,{type:r,size:i-8},a),a.currentFragment.tracks.push(s),a.currentFragment.currentTrack=null;const n=t.streams.find((e=>e.privData.trackId===s.trackId));if(n){const e=n.privData;s.streamIndex=n.index,(0,o.p)(n,s,a,t.ioReader.getPos(),t.ioReader.flags),e.currentSample=0,e.sampleEnd=!1}}else await e.skip(i-8)}}async function R(e,t,a,i){const r=e.getPos()+BigInt(Math.floor(i.size)),n={};for(t.streams.forEach((e=>{const t=e.privData;n[e.index]={samples:t.samplesIndex,currentSample:t.currentSample,sampleEnd:t.sampleEnd},t.samplesIndex=[]}));e.getPos()<r;){const i=e.getPos(),r=await e.readUint32();if(await e.readUint32()===(0,s.A)("tfra")){const i=await e.readUint8();await e.skip(3);const r=await e.readUint32(),n=await e.readUint32(),o=await e.readUint32(),c=t.streams.find((e=>e.privData.trackId===r));if(c){const r=c.privData;let d,f;for(let t=0;t<o;t++){1===i?(d=await e.readUint64(),f=await e.readUint64()):(d=BigInt(Math.floor(await e.readUint32())),f=BigInt(Math.floor(await e.readUint32()))),r.fragIndexes.push({pos:f,time:d});for(let t=0;t<1+(n>>4&3);t++)await e.skip(1);for(let t=0;t<1+(n>>2&3);t++)await e.skip(1);for(let t=0;t<1+(3&n);t++)await e.skip(1)}if(r.fragIndexes.length){await e.seek(r.fragIndexes[r.fragIndexes.length-1].pos);const i=await e.readUint32(),n=await e.readUint32();if(n===(0,s.A)("moof")&&(a.currentFragment={pos:BigInt(0),size:i,sequence:0,tracks:[],currentTrack:null},await S(e,t,a,{size:i,type:n}),r.samplesIndex.length)){const e=r.samplesIndex[r.samplesIndex.length-1];c.duration=e.pts+BigInt(Math.floor(e.duration)),r.samplesIndex.length=0}}}}await e.seek(i+BigInt(Math.floor(r)),!1,!1)}a.currentFragment=null,t.streams.forEach((e=>{var t,a,i,s,r,o;const c=e.privData;c.samplesIndex=null!==(t=null===(a=n[e.index])||void 0===a?void 0:a.samples)&&void 0!==t?t:[],c.currentSample=null!==(i=null===(s=n[e.index])||void 0===s?void 0:s.currentSample)&&void 0!==i?i:0,c.sampleEnd=null!==(r=null===(o=n[e.index])||void 0===o?void 0:o.sampleEnd)&&void 0!==r&&r}))}async function M(e,t,a,i,s){let r=BigInt(0);if(a.item.isIdatRelative){if(!s.heif.idatOffset)return g.R8("missing idat box required by the image grid",b,564),v.nr;r=s.heif.idatOffset}if(!(1&e.flags))return g.z3("grid box with non seekable input",b,570),v.nr;const n=e.getPos();await e.seek(BigInt(a.item.extentOffset)+r),await e.readUint8();const o=await e.readUint8(),c=await e.readUint8()+1,d=await e.readUint8()+1;i.width=1&o?await e.readUint32():await e.readUint16(),i.height=1&o?await e.readUint32():await e.readUint16(),await e.seek(n);let f=c*d;if(f!==a.tileIdList.length)return v.nr;i.codedWidth=0,i.codedHeight=0;for(let e=0;e<d;e++){let s=t.streams.find((t=>t.privData.trackId===a.tileIdList[e]));if(!s)return v.nr;i.codedWidth+=s.codecpar.width}for(let e=0;e<f;e+=d){let s=t.streams.find((t=>t.privData.trackId===a.tileIdList[e]));if(!s)return v.nr;i.codedHeight+=s.codecpar.height}i.offsets=new Array(f);let l=0,p=0,m=0;for(;p<i.codedHeight;){let e=m;for(;l<i.codedWidth;){if(m===f)return v.nr;let e=t.streams.find((e=>e.privData.trackId===a.tileIdList[m]));if(!e)return v.nr;i.offsets[m]={idx:e.id,horizontal:l,vertical:p},l+=e.codecpar.width,m++}if(l>i.codedWidth)return g.z3("Non uniform HEIF tiles",b,639),v.nr;l=0;let s=t.streams.find((t=>t.privData.trackId===a.tileIdList[e]));if(!s)return v.nr;p+=s.codecpar.height}return p>i.codedHeight||m!==f?(g.z3("Non uniform HEIF tiles",b,654),v.nr):0}async function D(e,t,a,i,s){let r=BigInt(0);if(a.item.isIdatRelative){if(!s.heif.idatOffset)return g.R8("missing idat box required by the image grid",b,669),v.nr;r=s.heif.idatOffset}if(!(1&e.flags))return g.z3("grid box with non seekable input",b,675),v.nr;const n=e.getPos();await e.seek(BigInt(a.item.extentOffset)+r),await e.readUint8();const o=await e.readUint8();i.background=[];for(let t=0;t<4;t++)i.background.push(await e.readUint16());i.width=i.codedWidth=1&o?await e.readUint32():await e.readUint16(),i.height=i.codedHeight=1&o?await e.readUint32():await e.readUint16(),i.offsets=new Array(a.tileIdList.length);for(let s=0;s<a.tileIdList.length;s++){let r=t.streams.find((e=>e.privData.trackId===a.tileIdList[a.tileIdList[s]]));if(!r)return v.nr;i.offsets[s]={idx:r.id,horizontal:1&o?await e.readUint32():await e.readUint16(),vertical:1&o?await e.readUint32():await e.readUint16()}}await e.seek(n)}async function $(e,t,a,i){var o;a.parseOneBox=B,a.parsers=n.A;const c=e.getPos()+BigInt(Math.floor(i.size));for(a.heif={},i.size>12&&"hdlr"===(await e.peekString(12)).substring(8)&&await e.skip(4);e.getPos()<c;){const t=await e.readUint32(),i=await e.readUint32();if(t<8)return void g.z3(`invalid box, type: ${i}, size ${t}`,b,736);i===(0,s.A)("hdlr")?await e.skip(t-8):i===(0,s.A)("idat")?(a.heif.idatOffset=e.getPos(),await e.skip(t-8)):n.A[i]?await n.A[i](e,null,{type:i,size:t-8},a):r.gQ.some((e=>(0,s.A)(e)===i))?await B(e,null,{type:i,size:t-8},a):await e.skip(t-8)}const d=e.getPos();if(a.heif.foundIloc&&a.heif.foundIinf&&null!==(o=a.heif.items)&&void 0!==o&&o.length){a.foundHEIF=!0;const i=new h.A;for(let e=0;e<a.heif.items.length;e++){const r=a.heif.items[e];if("av01"!==r.type&&"hvc1"!==r.type)continue;const o=t.createStream(),c=(0,f.A)();if(o.privData=c,c.trackId=r.id,o.codecpar.codecType=0,u.uf[(0,s.A)(r.type)]&&(o.codecpar.codecId=u.uf[(0,s.A)(r.type)]),o.nbFrames=BigInt(1),o.codecpar.framerate.den=1,o.codecpar.framerate.num=1,o.timeBase.den=1,o.timeBase.num=1,a.heif.primaryId===r.id&&(o.disposition|=1),r.name&&(o.metadata.title=r.name),r.ipma&&a.heif.ipcoItem)for(let e=0;e<r.ipma.length;e++){const t=a.heif.ipcoItem[r.ipma[e]];t&&n.A[t.tag]&&(i.reset(),i.appendBuffer(t.data),a.heif.currentItem=r,await n.A[t.tag](i,o,{type:t.tag,size:t.data.length},a),a.heif.currentItem=null)}let d=BigInt(0);r.isIdatRelative&&(a.heif.idatOffset||(g.R8(`Missing idat box for item ${r.id}`,b,825),t.removeStream(o),t.streamIndex--),d=a.heif.idatOffset),c.samplesIndex=[{pos:BigInt(r.extentOffset)+d,dts:BigInt(0),pts:BigInt(0),size:r.extentLength,flags:1,duration:y.N_}]}if(a.heif.grid)for(let s=0;s<a.heif.grid.length;s++){const r=a.heif.grid[s];if(r.item){var l;const s=t.createStreamGroup(3);if(s.privData=r,s.params=new z.de,null!==(l=r.tileIdList)&&void 0!==l&&l.length&&r.tileIdList.forEach((e=>{const a=t.streams.find((t=>t.privData.trackId===e));a&&t.addStreamToStreamGroup(s,a)})),r.item.id===a.heif.primaryId&&(s.disposition|=1),r.item.name&&(s.metadata.title=r.item.name),r.item.ipma&&a.heif.ipcoItem)for(let e=0;e<r.item.ipma.length;e++){const t=a.heif.ipcoItem[r.item.ipma[e]];t&&n.A[t.tag]&&(i.reset(),i.appendBuffer(t.data),a.heif.currentItem=r.item,await n.A[t.tag](i,s.params,{type:t.tag,size:t.data.length},a),a.heif.currentItem=null)}if("grid"===r.item.type){if(await M(e,t,r,s.params,a)<0){t.removeStreamGroup(s),t.streamGroupIndex--;continue}}else if("iovl"===r.item.type&&await D(e,t,r,s.params,a)<0){t.removeStreamGroup(s),t.streamGroupIndex--;continue}if(r.item.rotation||r.item.hflip||r.item.vflip){const e=new Float32Array(9),t=r.item.rotation*Math.PI/180,a=Math.cos(t),i=Math.sin(t);e[0]=a,e[1]=-i,e[3]=i,e[4]=a,e[8]=1073741824;const n=[1-2*(r.item.hflip?1:0),1-2*(r.item.vflip?1:0),1];if(r.item.hflip||r.item.vflip)for(let t=0;t<9;t++)e[t]*=n[t%3];s.params.sideData[5]=new Uint8Array(e.buffer)}}}for(let i=0;i<a.heif.items.length;i++){const s=a.heif.items[i];if(s.refs){const i=w.HP(s.refs);for(let r=0;r<i.length;r++){const n=i[r],o=s.refs[n];if("thmb"===n){const e=t.streams.find((e=>e.privData.trackId===o));e&&(e.disposition|=8192)}else{let i=a.heif.items.find((e=>e.id===o));if(i&&"Exif"===i.type&&1&e.flags){let s=BigInt(0);if(i.isIdatRelative){if(!a.heif.idatOffset){g.R8(`Missing idat box for item ${i.id}`,b,942);continue}s=a.heif.idatOffset}const r=e.getPos();await e.seek(BigInt(i.extentOffset)+s);const n=await e.readBuffer(i.extentLength);await e.seek(r);let o=t.streams.find((e=>e.privData.trackId===i.id));if(o)o.sideData[40]=n;else{const e=t.streamGroups.find((e=>{const t=e.privData;if(t.item.refs)return w.zy(w.BE(t.item.refs),i.id)}));e&&(e.params.sideData[40]=n)}}}}}}}await e.seek(d)}},6760:(e,t,a)=>{a.d(t,{Ui:()=>w,XC:()=>u,Yj:()=>g,k9:()=>m,wN:()=>l});var i=a(9983),s=a(7145),r=a(6890),n=a(1237),o=a(3139),c=a(3262),d=a(84),f=a(187);const l={0:"Profile0",1:"Profile1",2:"Profile2",3:"Profile3"},p=[{level:10,maxResolution:196608,maxFrameRate:30},{level:11,maxResolution:196608,maxFrameRate:60},{level:20,maxResolution:518400,maxFrameRate:30},{level:21,maxResolution:518400,maxFrameRate:60},{level:30,maxResolution:2073600,maxFrameRate:30},{level:31,maxResolution:2073600,maxFrameRate:60},{level:40,maxResolution:3686400,maxFrameRate:30},{level:41,maxResolution:3686400,maxFrameRate:60},{level:50,maxResolution:8294400,maxFrameRate:30},{level:51,maxResolution:8294400,maxFrameRate:60},{level:60,maxResolution:8847360,maxFrameRate:30},{level:61,maxResolution:8847360,maxFrameRate:60},{level:70,maxResolution:35389440,maxFrameRate:30},{level:71,maxResolution:35389440,maxFrameRate:60}];function m(e,t,a){const i=e*t;for(const e of p)if(i<=e.maxResolution&&a<=e.maxFrameRate)return e.level}function u(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){const a=w(t);e.codecpar.profile=a.profile,e.codecpar.level=a.level}}function w(e){const t=new d.A(e.length);return t.appendBuffer(e),{profile:t.readU(8),level:t.readU(8),bitDepth:t.readU(4),chromaSubsampling:t.readU(3),fullRangeFlag:t.readU1(),colorPrimaries:t.readU(8),colorTrc:t.readU(8),colorSpace:t.readU(8)}}function g(e){const t=new f.A(new Uint8Array(8)),a=function(e){let t=i.f[15](e+48),a=i.f[15](e+52);a===n.N_&&(a=m(i.f[15](e+56),i.f[15](e+60),(0,c.lb)((0,r.A)(e+72,s.Q))));const d=(0,o.I)(i.f[15](e+28));let f=i.f[15](e+40),l=1;d&&(f=d.comp[0].depth,1===d.log2ChromaW&&1===d.log2ChromaH?1===i.f[15](e+100)&&(l=0):1===d.log2ChromaW&&0===d.log2ChromaH?l=2:0===d.log2ChromaW&&0===d.log2ChromaH&&(l=3));const p=2===i.f[15](e+84)?1:0;return t===n.N_&&f&&(t=0==l||1==l?8==f?0:2:8==f?1:3),{profile:t,level:a,bitDepth:f,chromaSubsampling:l,fullRange:p}}(e);return t.writeUint8(a.profile),t.writeUint8(a.level),t.writeUint8(a.bitDepth<<4|a.chromaSubsampling<<1|a.fullRange),t.writeUint8(i.f[15](e+88)),t.writeUint8(i.f[15](e+92)),t.writeUint8(i.f[15](e+96)),t.writeUint16(0),t.getWroteBuffer()}},6876:(e,t,a)=>{a.d(t,{A:()=>c});var i=a(9906),s=a(3674),r=a(1497),n=a(1755);const o="packages/avformat/src/formats/isobmff/parsing/avcc.ts";async function c(e,t,a,c){const d=e.getPos();if(t.codecpar.codecId=27,a.size<=0)return;const f=(0,n.sY)(a.size),l=await e.readBuffer(a.size,(0,s.JW)(f,a.size));c.foundMoov?(t.sideData[1]=l.slice(),(0,n.Eb)(f)):(t.codecpar.extradata&&(0,n.Eb)(t.codecpar.extradata),t.codecpar.extradata=f,t.codecpar.extradataSize=a.size,r.XC(t,l));const p=a.size-Number(e.getPos()-d);p>0?await e.skip(p):p<0&&i.z3(`read avcc error, size: ${a.size}, read: ${a.size-p}`,o,64)}},6910:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(9906),s=a(6262);const r="packages/avformat/src/formats/isobmff/parsing/ispe.ts";async function n(e,t,a,n){const o=e.getPos();await e.skip(4);const c=await e.readUint32(),d=await e.readUint32();t instanceof s.Ay?(t.codecpar.width=c,t.codecpar.height=d):(t.width=c,t.height=d);const f=a.size-Number(e.getPos()-o);f>0?await e.skip(f):f<0&&i.z3(`read ispe error, size: ${a.size}, read: ${a.size-f}`,r,54)}},7314:(e,t,a)=>{a.d(t,{Bq:()=>p,En:()=>c,Hm:()=>n,Ij:()=>l,XC:()=>f,_5:()=>d,f7:()=>m,hY:()=>o,uF:()=>r});var i=a(1237),s=a(84);const r={1:"Main",2:"LC",3:"SSR",4:"LTP",5:"HE",6:"SCALABLE",29:"HEv2",23:"LD",39:"ELD"},n={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},o=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,i.N_,i.N_,i.N_],c=[i.N_,1,2,3,4,5,6,7];function d(e){let t=i.N_,a=i.N_,s=i.N_;return e.length>=2&&(t=e[0]>>3&31,a=o[(7&e[0])<<1|e[1]>>7],s=c[e[1]>>3&15]),{profile:t,sampleRate:a,channels:s}}function f(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t){const{profile:a,sampleRate:i,channels:s}=d(t);e.codecpar.profile=a,e.codecpar.sampleRate=i,e.codecpar.chLayout.nbChannels=s,e.codecpar.frameSize=5===a?2048:1024,e.codecpar.format=8}}function l(e){const t=n[e.sampleRate],a=e.chLayout.nbChannels,s=e.profile===i.N_?2:e.profile,r=new Uint8Array(2);return r[0]=(31&s)<<3|(14&t)>>1,r[1]=(1&t)<<7|(15&a)<<3,r}function p(e){if(e.length<7)return-1;const t=e[0]<<4|e[1]>>4;if(4095!==t)return-1;const a=1&e[1],i=(192&e[2])>>>6,s=(60&e[2])>>>2,r=(1&e[2])<<2|(192&e[3])>>>6,n=(3&e[3])<<11|e[4]<<3|(224&e[5])>>>5,d=3&e[6];let f=1===a?7:9,l=n-f;return{syncWord:t,profile:i+1,sampleRate:o[s],channels:c[r],aacFrameLength:n,numberOfRawDataBlocksInFrame:d,headerLength:f,framePayloadLength:l}}function m(e,t){function a(){const e=t.readU(2);let a=0;for(let i=0;i<=e;i++)a<<=8,a|=t.readU(8);return a}t||(t=new s.A).appendBuffer(e);const i=t.getPointer(),r={syncWord:0,profile:0,sampleRate:0,channels:0,useSameStreamMux:!1,headerLength:0,framePayloadLength:0,muxLengthBytes:0},n=t.readU(11);if(695!==n)return-1;r.syncWord=n,r.muxLengthBytes=t.readU(13);const d=1===t.readU1();if(r.useSameStreamMux=d,!d){const e=1===t.readU1();if(e&&1===t.readU1())return-1;if(e&&a(),1!==t.readU1())return-1;if(0!==t.readU(6))return-1;if(0!==t.readU(4))return-1;if(0!==t.readU(3))return-1;let i=e?a():0;const s=t.readU(5);i-=5;const n=t.readU(4);i-=4;const d=t.readU(4);if(i-=4,t.readU(3),i-=3,i>0&&t.readU(i),0!==t.readU(3))return-1;if(t.readU(8),1===t.readU1())if(e)a();else{let e=0;for(;;){e<<=8;const a=1===t.readU1();if(e+=t.readU(8),!a)break}}1===t.readU1()&&t.readU(8),r.profile=s+1,r.sampleRate=o[n],r.channels=c[d]}let f=0;for(;;){const e=t.readU(8);if(f+=e,255!==e)break}return r.framePayloadLength=f,r.headerLength=t.getPointer()-i+(8===t.getBitLeft()?0:1),r}},7512:(e,t,a)=>{a.d(t,{A:()=>l});var i=a(7127),s=a(9983),r=a(2320),n=a(9906),o=a(8940),c=a(449),d=a(4187);const f="packages/avformat/src/formats/isobmff/parsing/dec3.ts";async function l(e,t,a,l){const p=e.getPos();if(t.codecpar.codecId=86056,a.size<=0)return;const m=(0,d.E4)(t.codecpar[i.o9]+20,t.codecpar[i.o9]+24,7,4),u=s.f[20](m);await e.skip(2);const w=await e.readUint24(),g=w>>12&31,h=w>>9&7,k=w>>8&1;let z=BigInt(o.j[h]);k&&(z|=BigInt(8)),c.bl(t.codecpar[i.o9]+112),c.ML(t.codecpar[i.o9]+112,z),r.M[15](u,g),t.codecpar.chLayout.nbChannels>1&&7==g&&r.M[15](u,8);const v=a.size-Number(e.getPos()-p);v>0?await e.skip(v):v<0&&n.z3(`read avcc error, size: ${a.size}, read: ${a.size-v}`,f,83)}},7801:(e,t,a)=>{a.d(t,{A:()=>f});var i=a(9906),s=a(5815),r=a(187),n=a(3674),o=a(3690),c=a(1755);const d="packages/avformat/src/formats/isobmff/parsing/dops.ts";async function f(e,t,a,f){const l=e.getPos();t.codecpar.codecId=86076,await e.skip(1);const p=(0,c.sY)(a.size+8),m=(0,n.JW)(p,a.size+8),u=new s.A(m),w=new r.A(m,!1);w.writeString("OpusHead"),w.writeUint8(1),await e.readBuffer(a.size-1,(0,n.JW)(p+9,a.size-1)),u.seek(10),w.seek(10),w.writeUint16(u.readUint16()),w.writeUint32(u.readUint32()),w.writeUint16(u.readUint16()),f.foundMoov?(t.sideData[1]=m.slice(),(0,c.Eb)(p)):(t.codecpar.extradata&&(0,c.Eb)(t.codecpar.extradata),t.codecpar.extradata=p,t.codecpar.extradataSize=m.length,o.XC(t,m));const g=a.size-Number(e.getPos()-l);g>0?await e.skip(g):g<0&&i.z3(`read dops error, size: ${a.size}, read: ${a.size-g}`,d,78)}},7860:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/stsc.ts";async function r(e,t,a,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=t.privData,d=[],f=[],l=[],p=await e.readUint32();if(0===o)for(let t=0;t<p;t++)d.push(await e.readUint32()),f.push(await e.readUint32()),l.push(await e.readUint32());c.stscFirstChunk=d,c.stscSamplesPerChunk=f,c.stscSampleDescriptionIndex=l;const m=a.size-Number(e.getPos()-n);m>0?await e.skip(m):m<0&&i.z3(`read stsc error, size: ${a.size}, read: ${a.size-m}`,s,63)}},7939:(e,t,a)=>{a.d(t,{A:()=>c});var i=a(9906),s=a(3674),r=a(4096),n=a(1755);const o="packages/avformat/src/formats/isobmff/parsing/vvcc.ts";async function c(e,t,a,c){const d=e.getPos();if(await e.readUint8(),await e.skip(3),t.codecpar.codecId=196,a.size-4<=0)return;const f=(0,n.sY)(a.size-4),l=await e.readBuffer(a.size-4,(0,s.JW)(f,a.size-4));c.foundMoov?(t.sideData[1]=l.slice(),(0,n.Eb)(f)):(t.codecpar.extradata&&(0,n.Eb)(t.codecpar.extradata),t.codecpar.extradata=f,t.codecpar.extradataSize=a.size-4,r.XC(t,l));const p=a.size-Number(e.getPos()-d);p>0?await e.skip(p):p<0&&i.z3(`read vvcc error, size: ${a.size}, read: ${a.size-p}`,o,68)}},7962:(e,t,a)=>{a.d(t,{Q9:()=>r,f3:()=>n,uf:()=>o,zs:()=>s});var i=a(9515);const s={86018:64,86017:105,86076:173,86028:193,86021:221,12:32,27:33,173:35,196:51,167:177,0:0},r={32:12,33:27,35:173,51:196,177:167,64:86018,102:86018,103:86018,104:86018,105:86017,107:86017,173:86076,193:86028,221:86021,0:0},n={vide:0,pict:0,soun:1,clcp:3,sbtl:3,subt:3,subp:3,text:3},o={[(0,i.A)("mp4a")]:86018,1836253269:86017,[(0,i.A)("Opus")]:86076,[(0,i.A)("fLaC")]:86028,[(0,i.A)("spex")]:86051,[(0,i.A)("SPXN")]:86051,[(0,i.A)("ac-3")]:86019,[(0,i.A)("sac3")]:86019,[i.A.mp4v]:12,[(0,i.A)("av01")]:225,[(0,i.A)("vp08")]:139,[(0,i.A)("vp09")]:167,[(0,i.A)("avc1")]:27,[(0,i.A)("avc3")]:27,[(0,i.A)("hev1")]:173,[(0,i.A)("hvc1")]:173,[(0,i.A)("vvc1")]:196,[(0,i.A)("vvi1")]:196,[(0,i.A)("text")]:94213,[(0,i.A)("tx3g")]:94213,[(0,i.A)("png ")]:61,[(0,i.A)("MNG ")]:61,[(0,i.A)("gif ")]:97,[(0,i.A)("tiff")]:96,[(0,i.A)("H263")]:4,[(0,i.A)("3IVD")]:16}},8308:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/function/mktagle.ts";function r(e){4!==e.length&&i.R8(`tag length is not 4, tag: ${e}`,s,30);let t=0;for(let a=3;a>=0;a--)t=t<<8|e.charCodeAt(a);return t}},8535:(e,t,a)=>{a.d(t,{X:()=>o});var i=a(9906),s=a(3262),r=a(1237);const n="packages/avformat/src/formats/isobmff/function/buildIndex.ts";function o(e,t){var a;const o=e.privData,c=o.chunkOffsets,d=o.sampleSizes,f=o.cttsSampleCounts,l=o.cttsSampleOffsets,p=o.stscFirstChunk,m=o.stscSamplesPerChunk,u=o.stssSampleNumbersMap,w=o.sttsSampleCounts,g=o.sttsSampleDeltas;if(!c.length)return;let h=0,k=0,z=0,v=0,U=0,A=0,I=BigInt(0),y=0,b=BigInt(0);const x=[];if(!t.ignoreEditlist&&null!==(a=e.metadata.elst)&&void 0!==a&&a.length){let a=BigInt(0),o=0,c=!1,d=BigInt(0),f=BigInt(0);for(let t=0;t<e.metadata.elst.length;t++){const a=e.metadata.elst[t];0===t&&a.mediaTime===-BigInt(1)?(d=a.segmentDuration,o=1):t===o&&a.mediaTime>=BigInt(0)?f=a.mediaTime:c=!0}c&&i.R8("multiple edit list entries, a/v desync might occur, patch welcome",n,96),(d||f)&&t.timescale>0&&(d&&(d=(0,s.k)(d,{num:1,den:t.timescale},e.timeBase),e.duration!==r.Dh&&(e.duration+=d)),a=f-d,b=-a)}for(let t=0;t<c.length;t++)if(I=c[t],h<p.length-1&&p[h+1]===t+1&&h++,A=m[h],o.isPcm){const e={dts:b,pts:b,pos:I,size:d[0]*A,duration:g[0]*A,flags:1};b+=BigInt(Math.floor(e.duration)),x.push(e)}else for(;A>0;){const t={dts:b,pts:b,pos:I,size:d[y],duration:g[k],flags:0};(u&&u.has(y+1)||1===e.codecpar.codecType)&&(t.flags|=1),l&&(t.pts=t.dts+BigInt(Math.floor(l[v])),U++,U===f[v]&&(v++,U=0)),I+=BigInt(Math.floor(t.size)),b+=BigInt(Math.floor(g[k])),z++,z===w[k]&&(k++,z=0),y++,x.push(t),A--}x.length&&e.duration===r.Dh&&(e.duration=x[y-1].pts+BigInt(Math.floor(x[y-1].duration))),o.samplesIndex=x,e.nbFrames=BigInt(x.length)}},8837:(e,t,a)=>{a.d(t,{A:()=>c});var i=a(9906),s=a(3674),r=a(6760),n=a(1755);const o="packages/avformat/src/formats/isobmff/parsing/vpcc.ts";async function c(e,t,a,c){const d=e.getPos();if(await e.readUint8(),await e.skip(3),t.codecpar.codecId=167,a.size-4<=0)return;const f=(0,n.sY)(a.size-4),l=await e.readBuffer(a.size-4,(0,s.JW)(f,a.size-4));c.foundMoov?(t.sideData[1]=l.slice(),(0,n.Eb)(f)):(t.codecpar.extradata&&(0,n.Eb)(t.codecpar.extradata),t.codecpar.extradata=f,t.codecpar.extradataSize=a.size-4,r.XC(t,l));const p=a.size-Number(e.getPos()-d);p>0?await e.skip(p):p<0&&i.z3(`read vpcc error, size: ${a.size}, read: ${a.size-p}`,o,68)}},8940:(e,t,a)=>{a.d(t,{R:()=>m,j:()=>s});var i=a(84);const s=[3,4,3,7,259,263,1539,1543],r=[[64,69,96],[64,70,96],[80,87,120],[80,88,120],[96,104,144],[96,105,144],[112,121,168],[112,122,168],[128,139,192],[128,140,192],[160,174,240],[160,175,240],[192,208,288],[192,209,288],[224,243,336],[224,244,336],[256,278,384],[256,279,384],[320,348,480],[320,349,480],[384,417,576],[384,418,576],[448,487,672],[448,488,672],[512,557,768],[512,558,768],[640,696,960],[640,697,960],[768,835,1152],[768,836,1152],[896,975,1344],[896,976,1344],[1024,1114,1536],[1024,1115,1536],[1152,1253,1728],[1152,1254,1728],[1280,1393,1920],[1280,1394,1920]],n=[4,5,6,5],o=[4,6,7,6],c=[48e3,44100,32e3,0],d=[32,40,48,56,64,80,96,112,128,160,192,224,256,320,384,448,512,576,640],f=[2,1,2,3,3,4,4,5],l=[1,2,3,6],p=7;function m(e){const t=new i.A(e.length);t.appendBuffer(e);const a={syncWord:0,crc1:0,srCode:0,bitstreamId:0,bitstreamMode:0,channelMode:0,lfeOn:0,frameType:0,substreamId:0,centerMixLevel:0,surroundMixLevel:0,channelMap:0,numBlocks:0,dolbySurroundMode:0,srShift:0,sampleRate:0,bitrate:0,channels:0,frameSize:0,channelLayout:BigInt(0),ac3BitrateCode:0};if(a.syncWord=t.readU(16),2935!==a.syncWord)return-1;if(a.bitstreamId=31&t.peekU(29),a.bitstreamId>16)return-2;if(a.numBlocks=6,a.ac3BitrateCode=-1,a.centerMixLevel=5,a.surroundMixLevel=6,a.dolbySurroundMode=0,a.bitstreamId<=10){if(a.crc1=t.readU(16),a.srCode=t.readU(2),3===a.srCode)return-3;const e=t.readU(6);if(e>37)return-4;a.ac3BitrateCode=e>>1,t.readU(5),a.bitstreamMode=t.readU(3),a.channelMode=t.readU(3),2==a.channelMode?a.dolbySurroundMode=t.readU(2):(1&a.channelMode&&1!=a.channelMode&&(a.centerMixLevel=n[t.readU(2)]),4&a.channelMode&&(a.surroundMixLevel=o[t.readU(2)])),a.lfeOn=t.readU(1),a.srShift=Math.max(a.bitstreamId,8)-8,a.sampleRate=c[a.srCode]>>a.srShift,a.bitrate=1e3*d[a.ac3BitrateCode]>>a.srShift,a.channels=f[a.channelMode]+a.lfeOn,a.frameSize=2*r[e][a.srCode],a.frameType=2,a.substreamId=0}else{if(a.crc1=0,a.frameType=t.readU(2),3==a.frameType)return-5;if(a.substreamId=t.readU(3),a.frameSize=t.readU(11)+1<<1,a.frameSize<p)return-6;if(a.srCode=t.readU(2),3==a.srCode){const e=t.readU(2);if(3==e)return-7;a.sampleRate=c[e]/2,a.srShift=1}else a.numBlocks=l[t.readU(2)],a.sampleRate=c[a.srCode],a.srShift=0;a.channelMode=t.readU(3),a.lfeOn=t.readU(1),a.bitrate=8*a.frameSize*a.sampleRate/(256*a.numBlocks),a.channels=f[a.channelMode]+a.lfeOn}return a.channelLayout=BigInt(s[a.channelMode]),a.lfeOn&&(a.channelLayout|=BigInt(8)),a}},9109:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/tenc.ts";async function r(e,t,a,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=t.privData;let d=r.cencs?r.cencs[c.trackId]:null;d||(d={schemeType:0,schemeVersion:0,isProtected:0,defaultPerSampleIVSize:0,defaultKeyId:null,defaultConstantIV:null,cryptByteBlock:0,skipByteBlock:0,pattern:!1}),await e.skip(1);const f=await e.readUint8();if(o>0&&(d.pattern=!0,d.cryptByteBlock=f>>>4&15,d.skipByteBlock=15&f),d.isProtected=await e.readUint8(),d.defaultPerSampleIVSize=await e.readUint8(),d.defaultKeyId=await e.readBuffer(16),d.isProtected&&!d.defaultPerSampleIVSize){const t=await e.readUint8();d.defaultConstantIV=await e.readBuffer(t)}r.cencs?r.cencs[c.trackId]=d:r.cencs={[c.trackId]:d};const l=a.size-Number(e.getPos()-n);l>0?await e.skip(l):l<0&&i.z3(`read schm error, size: ${a.size}, read: ${a.size-l}`,s,90)}},9307:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(5485),s=a(9906);const r="packages/avformat/src/formats/isobmff/parsing/frma.ts";async function n(e,t,a,n){const o=e.getPos(),c=await e.peekUint32();e.setEndian(!1);const d=await e.readUint32();e.setEndian(!0);let f=i._B[d];f>0&&0!==t.codecpar.codecType?t.codecpar.codecType=1:1!==t.codecpar.codecType&&(f=i.pj[d],f>0?t.codecpar.codecType=0:(f=i._r[d],t.codecpar.codecType=3)),t.codecpar.codecTag=c,t.codecpar.codecId=f;const l=a.size-Number(e.getPos()-o);l>0?await e.skip(l):l<0&&s.z3(`read frma error, size: ${a.size}, read: ${a.size-l}`,r,65)}},9444:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/schm.ts";async function r(e,t,a,r){const n=e.getPos();await e.skip(4);const o=t.privData;let c=r.cencs?r.cencs[o.trackId]:null;c||(c={schemeType:0,schemeVersion:0,isProtected:0,defaultPerSampleIVSize:0,defaultKeyId:null,defaultConstantIV:null,cryptByteBlock:0,skipByteBlock:0,pattern:!1}),c.schemeType=await e.readUint32(),c.schemeVersion=await e.readUint32(),r.cencs?r.cencs[o.trackId]=c:r.cencs={[o.trackId]:c};const d=a.size-Number(e.getPos()-n);d>0?await e.skip(d):d<0&&i.z3(`read schm error, size: ${a.size}, read: ${a.size-d}`,s,72)}},9515:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/function/mktag.ts";function r(e){4!==e.length&&i.R8(`tag length is not 4, tag: ${e}`,s,31);let t=0;for(let a=0;a<4;a++)t=t<<8|e.charCodeAt(a);return t}},9558:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/trex.ts";async function r(e,t,a,r){const n=e.getPos();await e.readUint8(),await e.skip(3);const o=await e.readUint32();await e.skip(4);const c=await e.readUint32(),d=await e.readUint32(),f=await e.readUint32();r.trexs.push({trackId:o,duration:c,size:d,flags:f});const l=a.size-Number(e.getPos()-n);l>0?await e.skip(l):l<0&&i.z3(`read trex error, size: ${a.size}, read: ${a.size-l}`,s,59)}},9657:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/co64.ts";async function r(e,t,a,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=[],d=await e.readUint32();if(0===o)for(let t=0;t<d;t++)c.push(await e.readUint64());t.privData.chunkOffsets=c;const f=a.size-Number(e.getPos()-n);f>0?await e.skip(f):f<0&&i.z3(`read co64 error, size: ${a.size}, read: ${a.size-f}`,s,55)}},9676:(e,t,a)=>{a.d(t,{A:()=>c});var i=a(9906),s=a(3674),r=a(3043),n=a(1755);const o="packages/avformat/src/formats/isobmff/parsing/dfla.ts";async function c(e,t,a,c){const d=e.getPos();t.codecpar.codecId=86028,await e.skip(1),await e.skip(3);const f=await e.readUint8(),l=128&f,p=127&f,m=await e.readUint24();if(0===p&&34===m){const a=(0,n.sY)(m),i=await e.readBuffer(m,(0,s.JW)(a,m));c.foundMoov?(t.sideData[1]=i.slice(),(0,n.Eb)(a)):(t.codecpar.extradata&&(0,n.Eb)(t.codecpar.extradata),t.codecpar.extradata=a,t.codecpar.extradataSize=m,r.XC(t,i))}else i.z3("streaminfo must be first FLACMetadataBlock",o,67);l||i.R8("non streaminfo FLACMetadataBlock(s) ignored",o,71);const u=a.size-Number(e.getPos()-d);u>0?await e.skip(u):u<0&&i.z3(`read vpcc error, size: ${a.size}, read: ${a.size-u}`,o,79)}},9846:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/mvhd.ts";async function r(e,t,a,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3),1===o?(r.creationTime=await e.readUint64(),r.modificationTime=await e.readUint64(),r.timescale=await e.readUint32(),r.duration=await e.readUint64()):(r.creationTime=BigInt(Math.floor(await e.readUint32())),r.modificationTime=BigInt(Math.floor(await e.readUint32())),r.timescale=await e.readUint32(),r.duration=BigInt(Math.floor(await e.readUint32()))),r.rate=await e.readUint32(),r.volume=await e.readUint16()>>>8,await e.skip(10),r.matrix=new Uint32Array(9);for(let t=0;t<9;t++)r.matrix[t]=await e.readUint32();await e.skip(24),r.nextTrackId=await e.readUint32();const c=a.size-Number(e.getPos()-n);c>0?await e.skip(c):c<0&&i.z3(`read mvhd error, size: ${a.size}, read: ${a.size-c}`,s,68)}},9939:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9906);const s="packages/avformat/src/formats/isobmff/parsing/stco.ts";async function r(e,t,a,r){const n=e.getPos(),o=await e.readUint8();await e.skip(3);const c=[],d=await e.readUint32();if(0===o)for(let t=0;t<d;t++)c.push(BigInt(Math.floor(await e.readUint32())));t.privData.chunkOffsets=c;const f=a.size-Number(e.getPos()-n);f>0?await e.skip(f):f<0&&i.z3(`read stco error, size: ${a.size}, read: ${a.size-f}`,s,54)}}}]);