"use strict";(self.webpackChunkAVTranscoder=self.webpackChunkAVTranscoder||[]).push([[694],{6911:(e,i,t)=>{t.d(i,{A:()=>s});var r=t(4467);class s{constructor(){(0,r.A)(this,"type",-1)}async destroy(e){}}(0,r.A)(s,"Capabilities",[])},8694:(e,i,t)=>{t.r(i),t.d(i,{IVFHeader:()=>u,default:()=>m});var r=t(4467),s=t(9983),o=t(6911),d=t(495),a=t(4187),h=t(3262),n=t(9906);const c="packages/avformat/src/formats/OIvfFormat.ts";class u{constructor(){(0,r.A)(this,"version",void 0),(0,r.A)(this,"length",void 0),(0,r.A)(this,"codec",void 0),(0,r.A)(this,"width",void 0),(0,r.A)(this,"height",void 0),(0,r.A)(this,"denominator",void 0),(0,r.A)(this,"numerator",void 0),(0,r.A)(this,"framesCount",void 0),this.version=0,this.length=32,this.codec="VP80",this.width=0,this.height=0,this.framesCount=0,this.denominator=1,this.numerator=0}}class m extends o.A{constructor(){super(),(0,r.A)(this,"type",5),(0,r.A)(this,"header",void 0),(0,r.A)(this,"muxStreamIndex",void 0),this.header=new u}init(e){return e.ioWriter.setEndian(!1),0}writeHeader(e){const i=e.streams.find((e=>!(139!==e.codecpar.codecId&&167!==e.codecpar.codecId&&225!==e.codecpar.codecId||1024&e.disposition)));return i?(this.muxStreamIndex=i.index,167===i.codecpar.codecId?this.header.codec="VP90":225===i.codecpar.codecId&&(this.header.codec="AV01"),this.header.width=i.codecpar.width,this.header.height=i.codecpar.height,this.header.numerator=i.timeBase.num,this.header.denominator=i.timeBase.den,e.ioWriter.writeString("DKIF"),e.ioWriter.writeUint16(this.header.version),e.ioWriter.writeUint16(32),e.ioWriter.writeString(this.header.codec),e.ioWriter.writeUint16(this.header.width),e.ioWriter.writeUint16(this.header.height),e.ioWriter.writeUint32(this.header.denominator),e.ioWriter.writeUint32(this.header.numerator),e.ioWriter.writeUint32(this.header.framesCount),e.ioWriter.writeUint32(0),0):d.r8}writeAVPacket(e,i){if(!s.f[15](i+28))return void n.R8(`packet's size is 0: ${s.f[15](i+32)}, ignore it`,c,151);const t=e.getStreamByIndex(s.f[15](i+32));if(t&&!(1024&t.disposition)){if(t.index===this.muxStreamIndex){const t=e.getStreamByMediaType(0);t&&(e.ioWriter.writeUint32(s.f[15](i+28)),e.ioWriter.writeUint64((0,h.Mr)(s.f[17](i+8)||s.f[17](i+16),i+72,t.timeBase)),e.ioWriter.writeBuffer((0,a.iI)(i)),this.header.framesCount++)}return 0}n.R8(`can not found the stream width the packet's streamIndex: ${s.f[15](i+32)}, ignore it`,c,158)}writeTrailer(e){return e.ioWriter.seek(BigInt(24)),e.ioWriter.writeUint32(this.header.framesCount),e.ioWriter.flush(),0}flush(e){return e.ioWriter.flush(),0}getCapabilities(){return m.Capabilities}}(0,r.A)(m,"Capabilities",[139,167,225])}}]);