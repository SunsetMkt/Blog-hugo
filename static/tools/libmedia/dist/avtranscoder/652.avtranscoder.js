"use strict";(self.webpackChunkAVTranscoder=self.webpackChunkAVTranscoder||[]).push([[652],{75294:(e,t,a)=>{a.d(t,{CM:()=>o,Vz:()=>n,qg:()=>c});var i=a(49859),r=a(64093);class n{constructor(){(0,i.A)(this,"version",void 0),(0,i.A)(this,"layer",void 0),(0,i.A)(this,"protection",void 0),(0,i.A)(this,"bitrateIndex",void 0),(0,i.A)(this,"samplingFrequency",void 0),(0,i.A)(this,"padding",void 0),(0,i.A)(this,"private",void 0),(0,i.A)(this,"mode",void 0),(0,i.A)(this,"modeExtension",void 0),(0,i.A)(this,"copyright",void 0),(0,i.A)(this,"original",void 0),(0,i.A)(this,"emphasis",void 0)}}function c(e,t){e.version=t>>19&3,e.layer=t>>17&3,e.protection=t>>16&1,e.bitrateIndex=t>>12&15,e.samplingFrequency=t>>10&3,e.padding=t>>9&1,e.mode=t>>6&3,e.modeExtension=t>>4&3,e.copyright=t>>3&1,e.original=t>>2&1,e.emphasis=3&t}function o(e,t){let a=r.oz(e.version,e.layer,e.bitrateIndex);switch(e.layer){case 1:default:a=144e3*a/(t<<(3===e.version?0:1))>>>0,a+=e.padding;break;case 2:a=144e3*a/t>>>0,a+=e.padding;break;case 3:a=12e3*a/t>>>0,a=4*(a+e.padding)}return a}},19028:(e,t,a)=>{a.d(t,{In:()=>U,M9:()=>L,VO:()=>x,fz:()=>C,hm:()=>E,qg:()=>M});var i=a(52730),r=a.n(i),n=a(86226),c=a.n(n),o=a(18979),s=a.n(o),d=a(5496),l=a.n(d),g=a(64007),f=a.n(g),u=a(63939),p=a(50932),m=a(4624),T=a(50011),w=a(35336),b=a(31865),h=a(71517),P=a(37837),k=a(14686),S=a(72739),I=a(95335),v=a(92647);const A="src/avformat/formats/mp3/id3v2.ts",U={JPG:7,PNG:61,"image/gif":97,"image/jpeg":7,"image/jpg":7,"image/png":61,"image/tiff":96,"image/bmp":78,"image/webp":171},C=["Other","32x32 pixels 'file icon'","Other file icon","Cover (front)","Cover (back)","Leaflet page","Media (e.g. label side of CD)","Lead artist/lead performer/soloist","Artist/performer","Conductor","Band/Orchestra","Composer","Lyricist/text writer","Recording Location","During recording","During performance","Movie/video screen capture","A bright coloured fish","Illustration","Band/artist logotype","Publisher/Studio logotype"];function B(e,t){e.writeUint8(t>>21&127),e.writeUint8(t>>14&127),e.writeUint8(t>>7&127),e.writeUint8(127&t)}function y(e,t){let a="utf-8";return 0===e?a="iso-8859-1":1===e?a="utf-16":2===e&&(a="utf-16be"),new TextDecoder(a).decode(t)}function O(e){return(127&e)+((32512&e)>>1)+((8323072&e)>>2)+((2130706432&e)>>3)}async function N(e,t){await e.seek(t);const a=await e.readString(4);return/^[A-Z0-9]+$/.test(a)}async function M(e,t,a,i){const n=2!==a.version,c=n?10:6;let o=e.getPos()+BigInt(0|t);async function s(){await e.skip(Number(BigInt.asIntN(32,o-e.getPos())))}if(n&&64&r()(a)){let i=await async function(e,t){let a=0;for(;t--;)a=(a<<7)+(127&await e.readUint8());return a}(e,4);if(4===a.version&&(i-=4),i<0)return m.z3("invalid extended header length",A,149),await s();if(await e.skip(i),(t-=i+4)<0)return m.z3("extended header too long",A,155),await s()}for(;t>c;){let o,s;if(n){if(o=await e.readString(4),s=await e.readUint32(),!s){m.z3("invalid frame size",A,168);break}if(4===a.version&&s>127)if(s<t){await e.flush();const t=e.getPos();if(!(1&r()(e)||6+s<e.remainingLength()))break;if(await N(e,t+BigInt(2)+BigInt(O(s))))s=O(s);else if(!await N(e,t+BigInt(2)+BigInt(s)))break;await e.seek(t)}else s=O(s);await e.readUint16()}else o=await e.readString(3),s=await e.readUint24();if("APIC"===o)i.apic||(i.apic=[]),i.apic.push(await e.readBuffer(s));else if("USLT"===o){const t=await e.readUint8(),a=await e.readString(3),r=await e.readBuffer(s-4);i.lyrics=`${a} ${y(t,r)}`}else if("COMM"===o||"COM"===o){const t=await e.readUint8(),a=await e.readString(3),r=await e.readBuffer(s-4);i.comment=`${a} ${y(t,r)}`}else if("PRIV"===o){const t=e.getPos(),a=[];for(;;){const t=await e.readUint8();if(0===t)break;a.push(t)}const r=T.decode(new Uint8Array(a));let n;n="com.apple.streaming.transportStreamTimestamp"===r?await e.readUint64():await e.readBuffer(s-Number(e.getPos()-t)),i[r]=n}else{let t;switch(t="T"===o[0]?y(await e.readUint8(),await e.readBuffer(s-1)):await e.readBuffer(s),o){case"TIT2":case"TT2":i.title=t;break;case"TPE1":case"TP1":i.artist=t;break;case"TPE2":case"TP2":i.albumArtist=t;break;case"TPOS":i.disc=t;break;case"TCOP":i.copyright=t;break;case"TALB":case"TAL":i.album=t;break;case"TRCK":case"TRK":i.track=t;break;case"TYER":case"TDRL":case"TDRC":i.date=t;break;case"COMM":case"COM":i.comment=t;break;case"TCON":case"TCO":i.genre=t;break;case"TSSE":case"TEN":i.encoder=t;break;case"TCOM":i.composer=t;break;case"TENC":i.vendor=t;break;case"TLAN":i.language=t;break;case"TPE3":case"TP3":i.performer=t;break;case"TPUB":i.publisher=t;break;case"TCMP":case"TCP":i.compilation=t;break;case"TDEN":i.creationTime=t;break;case"TSOA":i.albumSort=t;break;case"TSOP":i.artistSort=t;break;case"TSOT":i.titleSort=t;break;case"TIT1":i.grouping=t;break;default:i[o]=t}}t-=s+c}4==a.version&&16&r()(a)&&(o+=BigInt(10)),await e.skip(Number(BigInt.asIntN(32,o-e.getPos())))}function E(e,t,a){const i=2!==a.version;c()(t).call(t,(t=>{const a=new b.A(t),r=a.readUint8();let n;function c(){let e=Number(a.getPos());for(;e<t.length&&t[e];)e++;return e}if(i?(n=a.readString(c()-Number(a.getPos())),a.skip(1)):n=a.readString(3),!U[n])return;const o=a.readUint8();let s;const d=c()-Number(a.getPos());d&&(s=y(r,a.readBuffer(d))),a.skip(1);const l=e.createStream();l.codecpar.codecId=U[n],l.codecpar.codecType=0,l.disposition|=1024,l.attachedPic=(0,h._5)(),p.M[15](l.attachedPic+32,l.index);const g=a.remainingSize(),f=(0,P.sY)(g),m=a.readBuffer(g);(0,k.lW)(f,g,m),m.length>=8&&S.FB(m.subarray(0,8),new Uint8Array([137,80,78,71,13,10,26,10]))&&(l.codecpar.codecId=61),(0,h.NX)(l.attachedPic,f,g),p.M[15](l.attachedPic+36,1|u.f[15](l.attachedPic+36)),l.metadata.comment=C[o],s&&(l.metadata.title=s)}))}function L(e,t,a,i){var r;let n=e.getPos();e.writeString("ID3"),e.writeUint8(t),e.writeUint16(0);const o=e.getPos();function d(a,i){const r=T.encode(i);e.writeString(a),4===t?B(e,r.length+1):e.writeUint32(r.length+1),e.writeUint16(0),e.writeUint8(3),e.writeBuffer(r)}function g(a,i){e.writeString(a),4===t?B(e,i.length):e.writeUint32(i.length),e.writeUint16(0),e.writeBuffer(i)}var f;if(e.writeUint32(0),i.poster&&g("APIC",i.poster),i.apic&&c()(f=i.apic).call(f,(e=>{g("APIC",e)})),i.title&&d("TIT2",i.title),i.artist&&d("TPE1",i.artist),i.albumArtist&&d("TPE2","albumArtist"),i.disc&&d("TPOS",i.disc),i.copyright&&d("TCOP",i.copyright),i.album&&d("TALB",i.album),i.track&&d("TRCK",i.track),i.date&&d("TDRC",i.date),i.comment){let e=i.comment;" "===e[3]&&(e=s()(e).call(e,0,3)+s()(e).call(e,4)),d("COMM",e)}if(i.lyrics){let e=i.lyrics;" "===e[3]&&(e=s()(e).call(e,0,3)+s()(e).call(e,4)),d("USLT",e)}i.genre&&d("TCON",i.genre+""),i.encoder&&d("TSSE",i.encoder),i.composer&&d("TCOM",i.composer),i.vendor&&d("TENC",i.vendor),i.language&&d("TLAN",i.language),i.performer&&d("TPE3",i.performer),i.publisher&&d("TPUB",i.publisher),i.compilation&&d("TCMP",i.compilation),i.creationTime&&d("TDEN",i.creationTime),i.albumSort&&d("TSOA",i.albumSort),i.artistSort&&d("TSOP",i.artistSort),i.titleSort&&d("TSOT",i.titleSort),i.grouping&&d("TIT1",i.grouping),a<10&&(a=10);const u=Number(BigInt.asIntN(32,e.getPos()-n));a>268435455-u&&(a=268435455-u),e.writeBuffer(l()(r=new Uint8Array(a)).call(r,0)),n=e.getPos(),e.seek(o),B(e,u),e.seek(n)}function x(e,t){var a;const i=[],r=new w.A,n=[];r.onFlush=e=>(n.push(s()(e).call(e)),0);const o=2!==t;return c()(a=e.streams).call(a,(e=>{if(1024&e.disposition&&(o&&(7===e.codecpar.codecId||61===e.codecpar.codecId||96===e.codecpar.codecId||97===e.codecpar.codecId||171===e.codecpar.codecId||78===e.codecpar.codecId)||!o&&(61===e.codecpar.codecId||7===e.codecpar.codecId))&&e.attachedPic){n.length=0,r.writeUint8(3),o?(r.writeString(I.BE(U)[e.codecpar.codecId]),r.writeUint8(0)):61===e.codecpar.codecId?r.writeString("PNG"):r.writeString("JPG");let t=0;e.metadata.comment&&f()(C).call(C,e.metadata.comment)>-1&&(t=f()(C).call(C,e.metadata.comment)),r.writeUint8(t),e.metadata.description&&r.writeString(e.metadata.description),r.writeUint8(0),r.writeBuffer((0,h.iI)(e.attachedPic)),r.flush(),i.push((0,v.A)(Uint8Array,n))}})),i}},31608:(e,t,a)=>{a.d(t,{FN:()=>n,W8:()=>i,c1:()=>r});const i=100,r=128,n=156}}]);