"use strict";(self.webpackChunkAVTranscoder=self.webpackChunkAVTranscoder||[]).push([[632],{51597:(e,i,t)=>{t.d(i,{A:()=>s});var r=t(49859);class s{constructor(){(0,r.A)(this,"type",-1)}async destroy(e){}}(0,r.A)(s,"Capabilities",[])},5632:(e,i,t)=>{t.r(i),t.d(i,{IVFHeader:()=>f,default:()=>w});var r=t(49859),s=t(71426),o=t.n(s),a=t(63939),d=(t(9599),t(51597)),h=t(4624),n=t(44328),c=t(71517),u=t(9705);const m="src/avformat/formats/OIvfFormat.ts";class f{constructor(){(0,r.A)(this,"version",void 0),(0,r.A)(this,"length",void 0),(0,r.A)(this,"codec",void 0),(0,r.A)(this,"width",void 0),(0,r.A)(this,"height",void 0),(0,r.A)(this,"denominator",void 0),(0,r.A)(this,"numerator",void 0),(0,r.A)(this,"framesCount",void 0),this.version=0,this.length=32,this.codec="VP80",this.width=0,this.height=0,this.framesCount=0,this.denominator=1,this.numerator=0}}class w extends d.A{constructor(){super(),(0,r.A)(this,"type",5),(0,r.A)(this,"header",void 0),(0,r.A)(this,"muxStreamIndex",void 0),this.header=new f}init(e){return e.ioWriter.setEndian(!1),0}writeHeader(e){var i;const t=o()(i=e.streams).call(i,(e=>!(139!==e.codecpar.codecId&&167!==e.codecpar.codecId&&225!==e.codecpar.codecId||1024&e.disposition)));return t?(this.muxStreamIndex=t.index,167===t.codecpar.codecId?this.header.codec="VP90":225===t.codecpar.codecId&&(this.header.codec="AV01"),this.header.width=t.codecpar.width,this.header.height=t.codecpar.height,this.header.numerator=t.timeBase.num,this.header.denominator=t.timeBase.den,e.ioWriter.writeString("DKIF"),e.ioWriter.writeUint16(this.header.version),e.ioWriter.writeUint16(32),e.ioWriter.writeString(this.header.codec),e.ioWriter.writeUint16(this.header.width),e.ioWriter.writeUint16(this.header.height),e.ioWriter.writeUint32(this.header.denominator),e.ioWriter.writeUint32(this.header.numerator),e.ioWriter.writeUint32(this.header.framesCount),e.ioWriter.writeUint32(0),0):u.r8}writeAVPacket(e,i){if(!a.f[15](i+28))return void h.R8(`packet's size is 0: ${a.f[15](i+32)}, ignore it`,m,144);const t=e.getStreamByIndex(a.f[15](i+32));if(t&&!(1024&t.disposition)){if(t.index===this.muxStreamIndex){const t=e.getStreamByMediaType(0);t&&(e.ioWriter.writeUint32(a.f[15](i+28)),e.ioWriter.writeUint64((0,n.Mr)(a.f[17](i+8)||a.f[17](i+16),i+72,t.timeBase)),e.ioWriter.writeBuffer((0,c.iI)(i)),this.header.framesCount++)}return 0}h.R8(`can not found the stream width the packet's streamIndex: ${a.f[15](i+32)}, ignore it`,m,151)}writeTrailer(e){return e.ioWriter.seek(BigInt(24)),e.ioWriter.writeUint32(this.header.framesCount),e.ioWriter.flush(),0}flush(e){return e.ioWriter.flush(),0}getCapabilities(){return w.Capabilities}}(0,r.A)(w,"Capabilities",[139,167,225])}}]);