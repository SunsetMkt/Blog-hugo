(self.webpackChunkAVTranscoder=self.webpackChunkAVTranscoder||[]).push([[331],{64436:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var r=a(49859),i=a(63939),n=(a(77162),a(37837)),s=a(71766);class o{constructor(){(0,r.A)(this,"inCodecpar",void 0),(0,r.A)(this,"inTimeBase",void 0),(0,r.A)(this,"outCodecpar",void 0)}init(e,t){return this.inCodecpar=(0,n.Gy)(168),(0,s.Yi)(this.inCodecpar,e),this.inTimeBase={den:i.f[15](t+4),num:i.f[15](t)},0}destroy(){this.inCodecpar&&((0,s.dn)(this.inCodecpar),this.inCodecpar=0)}}},50848:(e,t,a)=>{"use strict";a.d(t,{A:()=>P});var r=a(49859),i=a(18979),n=a.n(i),s=a(63939),o=a(50932),c=a(77162),d=a(29170),l=a(64436),p=a(14686),h=a(4624),f=a(9705),u=a(77231),g=a(95832),m=a(44328),A=a(37837),y=a(71517),I=a(67672),x=a(92647);class P extends l.A{constructor(...e){super(...e),(0,r.A)(this,"streamMuxConfig",void 0),(0,r.A)(this,"caches",void 0),(0,r.A)(this,"pendingItem",void 0)}init(e,t){return super.init(e,t),this.caches=[],this.streamMuxConfig={profile:u.N_,sampleRate:u.N_,channels:u.N_},0}sendAVPacket(e){var t;let a=0,r=s.f[17](e+16)!==u.Dh?s.f[17](e+16):s.f[17](e+8),i=n()(t=(0,p.s3)(s.f[20](e+24),s.f[15](e+28))).call(t);for(this.pendingItem&&(this.pendingItem.buffer=(0,x.A)(Uint8Array,[this.pendingItem.buffer,i.subarray(0,this.pendingItem.miss)]),i=i.subarray(this.pendingItem.miss),this.caches.push(this.pendingItem),this.pendingItem=null);a<i.length;){const t=g.Bq(i.subarray(a));if(I.ai(t)){let e=a+1;for(;e<i.length-1;e++)if(4095==(i[e]<<4|i[e+1]>>4)){a=e;break}if(e<i.length-1)continue;return h.z3("AACADTSParser parse failed","src/avformat/bsf/aac/ADTS2RawFilter.ts",109),f.LR}const n={dts:r,buffer:null,extradata:null,duration:u.N_,pos:s.f[17](e+56)};n.buffer=i.subarray(a+t.headerLength,a+t.headerLength+t.framePayloadLength),this.streamMuxConfig.profile=t.profile,this.streamMuxConfig.sampleRate=t.sampleRate,this.streamMuxConfig.channels=t.channels;const l=s.f[15](this.inCodecpar+48)!==this.streamMuxConfig.profile||s.f[15](this.inCodecpar+136)!==this.streamMuxConfig.sampleRate||s.f[15](this.inCodecpar+116)!==this.streamMuxConfig.channels,y=(0,m.k)(BigInt(Math.floor(1024*(t.numberOfRawDataBlocksInFrame+1)/this.streamMuxConfig.sampleRate*u.SF)),u.KR,this.inTimeBase);if(n.duration=Number(y),l){o.M[15](this.inCodecpar+48,this.streamMuxConfig.profile),o.M[15](this.inCodecpar+136,this.streamMuxConfig.sampleRate),o.M[15](this.inCodecpar+116,this.streamMuxConfig.channels);const e=(0,g.Ij)((0,d.A)(this.inCodecpar,c.A));s.f[20](this.inCodecpar+12)&&(0,A.Eb)(s.f[20](this.inCodecpar+12)),o.M[20](this.inCodecpar+12,(0,A.sY)(e.length)),(0,p.lW)(s.f[20](this.inCodecpar+12),e.length,e),o.M[15](this.inCodecpar+16,e.length),n.extradata=e}n.buffer.length<t.framePayloadLength?this.pendingItem={...n,miss:t.framePayloadLength-n.buffer.length}:this.caches.push(n),a+=t.aacFrameLength,r+=y}return 0}receiveAVPacket(e){if(this.caches.length){(0,y.Up)(e);const t=this.caches.shift(),a=(0,A.sY)(t.buffer.length);if((0,p.lW)(a,t.buffer.length,t.buffer),(0,y.NX)(e,a,t.buffer.length),o.M[17](e+16,t.dts),o.M[17](e+8,t.dts),o.M[17](e+56,t.pos),o.M[17](e+48,BigInt(Math.floor(t.duration))),o.M[15](e+36,1|s.f[15](e+36)),t.extradata){const a=(0,A.sY)(t.extradata.length);(0,p.lW)(a,t.extradata.length,t.extradata),(0,y.Ow)(e,1,a,t.extradata.length)}return 0}return f.LT}reset(){return this.pendingItem=null,this.caches.length=0,0}}},36488:(e,t,a)=>{"use strict";a.d(t,{A:()=>I});var r=a(49859),i=a(63939),n=a(50932),s=a(77162),o=a(29170),c=a(64436),d=a(14686),l=a(4624),p=a(9705),h=a(77231),f=a(95832),u=a(44328),g=a(37837),m=a(71517),A=a(37246),y=a(67672);class I extends c.A{constructor(...e){super(...e),(0,r.A)(this,"bitReader",void 0),(0,r.A)(this,"streamMuxConfig",void 0),(0,r.A)(this,"caches",void 0),(0,r.A)(this,"refSampleDuration",void 0)}init(e,t){return super.init(e,t),this.caches=[],this.refSampleDuration=BigInt(0),this.bitReader=new A.A,this.streamMuxConfig={profile:h.N_,sampleRate:h.N_,channels:h.N_},0}sendAVPacket(e){const t=(0,d.s3)(i.f[20](e+24),i.f[15](e+28));this.bitReader.appendBuffer(t);let a=i.f[17](e+16)!==h.Dh?i.f[17](e+16):i.f[17](e+8);for(;this.bitReader.remainingLength()>=20;){const t=this.bitReader.getPointer(),r=f.f7(null,this.bitReader);if(y.ai(r)){let e=!1;for(;this.bitReader.remainingLength()>=20;){if(695===this.bitReader.peekU(11)){e=!0;break}this.bitReader.readU1()}if(e)continue;return l.z3("AACLATMParser parse failed","src/avformat/bsf/aac/LATM2RawFilter.ts",108),this.bitReader.reset(),p.LR}if(r.framePayloadLength>=this.bitReader.remainingLength()){this.bitReader.skipPadding(),this.bitReader.setPointer(t);break}r.useSameStreamMux||(this.streamMuxConfig.profile=r.profile,this.streamMuxConfig.sampleRate=r.sampleRate,this.streamMuxConfig.channels=r.channels);const c=r.framePayloadLength,m=new Uint8Array(c);for(let e=0;e<c;e++)m[e]=this.bitReader.readU(8);const A={dts:a,buffer:m,extradata:null,pos:i.f[17](e+56)};if(i.f[15](this.inCodecpar+48)!==this.streamMuxConfig.profile||i.f[15](this.inCodecpar+136)!==this.streamMuxConfig.sampleRate||i.f[15](this.inCodecpar+116)!==this.streamMuxConfig.channels){this.refSampleDuration=(0,u.k)(BigInt(Math.floor(1024/this.streamMuxConfig.sampleRate*h.SF)),h.KR,this.inTimeBase),n.M[15](this.inCodecpar+48,this.streamMuxConfig.profile),n.M[15](this.inCodecpar+136,this.streamMuxConfig.sampleRate),n.M[15](this.inCodecpar+116,this.streamMuxConfig.channels);const e=(0,f.Ij)((0,o.A)(this.inCodecpar,s.A));i.f[20](this.inCodecpar+12)&&(0,g.Eb)(i.f[20](this.inCodecpar+12)),n.M[20](this.inCodecpar+12,(0,g.sY)(e.length)),(0,d.lW)(i.f[20](this.inCodecpar+12),e.length,e),n.M[15](this.inCodecpar+16,e.length),A.extradata=e}this.caches.push(A),a+=this.refSampleDuration,this.bitReader.skipPadding()}return 0}receiveAVPacket(e){if(this.caches.length){(0,m.Up)(e);const t=this.caches.shift(),a=(0,g.sY)(t.buffer.length);if((0,d.lW)(a,t.buffer.length,t.buffer),(0,m.NX)(e,a,t.buffer.length),n.M[17](e+16,t.dts),n.M[17](e+8,t.dts),n.M[17](e+56,t.pos),n.M[15](e+36,1|i.f[15](e+36)),n.M[17](e+48,this.refSampleDuration),t.extradata){const a=(0,g.sY)(t.extradata.length);(0,d.lW)(a,t.extradata.length,t.extradata),(0,m.Ow)(e,1,a,t.extradata.length)}return 0}return p.LT}reset(){return this.bitReader.reset(),this.caches.length=0,0}}},61702:(e,t,a)=>{"use strict";a.d(t,{A:()=>y});var r=a(49859),i=a(18979),n=a.n(i),s=a(63939),o=a(50932),c=a(64436),d=a(77231),l=a(44328),p=a(22576),h=a(4624),f=a(9705),u=a(71517),g=a(37837),m=a(14686),A=a(92647);class y extends c.A{constructor(...e){super(...e),(0,r.A)(this,"caches",void 0),(0,r.A)(this,"pendingItem",void 0)}init(e,t){return super.init(e,t),this.caches=[],0}sendAVPacket(e){let t=0,a=s.f[17](e+16)!==d.Dh?s.f[17](e+16):s.f[17](e+8),r=(0,u.iI)(e);for(this.pendingItem&&(this.pendingItem.buffer=(0,A.A)(Uint8Array,[this.pendingItem.buffer,r.subarray(0,this.pendingItem.miss)]),r=r.subarray(this.pendingItem.miss),this.caches.push(this.pendingItem),this.pendingItem=null);t<r.length;){const i=r[t]<<3|r[t+1]>>5;if(1023!==i){let e=t+1;for(;e<r.length-1;e++)if(1023==(r[e]<<3|r[e+1]>>5)){t=e;break}if(e<r.length-1)continue;return h.z3(`MpegtsOpusParser found syncWord not 0x3ff, got: 0x${i.toString(16)}`,"src/avformat/bsf/opus/Mpegts2RawFilter.ts",95),f.LR}const o=!!(16&r[t+1]),c=!!(8&r[t+1]);let u=t+2,g=0;for(;255===r[u];)g+=255,u++;g+=r[u],u++,u+=o?2:0,u+=c?2:0;let m=r.subarray(u,u+g);const A=s.f[15](this.inCodecpar+136)>0?s.f[15](this.inCodecpar+136):48e3,y=(0,l.k)(BigInt(Math.floor(p.kt(m)/A*d.SF)),d.KR,this.inTimeBase),I={dts:a,buffer:n()(m).call(m),duration:Number(y),pos:s.f[17](e+56)};I.buffer.length<g?this.pendingItem={...I,miss:g-I.buffer.length}:this.caches.push(I),a+=y,t=u+g}}receiveAVPacket(e){if(this.caches.length){(0,u.Up)(e);const t=this.caches.shift(),a=(0,g.sY)(t.buffer.length);return(0,m.lW)(a,t.buffer.length,t.buffer),(0,u.NX)(e,a,t.buffer.length),o.M[17](e+16,t.dts),o.M[17](e+8,t.dts),o.M[17](e+56,t.pos),o.M[15](e+36,1|s.f[15](e+36)),o.M[17](e+48,BigInt(Math.floor(t.duration))),0}return f.LR}reset(){return this.pendingItem=null,this.caches.length=0,0}}},85947:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var r=a(49859);class i{constructor(){(0,r.A)(this,"type",-1),(0,r.A)(this,"onStreamAdd",void 0)}async destroy(e){}}},59331:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>q});var r=a(49859),i=a(96319),n=a.n(i),s=a(52730),o=a.n(s),c=a(71426),d=a.n(c),l=a(6707),p=a.n(l),h=a(86226),f=a.n(h),u=a(94870),g=a.n(u),m=a(63939),A=a(50932),y=a(4624),I=a(97389),x=a(53783),P=a(27274),b=a(39e3),S=a(9705),M=a(29279),k=a(39144),v=a(52088),R=a(6403),C=a(85947),U=a(86191),L=a(71517),w=a(77231),B=a(52071),T=a(44328),E=a(72739),D=a(64093),F=a(62815),z=a(67659),N=a(59166),_=a(95832),V=a(22576),W=a(87518),Y=a(43290),$=a(37837),Q=a(14686),O=a(67672),X=a(60264),G=a(92647);const Z="src/avformat/formats/IMpegtsFormat.ts";class q extends C.A{constructor(){super(),(0,r.A)(this,"type",2),(0,r.A)(this,"context",void 0),(0,r.A)(this,"firstTSPacketPos",void 0),(0,r.A)(this,"cacheAVPacket",void 0),this.context=(0,I.A)()}init(e){e.ioReader&&e.ioReader.setEndian(!0),this.cacheAVPacket=0}async destroy(e){this.cacheAVPacket&&((0,L.Qe)(this.cacheAVPacket),this.cacheAVPacket=0),E.__(e.streams,(e=>{const t=e.privData;n()(t)&&(n()(t).destroy(),t.filter=null)}))}async readHeader(e){try{let t=0,a=await x.q(e.ioReader);for(a||(a=P.ZT),this.context.tsPacketSize=a,this.context.tsPacketSize!==P.VG&&71!==await e.ioReader.peekUint8()&&await this.syncTSPacket(e,!1);!this.context.hasPAT||!this.context.hasPMT;){const t=await x.$(e.ioReader,this.context);t.payload&&(0!==t.pid&&t.pid!==this.context.currentPmtPid&&134!==this.context.pmt.pid2StreamType.get(t.pid)||(0,b.A)(t,this.context))}return this.context.hasPAT&&this.context.hasPMT?(this.firstTSPacketPos=e.ioReader.getPos(),t):S.LR}catch(t){return y.z3(t.message,Z,150),e.ioReader.error}}checkExtradata(e,t){if(!t.codecpar.extradata){let a=(0,L.rU)(e,1);if(!a)return;t.codecpar.extradata=(0,$.sY)(m.f[25](a+4)),(0,Q.Mr)(t.codecpar.extradata,m.f[20](a),m.f[25](a+4)),t.codecpar.extradataSize=0|m.f[25](a+4),(0,L.Is)(e,1),86018===t.codecpar.codecId?_.XC(t,(0,Q.JW)(t.codecpar.extradata,t.codecpar.extradataSize)):86076===t.codecpar.codecId&&V.XC(t,(0,Q.JW)(t.codecpar.extradata,t.codecpar.extradataSize))}}handlePES(e,t,a,r){(a.randomAccessIndicator||1===r.codecpar.codecType)&&A.M[15](t+36,1|m.f[15](t+36));const i=r.privData;27!==r.codecpar.codecId&&173!==r.codecpar.codecId&&196!==r.codecpar.codecId||A.M[15](t+36,64|m.f[15](t+36)),A.M[15](t+32,r.index),A.M[17](t+16,a.dts),A.M[17](t+8,a.pts),A.M[17](t+56,a.pos),A.M[15](t+76,9e4),A.M[15](t+72,1),A.M[15](t+36,m.f[15](t+36)|o()(a)),r.startTime===w.Dh&&(r.startTime=m.f[17](t+8)||m.f[17](t+16));const s=(0,$.sY)(a.payload.length);if((0,Q.lW)(s,a.payload.length,a.payload),(0,L.NX)(t,s,a.payload.length),n()(i)){let a=0;if(a=n()(i).sendAVPacket(t),a<0)return y.z3("send avpacket to bsf failed",Z,211),S.LR;if(a=n()(i).receiveAVPacket(t),a<0)return this.context.ioEnd?(y.z3("receive avpacket from bsf failed",Z,221),S.LR):-1048575;for(A.M[15](t+76,9e4),A.M[15](t+72,1),A.M[15](t+32,r.index),this.checkExtradata(t,r);;){const t=this.cacheAVPacket||(0,L._5)();if(a=n()(i).receiveAVPacket(t),0!==a){this.cacheAVPacket=t;break}A.M[15](t+76,9e4),A.M[15](t+72,1),A.M[15](t+32,r.index),this.checkExtradata(t,r),e.interval.packetBuffer.push(t),this.cacheAVPacket=0}}else{const e=this.context.pmt.pid2StreamType.get(i.pid);if(3===e||4===e){A.M[15](t+36,1|m.f[15](t+36));const e=(0,L.iI)(t),a=e[1]>>>3&3,i=(6&e[1])>>1,n=(12&e[2])>>>2,s=3&~(e[3]>>>6)?2:1,o=D.Au(i),c=D.Y2(a,n);(r.codecpar.profile!==o||r.codecpar.sampleRate!==c||r.codecpar.chLayout.nbChannels!==s)&&(r.codecpar.profile=o,r.codecpar.sampleRate=c,r.codecpar.chLayout.nbChannels=s)}else if(27===r.codecpar.codecId){if(!r.codecpar.extradata){const e=F.sL((0,L.iI)(t));e&&(r.codecpar.extradata=(0,$.sY)(e.length),(0,Q.lW)(r.codecpar.extradata,e.length,e),r.codecpar.extradataSize=e.length,F.XC(r,e),A.M[15](t+36,1|m.f[15](t+36)))}}else if(173===r.codecpar.codecId){if(!r.codecpar.extradata){const e=z.sL((0,L.iI)(t));e&&(r.codecpar.extradata=(0,$.sY)(e.length),(0,Q.lW)(r.codecpar.extradata,e.length,e),r.codecpar.extradataSize=e.length,z.XC(r,e),A.M[15](t+36,1|m.f[15](t+36)))}}else if(196===r.codecpar.codecId){if(!r.codecpar.extradata){const e=N.sL((0,L.iI)(t));e&&(r.codecpar.extradata=(0,$.sY)(e.length),(0,Q.lW)(r.codecpar.extradata,e.length,e),r.codecpar.extradataSize=e.length,N.XC(r,e),A.M[15](t+36,1|m.f[15](t+36)))}}else if(86019===r.codecpar.codecId||86056===r.codecpar.codecId){if(r.codecpar.sampleRate===w.N_){const e=W.R((0,L.iI)(t));O.ai(e)||(r.codecpar.sampleRate=e.sampleRate,r.codecpar.chLayout.nbChannels=e.channels)}}else if(86020===r.codecpar.codecId&&r.codecpar.sampleRate===w.N_){const e=Y.R((0,L.iI)(t));O.ai(e)||(r.codecpar.sampleRate=e.sampleRate,r.codecpar.chLayout.nbChannels=e.channels)}}return 0}parsePESSlice(e,t,a,r){const i=r.privData;let n=(0,k.A)(a),s=(0,M.A)(n);if(s)return s;if((0,v.A)(a),27===r.codecpar.codecId||173===r.codecpar.codecId||196===r.codecpar.codecId){if(!i.pendingPES&&!this.context.ioEnd)return i.pendingPES=n,-1048575;if(i.pendingPES){let e=0;for(;;){const t=X.Ky(n.payload,e);if(!(t.offset>=0)){e=-1;break}if(4===t.startCode||3===t.startCode&&(173===r.codecpar.codecId&&t.offset+3<n.payload.length&&39==(n.payload[t.offset+3]>>>1&63)||196===r.codecpar.codecId&&t.offset+4<n.payload.length&&23==(n.payload[t.offset+4]>>>3&31))){e=t.offset;break}e+=3}if(e>=0){e>0&&(i.pendingPES.payload=(0,G.A)(Uint8Array,[i.pendingPES.payload,n.payload.subarray(0,e)]),n.payload=n.payload.subarray(e));let t=i.pendingPES;i.pendingPES=n,n=t}else{if(i.pendingPES.payload=(0,G.A)(Uint8Array,[i.pendingPES.payload,n.payload]),!this.context.ioEnd)return-1048575;n=i.pendingPES,i.pendingPES=null}}}return this.handlePES(e,t,n,r)}async readAVPacket_(e,t){if(this.context.ioEnd){var a,r;const i=()=>{var a;const r=d()(a=e.streams).call(a,(e=>!!e.privData.pendingPES));if(r){const a=r.privData,i=a.pendingPES;return a.pendingPES=null,this.handlePES(e,t,i,r)}return-1048576};if(!this.context.tsSliceQueueMap.size)return i();const n=p()(a=this.context.tsSliceQueueMap).call(a);let s;for(;;){const e=n.next();if(e.value&&e.value.slices.length){s=e.value;break}if(e.done)break}if(!s)return i();const o=d()(r=e.streams).call(r,(e=>e.privData.pid===s.pid));return o?this.parsePESSlice(e,t,s,o):((0,v.A)(s),this.readAVPacket_(e,t))}try{for(;;){var i;if(this.context.tsPacketSize!==P.VG&&71!==await e.ioReader.peekUint8()){try{await e.ioReader.flush()}catch(e){}await this.syncTSPacket(e,!1)}const a=await x.$(e.ioReader,this.context);if(!a.payload)continue;if(0===a.pid||a.pid===this.context.currentPmtPid||134===this.context.pmt.pid2StreamType.get(a.pid)){(0,b.A)(a,this.context);continue}const r=this.context.pmt.pid2StreamType.get(a.pid);if(!r)continue;let l=d()(i=e.streams).call(i,(e=>e.privData.pid===a.pid));l||(l=e.createStream(),(0,U.A)(a.pid,l,this.context));let p=a.payload[4]<<8|a.payload[5],h=this.context.tsSliceQueueMap.get(a.pid),f=!1;if(h){if(h.totalLength>0&&a.payloadUnitStartIndicator){const i=this.parsePESSlice(e,t,h,l);if(i<0){if(-1048575===i){var n,s;h.randomAccessIndicator=null!==(n=null===(s=a.adaptationFieldInfo)||void 0===s?void 0:s.randomAccessIndicator)&&void 0!==n?n:0,h.pos=a.pos,h.pid=a.pid,h.streamType=r,h.expectedLength=0===p?0:p+6,h.slices.push(a.payload),h.totalLength+=a.payload.length;continue}return i}f=!0}}else{if(!a.payloadUnitStartIndicator)continue;h=new R.pi,this.context.tsSliceQueueMap.set(a.pid,h)}var o,c;if(a.payloadUnitStartIndicator&&(h.randomAccessIndicator=null!==(o=null===(c=a.adaptationFieldInfo)||void 0===c?void 0:c.randomAccessIndicator)&&void 0!==o?o:0,h.pos=a.pos,h.pid=a.pid,h.streamType=r,h.expectedLength=0===p?0:p+6),h.slices.push(a.payload),h.totalLength+=a.payload.length,h.expectedLength>0&&h.expectedLength===h.totalLength){const a=this.parsePESSlice(e,t,h,l);if(a<0){if(-1048575===a)continue;return a}f=!0}if(f)return 0}}catch(a){return-1048576!==e.ioReader.error||this.context.ioEnd?-1048576===e.ioReader.error||-1048572===e.ioReader.error?e.ioReader.error:(y.z3(`read packet error, ${a}`,Z,581),S.LR):(this.context.ioEnd=!0,this.readAVPacket_(e,t))}}async readAVPacket(e,t){try{return this.readAVPacket_(e,t)}catch(t){return-1048576!==e.ioReader.error&&-1048572!==e.ioReader.error&&y.z3(t.message,Z,596),e.ioReader.error}}async syncTSPacket(e,t=!0){let a=w.Dh;for(;;)try{if(71===await e.ioReader.readUint8()){a=this.context.tsPacketSize===P.VG?e.ioReader.getPos()-BigInt(5):e.ioReader.getPos()-BigInt(1);let t=0,r=e.ioReader.getPos();for(;t<=10&&(await e.ioReader.skip(this.context.tsPacketSize-1),71===await e.ioReader.readUint8());)t++;if(t<10){a=w.Dh,await e.ioReader.seek(r);continue}break}}catch(e){a=w.Dh;break}if(a!==w.Dh&&(await e.ioReader.seek(a),t))for(;;){if((await x.$(e.ioReader,this.context)).payloadUnitStartIndicator){var r;await e.ioReader.seek(a),f()(r=e.streams).call(r,(e=>{let t=this.context.tsSliceQueueMap.get(e.privData.pid);t&&(0,v.A)(t);const a=e.privData;a.pendingPES=null,n()(a)&&n()(a).reset()}));break}a=e.ioReader.getPos()}}async seek(e,t,a,r){var i,s,o;let c=e.ioReader.getPos();f()(i=this.context.tsSliceQueueMap).call(i,(e=>{e.slices.length&&e.pos<c&&(c=e.pos)})),f()(s=e.streams).call(s,(e=>{var t;const a=e.privData;(null===(t=a.pendingPES)||void 0===t?void 0:t.pos)<c&&(c=a.pendingPES.pos)}));const d=()=>{var t,a;f()(t=this.context.tsSliceQueueMap).call(t,(e=>{(0,v.A)(e)})),f()(a=e.streams).call(a,(e=>{const t=e.privData;t.pendingPES=null,n()(t)&&n()(t).reset()}))};if(f()(o=this.context.pmt.pid2StreamType).call(o,((e,t)=>{this.context.tsSliceQueueMap.delete(t)})),16&r){const r=(0,T.k)(a,t.timeBase,w.i0);return await e.ioReader.seek(r,!0),this.context.ioEnd=!1,d(),BigInt(0)}if(2&r){const t=await e.ioReader.fileSize();return t<=BigInt(0)?BigInt(S.E$):(a<BigInt(0)?a=BigInt(0):a>t&&(a=t),await e.ioReader.seek(a),4&r||await this.syncTSPacket(e),this.context.ioEnd=!1,d(),c)}{var l,p;if(t&&t.sampleIndexes.length){let r=E.El(t.sampleIndexes,(e=>e.pts>a?-1:1));if(r>0&&(0,T.k)(a-t.sampleIndexes[r-1].pts,t.timeBase,w.i0)<BigInt(1e4))return y.Yz(`seek in sampleIndexes, found index: ${r}, pts: ${t.sampleIndexes[r-1].pts}, pos: ${t.sampleIndexes[r-1].pos}`,Z,758),await e.ioReader.seek(t.sampleIndexes[r-1].pos),this.context.ioEnd=!1,d(),c}y.Yz("not found any keyframe index, try to seek in bytes",Z,766);let r=await(0,B.A)(e,t,a,this.firstTSPacketPos,g()(l=this.readAVPacket).call(l,this),g()(p=this.syncTSPacket).call(p,this));return r>=0&&(this.context.ioEnd=!1,d()),r}}getAnalyzeStreamsCount(){var e,t;return null!==(e=null===(t=this.context.pmt)||void 0===t?void 0:t.pid2StreamType.size)&&void 0!==e?e:1}}},89564:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var r=a(27274);function i(e,t,a){const i=new Uint8Array(r.GV);let n=0,s=0;for(let r=0;r<e.length-3;r++)if(71===e[r]){const o=8191&(e[r+1]<<8|e[r+2]);let c=48&e[r+3];if(!a||8191===o||c){const e=r%t;i[e]++,n++,i[e]>s&&(s=i[e])}}return s-Math.max(n-10*s,0)/10}},52088:(e,t,a)=>{"use strict";function r(e){e.slices=[],e.totalLength=0,e.expectedLength=-1}a.d(t,{A:()=>r})},97389:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var r=a(74707),i=a.n(r),n=a(77231),s=a(6403);function o(){return{currentProgram:n.N_,currentPmtPid:n.N_,tsPacketSize:n.N_,hasPAT:!1,hasPMT:!1,tsSliceQueueMap:new(i()),pat:new s.Cd,pmt:new s.I4,program2Pmt:new(i()),ioEnd:!1,startPid:256,delay:BigInt(0)}}},76538:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var r=a(77231);function i(){return{pid:r.N_,filter:null,tsPacket:null,pes:null,pendingPES:null,continuityCounter:0,pesSlices:{total:0,buffers:[]},latm:!1}}},39e3:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var r=a(18979),i=a.n(r),n=a(6403),s=a(52088),o=a(63599);function c(e,t){const a=t.tsSliceQueueMap.get(e.pid);if(e.payloadUnitStartIndicator){const p=e.payload[0];if(a&&a.totalLength>0){var r;const n=i()(r=e.payload).call(r,1,Math.min(1+p,e.payload.length));a.slices.push(n),a.totalLength+=n.length,a.totalLength===a.expectedLength?((0,o.A)(e.pid,a,t),(0,s.A)(a)):((0,s.A)(a),t.tsSliceQueueMap.delete(e.pid))}for(let a=1+p;a<e.payload.length;){var c,d,l;if(255===e.payload[a])break;const r=(15&e.payload[a+1])<<8|e.payload[a+2],p=new n.pi;p.pid=e.pid,p.expectedLength=r+3,p.randomAccessIndicator=null!==(c=null===(d=e.adaptationFieldInfo)||void 0===d?void 0:d.randomAccessIndicator)&&void 0!==c?c:0;const h=i()(l=e.payload).call(l,a,Math.min(a+p.expectedLength-p.totalLength,e.payload.length));p.slices.push(h),p.totalLength+=h.length,t.tsSliceQueueMap.set(e.pid,p),p.totalLength===p.expectedLength?((0,o.A)(e.pid,p,t),(0,s.A)(p)):((0,s.A)(p),t.tsSliceQueueMap.delete(e.pid)),a+=h.length}}else if(a&&0!==a.totalLength){var p;const r=i()(p=e.payload).call(p,0,Math.min(a.expectedLength-a.totalLength,e.payload.length));a.slices.push(r),a.totalLength+=r.length,a.totalLength===a.expectedLength?((0,o.A)(e.pid,a,t),(0,s.A)(a)):((0,s.A)(a),t.tsSliceQueueMap.delete(e.pid))}}},86191:(e,t,a)=>{"use strict";a.d(t,{A:()=>u});var r=a(71426),i=a.n(r),n=a(61499),s=a(76538),o=a(27274),c=a(50848),d=a(36488),l=a(61702),p=a(22576),h=a(37837),f=a(14686);function u(e,t,a){t.timeBase.den=9e4,t.timeBase.num=1;const r=(0,s.A)();r.pid=e,t.privData=r;const u=a.pmt.pid2StreamType.get(e);if(6===u){const r=a.pmt.pid2ESDescriptor.get(e);if(t.codecpar.codecType=2,r){var g;const e=i()(r).call(r,(e=>5===e.tag));if(e&&(null===(g=e.buffer)||void 0===g?void 0:g.length)>=4)if("O"===String.fromCharCode(e.buffer[0])||"p"===String.fromCharCode(e.buffer[1])||"u"===String.fromCharCode(e.buffer[2])||"s"===String.fromCharCode(e.buffer[3])){t.codecpar.codecType=1,t.codecpar.codecId=86076,t.codecpar.sampleRate=48e3;const e=i()(r).call(r,(e=>127===e.tag));if(e&&128===e.buffer[0]){t.codecpar.chLayout.nbChannels=15&e.buffer[1]?15&e.buffer[1]:2;const a=p.Ij(t.codecpar);a&&(t.codecpar.extradata=(0,h.sY)(a.length),(0,f.lW)(t.codecpar.extradata,a.length,a),t.codecpar.extradataSize=a.length)}}else if("A"===String.fromCharCode(e.buffer[0])||"V"===String.fromCharCode(e.buffer[1])||"0"===String.fromCharCode(e.buffer[2])||"1"===String.fromCharCode(e.buffer[3])){t.codecpar.codecType=0,t.codecpar.codecId=225;const e=i()(r).call(r,(e=>128===e.tag));e&&(t.codecpar.extradata=(0,h.sY)(e.buffer.length),(0,f.lW)(t.codecpar.extradata,e.buffer.length,e.buffer),t.codecpar.extradataSize=e.buffer.length)}}}else{const e=o.$x[u];e?(t.codecpar.codecType=e[0],t.codecpar.codecId=e[1]):t.codecpar.codecType=2}let m;switch(u){case 15:m=new c.A;break;case 17:m=new d.A;break;case 6:86076===t.codecpar.codecId&&(m=new l.A)}return 27!==t.codecpar.codecId&&173!==t.codecpar.codecId&&196!==t.codecpar.codecId||(t.codecpar.flags|=1),m&&(t.privData.filter=m,m.init(t.codecpar[n.o9],t.timeBase[n.o9])),t}},31239:(e,t,a)=>{"use strict";function r(e,t){let a=0,r=e[a++];if(t.adaptationFieldInfo.discontinuityIndicator=r>>7&1,t.adaptationFieldInfo.randomAccessIndicator=r>>6&1,t.adaptationFieldInfo.elementaryStreamPriorityIndicator=r>>5&1,t.adaptationFieldInfo.pcrFlag=r>>4&1,t.adaptationFieldInfo.opcrFlag=r>>3&1,t.adaptationFieldInfo.splicingPointFlag=r>>2&1,t.adaptationFieldInfo.transportPrivateDataFlag=r>>1&1,t.adaptationFieldInfo.adaptationFieldExtensionFlag=1&r,t.adaptationFieldInfo.pcrFlag){const r=BigInt(Math.floor(e[a++]<<25|e[a++]<<17|e[a++]<<9|e[a++]<<1|e[a]>>7)),i=BigInt(Math.floor((1&e[a++])<<8|e[a++]));t.adaptationFieldInfo.pcr=r*BigInt(300)+i}if(t.adaptationFieldInfo.opcrFlag){const r=BigInt(Math.floor(e[a++]<<25|e[a++]<<17|e[a++]<<9|e[a++]<<1|e[a]>>7)),i=BigInt(Math.floor((1&e[a++])<<8|e[a++]));t.adaptationFieldInfo.pcr=r*BigInt(300)+i}if(t.adaptationFieldInfo.splicingPointFlag&&(t.adaptationFieldInfo.spliceCountDown=e[a++]),t.adaptationFieldInfo.transportPrivateDataFlag){const r=e[a++];t.adaptationFieldInfo.transportPrivateData=e.subarray(a,a+r),a+=r}if(t.adaptationFieldInfo.adaptationFieldExtensionFlag){const r=e[a++];t.adaptationFieldInfo.extension=e.subarray(a,a+r),a+=r}}a.d(t,{A:()=>r})},20549:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var r=a(31865),i=a(6403),n=a(92647),s=a(4624);const o="src/avformat/formats/mpegts/function/parsePAT.ts";function c(e,t){let a=0;const c=new r.A((0,n.A)(Uint8Array,e.slices),!0),d=c.readUint8();0!==d&&s.z3(`parsePAT: table_id ${d} is not corresponded to PAT!`,o,41);const l=4095&c.readUint16();c.readUint16(),a=c.readUint8();const p=a>>1&31,h=1&a,f=c.readUint8();let u;if(c.readUint8(),1===h&&0===f)u=new i.Cd,u.versionNumber=p;else if(u=t.pat,!u)return void s.z3("can not found PAT in mpegts context",o,65);const g=l-5-4,m=Number(BigInt.asIntN(32,c.getPos()))+g;let A=-1,y=-1;for(;c.getPos()<m;){const e=c.readUint16(),t=8191&c.readUint16();0===e?u.networkPid=t:(u.program2PmtPid.set(e,t),-1===A&&(A=e),-1===y&&(y=t))}1===h&&0===f&&(t.pat||s.pq("parsed first PAT",o,101),t.pat=u,t.currentProgram=A,t.currentPmtPid=y,t.hasPAT=!0)}},29279:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var r=a(77231),i=a(4624),n=a(9705);const s="src/avformat/formats/mpegts/function/parsePES.ts";function o(e){const t=e.data,a=t[3],o=t[4]<<8|t[5];let c=0,d=0,l=0;if(188!==a&&190!==a&&191!==a&&240!==a&&241!==a&&255!==a&&242!==a&&248!==a){let a=r.Dh,p=r.Dh;for(;;){if(6+d>=t.length)return n.LR;if(l=t[6+d],255!==l)break;d++}if(64==(192&l)&&(d+=2,l=t[6+d]),32==(224&l))c+=5,a=a=BigInt(Math.floor(536870912*(14&t[6+d])+4194304*(255&t[7+d])+16384*(254&t[8+d])+128*(255&t[9+d])+(254&t[10+d])/2)),16&l?(p=BigInt(Math.floor(536870912*(14&t[11+d])+4194304*(255&t[12+d])+16384*(254&t[13+d])+128*(255&t[14+d])+(254&t[15+d])/2)),c+=5):p=a;else if(128==(192&l)){const e=(192&t[7+d])>>>6;c=3+t[8+d],2!==e&&3!==e||(a=BigInt(Math.floor(536870912*(14&t[9+d])+4194304*(255&t[10+d])+16384*(254&t[11+d])+128*(255&t[12+d])+(254&t[13+d])/2)),p=3===e?BigInt(Math.floor(536870912*(14&t[14+d])+4194304*(255&t[15+d])+16384*(254&t[16+d])+128*(255&t[17+d])+(254&t[18+d])/2)):a)}else{if(15!==l)return i.z3("invalid data",s,122),n.LR;c=1}e.dts=p,e.pts=a;const h=6+d+c;let f=0;if(0!==o){if(o<d+c)return i.z3("Malformed PES: PES_packet_length < 3 + PES_header_data_length",s,134),n.LR;f=o-(d+c),h+(t.byteLength-h)!=o+6&&(i.R8("PES packet size mismatch",s,139),e.flags|=2)}else f=t.byteLength-h;e.payload=t.subarray(h,h+f)}else if((188===a||191===a||240===a||241===a||255===a||242===a||248===a)&&6===e.streamId){const a=6;let r=0;r=0!==o?o:t.byteLength-a,e.payload=t.subarray(a,a+r)}return 0}},39144:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var r=a(6403);function i(e){let t=new Uint8Array(e.totalLength);for(let a=0,r=0;a<e.slices.length;a++){let i=e.slices[a];t.set(i,r),r+=i.byteLength}const a=t[3],i=new r.xf;return i.data=t,i.pid=e.pid,i.streamId=a,i.streamType=e.streamType,i.pos=e.pos,i.randomAccessIndicator=e.randomAccessIndicator,i.flags=0,i}},65945:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var r=a(31865),i=a(6403),n=a(92647),s=a(4624);const o="src/avformat/formats/mpegts/function/parsePMT.ts";function c(e,t){let a=0;const c=new r.A((0,n.A)(Uint8Array,e.slices),!0),d=c.readUint8();2!==d&&s.z3(`parse PMT: table_id ${d} is not corresponded to PAT!`,o,41);const l=4095&c.readUint16(),p=c.readUint16();a=c.readUint8();const h=a>>1&31,f=1&a,u=c.readUint8();let g;if(c.readUint8(),1===f&&0===u)g=new i.I4,g.programNumber=p,g.versionNumber=h,t.program2Pmt.set(p,g),t.hasPMT=!0;else if(g=t.program2Pmt.get(p),!g)return void s.z3("can not found PMT in mpegts context",o,69);g.pcrPid=8191&c.readUint16();const m=4095&c.readUint16();c.skip(m);let A=Number(BigInt.asIntN(32,c.getPos()))+(l-9-m-4);for(;c.getPos()<A;){const e=c.readUint8(),t=8191&c.readUint16(),a=4095&c.readUint16();if(g.pid2StreamType.set(t,e),a>0){const e=[],r=Number(BigInt.asIntN(32,c.getPos()))+a;for(;c.getPos()<r;){const t=new i.kJ;t.tag=c.readUint8();const a=c.readUint8();a>0&&(t.buffer=c.readBuffer(a)),e.push(t)}g.pid2ESDescriptor.set(t,e)}}p===t.currentProgram&&(t.pmt||s.pq("parsed first PMT",o,112),t.pmt=g)}},43383:(e,t,a)=>{"use strict";function r(e,t){}a.d(t,{A:()=>r})},63599:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var r=a(20549),i=a(65945),n=a(43383);function s(e,t,a){0===e?(0,r.A)(t,a):e===a.currentPmtPid?(0,i.A)(t,a):a.pmt&&134===a.pmt.pid2StreamType.get(e)&&(0,n.A)(t,a)}},53783:(e,t,a)=>{"use strict";a.d(t,{$:()=>p,q:()=>l});var r=a(27274),i=a(89564),n=a(4624),s=a(6403),o=a(31239),c=a(20576);const d="src/avformat/formats/mpegts/impegts.ts";async function l(e){let t;try{t=await e.peekBuffer(r.pm)}catch(a){-1048576!==e.error&&(t=await e.peekBuffer(e.remainingLength()))}if(t&&t.length>=r.ZT){const e=(0,i.A)(t,r.ZT,!1),a=(0,i.A)(t,r.VG,!1),s=(0,i.A)(t,r.eR,!1);let o=(0,c.A)([e,s,a]);t.length<r.pm&&(o+=r.hY);let l=r.ZT;return e>o?l=r.ZT:a>o?l=r.VG:s>o&&(l=r.eR),n.Yz(`got ts packet size: ${l}`,d,70),l}return 0}async function p(e,t){const a=e.getPos();let i=0;t.tsPacketSize===r.VG&&await e.skip(4);const c=await e.readUint8();71!==c&&n.h2(`found syncByte not 0x47, value: ${c.toString(16)}`,d,90);const l=new s.am;l.pos=a,i=await e.readUint16(),l.payloadUnitStartIndicator=i>>14&1,l.transportPriority=i>>13&1,l.pid=8191&i,i=await e.readUint8(),l.adaptationFieldControl=i>>4&3,l.continuityCounter=15&i;let p=4;if(2===l.adaptationFieldControl||3===l.adaptationFieldControl){const a=await e.readUint8();if(5+a===r.ZT)return(0,o.A)(await e.readBuffer(a),l),t.tsPacketSize===r.eR&&await e.skip(16),l;a>0&&(0,o.A)(await e.readBuffer(a),l),p=5+a}return 1!==l.adaptationFieldControl&&3!==l.adaptationFieldControl||(l.payload=await e.readBuffer(r.ZT-p)),t.tsPacketSize===r.eR&&await e.skip(16),l}},27274:(e,t,a)=>{"use strict";a.d(t,{$x:()=>p,GV:()=>s,OS:()=>d,VG:()=>i,ZT:()=>n,eR:()=>r,hY:()=>c,pm:()=>o,qJ:()=>l});const r=204,i=192,n=188,s=204,o=8192,c=5,d=5,l=10,p={15:[1,86018],17:[1,86018],3:[1,86017],4:[1,86017],1:[0,2],2:[0,2],27:[0,27],16:[0,12],36:[0,173],51:[0,196],129:[1,86019],135:[1,86056],130:[1,86020]}},6403:(e,t,a)=>{"use strict";a.d(t,{Cd:()=>l,I4:()=>f,am:()=>c,kJ:()=>h,pi:()=>d,xf:()=>u,yU:()=>p});var r=a(49859),i=a(74707),n=a.n(i),s=a(77231);class o{constructor(){(0,r.A)(this,"discontinuityIndicator",0),(0,r.A)(this,"randomAccessIndicator",0),(0,r.A)(this,"elementaryStreamPriorityIndicator",0),(0,r.A)(this,"pcrFlag",0),(0,r.A)(this,"opcrFlag",0),(0,r.A)(this,"splicingPointFlag",0),(0,r.A)(this,"transportPrivateDataFlag",0),(0,r.A)(this,"adaptationFieldExtensionFlag",0),(0,r.A)(this,"pcr",BigInt(0)),(0,r.A)(this,"opcr",BigInt(0)),(0,r.A)(this,"spliceCountDown",0),(0,r.A)(this,"transportPrivateData",null),(0,r.A)(this,"extension",null)}}class c{constructor(){(0,r.A)(this,"pos",s.Dh),(0,r.A)(this,"payloadUnitStartIndicator",0),(0,r.A)(this,"transportPriority",0),(0,r.A)(this,"pid",s.N_),(0,r.A)(this,"adaptationFieldControl",0),(0,r.A)(this,"continuityCounter",0),(0,r.A)(this,"transportScramblingControl",0),(0,r.A)(this,"adaptationFieldInfo",new o),(0,r.A)(this,"payload",null)}}class d{constructor(){(0,r.A)(this,"slices",[]),(0,r.A)(this,"totalLength",0),(0,r.A)(this,"expectedLength",s.N_),(0,r.A)(this,"randomAccessIndicator",0),(0,r.A)(this,"pid",s.N_),(0,r.A)(this,"streamType",0),(0,r.A)(this,"pos",s.Dh)}}class l{constructor(){(0,r.A)(this,"versionNumber",0),(0,r.A)(this,"networkPid",s.N_),(0,r.A)(this,"program2PmtPid",new(n()))}}class p extends c{}class h{constructor(){(0,r.A)(this,"tag",void 0),(0,r.A)(this,"buffer",void 0)}}class f{constructor(){(0,r.A)(this,"versionNumber",0),(0,r.A)(this,"programNumber",0),(0,r.A)(this,"pcrPid",0),(0,r.A)(this,"pid2StreamType",new(n())),(0,r.A)(this,"pid2ESDescriptor",new(n()))}}class u{constructor(){(0,r.A)(this,"pid",s.N_),(0,r.A)(this,"streamType",0),(0,r.A)(this,"streamId",s.N_),(0,r.A)(this,"dts",s.Dh),(0,r.A)(this,"pts",s.Dh),(0,r.A)(this,"pos",s.Dh),(0,r.A)(this,"payload",null),(0,r.A)(this,"data",null),(0,r.A)(this,"randomAccessIndicator",0),(0,r.A)(this,"flags",void 0)}}},2187:(e,t,a)=>{"use strict";a.d(t,{d:()=>s});var r=a(72739),i=a(44328),n=a(77231);function s(e,t,a){let s=BigInt(0);return r.__(e,(e=>{s+=e.codecpar.bitrate*(0,i.k)(t,a,n.i0)/BigInt(8e3)})),s}},52071:(e,t,a)=>{"use strict";a.d(t,{A:()=>f});var r=a(52730),i=a.n(r),n=a(63939),s=(a(9599),a(77231)),o=a(44328),c=a(2187),d=a(71517),l=a(9705),p=a(4624);const h="src/avformat/function/seekInBytes.ts";async function f(e,t,a,r,f,u){const g=e.ioReader.getPos(),m=await e.ioReader.fileSize();let A=s.Dh,y=a;t.startTime!==s.Dh?y-=t.startTime:y-=t.firstDTS;const I=(0,o.k)(a,t.timeBase,s.i0);if(I<BigInt(1e4))return p.Yz(`seek pts is earlier then 10s, seek to first packet pos(${r}) directly`,h,64),await e.ioReader.seek(r),g;let x=(0,c.d)(e.streams,y,t.timeBase);const P=m-(0,c.d)(e.streams,BigInt(1e4),s.i0),b=(0,c.d)(e.streams,BigInt(1e4),s.i0);if(x>P&&(x=P),x<r)return await e.ioReader.seek(r),g;const S=(0,d._5)();let M=m,k=BigInt(0);e:for(;M-k<b&&(x=k),await e.ioReader.seek(x),await u(e),!(8&i()(e.ioReader));){let a=await f(e,S),r=n.f[17](S+56);if(!(a>=0)){A=s.Dh;break}{const i=(0,o.Mr)(n.f[17](S+8),S+72,s.i0);let c=i-I;if(p.Yz(`try to seek to pos: ${x}, got packet pts: ${n.f[17](S+8)}(${i}ms), diff: ${c}ms`,h,101),c<=BigInt(0)&&-c<BigInt(1e4)||M-k<b){const i=[r];for(;c<=0;){if(n.f[15](S+32)===t.index&&1&n.f[15](S+36)&&i.push(r),(0,d.Up)(S),a=await f(e,S),a<0){if(-1048576===a)break;if(-1048575===a)continue;A=s.Dh;break e}r=n.f[17](S+56),c=(0,o.Mr)(n.f[17](S+8),S+72,s.i0)-I}A=i.pop();break}c>BigInt(0)?(M=x,x=k+M>>BigInt(1)):(k=x,x=k+M>>BigInt(1))}if(8&i()(e.ioReader))break}return(0,d.Qe)(S),A!==s.Dh?(p.Yz(`finally seek to pos ${A}`,h,156),await e.ioReader.seek(A),await u(e),g):(await e.ioReader.seek(g),8&i()(e.ioReader)?BigInt(l.LT):BigInt(l.E$))}},95832:(e,t,a)=>{"use strict";a.d(t,{Bq:()=>h,En:()=>c,Hm:()=>s,Ij:()=>p,XC:()=>l,_5:()=>d,f7:()=>f,hY:()=>o,uF:()=>n});var r=a(77231),i=a(37246);const n={1:"Main",2:"LC",3:"SSR",4:"LTP",5:"HE",6:"SCALABLE",29:"HEv2",23:"LD",39:"ELD"},s={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},o=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,r.N_,r.N_,r.N_],c=[r.N_,1,2,3,4,5,6,7];function d(e){let t=r.N_,a=r.N_,i=r.N_;return e.length>=2&&(t=e[0]>>3&31,a=o[(7&e[0])<<1|e[1]>>7],i=c[e[1]>>3&15]),{profile:t,sampleRate:a,channels:i}}function l(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t){const{profile:a,sampleRate:r,channels:i}=d(t);e.codecpar.profile=a,e.codecpar.sampleRate=r,e.codecpar.chLayout.nbChannels=i,e.codecpar.frameSize=5===a?2048:1024,e.codecpar.format=8}}function p(e){const t=s[e.sampleRate],a=e.chLayout.nbChannels,i=e.profile===r.N_?2:e.profile,n=new Uint8Array(2);return n[0]=(31&i)<<3|(14&t)>>1,n[1]=(1&t)<<7|(15&a)<<3,n}function h(e){if(e.length<7)return-1;const t=e[0]<<4|e[1]>>4;if(4095!==t)return-1;const a=1&e[1],r=(192&e[2])>>>6,i=(60&e[2])>>>2,n=(1&e[2])<<2|(192&e[3])>>>6,s=(3&e[3])<<11|e[4]<<3|(224&e[5])>>>5,d=3&e[6];let l=1===a?7:9,p=s-l;return{syncWord:t,profile:r+1,sampleRate:o[i],channels:c[n],aacFrameLength:s,numberOfRawDataBlocksInFrame:d,headerLength:l,framePayloadLength:p}}function f(e,t){function a(){const e=t.readU(2);let a=0;for(let r=0;r<=e;r++)a<<=8,a|=t.readU(8);return a}t||(t=new i.A).appendBuffer(e);const r=t.getPointer(),n={syncWord:0,profile:0,sampleRate:0,channels:0,useSameStreamMux:!1,headerLength:0,framePayloadLength:0,muxLengthBytes:0},s=t.readU(11);if(695!==s)return-1;n.syncWord=s,n.muxLengthBytes=t.readU(13);const d=1===t.readU1();if(n.useSameStreamMux=d,!d){const e=1===t.readU1();if(e&&1===t.readU1())return-1;if(e&&a(),1!==t.readU1())return-1;if(0!==t.readU(6))return-1;if(0!==t.readU(4))return-1;if(0!==t.readU(3))return-1;let r=e?a():0;const i=t.readU(5);r-=5;const s=t.readU(4);r-=4;const d=t.readU(4);if(r-=4,t.readU(3),r-=3,r>0&&t.readU(r),0!==t.readU(3))return-1;if(t.readU(8),1===t.readU1())if(e)a();else{let e=0;for(;;){e<<=8;const a=1===t.readU1();if(e+=t.readU(8),!a)break}}1===t.readU1()&&t.readU(8),n.profile=i+1,n.sampleRate=o[s],n.channels=c[d]}let l=0;for(;;){const e=t.readU(8);if(l+=e,255!==e)break}return n.framePayloadLength=l,n.headerLength=t.getPointer()-r+(8===t.getBitLeft()?0:1),n}},87518:(e,t,a)=>{"use strict";a.d(t,{R:()=>f,j:()=>i});var r=a(37246);const i=[3,4,3,7,259,263,1539,1543],n=[[64,69,96],[64,70,96],[80,87,120],[80,88,120],[96,104,144],[96,105,144],[112,121,168],[112,122,168],[128,139,192],[128,140,192],[160,174,240],[160,175,240],[192,208,288],[192,209,288],[224,243,336],[224,244,336],[256,278,384],[256,279,384],[320,348,480],[320,349,480],[384,417,576],[384,418,576],[448,487,672],[448,488,672],[512,557,768],[512,558,768],[640,696,960],[640,697,960],[768,835,1152],[768,836,1152],[896,975,1344],[896,976,1344],[1024,1114,1536],[1024,1115,1536],[1152,1253,1728],[1152,1254,1728],[1280,1393,1920],[1280,1394,1920]],s=[4,5,6,5],o=[4,6,7,6],c=[48e3,44100,32e3,0],d=[32,40,48,56,64,80,96,112,128,160,192,224,256,320,384,448,512,576,640],l=[2,1,2,3,3,4,4,5],p=[1,2,3,6],h=7;function f(e){const t=new r.A(e.length);t.appendBuffer(e);const a={syncWord:0,crc1:0,srCode:0,bitstreamId:0,bitstreamMode:0,channelMode:0,lfeOn:0,frameType:0,substreamId:0,centerMixLevel:0,surroundMixLevel:0,channelMap:0,numBlocks:0,dolbySurroundMode:0,srShift:0,sampleRate:0,bitrate:0,channels:0,frameSize:0,channelLayout:BigInt(0),ac3BitrateCode:0};if(a.syncWord=t.readU(16),2935!==a.syncWord)return-1;if(a.bitstreamId=31&t.peekU(29),a.bitstreamId>16)return-2;if(a.numBlocks=6,a.ac3BitrateCode=-1,a.centerMixLevel=5,a.surroundMixLevel=6,a.dolbySurroundMode=0,a.bitstreamId<=10){if(a.crc1=t.readU(16),a.srCode=t.readU(2),3===a.srCode)return-3;const e=t.readU(6);if(e>37)return-4;a.ac3BitrateCode=e>>1,t.readU(5),a.bitstreamMode=t.readU(3),a.channelMode=t.readU(3),2==a.channelMode?a.dolbySurroundMode=t.readU(2):(1&a.channelMode&&1!=a.channelMode&&(a.centerMixLevel=s[t.readU(2)]),4&a.channelMode&&(a.surroundMixLevel=o[t.readU(2)])),a.lfeOn=t.readU(1),a.srShift=Math.max(a.bitstreamId,8)-8,a.sampleRate=c[a.srCode]>>a.srShift,a.bitrate=1e3*d[a.ac3BitrateCode]>>a.srShift,a.channels=l[a.channelMode]+a.lfeOn,a.frameSize=2*n[e][a.srCode],a.frameType=2,a.substreamId=0}else{if(a.crc1=0,a.frameType=t.readU(2),3==a.frameType)return-5;if(a.substreamId=t.readU(3),a.frameSize=t.readU(11)+1<<1,a.frameSize<h)return-6;if(a.srCode=t.readU(2),3==a.srCode){const e=t.readU(2);if(3==e)return-7;a.sampleRate=c[e]/2,a.srShift=1}else a.numBlocks=p[t.readU(2)],a.sampleRate=c[a.srCode],a.srShift=0;a.channelMode=t.readU(3),a.lfeOn=t.readU(1),a.bitrate=8*a.frameSize*a.sampleRate/(256*a.numBlocks),a.channels=l[a.channelMode]+a.lfeOn}return a.channelLayout=BigInt(i[a.channelMode]),a.lfeOn&&(a.channelLayout|=BigInt(8)),a}},43290:(e,t,a)=>{"use strict";a.d(t,{R:()=>d,u:()=>c});var r=a(37246),i=a(95073);const n=[1,2,2,2,2,3,3,4,4,5,6,6,6,7,8,8],s=[0,8e3,16e3,32e3,0,0,11025,22050,44100,0,0,12e3,24e3,48e3,96e3,192e3],o=[32e3,56e3,64e3,96e3,112e3,128e3,192e3,224e3,256e3,32e4,384e3,448e3,512e3,576e3,64e4,768e3,96e4,1024e3,1152e3,128e4,1344e3,1408e3,1411200,1472e3,1536e3,192e4,2048e3,3072e3,384e4,0,0,0],c=32;function d(e){const t=new r.A(e.length);t.appendBuffer(e);const a={syncWord:0,frameType:0,deficitSamples:0,crcFlag:0,sampleBlock:0,frameSize:0,channelIndex:0,sampleRateIndex:0,bitrateIndex:0,channels:0,sampleRate:0,bitrate:0};return a.syncWord=t.readU(32),2147385345!==a.syncWord&&4269736320!==a.syncWord?-1:(a.frameType=t.readU1(),a.deficitSamples=t.readU(5)+1,a.crcFlag=t.readU1(),a.sampleBlock=t.readU(7)+1,a.frameSize=(0,i.A)(t.readU(14)+1,4),a.channelIndex=t.readU(6),a.sampleRateIndex=t.readU(4),a.bitrateIndex=t.readU(5),a.channels=n[a.channelIndex],a.sampleRate=s[a.sampleRateIndex],a.bitrate=o[a.bitrateIndex],a)}},64093:(e,t,a)=>{"use strict";a.d(t,{Au:()=>y,He:()=>I,XC:()=>x,Y2:()=>g,hG:()=>m,oz:()=>A});var r=a(77231);const i=[44100,48e3,32e3,0],n=[22050,24e3,16e3,0],s=[11025,12e3,8e3,0],o=[0,1152,1152,384],c=[0,576,1152,384],d=[0,576,1152,384],l=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],p=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],h=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],f=[0,32,48,56,64,80,96,112,128,144,160,176,192,224,256,-1],u=[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1];function g(e,t){switch(e){case 0:return s[t];case 2:return n[t];case 3:return i[t]}return r.N_}function m(e,t){switch(e){case 0:return d[t];case 2:return c[t];case 3:return o[t]}return r.N_}function A(e,t,a){switch(t){case 1:switch(e){case 0:case 2:return u[a];case 3:return h[a]}break;case 2:switch(e){case 0:case 2:return u[a];case 3:return p[a]}case 3:switch(e){case 0:case 2:return f[a];case 3:return l[a]}}return r.N_}function y(e){switch(e){case 1:return 34;case 2:return 33;case 3:return 32}return r.N_}const I={32:"Layer1",33:"Layer2",34:"Layer3"};function x(e,t){if(t&&t.length>=4){const a=t[1]>>>3&3,r=(6&t[1])>>1,i=(12&t[2])>>>2,n=3&~(t[3]>>>6)?2:1,s=y(r),o=g(a,i);e.codecpar.profile=s,e.codecpar.sampleRate=o,e.codecpar.chLayout.nbChannels=n}}},22576:(e,t,a)=>{"use strict";a.d(t,{Ij:()=>d,XC:()=>c,kt:()=>o});var r=a(31865),i=a(729),n=a(44328);const s=[480,960,1920,2880,480,960,1920,2880,480,960,1920,2880,480,960,480,960,120,240,480,960,120,240,480,960,120,240,480,960,120,240,480,960];function o(e){let t=0,a=0,r=0;if(e.length<1)return 0;switch(t=e[0],a=s[t>>3],3&t){case 0:r=1;break;case 1:case 2:r=2;break;case 3:if(e.length<2)return 0;r=63&e[1]}return r*a}function c(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=19){const a=new r.A(t,!1);a.skip(9),e.codecpar.chLayout.nbChannels=a.readUint8(),e.codecpar.initialPadding=a.readUint16(),e.codecpar.sampleRate=a.readUint32(),e.codecpar.seekPreroll=Number((0,n.k)(BigInt(80),{den:1e3,num:1},{den:48e3,num:1}))}}function d(e){const t=new Uint8Array(19),a=new i.A(t,!1);return a.writeString("OpusHead"),a.writeUint8(1),a.writeUint8(e.chLayout.nbChannels),a.writeUint16(e.initialPadding),a.writeUint32(e.sampleRate),t}},20576:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var r=a(129),i=a.n(r),n=a(18979),s=a.n(n);function o(e){var t;if(0===e.length)return 0;const a=i()(t=s()(e).call(e)).call(t,((e,t)=>e-t)),r=Math.floor(a.length/2);return a.length%2==1?a[r]:(a[r-1]+a[r])/2}},6707:(e,t,a)=>{e.exports=a(49124)},27341:(e,t,a)=>{"use strict";a(99363),a(86024);var r=a(61747);e.exports=r("Array","values")},73592:(e,t,a)=>{"use strict";var r=a(27341);e.exports=r},49124:(e,t,a)=>{"use strict";a(12560);var r=a(73948),i=a(49724),n=a(88280),s=a(73592),o=Array.prototype,c={DOMTokenList:!0,NodeList:!0};e.exports=function(e){var t=e.values;return e===o||n(o,e)&&t===o.values||i(c,r(e))?s:t}}}]);