"use strict";(self.webpackChunkAVTranscoder=self.webpackChunkAVTranscoder||[]).push([[839],{85947:(e,t,i)=>{i.d(t,{A:()=>r});var a=i(49859);class r{constructor(){(0,a.A)(this,"type",-1),(0,a.A)(this,"onStreamAdd",void 0)}async destroy(e){}}},6839:(e,t,i)=>{i.r(t),i.d(t,{default:()=>P});var a=i(49859),r=i(52730),s=i.n(r),n=i(14686),o=i(61499),c=i(63939),d=i(50932),h=(i(9599),i(4624)),f=i(85947),l=i(37837),p=i(71517),g=i(77231),m=i(50011),u=i(64093),w=i(44328),I=i(31608),B=i(43607),b=i(72739),k=i(19028),R=i(75294),S=i(9705),T=i(67672);const x="src/avformat/formats/IMp3Format.ts";class P extends f.A{constructor(){super(),(0,a.A)(this,"type",14),(0,a.A)(this,"context",void 0)}init(e){e.ioReader&&e.ioReader.setEndian(!0),this.context={firstFramePos:g.Dh,isVBR:!1,hasID3v1:!1,id3v2:{version:g.N_,revision:g.N_,flags:g.N_},fileSize:BigInt(0)}}async parseID3(e,t){if("ID3"===await e.ioReader.peekString(3)){await e.ioReader.skip(3),this.context.id3v2.version=await e.ioReader.readUint8(),this.context.id3v2.revision=await e.ioReader.readUint8(),this.context.id3v2.flags=await e.ioReader.readUint8();const i=(127&await e.ioReader.readUint8())<<21|(127&await e.ioReader.readUint8())<<14|(127&await e.ioReader.readUint8())<<7|127&await e.ioReader.readUint8();await k.qg(e.ioReader,i,this.context.id3v2,e.metadata),e.metadata.apic&&(k.hm(e,e.metadata.apic,this.context.id3v2),delete e.metadata.apic),T.o(t.metadata["com.apple.streaming.transportStreamTimestamp"])&&(t.privData.nextDTS=(0,w.k)(t.metadata["com.apple.streaming.transportStreamTimestamp"],{num:1,den:9e4},t.timeBase))}}async readHeader(e){const t=e.createStream();t.codecpar.codecId=86017,t.codecpar.codecType=1,t.startTime=BigInt(0),t.firstDTS=BigInt(0);const i={frameHeader:new R.Vz,nbFrame:BigInt(0),tocIndexes:[],nextDTS:BigInt(0),frameLength:0};t.privData=i;const a=await e.ioReader.fileSize();if(1&s()(e.ioReader)&&!(2&s()(e.ioReader))&&a>I.c1&&(await e.ioReader.seek(a-BigInt(I.c1)),"TAG"===await e.ioReader.readString(3))){const t=e.metadata={};let i=await e.ioReader.readBuffer(30);t.title=m.decode(i).replace(/\s/g,""),i=await e.ioReader.readBuffer(30),t.artist=m.decode(i).replace(/\s/g,""),i=await e.ioReader.readBuffer(30),t.album=m.decode(i).replace(/\s/g,""),i=await e.ioReader.readBuffer(4),t.date=m.decode(i).replace(/\s/g,""),i=await e.ioReader.readBuffer(30),t.comment=m.decode(i).replace(/\s/g,""),0===i[28]&&0!==i[29]&&(t.track=i[29]+""),t.genre=await e.ioReader.readUint8(),this.context.hasID3v1=!0}for(await e.ioReader.seek(BigInt(0)),await this.parseID3(e,t),this.context.firstFramePos=e.ioReader.getPos();65504&~await e.ioReader.peekUint16();)await e.ioReader.skip(1);this.context.firstFramePos!==e.ioReader.getPos()&&(h.R8(`skipping ${e.ioReader.getPos()-this.context.firstFramePos} bytes of junk at ${this.context.firstFramePos}`,x,194),this.context.firstFramePos=e.ioReader.getPos()),t.codecpar.extradataSize=4,t.codecpar.extradata=(0,l.sY)(t.codecpar.extradataSize),await e.ioReader.peekBuffer(t.codecpar.extradataSize,(0,n.JW)(t.codecpar.extradata,t.codecpar.extradataSize)),R.qg(i.frameHeader,await e.ioReader.readUint32()),t.codecpar.profile=u.Au(i.frameHeader.layer),t.codecpar.frameSize=u.hG(i.frameHeader.version,i.frameHeader.layer),t.codecpar.sampleRate=u.Y2(i.frameHeader.version,i.frameHeader.samplingFrequency),t.timeBase.num=1,t.timeBase.den=t.codecpar.sampleRate;const r=3===i.frameHeader.mode?1:2;t.codecpar.chLayout.nbChannels=r;const o=BigInt(Math.floor(u.oz(i.frameHeader.version,i.frameHeader.layer,i.frameHeader.bitrateIndex))),c=R.CM(i.frameHeader,t.codecpar.sampleRate),d=e.ioReader.getPos();await e.ioReader.skip([[0,9,17],[0,0,0],[0,9,17],[0,17,32]][i.frameHeader.version][t.codecpar.chLayout.nbChannels]);const f=await e.ioReader.readString(4);if("Xing"===f||"Info"===f){this.context.isVBR=!0;const r=await e.ioReader.readUint32();1&r&&(i.nbFrame=BigInt(Math.floor(await e.ioReader.readUint32()))),2&r&&(this.context.fileSize=BigInt(Math.floor(await e.ioReader.readUint32())));const s=a>=d?a-d:BigInt(0);if(s&&this.context.fileSize){const e=B.jk(s,this.context.fileSize),t=B.T9(s,this.context.fileSize)-e;s>this.context.fileSize&&t>e>>BigInt(4)?(i.nbFrame=BigInt(0),h.R8("invalid concatenated file detected - using bitrate for duration",x,247)):t>e>>BigInt(4)&&h.R8("filesize and duration do not match (growing file?)",x,250)}if(t.duration=i.nbFrame*BigInt(0|t.codecpar.frameSize),4&r)for(let a=0;a<I.W8;a++){const r=await e.ioReader.readUint8(),s=this.context.fileSize*BigInt(Math.floor(r))/BigInt(256),n={dts:t.duration/BigInt(I.W8)*BigInt(Math.floor(a)),pos:s};i.tocIndexes.push(n)}8&r&&await e.ioReader.skip(4),t.metadata.encoder=await e.ioReader.readString(9),this.context.firstFramePos+=BigInt(Math.floor(c))}else await e.ioReader.seek(d),"VBRI"===await e.ioReader.readString(4)?(1===await e.ioReader.readUint16()&&(await e.ioReader.skip(4),this.context.fileSize=BigInt(Math.floor(await e.ioReader.readUint32())),i.nbFrame=BigInt(Math.floor(await e.ioReader.readUint32())),t.duration=i.nbFrame*BigInt(0|t.codecpar.frameSize)),this.context.firstFramePos+=BigInt(Math.floor(c))):(this.context.isVBR=!1,t.codecpar.bitrate=o*BigInt(1e3),a&&(i.nbFrame=(a-this.context.firstFramePos-BigInt(I.c1))/BigInt(Math.floor(c)),t.duration=i.nbFrame*BigInt(0|t.codecpar.frameSize)),i.frameLength=c,this.context.fileSize=a);for(await e.ioReader.seek(this.context.firstFramePos);65504&~await e.ioReader.peekUint16();)await e.ioReader.skip(1);if(this.context.firstFramePos!==e.ioReader.getPos()&&(h.R8(`skipping ${e.ioReader.getPos()-this.context.firstFramePos} bytes of junk at ${this.context.firstFramePos}`,x,312),this.context.firstFramePos=e.ioReader.getPos()),i.tocIndexes.length)for(let e=0;e<I.W8;e++)i.tocIndexes[e].pos+=this.context.firstFramePos;return i.nbFrame&&(t.nbFrames=i.nbFrame),0}async readAVPacket(e,t){const i=e.getStreamByMediaType(1),a=i.privData,r=e.ioReader.getPos();if(this.context.hasID3v1&&r>=this.context.fileSize-BigInt(I.c1))return-1048576;try{2&s()(e.ioReader)&&await this.parseID3(e,i),R.qg(a.frameHeader,await e.ioReader.peekUint32());const h=R.CM(a.frameHeader,i.codecpar.sampleRate),f=u.hG(a.frameHeader.version,a.frameHeader.layer);d.M[15](t+28,h),d.M[17](t+56,r),d.M[15](t+32,i.index),(0,n.Mr)(t+72,i.timeBase[o.o9],8),d.M[17](t+48,BigInt(Math.floor(f))),d.M[17](t+16,a.nextDTS),d.M[17](t+8,a.nextDTS),d.M[15](t+36,1|c.f[15](t+36)),a.nextDTS+=BigInt(Math.floor(f));const g=(0,l.sY)(h);return(0,p.NX)(t,g,h),await e.ioReader.readBuffer(h,(0,n.JW)(g,h)),0}catch(t){return-1048576!==e.ioReader.error&&-1048572!==e.ioReader.error&&h.z3(t.message,x,371),e.ioReader.error}}async syncToFrame(e){let t=g.Dh;const i=e.getStreamByMediaType(1),a=i.privData;for(;;)try{if(!(65504&~await e.ioReader.peekUint16())){t=e.ioReader.getPos(),R.qg(a.frameHeader,await e.ioReader.peekUint32());let r=this.context.isVBR?R.CM(a.frameHeader,i.codecpar.sampleRate):a.frameLength;if(r>512e3){await e.ioReader.skip(1);continue}await e.ioReader.skip(r);let s=0;for(;s<=3&&!(65504&~await e.ioReader.peekUint16());){R.qg(a.frameHeader,await e.ioReader.peekUint32());let t=this.context.isVBR?R.CM(a.frameHeader,i.codecpar.sampleRate):a.frameLength;await e.ioReader.skip(t),s++}if(!(s<3))break;await e.ioReader.seek(t+BigInt(1)),t=g.Dh}await e.ioReader.skip(1)}catch(e){break}t!==g.Dh&&await e.ioReader.seek(t)}async seek(e,t,i,a){const r=e.ioReader.getPos(),n=t.privData;if(16&a&&2&s()(e.ioReader)){const a=(0,w.k)(i,t.timeBase,g.i0);return await e.ioReader.seek(a,!0),n.nextDTS=i,BigInt(0)}if(2&a){const s=await e.ioReader.fileSize();return s<=BigInt(0)?BigInt(S.E$):(i<BigInt(0)?i=BigInt(0):i>s&&(i=s),await e.ioReader.seek(i),4&a||(await this.syncToFrame(e),t.duration&&t.duration!==g.Dh&&s&&(n.nextDTS=i/s*t.duration)),r)}if(t.sampleIndexes.length){let a=b.El(t.sampleIndexes,(e=>e.pts>i?-1:1));if(a>0&&(0,w.k)(i-t.sampleIndexes[a-1].pts,t.timeBase,g.i0)<BigInt(1e4))return h.Yz(`seek in sampleIndexes, found index: ${a}, pts: ${t.sampleIndexes[a-1].pts}, pos: ${t.sampleIndexes[a-1].pos}`,x,486),await e.ioReader.seek(t.sampleIndexes[a-1].pos),n.nextDTS=t.sampleIndexes[a-1].dts,r}if(i===BigInt(0))return await e.ioReader.seek(this.context.firstFramePos),r;if(this.context.isVBR)if(n.tocIndexes.length){const a=n.tocIndexes[Number(BigInt.asIntN(32,i/(t.duration/BigInt(I.W8))))];if(a)h.Yz(`seek in xing toc indexes, pts: ${a.dts}, pos: ${a.pos}`,x,502),await e.ioReader.seek(a.pos),n.nextDTS=a.dts;else{h.Yz("not found any keyframe index, try to seek in bytes",x,507);const a=R.CM(n.frameHeader,t.codecpar.sampleRate),r=i/BigInt(0|t.codecpar.frameSize),s=r*BigInt(Math.floor(a))+this.context.firstFramePos;n.nextDTS=r*BigInt(0|t.codecpar.frameSize),await e.ioReader.seek(s)}}else{h.Yz("not found any keyframe index, try to seek in bytes",x,516);const a=R.CM(n.frameHeader,t.codecpar.sampleRate),r=i/BigInt(0|t.codecpar.frameSize),s=r*BigInt(Math.floor(a))+this.context.firstFramePos;n.nextDTS=r*BigInt(0|t.codecpar.frameSize),await e.ioReader.seek(s)}else{const a=i/BigInt(0|t.codecpar.frameSize),r=a*BigInt(0|n.frameLength)+this.context.firstFramePos;n.nextDTS=a*BigInt(0|t.codecpar.frameSize),await e.ioReader.seek(r)}return await this.syncToFrame(e),r}getAnalyzeStreamsCount(){return 1}}},75294:(e,t,i)=>{i.d(t,{CM:()=>o,Vz:()=>s,qg:()=>n});var a=i(49859),r=i(64093);class s{constructor(){(0,a.A)(this,"version",void 0),(0,a.A)(this,"layer",void 0),(0,a.A)(this,"protection",void 0),(0,a.A)(this,"bitrateIndex",void 0),(0,a.A)(this,"samplingFrequency",void 0),(0,a.A)(this,"padding",void 0),(0,a.A)(this,"private",void 0),(0,a.A)(this,"mode",void 0),(0,a.A)(this,"modeExtension",void 0),(0,a.A)(this,"copyright",void 0),(0,a.A)(this,"original",void 0),(0,a.A)(this,"emphasis",void 0)}}function n(e,t){e.version=t>>19&3,e.layer=t>>17&3,e.protection=t>>16&1,e.bitrateIndex=t>>12&15,e.samplingFrequency=t>>10&3,e.padding=t>>9&1,e.mode=t>>6&3,e.modeExtension=t>>4&3,e.copyright=t>>3&1,e.original=t>>2&1,e.emphasis=3&t}function o(e,t){let i=r.oz(e.version,e.layer,e.bitrateIndex);switch(e.layer){case 1:default:i=144e3*i/(t<<(3===e.version?0:1))>>>0,i+=e.padding;break;case 2:i=144e3*i/t>>>0,i+=e.padding;break;case 3:i=12e3*i/t>>>0,i=4*(i+e.padding)}return i}},19028:(e,t,i)=>{i.d(t,{In:()=>P,M9:()=>C,VO:()=>D,fz:()=>v,hm:()=>F,qg:()=>M});var a=i(52730),r=i.n(a),s=i(86226),n=i.n(s),o=i(18979),c=i.n(o),d=i(5496),h=i.n(d),f=i(64007),l=i.n(f),p=i(63939),g=i(50932),m=i(4624),u=i(50011),w=i(35336),I=i(31865),B=i(71517),b=i(37837),k=i(14686),R=i(72739),S=i(95335),T=i(92647);const x="src/avformat/formats/mp3/id3v2.ts",P={JPG:7,PNG:61,"image/gif":97,"image/jpeg":7,"image/jpg":7,"image/png":61,"image/tiff":96,"image/bmp":78,"image/webp":171},v=["Other","32x32 pixels 'file icon'","Other file icon","Cover (front)","Cover (back)","Leaflet page","Media (e.g. label side of CD)","Lead artist/lead performer/soloist","Artist/performer","Conductor","Band/Orchestra","Composer","Lyricist/text writer","Recording Location","During recording","During performance","Movie/video screen capture","A bright coloured fish","Illustration","Band/artist logotype","Publisher/Studio logotype"];function y(e,t){e.writeUint8(t>>21&127),e.writeUint8(t>>14&127),e.writeUint8(t>>7&127),e.writeUint8(127&t)}function U(e,t){let i="utf-8";return 0===e?i="iso-8859-1":1===e?i="utf-16":2===e&&(i="utf-16be"),new TextDecoder(i).decode(t)}function A(e){return(127&e)+((32512&e)>>1)+((8323072&e)>>2)+((2130706432&e)>>3)}async function z(e,t){await e.seek(t);const i=await e.readString(4);return/^[A-Z0-9]+$/.test(i)}async function M(e,t,i,a){const s=2!==i.version,n=s?10:6;let o=e.getPos()+BigInt(0|t);async function c(){await e.skip(Number(BigInt.asIntN(32,o-e.getPos())))}if(s&&64&r()(i)){let a=await async function(e,t){let i=0;for(;t--;)i=(i<<7)+(127&await e.readUint8());return i}(e,4);if(4===i.version&&(a-=4),a<0)return m.z3("invalid extended header length",x,149),await c();if(await e.skip(a),(t-=a+4)<0)return m.z3("extended header too long",x,155),await c()}for(;t>n;){let o,c;if(s){if(o=await e.readString(4),c=await e.readUint32(),!c){m.z3("invalid frame size",x,168);break}if(4===i.version&&c>127)if(c<t){await e.flush();const t=e.getPos();if(!(1&r()(e)||6+c<e.remainingLength()))break;if(await z(e,t+BigInt(2)+BigInt(A(c))))c=A(c);else if(!await z(e,t+BigInt(2)+BigInt(c)))break;await e.seek(t)}else c=A(c);await e.readUint16()}else o=await e.readString(3),c=await e.readUint24();if("APIC"===o)a.apic||(a.apic=[]),a.apic.push(await e.readBuffer(c));else if("USLT"===o){const t=await e.readUint8(),i=await e.readString(3),r=await e.readBuffer(c-4);a.lyrics=`${i} ${U(t,r)}`}else if("COMM"===o||"COM"===o){const t=await e.readUint8(),i=await e.readString(3),r=await e.readBuffer(c-4);a.comment=`${i} ${U(t,r)}`}else if("PRIV"===o){const t=e.getPos(),i=[];for(;;){const t=await e.readUint8();if(0===t)break;i.push(t)}const r=u.decode(new Uint8Array(i));let s;s="com.apple.streaming.transportStreamTimestamp"===r?await e.readUint64():await e.readBuffer(c-Number(e.getPos()-t)),a[r]=s}else{let t;switch(t="T"===o[0]?U(await e.readUint8(),await e.readBuffer(c-1)):await e.readBuffer(c),o){case"TIT2":case"TT2":a.title=t;break;case"TPE1":case"TP1":a.artist=t;break;case"TPE2":case"TP2":a.albumArtist=t;break;case"TPOS":a.disc=t;break;case"TCOP":a.copyright=t;break;case"TALB":case"TAL":a.album=t;break;case"TRCK":case"TRK":a.track=t;break;case"TYER":case"TDRL":case"TDRC":a.date=t;break;case"COMM":case"COM":a.comment=t;break;case"TCON":case"TCO":a.genre=t;break;case"TSSE":case"TEN":a.encoder=t;break;case"TCOM":a.composer=t;break;case"TENC":a.vendor=t;break;case"TLAN":a.language=t;break;case"TPE3":case"TP3":a.performer=t;break;case"TPUB":a.publisher=t;break;case"TCMP":case"TCP":a.compilation=t;break;case"TDEN":a.creationTime=t;break;case"TSOA":a.albumSort=t;break;case"TSOP":a.artistSort=t;break;case"TSOT":a.titleSort=t;break;case"TIT1":a.grouping=t;break;default:a[o]=t}}t-=c+n}4==i.version&&16&r()(i)&&(o+=BigInt(10)),await e.skip(Number(BigInt.asIntN(32,o-e.getPos())))}function F(e,t,i){const a=2!==i.version;n()(t).call(t,(t=>{const i=new I.A(t),r=i.readUint8();let s;function n(){let e=Number(i.getPos());for(;e<t.length&&t[e];)e++;return e}if(a?(s=i.readString(n()-Number(i.getPos())),i.skip(1)):s=i.readString(3),!P[s])return;const o=i.readUint8();let c;const d=n()-Number(i.getPos());d&&(c=U(r,i.readBuffer(d))),i.skip(1);const h=e.createStream();h.codecpar.codecId=P[s],h.codecpar.codecType=0,h.disposition|=1024,h.attachedPic=(0,B._5)(),g.M[15](h.attachedPic+32,h.index);const f=i.remainingSize(),l=(0,b.sY)(f),m=i.readBuffer(f);(0,k.lW)(l,f,m),m.length>=8&&R.FB(m.subarray(0,8),new Uint8Array([137,80,78,71,13,10,26,10]))&&(h.codecpar.codecId=61),(0,B.NX)(h.attachedPic,l,f),g.M[15](h.attachedPic+36,1|p.f[15](h.attachedPic+36)),h.metadata.comment=v[o],c&&(h.metadata.title=c)}))}function C(e,t,i,a){var r;let s=e.getPos();e.writeString("ID3"),e.writeUint8(t),e.writeUint16(0);const o=e.getPos();function d(i,a){const r=u.encode(a);e.writeString(i),4===t?y(e,r.length+1):e.writeUint32(r.length+1),e.writeUint16(0),e.writeUint8(3),e.writeBuffer(r)}function f(i,a){e.writeString(i),4===t?y(e,a.length):e.writeUint32(a.length),e.writeUint16(0),e.writeBuffer(a)}var l;if(e.writeUint32(0),a.poster&&f("APIC",a.poster),a.apic&&n()(l=a.apic).call(l,(e=>{f("APIC",e)})),a.title&&d("TIT2",a.title),a.artist&&d("TPE1",a.artist),a.albumArtist&&d("TPE2","albumArtist"),a.disc&&d("TPOS",a.disc),a.copyright&&d("TCOP",a.copyright),a.album&&d("TALB",a.album),a.track&&d("TRCK",a.track),a.date&&d("TDRC",a.date),a.comment){let e=a.comment;" "===e[3]&&(e=c()(e).call(e,0,3)+c()(e).call(e,4)),d("COMM",e)}if(a.lyrics){let e=a.lyrics;" "===e[3]&&(e=c()(e).call(e,0,3)+c()(e).call(e,4)),d("USLT",e)}a.genre&&d("TCON",a.genre+""),a.encoder&&d("TSSE",a.encoder),a.composer&&d("TCOM",a.composer),a.vendor&&d("TENC",a.vendor),a.language&&d("TLAN",a.language),a.performer&&d("TPE3",a.performer),a.publisher&&d("TPUB",a.publisher),a.compilation&&d("TCMP",a.compilation),a.creationTime&&d("TDEN",a.creationTime),a.albumSort&&d("TSOA",a.albumSort),a.artistSort&&d("TSOP",a.artistSort),a.titleSort&&d("TSOT",a.titleSort),a.grouping&&d("TIT1",a.grouping),i<10&&(i=10);const p=Number(BigInt.asIntN(32,e.getPos()-s));i>268435455-p&&(i=268435455-p),e.writeBuffer(h()(r=new Uint8Array(i)).call(r,0)),s=e.getPos(),e.seek(o),y(e,p),e.seek(s)}function D(e,t){var i;const a=[],r=new w.A,s=[];r.onFlush=e=>(s.push(c()(e).call(e)),0);const o=2!==t;return n()(i=e.streams).call(i,(e=>{if(1024&e.disposition&&(o&&(7===e.codecpar.codecId||61===e.codecpar.codecId||96===e.codecpar.codecId||97===e.codecpar.codecId||171===e.codecpar.codecId||78===e.codecpar.codecId)||!o&&(61===e.codecpar.codecId||7===e.codecpar.codecId))&&e.attachedPic){s.length=0,r.writeUint8(3),o?(r.writeString(S.BE(P)[e.codecpar.codecId]),r.writeUint8(0)):61===e.codecpar.codecId?r.writeString("PNG"):r.writeString("JPG");let t=0;e.metadata.comment&&l()(v).call(v,e.metadata.comment)>-1&&(t=l()(v).call(v,e.metadata.comment)),r.writeUint8(t),e.metadata.description&&r.writeString(e.metadata.description),r.writeUint8(0),r.writeBuffer((0,B.iI)(e.attachedPic)),r.flush(),a.push((0,T.A)(Uint8Array,s))}})),a}},31608:(e,t,i)=>{i.d(t,{FN:()=>s,W8:()=>a,c1:()=>r});const a=100,r=128,s=156},64093:(e,t,i)=>{i.d(t,{Au:()=>I,He:()=>B,XC:()=>b,Y2:()=>m,hG:()=>u,oz:()=>w});var a=i(77231);const r=[44100,48e3,32e3,0],s=[22050,24e3,16e3,0],n=[11025,12e3,8e3,0],o=[0,1152,1152,384],c=[0,576,1152,384],d=[0,576,1152,384],h=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],f=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],l=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],p=[0,32,48,56,64,80,96,112,128,144,160,176,192,224,256,-1],g=[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1];function m(e,t){switch(e){case 0:return n[t];case 2:return s[t];case 3:return r[t]}return a.N_}function u(e,t){switch(e){case 0:return d[t];case 2:return c[t];case 3:return o[t]}return a.N_}function w(e,t,i){switch(t){case 1:switch(e){case 0:case 2:return g[i];case 3:return l[i]}break;case 2:switch(e){case 0:case 2:return g[i];case 3:return f[i]}case 3:switch(e){case 0:case 2:return p[i];case 3:return h[i]}}return a.N_}function I(e){switch(e){case 1:return 34;case 2:return 33;case 3:return 32}return a.N_}const B={32:"Layer1",33:"Layer2",34:"Layer3"};function b(e,t){if(t&&t.length>=4){const i=t[1]>>>3&3,a=(6&t[1])>>1,r=(12&t[2])>>>2,s=3&~(t[3]>>>6)?2:1,n=I(a),o=m(i,r);e.codecpar.profile=n,e.codecpar.sampleRate=o,e.codecpar.chLayout.nbChannels=s}}},35336:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(49859),r=i(50011);class s{constructor(e=1048576,t=!0,i){if((0,a.A)(this,"data",void 0),(0,a.A)(this,"buffer",void 0),(0,a.A)(this,"pointer",void 0),(0,a.A)(this,"pos",void 0),(0,a.A)(this,"size",void 0),(0,a.A)(this,"littleEndian",void 0),(0,a.A)(this,"error",void 0),(0,a.A)(this,"onFlush",void 0),(0,a.A)(this,"onSeek",void 0),this.pointer=0,this.pos=BigInt(0),this.size=e,this.littleEndian=!t,this.error=0,i&&i.view)this.size=i.length,this.buffer=i,this.data=i.view;else if(i&&!i.byteOffset)this.size=i.length,this.buffer=i,this.data=new DataView(this.buffer.buffer);else{if(i)throw new Error("not support subarray of ArrayBuffer");this.buffer=new Uint8Array(this.size),this.data=new DataView(this.buffer.buffer)}}writeUint8(e){this.remainingLength()<1&&this.flush(),this.data.setUint8(this.pointer,e),this.pointer++,this.pos++}writeUint16(e){this.remainingLength()<2&&this.flush(),this.data.setUint16(this.pointer,e,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}writeUint24(e){this.remainingLength()<3&&this.flush();const t=(16711680&e)>>16,i=(65280&e)>>8,a=255&e;this.littleEndian?(this.writeUint8(a),this.writeUint8(i),this.writeUint8(t)):(this.writeUint8(t),this.writeUint8(i),this.writeUint8(a))}writeUint32(e){this.remainingLength()<4&&this.flush(),this.data.setUint32(this.pointer,e,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}writeUint64(e){this.remainingLength()<8&&this.flush(),this.data.setBigUint64(this.pointer,e,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}writeInt8(e){this.remainingLength()<1&&this.flush(),this.data.setInt8(this.pointer,e),this.pointer++,this.pos++}writeInt16(e){this.remainingLength()<2&&this.flush(),this.data.setInt16(this.pointer,e,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}writeInt24(e){this.writeUint24(e<0?e+16777216:e)}writeInt32(e){this.remainingLength()<4&&this.flush(),this.data.setInt32(this.pointer,e,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}writeInt64(e){this.remainingLength()<8&&this.flush(),this.data.setBigInt64(this.pointer,e,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}writeFloat(e){this.remainingLength()<4&&this.flush(),this.data.setFloat32(this.pointer,e,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}writeDouble(e){this.remainingLength()<8&&this.flush(),this.data.setFloat64(this.pointer,e,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}getPointer(){return this.pointer}getPos(){return this.pos}remainingLength(){return this.size-this.pointer}writeBuffer(e){if(!e.length)return;let t=e.length;if(this.remainingLength()<t){let i=0;for(;t>0;){this.flush();const a=Math.min(this.size,t);this.buffer.set(e.subarray(i,i+a),this.pointer),this.pointer+=a,this.pos+=BigInt(a),i+=a,t-=a}}else this.buffer.set(e,this.pointer),this.pointer+=t,this.pos+=BigInt(t)}writeString(e){const t=r.encode(e);return this.writeBuffer(t),t.length}flush(){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const e=this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==e)throw this.error=e,Error("IOWriter error, flush failed")}this.pointer=0}flushToPos(e){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const t=this.onFlush(this.buffer.subarray(0,this.pointer),e);if(0!==t)throw this.error=t,Error("IOWriter error, flush failed")}this.pointer=0}seek(e){if(!this.onSeek)throw this.error=-1048574,Error("IOWriter error, seek failed because of no seek callback");this.flush();const t=this.onSeek(e);if(0!==t)throw this.error=t,Error("IOWriter error, seek failed");this.pos=e}seekInline(e){const t=this.pointer;this.pointer=Math.max(0,Math.min(this.size,e)),this.pos+=BigInt(this.pointer-t)}skip(e){const t=this.pointer;this.pointer=Math.min(this.size,this.pointer+e),this.pos+=BigInt(this.pointer-t)}back(e){const t=this.pointer;this.pointer=Math.max(0,this.pointer-e),this.pos+=BigInt(this.pointer-t)}getBuffer(){return this.buffer.subarray(0,this.pointer)}setEndian(e){this.littleEndian=!e}reset(){this.pointer=0,this.pos=BigInt(0),this.error=0}getBufferSize(){return this.size}}}}]);