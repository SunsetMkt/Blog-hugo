"use strict";(self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[]).push([[982],{85947:(t,i,e)=>{e.d(i,{A:()=>s});var r=e(49859);class s{constructor(){(0,r.A)(this,"type",-1),(0,r.A)(this,"onStreamAdd",void 0)}async destroy(t){}}},19028:(t,i,e)=>{e.d(i,{In:()=>b,fz:()=>m,hm:()=>P,qg:()=>T});var r=e(52730),s=e.n(r),a=e(86226),n=e.n(a),o=(e(18979),e(5496),e(64007),e(63939)),h=e(50932),f=e(4624),c=e(50011),l=(e(35336),e(31865)),d=e(71517),u=e(37837),p=e(14686),g=e(72739);e(95335);const w="src/avformat/formats/mp3/id3v2.ts",b={JPG:7,PNG:61,"image/gif":97,"image/jpeg":7,"image/jpg":7,"image/png":61,"image/tiff":96,"image/bmp":78,"image/webp":171},m=["Other","32x32 pixels 'file icon'","Other file icon","Cover (front)","Cover (back)","Leaflet page","Media (e.g. label side of CD)","Lead artist/lead performer/soloist","Artist/performer","Conductor","Band/Orchestra","Composer","Lyricist/text writer","Recording Location","During recording","During performance","Movie/video screen capture","A bright coloured fish","Illustration","Band/artist logotype","Publisher/Studio logotype"];function k(t,i){let e="utf-8";return 0===t?e="iso-8859-1":1===t?e="utf-16":2===t&&(e="utf-16be"),new TextDecoder(e).decode(i)}function I(t){return(127&t)+((32512&t)>>1)+((8323072&t)>>2)+((2130706432&t)>>3)}async function B(t,i){await t.seek(i);const e=await t.readString(4);return/^[A-Z0-9]+$/.test(e)}async function T(t,i,e,r){const a=2!==e.version,n=a?10:6;let o=t.getPos()+BigInt(0|i);async function h(){await t.skip(Number(BigInt.asIntN(32,o-t.getPos())))}if(a&&64&s()(e)){let r=await async function(t,i){let e=0;for(;i--;)e=(e<<7)+(127&await t.readUint8());return e}(t,4);if(4===e.version&&(r-=4),r<0)return f.z3("invalid extended header length",w,149),await h();if(await t.skip(r),(i-=r+4)<0)return f.z3("extended header too long",w,155),await h()}for(;i>n;){let o,h;if(a){if(o=await t.readString(4),h=await t.readUint32(),!h){f.z3("invalid frame size",w,168);break}if(4===e.version&&h>127)if(h<i){await t.flush();const i=t.getPos();if(!(1&s()(t)||6+h<t.remainingLength()))break;if(await B(t,i+BigInt(2)+BigInt(I(h))))h=I(h);else if(!await B(t,i+BigInt(2)+BigInt(h)))break;await t.seek(i)}else h=I(h);await t.readUint16()}else o=await t.readString(3),h=await t.readUint24();if("APIC"===o)r.apic||(r.apic=[]),r.apic.push(await t.readBuffer(h));else if("USLT"===o){const i=await t.readUint8(),e=await t.readString(3),s=await t.readBuffer(h-4);r.lyrics=`${e} ${k(i,s)}`}else if("COMM"===o||"COM"===o){const i=await t.readUint8(),e=await t.readString(3),s=await t.readBuffer(h-4);r.comment=`${e} ${k(i,s)}`}else if("PRIV"===o){const i=t.getPos(),e=[];for(;;){const i=await t.readUint8();if(0===i)break;e.push(i)}const s=c.decode(new Uint8Array(e));let a;a="com.apple.streaming.transportStreamTimestamp"===s?await t.readUint64():await t.readBuffer(h-Number(t.getPos()-i)),r[s]=a}else{let i;switch(i="T"===o[0]?k(await t.readUint8(),await t.readBuffer(h-1)):await t.readBuffer(h),o){case"TIT2":case"TT2":r.title=i;break;case"TPE1":case"TP1":r.artist=i;break;case"TPE2":case"TP2":r.albumArtist=i;break;case"TPOS":r.disc=i;break;case"TCOP":r.copyright=i;break;case"TALB":case"TAL":r.album=i;break;case"TRCK":case"TRK":r.track=i;break;case"TYER":case"TDRL":case"TDRC":r.date=i;break;case"COMM":case"COM":r.comment=i;break;case"TCON":case"TCO":r.genre=i;break;case"TSSE":case"TEN":r.encoder=i;break;case"TCOM":r.composer=i;break;case"TENC":r.vendor=i;break;case"TLAN":r.language=i;break;case"TPE3":case"TP3":r.performer=i;break;case"TPUB":r.publisher=i;break;case"TCMP":case"TCP":r.compilation=i;break;case"TDEN":r.creationTime=i;break;case"TSOA":r.albumSort=i;break;case"TSOP":r.artistSort=i;break;case"TSOT":r.titleSort=i;break;case"TIT1":r.grouping=i;break;default:r[o]=i}}i-=h+n}4==e.version&&16&s()(e)&&(o+=BigInt(10)),await t.skip(Number(BigInt.asIntN(32,o-t.getPos())))}function P(t,i,e){const r=2!==e.version;n()(i).call(i,(i=>{const e=new l.A(i),s=e.readUint8();let a;function n(){let t=Number(e.getPos());for(;t<i.length&&i[t];)t++;return t}if(r?(a=e.readString(n()-Number(e.getPos())),e.skip(1)):a=e.readString(3),!b[a])return;const f=e.readUint8();let c;const w=n()-Number(e.getPos());w&&(c=k(s,e.readBuffer(w))),e.skip(1);const I=t.createStream();I.codecpar.codecId=b[a],I.codecpar.codecType=0,I.disposition|=1024,I.attachedPic=(0,d._5)(),h.M[15](I.attachedPic+32,I.index);const B=e.remainingSize(),T=(0,u.sY)(B),P=e.readBuffer(B);(0,p.lW)(T,B,P),P.length>=8&&g.FB(P.subarray(0,8),new Uint8Array([137,80,78,71,13,10,26,10]))&&(I.codecpar.codecId=61),(0,d.NX)(I.attachedPic,T,B),h.M[15](I.attachedPic+36,1|o.f[15](I.attachedPic+36)),I.metadata.comment=m[f],c&&(I.metadata.title=c)}))}},35336:(t,i,e)=>{e.d(i,{A:()=>a});var r=e(49859),s=e(50011);class a{constructor(t=1048576,i=!0,e){if((0,r.A)(this,"data",void 0),(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"littleEndian",void 0),(0,r.A)(this,"error",void 0),(0,r.A)(this,"onFlush",void 0),(0,r.A)(this,"onSeek",void 0),this.pointer=0,this.pos=BigInt(0),this.size=t,this.littleEndian=!i,this.error=0,e&&e.view)this.size=e.length,this.buffer=e,this.data=e.view;else if(e&&!e.byteOffset)this.size=e.length,this.buffer=e,this.data=new DataView(this.buffer.buffer);else{if(e)throw new Error("not support subarray of ArrayBuffer");this.buffer=new Uint8Array(this.size),this.data=new DataView(this.buffer.buffer)}}writeUint8(t){this.remainingLength()<1&&this.flush(),this.data.setUint8(this.pointer,t),this.pointer++,this.pos++}writeUint16(t){this.remainingLength()<2&&this.flush(),this.data.setUint16(this.pointer,t,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}writeUint24(t){this.remainingLength()<3&&this.flush();const i=(16711680&t)>>16,e=(65280&t)>>8,r=255&t;this.littleEndian?(this.writeUint8(r),this.writeUint8(e),this.writeUint8(i)):(this.writeUint8(i),this.writeUint8(e),this.writeUint8(r))}writeUint32(t){this.remainingLength()<4&&this.flush(),this.data.setUint32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}writeUint64(t){this.remainingLength()<8&&this.flush(),this.data.setBigUint64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}writeInt8(t){this.remainingLength()<1&&this.flush(),this.data.setInt8(this.pointer,t),this.pointer++,this.pos++}writeInt16(t){this.remainingLength()<2&&this.flush(),this.data.setInt16(this.pointer,t,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}writeInt24(t){this.writeUint24(t<0?t+16777216:t)}writeInt32(t){this.remainingLength()<4&&this.flush(),this.data.setInt32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}writeInt64(t){this.remainingLength()<8&&this.flush(),this.data.setBigInt64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}writeFloat(t){this.remainingLength()<4&&this.flush(),this.data.setFloat32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}writeDouble(t){this.remainingLength()<8&&this.flush(),this.data.setFloat64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}getPointer(){return this.pointer}getPos(){return this.pos}remainingLength(){return this.size-this.pointer}writeBuffer(t){if(!t.length)return;let i=t.length;if(this.remainingLength()<i){let e=0;for(;i>0;){this.flush();const r=Math.min(this.size,i);this.buffer.set(t.subarray(e,e+r),this.pointer),this.pointer+=r,this.pos+=BigInt(r),e+=r,i-=r}}else this.buffer.set(t,this.pointer),this.pointer+=i,this.pos+=BigInt(i)}writeString(t){const i=s.encode(t);return this.writeBuffer(i),i.length}flush(){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const t=this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==t)throw this.error=t,Error("IOWriter error, flush failed")}this.pointer=0}flushToPos(t){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const i=this.onFlush(this.buffer.subarray(0,this.pointer),t);if(0!==i)throw this.error=i,Error("IOWriter error, flush failed")}this.pointer=0}seek(t){if(!this.onSeek)throw this.error=-1048574,Error("IOWriter error, seek failed because of no seek callback");this.flush();const i=this.onSeek(t);if(0!==i)throw this.error=i,Error("IOWriter error, seek failed");this.pos=t}seekInline(t){const i=this.pointer;this.pointer=Math.max(0,Math.min(this.size,t)),this.pos+=BigInt(this.pointer-i)}skip(t){const i=this.pointer;this.pointer=Math.min(this.size,this.pointer+t),this.pos+=BigInt(this.pointer-i)}back(t){const i=this.pointer;this.pointer=Math.max(0,this.pointer-t),this.pos+=BigInt(this.pointer-i)}getBuffer(){return this.buffer.subarray(0,this.pointer)}setEndian(t){this.littleEndian=!t}reset(){this.pointer=0,this.pos=BigInt(0),this.error=0}getBufferSize(){return this.size}}}}]);