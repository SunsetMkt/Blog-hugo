(self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[]).push([[433],{70509:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});var s=i(49859);class r{constructor(){(0,s.A)(this,"onFlush",void 0)}}},97801:(t,e,i)=>{"use strict";i.d(e,{A:()=>y});var s,r=i(49859),a=i(5496),n=i.n(a),o=i(18979),h=i.n(o),l=i(70509),c=i(13258),u=i(51678),d=i(13724),p=i(4624);const f="src/avnetwork/bsp/aes/AESDecryptPipe.ts",m=16;let T=!0;const E=n()(s=new Uint8Array(m)).call(s,m);class y extends l.A{constructor(t=0,e=1048576){super(),(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"aesSoftDecryptor",void 0),(0,r.A)(this,"aesWebDecryptor",void 0),(0,r.A)(this,"aesTargetDecryptor",void 0),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"endPointer",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"ended",void 0),(0,r.A)(this,"iv",void 0),(0,r.A)(this,"key",void 0),(0,r.A)(this,"mode",void 0),(0,r.A)(this,"pos",void 0),this.mode=t,this.size=e,this.pointer=0,this.endPointer=0,this.pos=0,this.ended=!1,this.buffer=new Uint8Array(e),this.aesSoftDecryptor=new c.A(t),u.A.isSupport()&&T&&(this.aesWebDecryptor=new u.A(t)),this.aesTargetDecryptor=this.aesWebDecryptor||this.aesSoftDecryptor}remainingLength(){return this.endPointer-this.pointer}async expandKey(t,e){this.key=t,this.iv=e,this.aesWebDecryptor&&await this.aesWebDecryptor.expandKey(t),t.byteLength<=8&&this.aesSoftDecryptor.expandKey(t)}async flush_(t){for(;;){const e=await this.onFlush(t);if(-1048575!==e)return e;await new d.A(0)}}async flush(){if(this.size-this.remainingLength()<=0)return;this.pointer<this.endPointer?this.pointer&&(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer):this.endPointer=0,this.pointer=0;const t=await this.flush_(this.buffer.subarray(this.endPointer));if(t<0){if(-1048576===t)return void(this.ended=!0);p.h2(`AESPipe error, flush failed, ret: ${t}`,f,128)}this.endPointer+=t}removePadding(t){const e=t.length,i=e&&new DataView(t.buffer).getUint8(e-1);return i?t.subarray(0,e-i):t}async decryptCBC(t){let e,i=0;var s;this.aesTargetDecryptor!==this.aesWebDecryptor||this.ended||(e=h()(s=this.buffer.subarray(this.pointer+t,this.pointer+t+m)).call(s),this.buffer.set((await this.aesWebDecryptor.encryptPadding(E,this.buffer.subarray(this.pointer+t-m,this.pointer+t))).subarray(0,m),this.pointer+t),i=m);try{const s=this.buffer.subarray(this.pointer,this.pointer+t+i),r=await this.aesTargetDecryptor.decrypt(s,this.iv);return this.iv=h()(s).call(s,s.length-m-i,s.length-i).buffer,e&&this.buffer.set(e,this.pointer+t),this.pointer+=t,this.pos+=t,new Uint8Array(r)}catch(i){if(this.aesTargetDecryptor===this.aesWebDecryptor&&this.key.byteLength<=8)return p.R8("web aes decrypt failed, try to use soft decryptor",f,178),e&&this.buffer.set(e,this.pointer+t),this.aesTargetDecryptor=this.aesSoftDecryptor,T=!1,this.decryptCBC(t);p.h2("aes decrypt failed",f,188)}}getCTRIv(){var t;const e=h()(t=new Uint8Array(this.iv)).call(t);let i=Math.floor(this.pos/m);for(let t=15;t>=0&&i>0;t--){const s=e[t]+(255&i);e[t]=255&s,i=(i>>>8)+(s>>8)}return e.buffer}async decryptCTR(t){try{const e=this.buffer.subarray(this.pointer,this.pointer+t),i=await this.aesTargetDecryptor.decrypt(e,this.getCTRIv());return this.pointer+=t,this.pos+=t,new Uint8Array(i)}catch(e){if(this.aesTargetDecryptor===this.aesWebDecryptor&&this.key.byteLength<=8)return p.R8("web aes decrypt failed, try to use soft decryptor",f,214),this.aesTargetDecryptor=this.aesSoftDecryptor,T=!1,this.decryptCTR(t);p.h2("aes decrypt failed",f,220)}}async read(t){for(;!this.ended&&this.remainingLength()<48;)await this.flush();if(0===this.remainingLength())return-1048576;if(0===this.mode){const e=Math.min(Math.floor((this.remainingLength()-(this.ended?0:32))/m)*m,t.length);let i=await this.decryptCBC(e);return this.ended&&this.aesTargetDecryptor===this.aesSoftDecryptor&&(i=this.removePadding(i)),t.set(i),i.length}{const e=this.ended?this.remainingLength():Math.min(Math.floor(this.remainingLength()/m)*m,t.length);let i=await this.decryptCTR(e);return t.set(i),i.length}}}},15433:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>V});var s=i(49859),r=i(61240),a=i.n(r),n=i(74707),o=i.n(n),h=i(71426),l=i.n(h),c=i(86226),u=i.n(c),d=i(48079),p=i.n(d),f=i(64007),m=i.n(f),T=i(18979),E=i.n(T),y=i(96319),g=i.n(y),v=i(31721),A=i.n(v),S=i(13724),b=i(82800),I=i(95335),X=i(8507),N=i(48182),R=i(77580),P=i(86932),L=i(4624),D=i(97801),w=i(67672),O=i(9705),M=i(51678),U=i(62751);const C="src/avnetwork/ioLoader/HlsIOLoader.ts";function x(t,e="GET"){var i,s,r;const a={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};return null!==(i=t.httpOptions)&&void 0!==i&&i.headers&&I.__(t.httpOptions.headers,((t,e)=>{a.headers[e]=t})),null!==(s=t.httpOptions)&&void 0!==s&&s.credentials&&(a.credentials=t.httpOptions.credentials),null!==(r=t.httpOptions)&&void 0!==r&&r.referrerPolicy&&(a.referrerPolicy=t.httpOptions.referrerPolicy),a}async function k(t,e,i,s){return new(a())(((r,a)=>{let n=0;!async function o(){try{const a=await fetch(t,{...x(e),signal:s}),l=await a.text(),c=(0,N.A)(l);if(i.isLive&&(!c.segments||c.segments.length<2)){var h;let t=5;null!==(h=c.segments)&&void 0!==h&&h.length&&(t=c.segments[0].duration*(2-c.segments.length)),L.R8(`wait for min buffer time, now segments: ${c.segments.length}`,C,94),await new S.A(t),n=0,o()}r(c)}catch(t){if("AbortError"===(null==t?void 0:t.name))return void r(null);if(n<i.retryCount)return n++,L.z3(`failed fetch m3u8 file, retry(${n}/3)`,C,108),await new S.A(i.retryInterval),o();L.z3("HLSLoader: exception, fetch slice error",C,113),a()}}()}))}class B{constructor(t,e,i,r){(0,s.A)(this,"options",void 0),(0,s.A)(this,"info",void 0),(0,s.A)(this,"mediaPlayList",void 0),(0,s.A)(this,"fetchedMap",void 0),(0,s.A)(this,"fetchedHistoryList",void 0),(0,s.A)(this,"mediaListUrl",void 0),(0,s.A)(this,"segmentIndex",void 0),(0,s.A)(this,"currentUri",void 0),(0,s.A)(this,"loader",void 0),(0,s.A)(this,"keyMap",void 0),(0,s.A)(this,"currentIV",void 0),(0,s.A)(this,"currentKey",void 0),(0,s.A)(this,"aesDecryptPipe",void 0),(0,s.A)(this,"initLoaded",void 0),(0,s.A)(this,"isInitLoader",void 0),(0,s.A)(this,"minBuffer",void 0),(0,s.A)(this,"pendingBuffer",void 0),(0,s.A)(this,"magicAdded",void 0),(0,s.A)(this,"sleep",void 0),(0,s.A)(this,"aborted",void 0),(0,s.A)(this,"signal",void 0),this.options=t,this.info=e,this.segmentIndex=0,this.fetchedMap=new(o()),this.fetchedHistoryList=[],this.keyMap=new(o()),this.aborted=!1,i&&r&&this.setMediaPlayList(i,r)}setMediaPlayList(t,e){if(this.options.isLive){var i;this.fetchedMap.clear(),this.fetchedHistoryList.length=0,this.segmentIndex=0;const t=l()(i=e.segments).call(i,(t=>t.uri===this.currentUri));var s;if(t)for(u()(s=e.segments).call(s,((e,i)=>{e.mediaSequenceNumber===t.mediaSequenceNumber+1?this.segmentIndex=i:e.mediaSequenceNumber<=t.mediaSequenceNumber&&(this.fetchedMap.set(e.uri,!0),this.fetchedHistoryList.push(e.uri))}));this.fetchedHistoryList.length>=10;)this.fetchedMap.delete(this.fetchedHistoryList.shift())}if(this.mediaListUrl=t,this.mediaPlayList=e,this.minBuffer=this.mediaPlayList.duration||0,this.mediaPlayList.endlist&&(this.options.isLive=!1),this.initLoaded=!0,this.mediaPlayList.segments.length&&p()(this.mediaPlayList.segments[0])&&(this.initLoaded=!1),this.mediaPlayList.lowLatencyCompatibility){const t=this.mediaPlayList.lowLatencyCompatibility.partHoldBack||this.mediaPlayList.lowLatencyCompatibility.holdBack||this.minBuffer;let e=0,i=!1,s=0;for(let a=this.mediaPlayList.segments.length-1;a>=0;a--){var r;const n=this.mediaPlayList.segments[a];if(null!==(r=n.parts)&&void 0!==r&&r.length){if(!n.uri)continue;for(let r=n.parts.length-1;r>=0;r--){const o=n.parts[r];if(!o.hint&&(e+=o.duration,o.independent&&(i=!0),e>=t&&i)){s=a;break}}if(e>=t&&i)break}else if(e+=n.duration,i=!0,e>=t&&i){s=a;break}}this.fetchedMap.clear(),this.fetchedHistoryList.length=0;for(let t=0;t<s;t++){const e=this.mediaPlayList.segments[t];this.fetchedMap.set(e.uri,!0),this.fetchedHistoryList.push(e.uri)}for(;this.fetchedHistoryList.length>=10;)this.fetchedMap.delete(this.fetchedHistoryList.shift());this.segmentIndex=s,this.minBuffer=e}}getMediaListUrl(){return this.mediaListUrl}async checkNeedDecrypt(t,e,i){var s;if(!t)return void(this.aesDecryptPipe=null);if("aes-128"!==t.method.toLocaleLowerCase()&&"aes-128-ctr"!==t.method.toLocaleLowerCase()&&("aes-256"!==t.method.toLocaleLowerCase()&&"aes-256-ctr"!==t.method.toLocaleLowerCase()||!M.A.isSupport())){if("mp4"===e.split(".").pop())return void(this.aesDecryptPipe=null);L.h2(`m3u8 ts not support EXT-X-KEY METHOD ${t.method}`,C,286)}const r=t.uri;if(this.keyMap.has(r)?this.currentKey=this.keyMap.get(r):(this.currentKey=await(await fetch((0,X.ll)(this.mediaListUrl,r),x(this.info))).arrayBuffer(),this.keyMap.set(r,this.currentKey)),t.iv)this.currentIV=t.iv.buffer;else{const t=new Uint8Array(16);new DataView(t.buffer).setUint32(12,i,!1),this.currentIV=t.buffer}this.aesDecryptPipe=new D.A(m()(s=t.method.toLocaleLowerCase()).call(s,"ctr")>0?1:0),this.aesDecryptPipe.onFlush=async t=>this.loader.read(t),await this.aesDecryptPipe.expandKey(this.currentKey,this.currentIV)}handleSlice(t,e){const i=this.loader.getUrl().split(".").pop();if("mp3"!==i&&!this.magicAdded&&73===e[0]&&68===e[1]&&51===e[2]){var s;const r=null!==(s=U.HR[i])&&void 0!==s?s:-1;return-1===r?t:(t+6>e.length&&(this.pendingBuffer=E()(e).call(e,t-6)),e.set(E()(e).call(e,0,t-6),6),e[0]=76,e[1]=73,e[2]=77,e[3]=65,e[4]=r>>>8&255,e[5]=255&r,this.magicAdded=!0,this.pendingBuffer?t:t+6)}return t}async read(t){if(this.pendingBuffer){let e=this.pendingBuffer.length;return t.set(this.pendingBuffer),this.pendingBuffer=null,e}let e=0;if(this.loader){if(e=this.aesDecryptPipe?await this.aesDecryptPipe.read(t):await this.loader.read(t),-1048576!==e||this.aborted)return e;if(this.isInitLoader)this.initLoaded=!0;else if(this.options.isLive)this.fetchedMap.set(this.currentUri,!0),10===this.fetchedHistoryList.length&&this.fetchedMap.delete(this.fetchedHistoryList.shift()),this.fetchedHistoryList.push(this.currentUri),this.segmentIndex++;else if(this.segmentIndex++,this.segmentIndex>=this.mediaPlayList.segments.length)return-1048576;this.loader=null}if(this.options.isLive){var i,s,r;const e=g()(i=this.mediaPlayList.segments).call(i,(t=>t.uri&&!this.fetchedMap.get(t.uri)));if(!e.length){var a;if(this.mediaPlayList.endlist)return-1048576;const e=(this.minBuffer-((0,P.A)()-this.mediaPlayList.timestamp)/1e3)/2;return e>0&&(this.sleep=new S.A(e),await this.sleep,this.sleep=null,this.aborted)?-1048576:("function"==typeof AbortController&&(this.signal=new AbortController),this.mediaPlayList=await k(this.mediaListUrl,this.info,this.options,null===(a=this.signal)||void 0===a?void 0:a.signal),this.signal=null,this.aborted?-1048576:this.read(t))}this.isInitLoader=!(null===(s=p()(e[0]))||void 0===s||!s.uri||this.initLoaded),this.currentUri=e[0].uri,this.isInitLoader?null!==(r=p()(e[0]))&&void 0!==r&&r.key&&await this.checkNeedDecrypt(p()(e[0]).key,p()(e[0]).uri,this.segmentIndex+(this.mediaPlayList.mediaSequenceBase||0)):await this.checkNeedDecrypt(e[0].key,this.currentUri,this.segmentIndex+(this.mediaPlayList.mediaSequenceBase||0)),this.loader=new R.A(I.X$({},this.options,{disableSegment:!0,loop:!1}));const n=(0,X.ll)(this.mediaListUrl,this.isInitLoader?p()(e[0]).uri:this.currentUri),o={from:0,to:-1},h=this.isInitLoader?p()(e[0]).byterange:e[0].byterange;h&&(o.from=h.offset,o.to=h.offset+h.length),await this.loader.open(I.X$({},this.info,{url:n}),o);const l=await(this.aesDecryptPipe?this.aesDecryptPipe.read(t):this.loader.read(t));return l>10?this.handleSlice(l,t):l}{var n,o;this.loader=new R.A(I.X$({},this.options,{disableSegment:!0,loop:!1}));let e=this.mediaPlayList.segments[this.segmentIndex];for(;e&&!e.uri;)e=this.mediaPlayList.segments[++this.segmentIndex];this.isInitLoader=!(null===(n=p()(e))||void 0===n||!n.uri||this.initLoaded),this.isInitLoader?null!==(o=p()(e))&&void 0!==o&&o.key&&await this.checkNeedDecrypt(p()(e).key,p()(e).uri,this.segmentIndex+(this.mediaPlayList.mediaSequenceBase||0)):await this.checkNeedDecrypt(e.key,e.uri,this.segmentIndex+(this.mediaPlayList.mediaSequenceBase||0));const i=(0,X.ll)(this.mediaListUrl,this.isInitLoader?p()(e).uri:e.uri),s={from:0,to:-1},r=this.isInitLoader?p()(e).byterange:e.byterange;r&&(s.from=r.offset,s.to=r.offset+r.length),await this.loader.open(I.X$({},this.info,{url:i}),s);const a=await(this.aesDecryptPipe?this.aesDecryptPipe.read(t):this.loader.read(t));return a>10?this.handleSlice(a,t):a}}async seek(t,e=0){this.loader&&(await this.loader.abort(),this.loader=null);let i=e,s=Number(t),r=-1;for(let t=0;t<this.mediaPlayList.segments.length;t++)if(w.ai(this.mediaPlayList.segments[t].duration)&&(i+=this.mediaPlayList.segments[t].duration,1e3*i>=s)){r=t;break}return-1===r&&(r=this.mediaPlayList.segments.length-1),this.segmentIndex=r,this.aborted=!1,0}abortSleep(){this.aborted=!0,this.loader&&this.loader.abortSleep(),this.sleep&&(this.sleep.stop(),this.sleep=null)}async abort(){this.abortSleep(),this.signal&&(this.signal.abort(),this.signal=null),this.loader&&(await this.loader.abort(),this.loader=null)}getMinBuffer(){return this.minBuffer}getDuration(){return this.mediaPlayList.duration}getNextFragmentStart(t=0){if(this.segmentIndex>=this.mediaPlayList.segments.length-1)return-1;for(let e=0;e<this.segmentIndex+1;e++){if(!w.ai(this.mediaPlayList.segments[e].duration))return-1;t+=this.mediaPlayList.segments[e].duration}return t}}class V extends b.A{constructor(...t){super(...t),(0,s.A)(this,"info",void 0),(0,s.A)(this,"masterPlaylist",void 0),(0,s.A)(this,"mediaPlayListIndex",void 0),(0,s.A)(this,"mainLoader",void 0),(0,s.A)(this,"loaders",void 0),(0,s.A)(this,"audioSelectedIndex",void 0),(0,s.A)(this,"subtitleSelectedIndex",void 0),(0,s.A)(this,"sleep",void 0),(0,s.A)(this,"aborted",void 0),(0,s.A)(this,"start",void 0)}async fetchMasterPlayList(){try{const a=await fetch(this.info.url,x(this.info)),n=await a.text(),o=(0,N.A)(n);if(o.isMasterPlaylist){if(this.masterPlaylist=o,this.options.preferResolution||this.options.preferVideoCodec){var t,e;let i=1,s=1;if(this.options.preferResolution){const t=this.options.preferResolution.split("*");i=+t[0]||1,s=+t[1]||1}let r=!1,a=1/0,n=A()(t=this.masterPlaylist.variants).call(t,(t=>{var e;return t.codecs&&m()(e=t.codecs).call(e,this.options.preferVideoCodec)>=0}));u()(e=this.masterPlaylist.variants).call(e,((t,e)=>{var o;if(!(this.options.preferVideoCodec&&n&&t.codecs&&-1===m()(o=t.codecs).call(o,this.options.preferVideoCodec))&&(r||(this.mediaPlayListIndex=e,r=!0),t.resolution&&this.options.preferResolution)){const r=1===i?1:t.resolution.width,n=1===s?1:t.resolution.height;Math.abs(r*n-i*s)<a&&(a=Math.abs(r*n-i*s),this.mediaPlayListIndex=e)}}))}const r=this.masterPlaylist.variants[this.mediaPlayListIndex];if(r){if(r.audio.length&&this.options.preferAudioLang){var i;let t=!1;u()(i=r.audio).call(i,((e,i)=>{var s;e.language&&m()(s=e.language).call(s,this.options.preferAudioLang)>=0&&!t&&(this.audioSelectedIndex=i,e.language===this.options.preferAudioLang&&(t=!0))}))}if(r.subtitles.length&&this.options.preferSubtitleLang){var s;let t=!1;u()(s=r.subtitles).call(s,((e,i)=>{var s;e.language&&m()(s=e.language).call(s,this.options.preferSubtitleLang)>=0&&!t&&(this.subtitleSelectedIndex=i,e.language===this.options.preferSubtitleLang&&(t=!0))}))}}}else{const t=o;if(this.options.isLive&&(!t.segments||t.segments.length<2)){var r;let e=5;return null!==(r=t.segments)&&void 0!==r&&r.length&&(e=t.segments[0].duration*(2-t.segments.length)),L.R8(`wait for min buffer time, now segments: ${t.segments.length}`,C,666),await new S.A(e),this.fetchMasterPlayList()}this.mainLoader=new B(I.X$({enableBandwidthReader:!0},this.options),this.info,this.info.url,t),this.loaders.set(0,this.mainLoader)}return o}catch(t){if(this.retryCount<this.options.retryCount)return this.retryCount++,L.z3(`failed fetch m3u8 file, retry(${this.retryCount}/3)`,C,683),this.sleep=new S.A(3),await this.sleep,this.sleep=null,this.aborted&&L.h2("HLSLoader: exception, fetch abort",C,688),this.fetchMasterPlayList();this.status=3,L.h2("HLSLoader: exception, fetch slice error",C,694)}}buildUrl(t){return/^https?/.test(t)||(t=X.ll(this.info.url,t)),t}async createLoader(){if(this.masterPlaylist){const t=this.masterPlaylist.variants[this.mediaPlayListIndex];if(t||L.h2("no media playlist",C,710),t.audio.length){const e=this.buildUrl(t.audio[this.audioSelectedIndex].uri);this.loaders.set(1,new B(this.options,this.info,e,await k(e,this.info,this.options)))}if(t.subtitles.length){const e=this.buildUrl(t.subtitles[this.subtitleSelectedIndex].uri);this.loaders.set(3,new B(this.options,this.info,e,await k(e,this.info,this.options)))}const e=this.buildUrl(t.uri);this.mainLoader=new B(I.X$({enableBandwidthReader:!0},this.options),this.info,e,await k(e,this.info,this.options)),this.loaders.set(0,this.mainLoader)}}async open(t){return 2===this.status?0:0!==this.status?O.lh:(this.info=t,this.mediaPlayListIndex=0,this.audioSelectedIndex=0,this.subtitleSelectedIndex=0,this.loaders=new(o()),this.status=1,this.retryCount=0,this.aborted=!1,this.start=0,await this.fetchMasterPlayList(),!this.loaders.size&&this.masterPlaylist&&await this.createLoader(),this.status=2,0)}async read(t,e){if(!e)return O.UY;const i=await this.loaders.get(e.mediaType).read(t);return i<0&&-1048575!==i&&(this.status=-1048576===i?4:3),i}async seek(t,e){return e?(await this.loaders.get(e.mediaType).seek(t,this.start),4===this.status&&(this.status=2),0):O.UY}async size(){return BigInt(0)}async abort(){for(let t of this.loaders)await t[1].abort();this.aborted=!0,this.sleep&&(this.sleep.stop(),this.sleep=null)}async stop(){await this.abort(),this.status=0}getDuration(){var t,e;return null!==(t=null===(e=this.mainLoader)||void 0===e?void 0:e.getDuration())&&void 0!==t?t:0}hasVideo(){return this.masterPlaylist?this.masterPlaylist.variants.length>0:!!this.mainLoader}hasAudio(){if(this.masterPlaylist)return this.masterPlaylist.variants[this.mediaPlayListIndex].audio.length>0}hasSubtitle(){if(this.masterPlaylist)return this.masterPlaylist.variants[this.mediaPlayListIndex].subtitles.length>0}getVideoList(){var t,e,i;return{list:null!==(t=null===(e=this.masterPlaylist)||void 0===e?void 0:p()(i=e.variants).call(i,(t=>{var e,i,s,r,a;return{width:null!==(e=null===(i=t.resolution)||void 0===i?void 0:i.width)&&void 0!==e?e:0,height:null!==(s=null===(r=t.resolution)||void 0===r?void 0:r.height)&&void 0!==s?s:0,frameRate:null!==(a=t.frameRate)&&void 0!==a?a:0,codec:t.codecs,bandwidth:t.bandwidth}})))&&void 0!==t?t:[],selectedIndex:this.mediaPlayListIndex||0}}getAudioList(){if(this.masterPlaylist&&this.hasAudio()){var t;const e=this.masterPlaylist.variants[this.mediaPlayListIndex];return{list:p()(t=e.audio).call(t,(t=>({lang:t.language,codec:t.name}))),selectedIndex:this.audioSelectedIndex}}return{list:[],selectedIndex:0}}getSubtitleList(){if(this.masterPlaylist&&this.hasSubtitle()){var t;const e=this.masterPlaylist.variants[this.mediaPlayListIndex];return{list:p()(t=e.subtitles).call(t,(t=>({lang:t.language,codec:t.name}))),selectedIndex:this.subtitleSelectedIndex}}return{list:[],selectedIndex:0}}async selectVideo(t){if(this.masterPlaylist){const e=this.masterPlaylist.variants[t];if(e){const i=this.buildUrl(e.uri),s=await k(i,this.info,this.options);if(this.loaders.get(0).setMediaPlayList(i,s),this.mediaPlayListIndex=t,1===e.audio.length&&this.loaders.has(1)&&this.buildUrl(e.audio[0].uri)!==this.loaders.get(1).getMediaListUrl()){const t=this.buildUrl(e.audio[0].uri),i=await k(t,this.info,this.options);this.loaders.get(1).setMediaPlayList(t,i)}if(1===e.subtitles.length&&this.loaders.has(3)&&this.buildUrl(e.subtitles[0].uri)!==this.loaders.get(3).getMediaListUrl()){const t=this.buildUrl(e.subtitles[0].uri),i=await k(t,this.info,this.options);this.loaders.get(3).setMediaPlayList(t,i)}return this.loaders.get(0).getNextFragmentStart(this.start)}}return-1}async selectAudio(t){if(this.masterPlaylist){const e=this.masterPlaylist.variants[this.mediaPlayListIndex];if(null!=e&&e.audio[t]){const i=this.buildUrl(e.audio[t].uri),s=await k(i,this.info,this.options);return this.loaders.get(1).setMediaPlayList(i,s),this.audioSelectedIndex=t,this.loaders.get(1).getNextFragmentStart(this.start)}}return-1}async selectSubtitle(t){if(this.masterPlaylist){const e=this.masterPlaylist.variants[this.mediaPlayListIndex];if(null!=e&&e.subtitles[t]){const i=this.buildUrl(e.subtitles[t].uri),s=await k(i,this.info,this.options);return this.loaders.get(3).setMediaPlayList(i,s),this.subtitleSelectedIndex=t,this.loaders.get(3).getNextFragmentStart(this.start)}}return-1}getMinBuffer(){var t,e;return null!==(t=null===(e=this.mainLoader)||void 0===e?void 0:e.getMinBuffer())&&void 0!==t?t:0}setStart(t){this.start=t}}},48182:(t,e,i)=>{"use strict";i.d(e,{A:()=>_});var s=i(165),r=i.n(s),a=i(82895),n=i.n(a),o=i(64007),h=i.n(o),l=i(11265),c=i.n(l),u=i(18979),d=i.n(u),p=i(31721),f=i.n(p),m=i(2457),T=i.n(m),E=i(52780),y=i.n(E),g=i(50697),v=i.n(g),A=i(73363),S=i.n(A),b=i(48079),I=i.n(b),X=i(74707),N=i.n(X),R=i(67756),P=i(64608),L=i(4624);const D="src/avprotocol/m3u8/parser.ts";function w(t){return R.Bq(t,'"')}function O(t){const e=R.gI(t,",");return{duration:R.Ro(e[0]),title:decodeURIComponent(escape(e[1]))}}function M(t){const e=R.gI(t,"@");return{length:R.Ro(e[0]),offset:e[1]?R.Ro(e[1]):-1}}function U(t){const e=R.gI(t,"x");return{width:R.Ro(e[0]),height:R.Ro(e[1])}}function C(t){const e="ALLOWED-CPC: Each entry must consit of KEYFORMAT and Content Protection Configuration",i=t.split(",");0===i.length&&L.z3(e,D,103);const s=[];for(const t of i){const[i,r]=R.gI(t,":");i&&r?s.push({format:i,cpcList:r.split("/")}):L.z3(e,D,109)}return s}function x(t){const e=R.m2(t);return 16!==e.length&&L.z3("IV must be a 128-bit unsigned integer",D,120),e}function k(t,e){e.IV&&t.compatibleVersion<2&&(t.compatibleVersion=2),(e.KEYFORMAT||e.KEYFORMATVERSIONS)&&t.compatibleVersion<5&&(t.compatibleVersion=5)}function B(t){const e={};for(const s of R.HG(t)){const[t,a]=R.gI(s,"="),n=w(a);switch(t){case"URI":e[t]=n;break;case"START-DATE":case"END-DATE":e[t]=new Date(n);break;case"IV":e[t]=x(n);break;case"BYTERANGE":e[t]=M(n);break;case"RESOLUTION":e[t]=U(n);break;case"ALLOWED-CPC":e[t]=C(n);break;case"END-ON-NEXT":case"DEFAULT":case"AUTOSELECT":case"FORCED":case"PRECISE":case"CAN-BLOCK-RELOAD":case"INDEPENDENT":case"GAP":e[t]="YES"===n;break;case"DURATION":case"PLANNED-DURATION":case"BANDWIDTH":case"AVERAGE-BANDWIDTH":case"FRAME-RATE":case"TIME-OFFSET":case"CAN-SKIP-UNTIL":case"HOLD-BACK":case"PART-HOLD-BACK":case"PART-TARGET":case"BYTERANGE-START":case"BYTERANGE-LENGTH":case"LAST-MSN":case"LAST-PART":case"SKIPPED-SEGMENTS":case"SCORE":case"PROGRAM-ID":e[t]=R.Ro(n);break;default:r()(t).call(t,"SCTE35-")?e[t]=R.m2(n):r()(t).call(t,"X-")?e[t]=(i=a,r()(i).call(i,'"')?w(i):r()(i).call(i,"0x")||r()(i).call(i,"0X")?R.m2(i):R.Ro(i)):("VIDEO-RANGE"===t&&"SDR"!==n&&"HLG"!==n&&"PQ"!==n&&L.h2(`VIDEO-RANGE: unknown value "${n}"`,D,207),e[t]=n)}}var i;return e}function V(t,e,i){const s=function({attributes:t}){return new P.ru({type:t.TYPE,uri:t.URI,groupId:t["GROUP-ID"],language:t.LANGUAGE,assocLanguage:t["ASSOC-LANGUAGE"],name:t.NAME,isDefault:t.DEFAULT,autoselect:t.AUTOSELECT,forced:t.FORCED,instreamId:t["INSTREAM-ID"],characteristics:t.CHARACTERISTICS,channels:t.CHANNELS})}(e),r=t[R.Th(i)],a=function(t,e){let i=!1;for(const s of t){if(s.name===e.name)return"All EXT-X-MEDIA tags in the same Group MUST have different NAME attributes.";s.isDefault&&(i=!0)}return i&&e.isDefault?"EXT-X-MEDIA A Group MUST NOT have more than one member with a DEFAULT attribute of YES.":""}(r,s);a&&L.h2(a,D,316),r.push(s),s.isDefault&&(t.currentRenditions[R.Th(i)]=r.length-1)}function F(t,e,i,s,a){const n=new P.KT({uri:i,bandwidth:e.BANDWIDTH,averageBandwidth:e["AVERAGE-BANDWIDTH"],score:e.SCORE,codecs:e.CODECS,resolution:e.RESOLUTION,frameRate:e["FRAME-RATE"],hdcpLevel:e["HDCP-LEVEL"],allowedCpc:e["ALLOWED-CPC"],videoRange:e["VIDEO-RANGE"],stableVariantId:e["STABLE-VARIANT-ID"],programId:e["PROGRAM-ID"]});for(const i of t)if("EXT-X-MEDIA"===i.name){const t=i.attributes,s=t.TYPE;if(s&&t["GROUP-ID"]||L.h2("EXT-X-MEDIA TYPE attribute is REQUIRED.",D,356),e[s]===t["GROUP-ID"]&&(V(n,i,s),"CLOSED-CAPTIONS"===s))for(const{instreamId:t}of n.closedCaptions)if(t&&r()(t).call(t,"SERVICE")&&a.compatibleVersion<7){a.compatibleVersion=7;break}}return function(t,e,i){for(const r of["AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS"]){var s;"CLOSED-CAPTIONS"===r&&"NONE"===t[r]?(i.isClosedCaptionsNone=!0,e.closedCaptions=[]):t[r]&&!f()(s=e[R.Th(r)]).call(s,(e=>e.groupId===t[r]))&&L.h2(`${r} attribute MUST match the value of the GROUP-ID attribute of an EXT-X-MEDIA tag whose TYPE attribute is ${r}.`,D,331)}}(e,n,a),n.isIFrameOnly=s,n}function Y(t,e){if(t.method!==e.method)return!1;if(t.uri!==e.uri)return!1;if(t.iv){if(!e.iv)return!1;if(t.iv.length!==e.iv.length)return!1;for(let i=0;i<t.iv.length;i++)if(t.iv[i]!==e.iv[i])return!1}else if(e.iv)return!1;return t.format===e.format&&t.formatVersion===e.formatVersion}function G(t,e,i,s,a,n,o){const h=new P.Y4({uri:e,mediaSequenceNumber:a,discontinuitySequence:n});let l=!1,c=!1;for(let e=i;e<=s;e++){const{name:i,value:s,attributes:a}=t[e];if("EXTINF"===i)!y()(s.duration)&&o.compatibleVersion<3&&(o.compatibleVersion=3),Math.round(s.duration)>o.targetDuration&&L.h2("EXTINF duration, when rounded to the nearest integer, MUST be less than or equal to the target duration",D,518),h.duration=s.duration,h.title=s.title;else if("EXT-X-BYTERANGE"===i)o.compatibleVersion<4&&(o.compatibleVersion=4),h.byterange=s;else if("EXT-X-DISCONTINUITY"===i)h.parts.length>0&&L.h2("EXT-X-DISCONTINUITY must appear before the first EXT-X-PART tag of the Parent Segment.",D,531),h.discontinuity=!0;else if("EXT-X-KEY"===i)h.parts.length>0&&L.h2("EXT-X-KEY must appear before the first EXT-X-PART tag of the Parent Segment.",D,537),"NONE"!==a.METHOD?(k(o,a),h.key=new P.Uz({method:a.METHOD,uri:a.URI,iv:a.IV,format:a.KEYFORMAT,formatVersion:a.KEYFORMATVERSIONS})):h.key=null;else if("EXT-X-MAP"===i)h.parts.length>0&&L.h2("EXT-X-MAP must appear before the first EXT-X-PART tag of the Parent Segment.",D,556),o.compatibleVersion<5&&(o.compatibleVersion=5),o.hasMap=!0,h.map=new P.qP({uri:a.URI,byterange:a.BYTERANGE,key:h.key});else if("EXT-X-PROGRAM-DATE-TIME"===i)h.programDateTime=s;else if("EXT-X-DATERANGE"===i){const t={};for(const e of v()(a))(r()(e).call(e,"SCTE35-")||r()(e).call(e,"X-"))&&(t[e]=a[e]);h.dateRange=new P.ad({id:a.ID,classId:a.CLASS,start:a["START-DATE"],end:a["END-DATE"],duration:a.DURATION,plannedDuration:a["PLANNED-DURATION"],endOnNext:a["END-ON-NEXT"],attributes:t})}else if("EXT-X-CUE-OUT"===i)h.markers.push(new P.xC({type:"OUT",duration:a&&a.DURATION||s}));else if("EXT-X-CUE-IN"===i)h.markers.push(new P.xC({type:"IN"}));else if("EXT-X-CUE-OUT-CONT"===i||"EXT-X-CUE"===i||"EXT-OATCLS-SCTE35"===i||"EXT-X-ASSET"===i||"EXT-X-SCTE35"===i)h.markers.push(new P.xC({type:"RAW",tagName:i,value:s}));else if("EXT-X-PRELOAD-HINT"!==i||a.TYPE)if("EXT-X-PRELOAD-HINT"===i&&"PART"===a.TYPE&&c)L.h2("Servers should not add more than one EXT-X-PRELOAD-HINT tag with the same TYPE attribute to a Playlist.",D,617);else if("EXT-X-PART"!==i&&"EXT-X-PRELOAD-HINT"!==i||a.URI){if("EXT-X-PRELOAD-HINT"===i&&"MAP"===a.TYPE)l&&L.h2("Servers should not add more than one EXT-X-PRELOAD-HINT tag with the same TYPE attribute to a Playlist.",D,624),l=!0,o.hasMap=!0,h.map=new P.qP({hint:!0,uri:a.URI,byterange:{length:a["BYTERANGE-LENGTH"],offset:a["BYTERANGE-START"]||0}});else if("EXT-X-PART"===i||"EXT-X-PRELOAD-HINT"===i&&"PART"===a.TYPE){"EXT-X-PART"!==i||a.DURATION||L.h2("EXT-X-PART: DURATION attribute is mandatory",D,636),"EXT-X-PRELOAD-HINT"===i&&(c=!0);const t=new P.nw({hint:"EXT-X-PRELOAD-HINT"===i,uri:a.URI,byterange:"EXT-X-PART"===i?a.BYTERANGE:{length:a["BYTERANGE-LENGTH"],offset:a["BYTERANGE-START"]||0},duration:a.DURATION,independent:a.INDEPENDENT,gap:a.GAP});h.parts.push(t)}}else L.h2("EXT-X-PART / EXT-X-PRELOAD-HINT: URI attribute is mandatory",D,620);else L.h2("EXT-X-PRELOAD-HINT: TYPE attribute is mandatory",D,614)}return h}function H(t,e,i,s,r,a,n){const o=new P.Vd({uri:e,mediaSequenceNumber:r,discontinuitySequence:a});for(let e=i;e<=s;e++){const{name:i,attributes:s}=t[e];"EXTINF"===i?L.h2("A prefetch segment must not be advertised with an EXTINF tag.",D,668):"EXT-X-DISCONTINUITY"===i?L.h2("A prefetch segment must not be advertised with an EXT-X-DISCONTINUITY tag.",D,671):"EXT-X-PREFETCH-DISCONTINUITY"===i?o.discontinuity=!0:"EXT-X-KEY"===i?"NONE"!==s.METHOD&&(k(n,s),o.key=new P.Uz({method:s.METHOD,uri:s.URI,iv:s.IV,format:s.KEYFORMAT,formatVersion:s.KEYFORMATVERSIONS})):"EXT-X-MAP"===i&&L.h2("Prefetch segments must not be advertised with an EXT-X-MAP tag.",D,689)}return o}function K(t,e,i,s,r){const{discontinuity:a,key:n,map:o,byterange:h,uri:l}=e;if(a&&(e.discontinuitySequence=i+1),n||(e.key=s),o||(e.map=r),h&&-1===h.offset){const{segments:e}=t;if(e.length>0){const t=e[e.length-1];t.byterange&&t.uri===l?h.offset=t.byterange.offset+t.byterange.length:L.h2("If offset of EXT-X-BYTERANGE is not present, a previous Media Segment MUST be a sub-range of the same media resource",D,913)}else L.h2("If offset of EXT-X-BYTERANGE is not present, a previous Media Segment MUST appear in the Playlist file",D,917)}return t.segments.push(e),[e.discontinuitySequence,e.key,I()(e)]}function q(t,e){const[i,s]=function(t){var e,i;const s=h()(t).call(t,":");var r;return-1===s?[c()(r=d()(t).call(t,1)).call(r),null]:[c()(e=d()(t).call(t,1,s)).call(e),c()(i=d()(t).call(t,s+1)).call(i)]}(t),r=function(t){switch(t){case"EXTM3U":case"EXT-X-VERSION":return"Basic";case"EXTINF":case"EXT-X-BYTERANGE":case"EXT-X-DISCONTINUITY":case"EXT-X-PREFETCH-DISCONTINUITY":case"EXT-X-KEY":case"EXT-X-MAP":case"EXT-X-PROGRAM-DATE-TIME":case"EXT-X-DATERANGE":case"EXT-X-CUE-OUT":case"EXT-X-CUE-IN":case"EXT-X-CUE-OUT-CONT":case"EXT-X-CUE":case"EXT-OATCLS-SCTE35":case"EXT-X-ASSET":case"EXT-X-SCTE35":case"EXT-X-PART":case"EXT-X-PRELOAD-HINT":return"Segment";case"EXT-X-TARGETDURATION":case"EXT-X-MEDIA-SEQUENCE":case"EXT-X-DISCONTINUITY-SEQUENCE":case"EXT-X-ENDLIST":case"EXT-X-PLAYLIST-TYPE":case"EXT-X-I-FRAMES-ONLY":case"EXT-X-SERVER-CONTROL":case"EXT-X-PART-INF":case"EXT-X-PREFETCH":case"EXT-X-RENDITION-REPORT":case"EXT-X-SKIP":return"MediaPlaylist";case"EXT-X-MEDIA":case"EXT-X-STREAM-INF":case"EXT-X-I-FRAME-STREAM-INF":case"EXT-X-SESSION-DATA":case"EXT-X-SESSION-KEY":return"MasterPlaylist";case"EXT-X-INDEPENDENT-SEGMENTS":case"EXT-X-START":return"MediaorMasterPlaylist";default:return"Unknown"}}(i);if(function(t,e){if("Segment"===t||"MediaPlaylist"===t)return void 0===e.isMasterPlaylist?void(e.isMasterPlaylist=!1):void(e.isMasterPlaylist&&L.h2("The file contains both media and master playlist tags.",D,1024));if("MasterPlaylist"===t){if(void 0===e.isMasterPlaylist)return void(e.isMasterPlaylist=!0);!1===e.isMasterPlaylist&&L.h2("The file contains both media and master playlist tags.",D,1034)}}(r,e),"Unknown"===r)return null;"MediaPlaylist"===r&&"EXT-X-RENDITION-REPORT"!==i&&"EXT-X-PREFETCH"!==i&&(e.hash[i]&&L.h2("There MUST NOT be more than one Media Playlist tag of each type in any Media Playlist",D,1055),e.hash[i]=!0);const[a,o]=function(t,e){switch(t){case"EXTM3U":case"EXT-X-DISCONTINUITY":case"EXT-X-ENDLIST":case"EXT-X-I-FRAMES-ONLY":case"EXT-X-INDEPENDENT-SEGMENTS":case"EXT-X-CUE-IN":return[null,null];case"EXT-X-VERSION":case"EXT-X-TARGETDURATION":case"EXT-X-MEDIA-SEQUENCE":case"EXT-X-DISCONTINUITY-SEQUENCE":return[R.Ro(e),null];case"EXT-X-CUE-OUT":return n()(Number(e))?[null,B(e)]:[R.Ro(e),null];case"EXT-X-KEY":case"EXT-X-MAP":case"EXT-X-DATERANGE":case"EXT-X-MEDIA":case"EXT-X-STREAM-INF":case"EXT-X-I-FRAME-STREAM-INF":case"EXT-X-SESSION-DATA":case"EXT-X-SESSION-KEY":case"EXT-X-START":case"EXT-X-SERVER-CONTROL":case"EXT-X-PART-INF":case"EXT-X-PART":case"EXT-X-PRELOAD-HINT":case"EXT-X-RENDITION-REPORT":case"EXT-X-SKIP":return[null,B(e)];case"EXTINF":return[O(e),null];case"EXT-X-BYTERANGE":return[M(e),null];case"EXT-X-PROGRAM-DATE-TIME":return[new Date(e),null];default:return[e,null]}}(i,s);return{name:i,category:r,value:a,attributes:o}}function W(t,e){let i;return e.isMasterPlaylist?i=function(t,e){const i=new P.ts;let s=!1;for(const[o,{name:h,value:l,attributes:c}]of T()(t).call(t))if("EXT-X-VERSION"===h)i.version=l;else if("EXT-X-STREAM-INF"===h){const a=t[o+1];("string"!=typeof a||r()(a).call(a,"#EXT"))&&L.h2("EXT-X-STREAM-INF must be followed by a URI line",D,418);const n=F(t,c,a,!1,e);n&&("number"==typeof n.score&&(s=!0,n.score<0&&L.h2("SCORE attribute on EXT-X-STREAM-INF must be positive decimal-floating-point number.",D,425)),i.variants.push(n))}else if("EXT-X-I-FRAME-STREAM-INF"===h){const s=F(t,c,c.URI,!0,e);s&&i.variants.push(s)}else if("EXT-X-SESSION-DATA"===h){var a;const t=new P.pf({id:c["DATA-ID"],value:c.VALUE,uri:c.URI,language:c.LANGUAGE});f()(a=i.sessionDataList).call(a,(e=>e.id===t.id&&e.language===t.language))&&L.h2("A Playlist MUST NOT contain more than one EXT-X-SESSION-DATA tag with the same DATA-ID attribute and the same LANGUAGE attribute.",D,445),i.sessionDataList.push(t)}else if("EXT-X-SESSION-KEY"===h){var n;"NONE"===c.METHOD&&L.h2("EXT-X-SESSION-KEY: The value of the METHOD attribute MUST NOT be NONE",D,451);const t=new P.Uz({method:c.METHOD,uri:c.URI,iv:c.IV,format:c.KEYFORMAT,formatVersion:c.KEYFORMATVERSIONS});f()(n=i.sessionKeyList).call(n,(e=>Y(e,t)))&&L.h2("A Master Playlist MUST NOT contain more than one EXT-X-SESSION-KEY tag with the same METHOD, URI, IV, KEYFORMAT, and KEYFORMATVERSIONS attribute values.",D,461),k(e,c),i.sessionKeyList.push(t)}else"EXT-X-INDEPENDENT-SEGMENTS"===h?(i.independentSegments&&L.h2("EXT-X-INDEPENDENT-SEGMENTS tag MUST NOT appear more than once in a Playlist",D,468),i.independentSegments=!0):"EXT-X-START"===h&&(i.start&&L.h2("EXT-X-START tag MUST NOT appear more than once in a Playlist",D,474),"number"!=typeof c["TIME-OFFSET"]&&L.h2("EXT-X-START: TIME-OFFSET attribute is REQUIRED",D,477),i.start={offset:c["TIME-OFFSET"],precise:c.PRECISE||!1});if(s)for(const t of i.variants)"number"!=typeof t.score&&L.h2("If any Variant Stream contains the SCORE attribute, then all Variant Streams in the Master Playlist SHOULD have a SCORE attribute",D,485);if(e.isClosedCaptionsNone)for(const t of i.variants)t.closedCaptions.length>0&&L.h2("If there is a variant with CLOSED-CAPTIONS attribute of NONE, all EXT-X-STREAM-INF tags MUST have this attribute with a value of NONE",D,492);return i}(t,e):(i=function(t,e){var i;const s=new P.tk;let r=-1,a=0,n=!1,o=!1,h=0,l=null,c=null,u=!1;for(const[i,d]of T()(t).call(t)){const{name:p,value:f,attributes:m,category:T}=d;if("Segment"!==T){if("EXT-X-VERSION"===p)void 0===s.version?s.version=f:L.h2("A Playlist file MUST NOT contain more than one EXT-X-VERSION tag.",D,721);else if("EXT-X-TARGETDURATION"===p)s.targetDuration=e.targetDuration=f;else if("EXT-X-MEDIA-SEQUENCE"===p)s.segments.length>0&&L.h2("The EXT-X-MEDIA-SEQUENCE tag MUST appear before the first Media Segment in the Playlist.",D,729),s.mediaSequenceBase=a=f;else if("EXT-X-DISCONTINUITY-SEQUENCE"===p)s.segments.length>0&&L.h2("The EXT-X-DISCONTINUITY-SEQUENCE tag MUST appear before the first Media Segment in the Playlist.",D,735),n&&L.h2("The EXT-X-DISCONTINUITY-SEQUENCE tag MUST appear before any EXT-X-DISCONTINUITY tag.",D,738),s.discontinuitySequenceBase=h=f;else if("EXT-X-ENDLIST"===p)s.endlist=!0;else if("EXT-X-PLAYLIST-TYPE"===p)s.playlistType=f;else if("EXT-X-I-FRAMES-ONLY"===p)e.compatibleVersion<4&&(e.compatibleVersion=4),s.isIFrame=!0;else if("EXT-X-INDEPENDENT-SEGMENTS"===p)s.independentSegments&&L.h2("EXT-X-INDEPENDENT-SEGMENTS tag MUST NOT appear more than once in a Playlist",D,756),s.independentSegments=!0;else if("EXT-X-START"===p)s.start&&L.h2("EXT-X-START tag MUST NOT appear more than once in a Playlist",D,762),"number"!=typeof m["TIME-OFFSET"]&&L.h2("EXT-X-START: TIME-OFFSET attribute is REQUIRED",D,765),s.start={offset:m["TIME-OFFSET"],precise:m.PRECISE||!1};else if("EXT-X-SERVER-CONTROL"===p)m["CAN-BLOCK-RELOAD"]||L.h2("EXT-X-SERVER-CONTROL: CAN-BLOCK-RELOAD=YES is mandatory for Low-Latency HLS",D,771),s.lowLatencyCompatibility={canBlockReload:m["CAN-BLOCK-RELOAD"],canSkipUntil:m["CAN-SKIP-UNTIL"],holdBack:m["HOLD-BACK"],partHoldBack:m["PART-HOLD-BACK"]};else if("EXT-X-PART-INF"===p)m["PART-TARGET"]||L.h2("EXT-X-PART-INF: PART-TARGET attribute is mandatory",D,782),s.partTargetDuration=m["PART-TARGET"];else if("EXT-X-RENDITION-REPORT"===p)m.URI||L.h2("EXT-X-RENDITION-REPORT: URI attribute is mandatory",D,788),0===m.URI.search(/^[a-z]+:/)&&L.h2("EXT-X-RENDITION-REPORT: URI must be relative to the playlist uri",D,791),s.renditionReports.push(new P.h4({uri:m.URI,lastMSN:m["LAST-MSN"],lastPart:m["LAST-PART"]}));else if("EXT-X-SKIP"===p)m["SKIPPED-SEGMENTS"]||L.h2("EXT-X-SKIP: SKIPPED-SEGMENTS attribute is mandatory",D,801),e.compatibleVersion<9&&(e.compatibleVersion=9),s.skip=m["SKIPPED-SEGMENTS"],a+=s.skip;else if("EXT-X-PREFETCH"===p){const n=H(t,f,-1===r?i:r,i-1,a++,h,e);n&&(n.discontinuity&&(n.discontinuitySequence++,h=n.discontinuitySequence),n.key?l=n.key:null===n.key?l=void 0:n.key=l,s.prefetchSegments.push(n)),o=!0,r=-1}else if("string"==typeof d){-1===r&&L.h2("A URI line is not preceded by any segment tags",D,841),s.targetDuration||L.h2("The EXT-X-TARGETDURATION tag is REQUIRED",D,844),o&&L.h2("These segments must appear after all complete segments.",D,847);const n=G(t,d,r,i-1,a++,h,e);n&&(null===n.key&&(l=void 0),[h,l,c]=K(s,n,h,l,c),!u&&n.parts.length>0&&(u=!0)),r=-1}}else-1===r&&(r=i),"EXT-X-DISCONTINUITY"===p&&(n=!0)}if(-1!==r){const i=G(t,"",r,t.length-1,a++,h,e);if(i){var d;null===i.key&&(l=void 0);const{parts:t}=i;!(t.length>0)||s.endlist||null!==(d=t[t.length-1])&&void 0!==d&&d.hint||L.h2("If the Playlist contains EXT-X-PART tags and does not contain an EXT-X-ENDLIST tag, the Playlist must contain an EXT-X-PRELOAD-HINT tag with a TYPE=PART attribute",D,870),K(s,i,h,l,c),!u&&i.parts.length>0&&(u=!0)}}return function(t){const e=new(N()),i=new(N());let s=!1,r=!1;for(let a=t.length-1;a>=0;a--){const{programDateTime:n,dateRange:o}=t[a];if(n&&(r=!0),o&&o.start){s=!0,o.endOnNext&&(o.end||o.duration)&&L.h2("An EXT-X-DATERANGE tag with an END-ON-NEXT=YES attribute MUST NOT contain DURATION or END-DATE attributes.",D,937);const t=o.start.getTime(),r=o.duration||0;o.end&&o.duration&&t+1e3*r!==o.end.getTime()&&L.h2("END-DATE MUST be equal to the value of the START-DATE attribute plus the value of the DURATION",D,943),o.endOnNext&&(o.end=e.get(o.classId)),e.set(o.classId,o.start);const a=o.end?o.end.getTime():o.start.getTime()+1e3*(o.duration||0),n=i.get(o.classId);if(n){for(const e of n)(e.start<=t&&e.end>t||e.start>=t&&e.start<a)&&L.h2("DATERANGE tags with the same CLASS should not overlap",D,955);n.push({start:t,end:a})}else o.classId&&i.set(o.classId,[{start:t,end:a}])}}s&&!r&&L.h2("If a Playlist contains an EXT-X-DATERANGE tag, it MUST also contain at least one EXT-X-PROGRAM-DATE-TIME tag.",D,966)}(s.segments),s.lowLatencyCompatibility&&function({lowLatencyCompatibility:t,targetDuration:e,partTargetDuration:i,segments:s,renditionReports:r},a){const{canSkipUntil:n,holdBack:o,partHoldBack:h}=t;if(n<6*e&&L.h2("The Skip Boundary must be at least six times the EXT-X-TARGETDURATION.",D,973),o<3*e&&L.h2("HOLD-BACK must be at least three times the EXT-X-TARGETDURATION.",D,977),a){void 0===i&&L.h2("EXT-X-PART-INF is required if a Playlist contains one or more EXT-X-PART tags",D,981),void 0===h&&L.h2("EXT-X-PART: PART-HOLD-BACK attribute is mandatory",D,984),h<i&&L.h2("PART-HOLD-BACK must be at least PART-TARGET",D,987);for(const[t,{parts:e}]of T()(s).call(s))for(const[t,{duration:s}]of T()(e).call(e))void 0!==s&&(s>i&&L.h2("PART-TARGET is the maximum duration of any Partial Segment",D,998),t<e.length-1&&s<.85*i&&L.h2("All Partial Segments except the last part of a segment must have a duration of at least 85% of PART-TARGET",D,1001))}for(const t of r){const e=s[s.length-1];null!==t.lastMSN&&void 0!==t.lastMSN||(t.lastMSN=e.mediaSequenceNumber),(null===t.lastPart||void 0===t.lastPart)&&e.parts.length>0&&(t.lastPart=e.parts.length-1)}}(s,u),s.duration=S()(i=s.segments).call(i,((t,e)=>"number"==typeof e.duration?t+e.duration:t),0),s}(t,e),!i.isIFrame&&e.hasMap&&e.compatibleVersion<6&&(e.compatibleVersion=6)),e.compatibleVersion>1&&(!i.version||i.version<e.compatibleVersion)&&L.h2(`EXT-X-VERSION needs to be ${e.compatibleVersion} or higher.`,D,1105),i}function _(t){const e={version:void 0,isMasterPlaylist:void 0,hasMap:!1,targetDuration:0,compatibleVersion:1,isClosedCaptionsNone:!1,hash:{}},i=function(t,e){const i=[];for(const s of t.split("\n")){const t=c()(s).call(s);if(t)if(r()(t).call(t,"#")){if(r()(t).call(t,"#EXT")){const s=q(t,e);s&&i.push(s)}}else i.push(t)}return 0!==i.length&&"EXTM3U"===i[0].name||L.h2("The EXTM3U tag MUST be the first line.",D,1087),i}(t,e),s=W(i,e);return s.source=t,s}},64608:(t,e,i)=>{"use strict";i.d(e,{KT:()=>n,Uz:()=>h,Vd:()=>y,Y4:()=>T,ad:()=>c,h4:()=>g,nw:()=>E,pf:()=>o,qP:()=>l,ru:()=>a,tk:()=>m,ts:()=>f,xC:()=>u});var s=i(49859),r=i(86932);class a{constructor({type:t,uri:e,groupId:i,language:r,assocLanguage:a,name:n,isDefault:o,autoselect:h,forced:l,instreamId:c,characteristics:u,channels:d}){(0,s.A)(this,"type",void 0),(0,s.A)(this,"uri",void 0),(0,s.A)(this,"groupId",void 0),(0,s.A)(this,"language",void 0),(0,s.A)(this,"assocLanguage",void 0),(0,s.A)(this,"name",void 0),(0,s.A)(this,"isDefault",void 0),(0,s.A)(this,"autoselect",void 0),(0,s.A)(this,"forced",void 0),(0,s.A)(this,"instreamId",void 0),(0,s.A)(this,"characteristics",void 0),(0,s.A)(this,"channels",void 0),this.type=t,this.uri=e,this.groupId=i,this.language=r,this.assocLanguage=a,this.name=n,this.isDefault=o,this.autoselect=h,this.forced=l,this.instreamId=c,this.characteristics=u,this.channels=d}}class n{constructor({uri:t,isIFrameOnly:e=!1,bandwidth:i,averageBandwidth:r,score:a,codecs:n,resolution:o,frameRate:h,hdcpLevel:l,allowedCpc:c,videoRange:u,stableVariantId:d,programId:p,audio:f=[],video:m=[],subtitles:T=[],closedCaptions:E=[],currentRenditions:y={audio:0,video:0,subtitles:0,closedCaptions:0}}){(0,s.A)(this,"uri",void 0),(0,s.A)(this,"isIFrameOnly",void 0),(0,s.A)(this,"bandwidth",void 0),(0,s.A)(this,"averageBandwidth",void 0),(0,s.A)(this,"score",void 0),(0,s.A)(this,"codecs",void 0),(0,s.A)(this,"resolution",void 0),(0,s.A)(this,"frameRate",void 0),(0,s.A)(this,"hdcpLevel",void 0),(0,s.A)(this,"allowedCpc",void 0),(0,s.A)(this,"videoRange",void 0),(0,s.A)(this,"stableVariantId",void 0),(0,s.A)(this,"programId",void 0),(0,s.A)(this,"audio",void 0),(0,s.A)(this,"video",void 0),(0,s.A)(this,"subtitles",void 0),(0,s.A)(this,"closedCaptions",void 0),(0,s.A)(this,"currentRenditions",void 0),this.uri=t,this.isIFrameOnly=e,this.bandwidth=i,this.averageBandwidth=r,this.score=a,this.codecs=n,this.resolution=o,this.frameRate=h,this.hdcpLevel=l,this.allowedCpc=c,this.videoRange=u,this.stableVariantId=d,this.programId=p,this.audio=f,this.video=m,this.subtitles=T,this.closedCaptions=E,this.currentRenditions=y}}class o{constructor({id:t,value:e,uri:i,language:r}){(0,s.A)(this,"id",void 0),(0,s.A)(this,"value",void 0),(0,s.A)(this,"uri",void 0),(0,s.A)(this,"language",void 0),this.id=t,this.value=e,this.uri=i,this.language=r}}class h{constructor({method:t,uri:e,iv:i,format:r,formatVersion:a}){(0,s.A)(this,"method",void 0),(0,s.A)(this,"uri",void 0),(0,s.A)(this,"iv",void 0),(0,s.A)(this,"format",void 0),(0,s.A)(this,"formatVersion",void 0),this.method=t,this.uri=e,this.iv=i,this.format=r,this.formatVersion=a}}class l{constructor({hint:t=!1,uri:e,mimeType:i,byterange:r,key:a}){(0,s.A)(this,"hint",void 0),(0,s.A)(this,"uri",void 0),(0,s.A)(this,"mimeType",void 0),(0,s.A)(this,"byterange",void 0),(0,s.A)(this,"key",void 0),this.hint=t,this.uri=e,this.mimeType=i,this.byterange=r,this.key=a}}class c{constructor({id:t,classId:e,start:i,end:r,duration:a,plannedDuration:n,endOnNext:o,attributes:h={}}){(0,s.A)(this,"id",void 0),(0,s.A)(this,"classId",void 0),(0,s.A)(this,"start",void 0),(0,s.A)(this,"end",void 0),(0,s.A)(this,"duration",void 0),(0,s.A)(this,"plannedDuration",void 0),(0,s.A)(this,"endOnNext",void 0),(0,s.A)(this,"attributes",void 0),this.id=t,this.classId=e,this.start=i,this.end=r,this.duration=a,this.plannedDuration=n,this.endOnNext=o,this.attributes=h}}class u{constructor({type:t,duration:e,tagName:i,value:r}){(0,s.A)(this,"type",void 0),(0,s.A)(this,"duration",void 0),(0,s.A)(this,"tagName",void 0),(0,s.A)(this,"value",void 0),this.type=t,this.duration=e,this.tagName=i,this.value=r}}class d{constructor(t){(0,s.A)(this,"type",void 0),this.type=t}}class p extends d{constructor({isMasterPlaylist:t,uri:e,version:i,independentSegments:r=!1,start:a,source:n}){super("playlist"),(0,s.A)(this,"isMasterPlaylist",void 0),(0,s.A)(this,"uri",void 0),(0,s.A)(this,"version",void 0),(0,s.A)(this,"independentSegments",void 0),(0,s.A)(this,"start",void 0),(0,s.A)(this,"source",void 0),this.isMasterPlaylist=t,this.uri=e,this.version=i,this.independentSegments=r,this.start=a,this.source=n}}class f extends p{constructor(t={}){super({...t,isMasterPlaylist:!0}),(0,s.A)(this,"variants",void 0),(0,s.A)(this,"currentVariant",void 0),(0,s.A)(this,"sessionDataList",void 0),(0,s.A)(this,"sessionKeyList",void 0);const{variants:e=[],currentVariant:i,sessionDataList:r=[],sessionKeyList:a=[]}=t;this.variants=e,this.currentVariant=i,this.sessionDataList=r,this.sessionKeyList=a}}class m extends p{constructor(t={}){super({...t,isMasterPlaylist:!1}),(0,s.A)(this,"targetDuration",void 0),(0,s.A)(this,"mediaSequenceBase",void 0),(0,s.A)(this,"discontinuitySequenceBase",void 0),(0,s.A)(this,"endlist",void 0),(0,s.A)(this,"playlistType",void 0),(0,s.A)(this,"isIFrame",void 0),(0,s.A)(this,"segments",void 0),(0,s.A)(this,"prefetchSegments",void 0),(0,s.A)(this,"lowLatencyCompatibility",void 0),(0,s.A)(this,"partTargetDuration",void 0),(0,s.A)(this,"renditionReports",void 0),(0,s.A)(this,"skip",void 0),(0,s.A)(this,"hash",void 0),(0,s.A)(this,"duration",void 0),(0,s.A)(this,"timestamp",void 0);const{targetDuration:e,mediaSequenceBase:i=0,discontinuitySequenceBase:a=0,endlist:n=!1,playlistType:o,isIFrame:h,segments:l=[],prefetchSegments:c=[],lowLatencyCompatibility:u,partTargetDuration:d,renditionReports:p=[],skip:f=0,hash:m,duration:T=0}=t;this.targetDuration=e,this.mediaSequenceBase=i,this.discontinuitySequenceBase=a,this.endlist=n,this.playlistType=o,this.isIFrame=h,this.segments=l,this.prefetchSegments=c,this.lowLatencyCompatibility=u,this.partTargetDuration=d,this.renditionReports=p,this.skip=f,this.hash=m,this.duration=T,this.timestamp=(0,r.A)()}}class T extends d{constructor({uri:t,mimeType:e,data:i,duration:r,title:a,byterange:n,discontinuity:o,mediaSequenceNumber:h=0,discontinuitySequence:l=0,key:c,map:u,programDateTime:d,dateRange:p,markers:f=[],parts:m=[]}){super("segment"),(0,s.A)(this,"uri",void 0),(0,s.A)(this,"mimeType",void 0),(0,s.A)(this,"data",void 0),(0,s.A)(this,"duration",void 0),(0,s.A)(this,"title",void 0),(0,s.A)(this,"byterange",void 0),(0,s.A)(this,"discontinuity",void 0),(0,s.A)(this,"mediaSequenceNumber",void 0),(0,s.A)(this,"discontinuitySequence",void 0),(0,s.A)(this,"key",void 0),(0,s.A)(this,"map",void 0),(0,s.A)(this,"programDateTime",void 0),(0,s.A)(this,"dateRange",void 0),(0,s.A)(this,"markers",void 0),(0,s.A)(this,"parts",void 0),this.uri=t,this.mimeType=e,this.data=i,this.duration=r,this.title=a,this.byterange=n,this.discontinuity=o,this.mediaSequenceNumber=h,this.discontinuitySequence=l,this.key=c,this.map=u,this.programDateTime=d,this.dateRange=p,this.markers=f,this.parts=m}}class E extends d{constructor({hint:t=!1,uri:e,duration:i,independent:r,byterange:a,gap:n}){super("part"),(0,s.A)(this,"hint",void 0),(0,s.A)(this,"uri",void 0),(0,s.A)(this,"duration",void 0),(0,s.A)(this,"independent",void 0),(0,s.A)(this,"byterange",void 0),(0,s.A)(this,"gap",void 0),this.hint=t,this.uri=e,this.duration=i,this.independent=r,this.duration=i,this.byterange=a,this.gap=n}}class y extends d{constructor({uri:t,discontinuity:e,mediaSequenceNumber:i=0,discontinuitySequence:r=0,key:a}){super("prefetch"),(0,s.A)(this,"uri",void 0),(0,s.A)(this,"discontinuity",void 0),(0,s.A)(this,"mediaSequenceNumber",void 0),(0,s.A)(this,"discontinuitySequence",void 0),(0,s.A)(this,"key",void 0),this.uri=t,this.discontinuity=e,this.mediaSequenceNumber=i,this.discontinuitySequence=r,this.key=a}}class g{constructor({uri:t,lastMSN:e,lastPart:i}){(0,s.A)(this,"uri",void 0),(0,s.A)(this,"lastMSN",void 0),(0,s.A)(this,"lastPart",void 0),this.uri=t,this.lastMSN=e,this.lastPart=i}}},67756:(t,e,i)=>{"use strict";i.d(e,{Bq:()=>v,HG:()=>A,Ro:()=>E,Th:()=>S,gI:()=>g,m2:()=>y});var s=i(63579),r=i.n(s),a=i(80668),n=i.n(a),o=i(82895),h=i.n(o),l=i(165),c=i.n(l),u=i(18979),d=i.n(u),p=i(11265),f=i.n(p),m=i(27124),T=i.n(m);function E(t,e=10){if("number"==typeof t)return t;const i=10===e?r()(t):n()(t,e);return h()(i)?0:i}function y(t){(c()(t).call(t,"0x")||c()(t).call(t,"0X"))&&(t=d()(t).call(t,2));const e=[];for(let i=0;i<t.length;i+=2)e.push(E(d()(t).call(t,i,i+2),16));return new Uint8Array(e)}function g(t,e,i=0){let s=-1;for(let r=0,a=0;r<t.length;r++)if(t[r]===e){if(a++===i)return[d()(t).call(t,0,r),d()(t).call(t,r+1)];s=r}return-1!==s?[d()(t).call(t,0,s),d()(t).call(t,s+1)]:[t]}function v(t,e=" "){return t?(t=f()(t).call(t)," "===e||(c()(t).call(t,e)&&(t=d()(t).call(t,1)),T()(t).call(t,e)&&(t=d()(t).call(t,0,-1))),t):t}function A(t){var e;const i=[];let s=!0,r=0;const a=[];for(let e=0;e<t.length;e++){const o=t[e];var n;s&&","===o?(i.push(f()(n=d()(t).call(t,r,e)).call(n)),r=e+1):'"'!==o&&"'"!==o||(s?(a.push(o),s=!1):o===a[a.length-1]?(a.pop(),s=!0):a.push(o))}return i.push(f()(e=d()(t).call(t,r)).call(e)),i}function S(t){const e=[];let i=!1;for(const s of t)"-"!==s&&"_"!==s?i?(e.push(s.toUpperCase()),i=!1):e.push(s.toLowerCase()):i=!0;return e.join("")}},62751:(t,e,i)=>{"use strict";i.d(e,{$$:()=>a,Eh:()=>m,HR:()=>r,IY:()=>v,Ki:()=>g,Ld:()=>l,Mb:()=>E,Sz:()=>u,Xp:()=>h,_R:()=>n,_m:()=>f,d8:()=>T,iW:()=>d,mX:()=>p,n1:()=>o,os:()=>s,qO:()=>c,u6:()=>y});const s={86017:"mp3",86018:"mp4a.40",86021:"vorbis",86028:"flac",86076:"opus",65542:"ulaw",65543:"alaw",86019:"ac-3",86056:"ec-3",86020:"dtsc",65541:"pcm-u8",65540:"pcm-s8",65536:"pcm-s16",65537:"pcm-s16be",65548:"pcm-s24",65549:"pcm-s24be",65544:"pcm-s32",65545:"pcm-s32be",65557:"pcm-f32",65556:"pcm-f32be",65559:"pcm-f64",65558:"pcm-f64be",225:"av01",27:"avc1",173:"hev1",196:"vvc1",139:"vp8",167:"vp09",12:"mp4v"},r={flv:0,mp4:1,m4s:1,mov:1,ts:2,mts:2,m2ts:2,ivf:5,opus:4,oggs:4,ogg:4,m3u8:2,m3u:2,mpd:1,mp3:14,mkv:8,mka:8,webm:9,aac:15,flac:17,wav:16,srt:19,vtt:18,ssa:20,ass:20,xml:21,ttml:21,h264:11,264:11,avc:11,h265:12,265:12,hevc:12,h266:13,266:13,vvc:13,mpeg:3,mpg:3,rtsp:6,rtmp:7,avi:10,avif:1,heic:1},a={m3u8:4,m3u:4,mpd:5},n={copy:0,h264:27,h261:3,h263:4,h263i:20,h263p:19,mjpeg:7,wmv1:17,wmv2:18,wmv3:71,avc:27,hevc:173,h265:173,vvc:196,h266:196,av1:225,vp9:167,vp8:139,mpeg4:12,theora:30,mpeg2video:2,rv10:5,rv20:6,rv30:68,rv40:69,png:61,bmp:78,webp:171,tiff:96,gif:97},o={copy:0,aac:86018,ac3:86019,eac3:86056,dts:86020,mp3:86017,opus:86076,flac:86028,speex:86051,vorbis:86021,pcm_alaw:65543,pcm_mulaw:65542,wmav1:86023,wmav2:86024,cook:86036,sipr:86057,ralf:86073,pcm_u8:65541,pcm_s16le:65536,pcm_s24le:65548,pcm_s32le:65544,pcm_s64le:65567,pcm_f32le:65557,pcm_f64le:65559},h={webvtt:94226,subrip:94225,ass:94230,ttml:94232,mov_text:94213,hdmv_pgs:94214,hdmv_text:94231,dvd:94208,dvb:94209,eia_608:94218},l={bin_data:98314},c={yuv420p:0,yuv422p:4,yuv444p:5,yuva420p:33,yuva422p:78,yuva444p:79,yuvj420p:12,yuvj422p:13,yuvj444p:14,yuv420p10le:62,yuv422p10le:64,yuv444p10le:68,yuva420p10le:87,yuva422p10le:89,yuva444p10le:91,yuv420p10be:61,yuv422p10be:63,yuv444p10be:67,yuva420p10be:86,yuva422p10be:88,yuva444p10be:90,rgba:26,rgb24:2,bgr24:3,gray:8},u={u8:0,"u8-planar":5,s16:1,"s16-planar":6,s32:2,"s32-planar":7,s64:10,"s64-planar":11,float:3,"float-planar":8,double:4,"double-planar":9},d={flv:0,isobmff:1,mp4:1,mov:1,ts:2,mpegts:2,mpeg:3,ivf:5,ogg:4,opus:4,m3u8:2,m3u:2,mpd:1,mp3:14,mkv:8,matroska:8,mka:8,webm:9,aac:15,flac:17,wav:16,raw_h264:11,raw_h265:12,raw_vvc:13,rtsp:6,rtmp:7,avi:10,h264:11,h265:12,h266:13},p={tv:1,pc:2},f={bt709:1,fcc:4,bt470bg:5,smpte170m:6,smpte240m:7,ycgco:8,gbr:0,bt2020nc:9},m={bt709:1,bt470m:4,bt470bg:5,smpte170m:6,smpte240m:7,smpte428:10,film:8,smpte431:11,smpte432:12,bt2020:9,"jedec-p22":22,ebu3213:22},T={bt709:1,gamma22:4,gamma28:5,smpte170m:6,smpte240m:7,srgb:13,xvycc:11,"bt2020-10":14,"bt2020-12":15,smpte2084:16,"arib-std-b67":18},E={Audio:1,Video:0,Subtitle:3,Attachment:4,Data:2},y={"Tile Grid":3,"Audio Element":1,"Mix Presentation":2},g={default:1,dub:2,original:4,comment:8,lyrics:16,karaoke:32,forced:64,"hearing impaired":128,"visual impaired":256,"clean effects":512,"attached pic":1024,"timed thumbnails":2048,captions:65536,descriptions:131072,metadata:262144,dependent:524288,"still image":1048576,thumbnail:8192},v={mono:4,stereo:3,2.1:11,"3.0":7,"3.0(back)":259,"4.0":263,quad:51,"quad(side)":1539,3.1:15,"5.0":55,"5.0(side)":1543,4.1:271,5.1:63,"5.1(side)":1551,"6.0":1799,"6.0(front)":1731,"3.1.2":20495,hexagonal:311,6.1:1807,"6.1(back)":319,"6.1(front)":1739,"7.0":1591,"7.0(front)":1735,7.1:1599,"7.1(wide)":255,"7.1(wide-side)":1743,"5.1.2":20543,octagonal:1847,cube:184371,"5.1.4":184383,"7.1.2":22079,"7.1.4":185919,"7.2.3":34359825983,"9.1.4":186111,hexadecagonal:6442710839,downmix:1610612736,22.2:2164663779327}},13258:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});var s=i(49859);class r{constructor(t=0){(0,s.A)(this,"rcon",[0,1,2,4,8,16,32,64,128,27,54]),(0,s.A)(this,"subMix",[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)]),(0,s.A)(this,"invSubMix",[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)]),(0,s.A)(this,"sBox",new Uint32Array(256)),(0,s.A)(this,"invSBox",new Uint32Array(256)),(0,s.A)(this,"key",new Uint32Array(0)),(0,s.A)(this,"ksRows",0),(0,s.A)(this,"keySize",0),(0,s.A)(this,"keySchedule",void 0),(0,s.A)(this,"invKeySchedule",void 0),this.initTable()}uint8ArrayToUint32Array_(t){const e=new DataView(t),i=new Uint32Array(4);for(let t=0;t<4;t++)i[t]=e.getUint32(4*t);return i}initTable(){const t=this.sBox,e=this.invSBox,i=this.subMix,s=i[0],r=i[1],a=i[2],n=i[3],o=this.invSubMix,h=o[0],l=o[1],c=o[2],u=o[3],d=new Uint32Array(256);let p=0,f=0,m=0;for(m=0;m<256;m++)d[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){let i=f^f<<1^f<<2^f<<3^f<<4;i=i>>>8^255&i^99,t[p]=i,e[i]=p;const o=d[p],m=d[o],T=d[m];let E=257*d[i]^16843008*i;s[p]=E<<24|E>>>8,r[p]=E<<16|E>>>16,a[p]=E<<8|E>>>24,n[p]=E,E=16843009*T^65537*m^257*o^16843008*p,h[i]=E<<24|E>>>8,l[i]=E<<16|E>>>16,c[i]=E<<8|E>>>24,u[i]=E,p?(p=o^d[d[d[T^o]]],f^=d[d[f]]):p=f=1}}async expandKey(t){const e=this.uint8ArrayToUint32Array_(t);if(this.key){let t=!0,i=0;for(;i<e.length&&t;)t=e[i]===this.key[i],i++;if(t)return}this.key=e;const i=this.keySize=this.key.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);const s=this.ksRows=4*(i+6+1);let r,a;const n=this.keySchedule=new Uint32Array(s),o=this.invKeySchedule=new Uint32Array(s),h=this.sBox,l=this.rcon,c=this.invSubMix,u=c[0],d=c[1],p=c[2],f=c[3];let m,T;for(r=0;r<s;r++)r<i?m=n[r]=e[r]:(T=m,r%i==0?(T=T<<8|T>>>24,T=h[T>>>24]<<24|h[T>>>16&255]<<16|h[T>>>8&255]<<8|h[255&T],T^=l[r/i|0]<<24):i>6&&r%i==4&&(T=h[T>>>24]<<24|h[T>>>16&255]<<16|h[T>>>8&255]<<8|h[255&T]),n[r]=m=(n[r-i]^T)>>>0);for(a=0;a<s;a++)r=s-a,T=3&a?n[r]:n[r-4],o[a]=a<4||r<=4?T:u[h[T>>>24]]^d[h[T>>>16&255]]^p[h[T>>>8&255]]^f[h[255&T]],o[a]=o[a]>>>0}networkToHostOrderSwap(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24}async decrypt(t,e){const i=this.keySize+6,s=this.invKeySchedule,r=this.invSBox,a=this.invSubMix,n=a[0],o=a[1],h=a[2],l=a[3],c=this.uint8ArrayToUint32Array_(e);let u=c[0],d=c[1],p=c[2],f=c[3];const m=new Int32Array(t.buffer).subarray(t.byteOffset>>>2,(t.byteOffset>>>2)+(t.length>>>2)),T=new Int32Array(m.length);let E,y,g,v,A,S,b,I,X,N,R,P,L,D;const w=this.networkToHostOrderSwap;let O=0;for(;O<m.length;){for(X=w(m[O]),N=w(m[O+1]),R=w(m[O+2]),P=w(m[O+3]),A=X^s[0],S=P^s[1],b=R^s[2],I=N^s[3],L=4,D=1;D<i;D++)E=n[A>>>24]^o[S>>16&255]^h[b>>8&255]^l[255&I]^s[L],y=n[S>>>24]^o[b>>16&255]^h[I>>8&255]^l[255&A]^s[L+1],g=n[b>>>24]^o[I>>16&255]^h[A>>8&255]^l[255&S]^s[L+2],v=n[I>>>24]^o[A>>16&255]^h[S>>8&255]^l[255&b]^s[L+3],A=E,S=y,b=g,I=v,L+=4;E=r[A>>>24]<<24^r[S>>16&255]<<16^r[b>>8&255]<<8^r[255&I]^s[L],y=r[S>>>24]<<24^r[b>>16&255]<<16^r[I>>8&255]<<8^r[255&A]^s[L+1],g=r[b>>>24]<<24^r[I>>16&255]<<16^r[A>>8&255]<<8^r[255&S]^s[L+2],v=r[I>>>24]<<24^r[A>>16&255]<<16^r[S>>8&255]<<8^r[255&b]^s[L+3],T[O]=w(E^u),T[O+1]=w(v^d),T[O+2]=w(g^p),T[O+3]=w(y^f),u=X,d=N,p=R,f=P,O+=4}return T.buffer}}},51678:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});var s=i(49859);class r{constructor(t=0){(0,s.A)(this,"subtle",void 0),(0,s.A)(this,"key",void 0),(0,s.A)(this,"mode",void 0),(0,s.A)(this,"keyBuffer",void 0),this.mode=t,this.subtle=crypto.subtle||crypto.webkitSubtle}getSubtleAlgoName(){switch(this.mode){case 0:return"AES-CBC";case 1:return"AES-CTR"}}async expandKey(t){let e=new Uint8Array(t);if(this.keyBuffer){let t=!0,i=0;for(;i<e.length&&t;)t=e[i]===this.keyBuffer[i],i++;if(t)return}this.keyBuffer=e,this.key=await this.subtle.importKey("raw",t,{name:this.getSubtleAlgoName()},!1,["encrypt","decrypt"])}async encryptPadding(t,e){return new Uint8Array(await crypto.subtle.encrypt({name:"AES-CBC",iv:e},this.key,t))}async decrypt(t,e){switch(this.mode){case 0:return this.subtle.decrypt({name:"AES-CBC",iv:e},this.key,t);case 1:return this.subtle.decrypt({name:"AES-CTR",counter:e,length:64},this.key,t)}}static isSupport(){return"object"==typeof(crypto.subtle||crypto.webkitSubtle)}}},6498:(t,e,i)=>{"use strict";i(11265),i(67672),i(72739)},8507:(t,e,i)=>{"use strict";i.d(e,{ll:()=>E,qg:()=>l}),i(64007);var s=i(11265),r=i.n(s),a=(i(85569),i(57855)),n=i.n(a),o=i(56712),h=i.n(o);function l(t){const e=t,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],s=/:\/\/([^\/@]*@?)\[(\S+)\]/;let r="";s.test(t)&&(t=t.replace(s,((t,e,i)=>(r=i,`://${e||""}a.b`))));const a={},n=/^(?:(?![^:@\/]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@\/]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);let o=14;for(;o--;){var h;a[i[o]]=null!==(h=n[o])&&void 0!==h?h:""}return r&&(a.host=r,a.source=e,a.authority=r+(a.port?":"+a.port:"")),{protocol:a.protocol,file:a.file,host:a.host,port:a.port,user:a.user,password:a.password,origin:`${a.protocol}://${a.authority}`,pathname:a.path,search:`?${a.query}`,hash:a.anchor?`#${a.anchor}`:""}}i(67672),i(6498),i(72739),i(95335);const c=/(?:\/|^)\.(?=\/)/g,u=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,d=/^(?=([^\/?#]*))\1([^]*)$/,p=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/;function f(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}function m(t){const e=p.exec(t);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null}function T(t){var e,i;for(t=n()(e=t.split("")).call(e).join("").replace(c,"");t.length!==(t=t.replace(u,"")).length;);return n()(i=t.split("")).call(i).join("")}function E(t,e,i){if(i=i||{},t=r()(t).call(t),!(e=r()(e).call(e))){if(!i.alwaysNormalize)return t;let e=m(t);if(!e)throw new Error("Error trying to parse base URL.");return e.path=T(e.path),f(e)}let s=m(e);if(!s)throw new Error("Error trying to parse relative URL.");if(s.scheme)return i.alwaysNormalize?(s.path=T(s.path),f(s)):e;let a=m(t);if(!a)throw new Error("Error trying to parse base URL.");if(!a.netLoc&&a.path&&"/"!==a.path[0]){let t=d.exec(a.path);a.netLoc=t[1],a.path=t[2]}a.netLoc&&!a.path&&(a.path="/");const n={scheme:a.scheme,netLoc:s.netLoc,path:null,params:s.params,query:s.query,fragment:s.fragment};if(!s.netLoc&&(n.netLoc=a.netLoc,"/"!==s.path[0]))if(s.path){let t=a.path,e=t.substring(0,h()(t).call(t,"/")+1)+s.path;n.path=T(e)}else n.path=a.path,s.params||(n.params=a.params,s.query||(n.query=a.query));return null===n.path&&(n.path=i.alwaysNormalize?T(s.path):s.path),f(n)}},27124:(t,e,i)=>{t.exports=i(85837)},2457:(t,e,i)=>{t.exports=i(96796)},96319:(t,e,i)=>{t.exports=i(22616)},71426:(t,e,i)=>{t.exports=i(99617)},48079:(t,e,i)=>{t.exports=i(98894)},73363:(t,e,i)=>{t.exports=i(79528)},57855:(t,e,i)=>{t.exports=i(14106)},31721:(t,e,i)=>{t.exports=i(82990)},165:(t,e,i)=>{t.exports=i(12268)},85569:(t,e,i)=>{t.exports=i(76660)},52780:(t,e,i)=>{t.exports=i(18623)},82895:(t,e,i)=>{t.exports=i(94740)},63579:(t,e,i)=>{t.exports=i(46482)},80668:(t,e,i)=>{t.exports=i(13941)},45771:(t,e,i)=>{"use strict";i(99363),i(86024);var s=i(61747);t.exports=s("Array","entries")},16177:(t,e,i)=>{"use strict";i(49295);var s=i(61747);t.exports=s("Array","filter")},94668:(t,e,i)=>{"use strict";i(6290);var s=i(61747);t.exports=s("Array","find")},28253:(t,e,i)=>{"use strict";i(6687);var s=i(61747);t.exports=s("Array","map")},16693:(t,e,i)=>{"use strict";i(46339);var s=i(61747);t.exports=s("Array","reduce")},66429:(t,e,i)=>{"use strict";i(48559);var s=i(61747);t.exports=s("Array","reverse")},55939:(t,e,i)=>{"use strict";i(10521);var s=i(61747);t.exports=s("Array","some")},64048:(t,e,i)=>{"use strict";var s=i(88280),r=i(48270),a=String.prototype;t.exports=function(t){var e=t.endsWith;return"string"==typeof t||t===a||s(a,t)&&e===a.endsWith?r:e}},33155:(t,e,i)=>{"use strict";var s=i(88280),r=i(16177),a=Array.prototype;t.exports=function(t){var e=t.filter;return t===a||s(a,t)&&e===a.filter?r:e}},63246:(t,e,i)=>{"use strict";var s=i(88280),r=i(94668),a=Array.prototype;t.exports=function(t){var e=t.find;return t===a||s(a,t)&&e===a.find?r:e}},39299:(t,e,i)=>{"use strict";var s=i(88280),r=i(28253),a=Array.prototype;t.exports=function(t){var e=t.map;return t===a||s(a,t)&&e===a.map?r:e}},28823:(t,e,i)=>{"use strict";var s=i(88280),r=i(16693),a=Array.prototype;t.exports=function(t){var e=t.reduce;return t===a||s(a,t)&&e===a.reduce?r:e}},98059:(t,e,i)=>{"use strict";var s=i(88280),r=i(66429),a=Array.prototype;t.exports=function(t){var e=t.reverse;return t===a||s(a,t)&&e===a.reverse?r:e}},69685:(t,e,i)=>{"use strict";var s=i(88280),r=i(55939),a=Array.prototype;t.exports=function(t){var e=t.some;return t===a||s(a,t)&&e===a.some?r:e}},67961:(t,e,i)=>{"use strict";var s=i(88280),r=i(54491),a=String.prototype;t.exports=function(t){var e=t.startsWith;return"string"==typeof t||t===a||s(a,t)&&e===a.startsWith?r:e}},10317:(t,e,i)=>{"use strict";i(56648),i(49721);var s=i(92046),r=i(76024);s.JSON||(s.JSON={stringify:JSON.stringify}),t.exports=function(t,e,i){return r(s.JSON.stringify,null,arguments)}},99296:(t,e,i)=>{"use strict";i(52228);var s=i(92046);t.exports=s.Number.isInteger},32347:(t,e,i)=>{"use strict";i(25671);var s=i(92046);t.exports=s.Number.isNaN},15719:(t,e,i)=>{"use strict";i(42131);var s=i(92046);t.exports=s.Number.parseFloat},22744:(t,e,i)=>{"use strict";i(12276);var s=i(92046);t.exports=s.Number.parseInt},48270:(t,e,i)=>{"use strict";i(80430);var s=i(61747);t.exports=s("String","endsWith")},54491:(t,e,i)=>{"use strict";i(22395);var s=i(61747);t.exports=s("String","startsWith")},35043:(t,e,i)=>{"use strict";var s=i(82159),r=i(39298),a=i(16946),n=i(20575),o=TypeError,h="Reduce of empty array with no initial value",l=function(t){return function(e,i,l,c){var u=r(e),d=a(u),p=n(u);if(s(i),0===p&&l<2)throw new o(h);var f=t?p-1:0,m=t?-1:1;if(l<2)for(;;){if(f in d){c=d[f],f+=m;break}if(f+=m,t?f<0:p<=f)throw new o(h)}for(;t?f>=0:p>f;f+=m)f in d&&(c=i(c,d[f],f,u));return c}};t.exports={left:l(!1),right:l(!0)}},25735:(t,e,i)=>{"use strict";var s=i(76264)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[s]=!1,"/./"[t](e)}catch(t){}}return!1}},3701:(t,e,i)=>{"use strict";var s=i(1907),r=i(98828),a=i(81164).start,n=RangeError,o=isFinite,h=Math.abs,l=Date.prototype,c=l.toISOString,u=s(l.getTime),d=s(l.getUTCDate),p=s(l.getUTCFullYear),f=s(l.getUTCHours),m=s(l.getUTCMilliseconds),T=s(l.getUTCMinutes),E=s(l.getUTCMonth),y=s(l.getUTCSeconds);t.exports=r((function(){return"0385-07-25T07:06:39.999Z"!==c.call(new Date(-50000000000001))}))||!r((function(){c.call(new Date(NaN))}))?function(){if(!o(u(this)))throw new n("Invalid time value");var t=this,e=p(t),i=m(t),s=e<0?"-":e>9999?"+":"";return s+a(h(e),s?6:4,0)+"-"+a(E(t)+1,2,0)+"-"+a(d(t),2,0)+"T"+a(f(t),2,0)+":"+a(T(t),2,0)+":"+a(y(t),2,0)+"."+a(i,3,0)+"Z"}:c},65370:(t,e,i)=>{"use strict";var s=i(46285),r=Math.floor;t.exports=Number.isInteger||function(t){return!s(t)&&isFinite(t)&&r(t)===t}},72087:(t,e,i)=>{"use strict";var s=i(46285),r=i(45807),a=i(76264)("match");t.exports=function(t){var e;return s(t)&&(void 0!==(e=t[a])?!!e:"RegExp"===r(t))}},12074:(t,e,i)=>{"use strict";var s=i(72087),r=TypeError;t.exports=function(t){if(s(t))throw new r("The method doesn't accept regular expressions");return t}},81164:(t,e,i)=>{"use strict";var s=i(1907),r=i(3121),a=i(90160),n=i(69314),o=i(74239),h=s(n),l=s("".slice),c=Math.ceil,u=function(t){return function(e,i,s){var n,u,d=a(o(e)),p=r(i),f=d.length,m=void 0===s?" ":a(s);return p<=f||""===m?d:((u=h(m,c((n=p-f)/m.length))).length>n&&(u=l(u,0,n)),t?d+u:u+d)}};t.exports={start:u(!1),end:u(!0)}},69314:(t,e,i)=>{"use strict";var s=i(65482),r=i(90160),a=i(74239),n=RangeError;t.exports=function(t){var e=r(a(this)),i="",o=s(t);if(o<0||o===1/0)throw new n("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(i+=e);return i}},49295:(t,e,i)=>{"use strict";var s=i(11091),r=i(70726).filter;s({target:"Array",proto:!0,forced:!i(59552)("filter")},{filter:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},6290:(t,e,i)=>{"use strict";var s=i(11091),r=i(70726).find,a=i(42156),n="find",o=!0;n in[]&&Array(1)[n]((function(){o=!1})),s({target:"Array",proto:!0,forced:o},{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),a(n)},6687:(t,e,i)=>{"use strict";var s=i(11091),r=i(70726).map;s({target:"Array",proto:!0,forced:!i(59552)("map")},{map:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},46339:(t,e,i)=>{"use strict";var s=i(11091),r=i(35043).left,a=i(77623),n=i(20798);s({target:"Array",proto:!0,forced:!i(47586)&&n>79&&n<83||!a("reduce")},{reduce:function(t){var e=arguments.length;return r(this,t,e,e>1?arguments[1]:void 0)}})},48559:(t,e,i)=>{"use strict";var s=i(11091),r=i(1907),a=i(11793),n=r([].reverse),o=[1,2];s({target:"Array",proto:!0,forced:String(o)===String(o.reverse())},{reverse:function(){return a(this)&&(this.length=this.length),n(this)}})},10521:(t,e,i)=>{"use strict";var s=i(11091),r=i(70726).some;s({target:"Array",proto:!0,forced:!i(77623)("some")},{some:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},56648:(t,e,i)=>{"use strict";var s=i(11091),r=i(13930),a=i(39298),n=i(46028),o=i(3701),h=i(45807);s({target:"Date",proto:!0,forced:i(98828)((function(){return null!==new Date(NaN).toJSON()||1!==r(Date.prototype.toJSON,{toISOString:function(){return 1}})}))},{toJSON:function(t){var e=a(this),i=n(e,"number");return"number"!=typeof i||isFinite(i)?"toISOString"in e||"Date"!==h(e)?e.toISOString():r(o,e):null}})},52228:(t,e,i)=>{"use strict";i(11091)({target:"Number",stat:!0},{isInteger:i(65370)})},25671:(t,e,i)=>{"use strict";i(11091)({target:"Number",stat:!0},{isNaN:function(t){return t!=t}})},42131:(t,e,i)=>{"use strict";var s=i(11091),r=i(27213);s({target:"Number",stat:!0,forced:Number.parseFloat!==r},{parseFloat:r})},12276:(t,e,i)=>{"use strict";var s=i(11091),r=i(72778);s({target:"Number",stat:!0,forced:Number.parseInt!==r},{parseInt:r})},80430:(t,e,i)=>{"use strict";var s,r=i(11091),a=i(92361),n=i(13846).f,o=i(3121),h=i(90160),l=i(12074),c=i(74239),u=i(25735),d=i(7376),p=a("".slice),f=Math.min,m=u("endsWith");r({target:"String",proto:!0,forced:!(!d&&!m&&(s=n(String.prototype,"endsWith"),s&&!s.writable)||m)},{endsWith:function(t){var e=h(c(this));l(t);var i=arguments.length>1?arguments[1]:void 0,s=e.length,r=void 0===i?s:f(o(i),s),a=h(t);return p(e,r-a.length,r)===a}})},22395:(t,e,i)=>{"use strict";var s,r=i(11091),a=i(92361),n=i(13846).f,o=i(3121),h=i(90160),l=i(12074),c=i(74239),u=i(25735),d=i(7376),p=a("".slice),f=Math.min,m=u("startsWith");r({target:"String",proto:!0,forced:!(!d&&!m&&(s=n(String.prototype,"startsWith"),s&&!s.writable)||m)},{startsWith:function(t){var e=h(c(this));l(t);var i=o(f(arguments.length>1?arguments[1]:void 0,e.length)),s=h(t);return p(e,i,i+s.length)===s}})},22392:(t,e,i)=>{"use strict";var s=i(45771);t.exports=s},85837:(t,e,i)=>{"use strict";var s=i(64048);t.exports=s},96796:(t,e,i)=>{"use strict";i(12560);var s=i(73948),r=i(49724),a=i(88280),n=i(22392),o=Array.prototype,h={DOMTokenList:!0,NodeList:!0};t.exports=function(t){var e=t.entries;return t===o||a(o,t)&&e===o.entries||r(h,s(t))?n:e}},22616:(t,e,i)=>{"use strict";var s=i(33155);t.exports=s},99617:(t,e,i)=>{"use strict";var s=i(63246);t.exports=s},98894:(t,e,i)=>{"use strict";var s=i(39299);t.exports=s},79528:(t,e,i)=>{"use strict";var s=i(28823);t.exports=s},14106:(t,e,i)=>{"use strict";var s=i(98059);t.exports=s},82990:(t,e,i)=>{"use strict";var s=i(69685);t.exports=s},12268:(t,e,i)=>{"use strict";var s=i(67961);t.exports=s},76660:(t,e,i)=>{"use strict";var s=i(10317);t.exports=s},18623:(t,e,i)=>{"use strict";var s=i(99296);t.exports=s},94740:(t,e,i)=>{"use strict";var s=i(32347);t.exports=s},46482:(t,e,i)=>{"use strict";var s=i(15719);t.exports=s},13941:(t,e,i)=>{"use strict";var s=i(22744);t.exports=s}}]);